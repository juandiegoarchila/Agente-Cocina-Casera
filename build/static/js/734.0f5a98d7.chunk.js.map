{"version":3,"file":"static/js/734.0f5a98d7.chunk.js","mappings":"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","sources":["components/common/PaymentSplitEditor.js","utils/payments.js","components/Admin/utilities/exportToExcel.js","components/Admin/utilities/exportToPDF.js","components/Admin/utilities/exportToCSV.js","components/Admin/utils.js","components/Admin/TablaPedidos.js","components/Admin/InteraccionesPedidos.js","components/Admin/OrderManagement.js","components/Admin/utilities/previewOrders.js","components/Admin/utilities/previewExcel.js","utils/classNames.js"],"sourcesContent":["// src/components/common/PaymentSplitEditor.jsx\r\nimport React, { useEffect, useMemo, useState } from 'react';\r\nimport { classNames } from '../../utils/classNames';\r\n\r\nconst toInt = (v) => {\r\n  const n = Math.floor(Number(v || 0));\r\n  return Number.isFinite(n) ? n : 0;\r\n};\r\n\r\nconst normKey = (s) => (s || '').toString().trim().toLowerCase();\r\n\r\nconst buildMethodOptions = (catalogMethods) => {\r\n  if (Array.isArray(catalogMethods) && catalogMethods.length) {\r\n    const names = catalogMethods\r\n      .map((m) => (typeof m === 'string' ? m : (m?.name || m?.label || '')))\r\n      .filter(Boolean);\r\n    return Array.from(new Set(names));\r\n  }\r\n  return ['Efectivo', 'Nequi', 'Daviplata'];\r\n};\r\n\r\nexport default function PaymentSplitEditor({\r\n  theme = 'light',\r\n  total = 0,\r\n  value = [],\r\n  onChange,\r\n  catalogMethods = [],\r\n  disabled = false,\r\n}) {\r\n  const methods = useMemo(() => buildMethodOptions(catalogMethods), [catalogMethods]);\r\n\r\n  const [rows, setRows] = useState(() => {\r\n    const sanitized = Array.isArray(value) ? value : [];\r\n    if (sanitized.length) {\r\n      return sanitized.map((r) => ({\r\n        method: typeof r.method === 'string' ? r.method : (r?.method?.name || ''),\r\n        amount: toInt(r.amount),\r\n        note: r.note || '',\r\n      }));\r\n    }\r\n    return [{ method: 'Efectivo', amount: toInt(total), note: '' }];\r\n  });\r\n\r\n  useEffect(() => {\r\n    const sanitized = Array.isArray(value) ? value : [];\r\n    if (sanitized.length) {\r\n      setRows(\r\n        sanitized.map((r) => ({\r\n          method: typeof r.method === 'string' ? r.method : (r?.method?.name || ''),\r\n          amount: toInt(r.amount),\r\n          note: r.note || '',\r\n        }))\r\n      );\r\n    }\r\n  }, [value]);\r\n\r\n  const sum = rows.reduce((acc, r) => acc + toInt(r.amount), 0);\r\n  const diff = toInt(total) - sum;\r\n  const ok = diff === 0;\r\n\r\n  const emit = (next) => {\r\n    setRows(next);\r\n    onChange &&\r\n      onChange(\r\n        next.map((r) => ({\r\n          method: r.method,\r\n          amount: toInt(r.amount),\r\n          note: r.note || '',\r\n        }))\r\n      );\r\n  };\r\n\r\n  const handleChange = (idx, key, val) => {\r\n    const next = rows.map((r, i) => (i === idx ? { ...r, [key]: key === 'amount' ? toInt(val) : val } : r));\r\n    emit(next);\r\n  };\r\n\r\n  const addRow = () => {\r\n    const unused = methods.find((m) => !rows.some((r) => normKey(r.method) === normKey(m))) || methods[0];\r\n    const next = [...rows, { method: unused, amount: Math.max(0, diff), note: '' }];\r\n    emit(next);\r\n  };\r\n\r\n  const removeRow = (idx) => {\r\n    const next = rows.filter((_, i) => i !== idx);\r\n    emit(next.length ? next : [{ method: 'Efectivo', amount: toInt(total), note: '' }]);\r\n  };\r\n\r\n  const fill5050 = () => {\r\n    if (methods.length < 2) return;\r\n    const half = Math.floor(toInt(total) / 2);\r\n    const rest = toInt(total) - half;\r\n    emit([\r\n      { method: methods[0], amount: half, note: '' },\r\n      { method: methods[1], amount: rest, note: '' },\r\n    ]);\r\n  };\r\n\r\n  const split3 = () => {\r\n    const a = Math.floor(toInt(total) / 3);\r\n    const b = Math.floor((toInt(total) - a) / 2);\r\n    const c = toInt(total) - a - b;\r\n    emit([\r\n      { method: methods[0] || 'Efectivo', amount: a, note: '' },\r\n      { method: methods[1] || 'Nequi', amount: b, note: '' },\r\n      { method: methods[2] || 'Daviplata', amount: c, note: '' },\r\n    ]);\r\n  };\r\n\r\n  const setAllTo = (m) => {\r\n    emit([{ method: m, amount: toInt(total), note: '' }]);\r\n  };\r\n\r\n  return (\r\n    <div className={classNames(\"p-3 rounded-lg border\", theme === 'dark' ? 'border-gray-600 bg-gray-800' : 'border-gray-200 bg-gray-50')}>\r\n      <div className=\"flex flex-wrap items-center justify-between gap-2 mb-2\">\r\n        <h5 className=\"font-semibold text-sm\">Dividir pago</h5>\r\n        <div className=\"flex flex-wrap gap-2\">\r\n          <button type=\"button\" disabled={disabled} onClick={fill5050}\r\n            className={classNames(\"px-2 py-1 rounded text-xs border\", theme==='dark'?'border-gray-500 hover:bg-gray-700':'border-gray-300 hover:bg-white')}>\r\n            50 / 50\r\n          </button>\r\n          <button type=\"button\" disabled={disabled} onClick={split3}\r\n            className={classNames(\"px-2 py-1 rounded text-xs border\", theme==='dark'?'border-gray-500 hover:bg-gray-700':'border-gray-300 hover:bg-white')}>\r\n            1/3 cada uno\r\n          </button>\r\n          {methods.map((m) => (\r\n            <button key={m} type=\"button\" disabled={disabled} onClick={() => setAllTo(m)}\r\n              className={classNames(\"px-2 py-1 rounded text-xs border\", theme==='dark'?'border-gray-500 hover:bg-gray-700':'border-gray-300 hover:bg-white')}>\r\n              Todo {m}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"space-y-2\">\r\n        {rows.map((r, idx) => (\r\n          <div key={idx} className=\"grid grid-cols-1 sm:grid-cols-12 gap-2 items-center\">\r\n            <select\r\n              disabled={disabled}\r\n              value={r.method}\r\n              onChange={(e) => handleChange(idx, 'method', e.target.value)}\r\n              className={classNames(\"sm:col-span-4 p-2 rounded border text-sm\", theme==='dark'?'border-gray-600 bg-gray-700 text-white':'border-gray-300 bg-white')}\r\n            >\r\n              {methods.map((m) => (\r\n                <option key={m} value={m}>{m}</option>\r\n              ))}\r\n            </select>\r\n\r\n            <input\r\n              disabled={disabled}\r\n              type=\"number\"\r\n              min=\"0\"\r\n              step=\"1\"\r\n              value={r.amount}\r\n              onChange={(e) => handleChange(idx, 'amount', e.target.value)}\r\n              className={classNames(\"sm:col-span-4 p-2 rounded border text-sm\", theme==='dark'?'border-gray-600 bg-gray-700 text-white':'border-gray-300 bg-white')}\r\n              placeholder=\"Monto en COP\"\r\n            />\r\n\r\n            <input\r\n              disabled={disabled}\r\n              type=\"text\"\r\n              value={r.note || ''}\r\n              onChange={(e) => handleChange(idx, 'note', e.target.value)}\r\n              className={classNames(\"sm:col-span-3 p-2 rounded border text-sm\", theme==='dark'?'border-gray-600 bg-gray-700 text-white':'border-gray-300 bg-white')}\r\n              placeholder=\"Nota (opcional)\"\r\n            />\r\n\r\n            <div className=\"sm:col-span-1 flex justify-end\">\r\n              <button type=\"button\" disabled={disabled} onClick={() => removeRow(idx)}\r\n                className={classNames(\"px-2 py-1 rounded text-xs border\", theme==='dark'?'border-gray-500 hover:bg-gray-700':'border-gray-300 hover:bg-white')}>\r\n                ✕\r\n              </button>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      <div className=\"mt-3 flex items-center justify-between text-sm\">\r\n        <button type=\"button\" disabled={disabled} onClick={addRow}\r\n          className={classNames(\"px-3 py-1 rounded border\", theme==='dark'?'border-gray-500 hover:bg-gray-700':'border-gray-300 hover:bg-white')}>\r\n          + Añadir línea\r\n        </button>\r\n\r\n        <div className=\"flex items-center gap-2\">\r\n          <span>Total pedido:</span>\r\n          <strong>${toInt(total).toLocaleString('es-CO')}</strong>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"mt-2\">\r\n        {ok ? (\r\n          <span className={classNames(\"inline-block text-xs px-2 py-1 rounded\", theme==='dark'?'bg-green-700 text-white':'bg-green-100 text-green-800')}>\r\n            ✔ Suma exacta\r\n          </span>\r\n        ) : diff > 0 ? (\r\n          <span className={classNames(\"inline-block text-xs px-2 py-1 rounded\", theme==='dark'?'bg-yellow-700 text-white':'bg-yellow-100 text-yellow-800')}>\r\n            Falta asignar ${diff.toLocaleString('es-CO')}\r\n          </span>\r\n        ) : (\r\n          <span className={classNames(\"inline-block text-xs px-2 py-1 rounded\", theme==='dark'?'bg-red-700 text-white':'bg-red-100 text-red-800')}>\r\n            Sobran ${Math.abs(diff).toLocaleString('es-CO')}\r\n          </span>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","// src/utils/payments.js\r\n// Utilidades para normalizar métodos de pago y sumar exactamente por split o legado.\r\n\r\nconst norm = (s) => (s ?? '').toString().trim().toLowerCase();\r\n\r\nexport const normalizePaymentMethodKey = (methodLike) => {\r\n  const raw =\r\n    typeof methodLike === 'string'\r\n      ? methodLike\r\n      : methodLike?.name || methodLike?.label || methodLike?.title || methodLike?.method || methodLike?.type || methodLike?.payment || '';\r\n  const t = norm(raw);\r\n  if (t.includes('efect') || t.includes('cash')) return 'cash';\r\n  if (t.includes('nequi')) return 'nequi';\r\n  if (t.includes('davi')) return 'daviplata';\r\n  return 'other';\r\n};\r\n\r\nconst pickMethodLabel = (methodLike) => {\r\n  if (typeof methodLike === 'string') return methodLike;\r\n  return (\r\n    methodLike?.name ||\r\n    methodLike?.label ||\r\n    methodLike?.title ||\r\n    methodLike?.method ||\r\n    methodLike?.type ||\r\n    methodLike?.payment ||\r\n    'Otro'\r\n  );\r\n};\r\n\r\n/**\r\n * Extrae filas [{methodKey, amount, rawLabel}] desde una orden.\r\n * - Si existe order.payments (split), lo usa.\r\n * - Sino, detecta método legado y asigna 100% del total.\r\n * - Sino, cae en {other}.\r\n */\r\nexport const extractOrderPayments = (order) => {\r\n  const total = Math.floor(Number(order?.total || 0)) || 0;\r\n\r\n  if (Array.isArray(order?.payments) && order.payments.length) {\r\n    return order.payments.map((p) => {\r\n      const amount = Math.floor(Number(p?.amount || 0)) || 0;\r\n      return {\r\n        methodKey: normalizePaymentMethodKey(p?.method),\r\n        amount,\r\n        rawLabel: pickMethodLabel(p?.method),\r\n      };\r\n    });\r\n  }\r\n\r\n  const legacySources = [\r\n    order?.meals?.[0]?.paymentMethod ?? order?.meals?.[0]?.payment,\r\n    order?.breakfasts?.[0]?.payment ?? order?.breakfasts?.[0]?.paymentMethod,\r\n    order?.paymentMethod ?? order?.payment,\r\n  ].filter(Boolean);\r\n\r\n  if (legacySources.length) {\r\n    const label = pickMethodLabel(legacySources[0]);\r\n    return [\r\n      {\r\n        methodKey: normalizePaymentMethodKey(legacySources[0]),\r\n        amount: total,\r\n        rawLabel: label,\r\n      },\r\n    ];\r\n  }\r\n\r\n  return [{ methodKey: 'other', amount: total, rawLabel: 'Otro' }];\r\n};\r\n\r\n/** Texto compacto: \"Efectivo $6.000 + Nequi $6.000\" */\r\nexport const summarizePayments = (paymentsRows = []) => {\r\n  if (!Array.isArray(paymentsRows) || !paymentsRows.length) return 'Sin pago';\r\n  const agg = paymentsRows.reduce((a, r) => {\r\n    const key = r.methodKey || normalizePaymentMethodKey(r?.method);\r\n    a[key] = (a[key] || 0) + (Math.floor(Number(r.amount || 0)) || 0);\r\n    return a;\r\n  }, {});\r\n  const asText = [];\r\n  if (agg.cash) asText.push(`Efectivo $${agg.cash.toLocaleString('es-CO')}`);\r\n  if (agg.nequi) asText.push(`Nequi $${agg.nequi.toLocaleString('es-CO')}`);\r\n  if (agg.daviplata) asText.push(`Daviplata $${agg.daviplata.toLocaleString('es-CO')}`);\r\n  if (agg.other && !asText.length) asText.push(`Otro $${agg.other.toLocaleString('es-CO')}`);\r\n  return asText.join(' + ') || 'Sin pago';\r\n};\r\n\r\n/**\r\n * Valor por defecto para el editor de split:\r\n * - Si hay split → se usa tal cual\r\n * - Si hay método legado → 100% al método\r\n * - Sino → 100% Efectivo\r\n */\r\nexport const defaultPaymentsForOrder = (order) => {\r\n  const rows = extractOrderPayments(order);\r\n  if (rows?.length) return rows.map(({ methodKey, amount }) => ({ method: methodKey, amount }));\r\n  const total = Math.floor(Number(order?.total || 0)) || 0;\r\n  return [{ method: 'cash', amount: total }];\r\n};\r\n\r\n/**\r\n * Totales simples por método (para tiles/chips rápidos).\r\n * Devuelve: { cash, nequi, daviplata, other, total }\r\n */\r\nexport const sumPaymentsByMethod = (orders = []) => {\r\n  const out = { cash: 0, nequi: 0, daviplata: 0, other: 0, total: 0 };\r\n  for (const order of orders) {\r\n    const rows = extractOrderPayments(order);\r\n    for (const r of rows) {\r\n      const amt = Math.floor(Number(r.amount || 0)) || 0;\r\n      out[r.methodKey] = (out[r.methodKey] || 0) + amt;\r\n      out.total += amt;\r\n    }\r\n  }\r\n  return out;\r\n};\r\n\r\n/** Helpers de clasificación por tipo/ubicación */\r\nexport const isBreakfastOrder = (order) =>\r\n  order?.type === 'breakfast' || Array.isArray(order?.breakfasts);\r\n\r\nexport const isDeliveryOrder = (order) => {\r\n  const tag =\r\n    order?.orderType ||\r\n    order?.meals?.[0]?.orderType ||\r\n    order?.breakfasts?.[0]?.orderType ||\r\n    '';\r\n  const collection = (order?.__collection || '').toLowerCase();\r\n  const c = norm(tag);\r\n  if (collection.includes('delivery')) return true;\r\n  if (c.includes('delivery') || c.includes('domicil')) return true;\r\n  return false;\r\n};\r\n\r\nexport const isTableOrder = (order) => {\r\n  const collection = (order?.__collection || '').toLowerCase();\r\n  if (collection.includes('table')) return true;\r\n  const tableNumber =\r\n    order?.meals?.[0]?.tableNumber ?? order?.breakfasts?.[0]?.tableNumber;\r\n  return !!tableNumber;\r\n};\r\n\r\n/** Consideramos \"salón\" lo hecho por mesero: mesa o llevar desde mesa/breakfast table/takeaway */\r\nexport const isSalonOrder = (order) => {\r\n  const collection = (order?.__collection || '').toLowerCase();\r\n  // Cualquier cosa que provenga de colecciones de mesa pertenece a salón\r\n  if (collection.includes('table')) return true;\r\n\r\n  // Para desayunos creados como mesa o para llevar por mesero, también cuenta como salón\r\n  const t = norm(order?.orderType || order?.breakfasts?.[0]?.orderType || '');\r\n  if (Array.isArray(order?.breakfasts) && (t.includes('table') || t.includes('takeaway') || t.includes('para llevar') || t.includes('llevar'))) {\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n};\r\n\r\n\r\n/** Marcas típicas para saber si el domiciliario ya liquidó el efectivo */\r\nexport const isCashSettled = (order) => {\r\n  if (order?.settlement?.status && norm(order.settlement.status) === 'liquidated') return true;\r\n  if (order?.liquidated === true) return true;\r\n  if (order?.cashSettled === true) return true;\r\n  if (order?.settledAt) return true;\r\n  return false;\r\n};\r\n\r\n/** Totales por método con semántica de caja */\r\nexport const calcMethodTotalsAll = (orders = [], tableOrders = [], breakfastOrders = []) => {\r\n  const acc = {\r\n    nequiTotal: 0,\r\n    daviplataTotal: 0,\r\n    nequiPendiente: 0,\r\n    daviplatasPendiente: 0,\r\n    cashSalon: 0,\r\n    cashClientesSettled: 0,\r\n    cashClientesPendiente: 0,\r\n    totalLiquidado: 0,\r\n    totalPendiente: 0,\r\n    totalDomicilios: 0,\r\n    totalSalon: 0\r\n  };\r\n\r\n  const accumulate = (list = []) => {\r\n    for (const o of list) {\r\n      const rows = extractOrderPayments(o);\r\n      const isSalon = isSalonOrder(o);\r\n      \r\n      // Para cada método de pago en la orden\r\n      for (const r of rows) {\r\n        const amt = Math.floor(Number(r?.amount || 0)) || 0;\r\n        if (amt <= 0) continue;\r\n\r\n        if (isSalon) {\r\n          // Los pagos de salón siempre se suman al total\r\n          acc.totalSalon += amt;\r\n          if (r.methodKey === 'cash') acc.cashSalon += amt;\r\n          else if (r.methodKey === 'nequi') acc.nequiTotal += amt;\r\n          else if (r.methodKey === 'daviplata') acc.daviplataTotal += amt;\r\n          acc.totalLiquidado += amt;\r\n        } else {\r\n          // Para domicilios\r\n          acc.totalDomicilios += amt;\r\n          \r\n          // Depende del estado de liquidación\r\n          if (r.methodKey === 'cash') {\r\n            if (o?.settled || o?.paymentSettled?.cash) {\r\n              acc.cashClientesSettled += amt;\r\n              acc.totalLiquidado += amt;\r\n            } else {\r\n              acc.cashClientesPendiente += amt;\r\n              acc.totalPendiente += amt;\r\n            }\r\n          }\r\n          else if (r.methodKey === 'nequi') {\r\n            if (o?.settled || o?.paymentSettled?.nequi) {\r\n              acc.nequiTotal += amt;\r\n              acc.totalLiquidado += amt;\r\n            } else {\r\n              acc.nequiPendiente += amt;\r\n              acc.totalPendiente += amt;\r\n            }\r\n          }\r\n          else if (r.methodKey === 'daviplata') {\r\n            if (o?.settled || o?.paymentSettled?.daviplata) {\r\n              acc.daviplataTotal += amt;\r\n              acc.totalLiquidado += amt;\r\n            } else {\r\n              acc.daviplatasPendiente += amt;\r\n              acc.totalPendiente += amt;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  accumulate(orders);\r\n  accumulate(tableOrders);\r\n  accumulate(breakfastOrders);\r\n\r\n  acc.cashCaja = acc.cashSalon + acc.cashClientesSettled;\r\n  \r\n  return acc;\r\n};\r\n","//src/components/Admin/utilities/exportToExcel.js\r\nimport ExcelJS from 'exceljs';\r\n\r\nexport const exportToExcel = async (orders, totals, deliveryPersons, totalProteinUnits, proteins) => {\r\n  try {\r\n    const workbook = new ExcelJS.Workbook();\r\n    const worksheet = workbook.addWorksheet('Gestión de Pedidos');\r\n\r\n    const cleanText = (text) => {\r\n      if (text == null || text === undefined) return '';\r\n      if (typeof text === 'string') return text.replace(' NUEVO', '').trim();\r\n      if (typeof text === 'boolean') return text.toString();\r\n      if (typeof text === 'object' && text !== null && 'name' in text && typeof text.name === 'string') {\r\n        return text.name.replace(' NUEVO', '').trim();\r\n      }\r\n      return String(text).replace(' NUEVO', '').trim();\r\n    };\r\n\r\n    const applyThinBorder = (cell) => {\r\n      cell.border = {\r\n        top: { style: 'thin', color: { argb: 'FF000000' } },\r\n        left: { style: 'thin', color: { argb: 'FF000000' } },\r\n        bottom: { style: 'thin', color: { argb: 'FF000000' } },\r\n        right: { style: 'thin', color: { argb: 'FF000000' } },\r\n      };\r\n    };\r\n\r\n    // 🟡 1. Resumen de Proteínas\r\n    worksheet.addRow(['', 'PROTEÍNAS DEL DÍA']);\r\n    const proteinHeaderRow = worksheet.lastRow.number;\r\n    worksheet.mergeCells(proteinHeaderRow, 2, proteinHeaderRow, 3);\r\n    const ourHeader = worksheet.getCell(`B${proteinHeaderRow}`);\r\n    ourHeader.font = { bold: true, color: { argb: 'FFFFFFFF' } };\r\n    ourHeader.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF0066CC' } };\r\n    ourHeader.alignment = { horizontal: 'center' };\r\n\r\n    worksheet.getRow(proteinHeaderRow + 1).values = ['', 'Proteína', 'Unidades', '', ''];\r\n    const proteinTableHeader = worksheet.getRow(proteinHeaderRow + 1);\r\n    proteinTableHeader.eachCell((cell, colNumber) => {\r\n      if (colNumber === 2 || colNumber === 3) {\r\n        cell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF28A745' } };\r\n        cell.font = { color: { argb: 'FFFFFFFF' }, bold: true };\r\n        cell.alignment = { horizontal: 'center' };\r\n        applyThinBorder(cell);\r\n      }\r\n      if (colNumber === 4 || colNumber === 5) {\r\n        cell.value = '';\r\n      }\r\n    });\r\n\r\n    const proteinData = proteins.length === 0\r\n      ? [{ name: '-', quantity: '-', extra: '', extraValue: '' }]\r\n      : [\r\n          ...proteins.slice(0, -2),\r\n          {\r\n            name: proteins[proteins.length - 2]?.name || '-',\r\n            quantity: proteins[proteins.length - 2]?.quantity || '-',\r\n            extra: 'TOTAL PROTEÍNAS:',\r\n            extraValue: totalProteinUnits.toLocaleString('es-CO'),\r\n          },\r\n          {\r\n            name: proteins[proteins.length - 1]?.name || '-',\r\n            quantity: proteins[proteins.length - 1]?.quantity || '-',\r\n            extra: 'Fecha actual:',\r\n            extraValue: `${String(new Date().getDate()).padStart(2, '0')}/${String(new Date().getMonth() + 1).padStart(2, '0')}/${new Date().getFullYear()}`,\r\n          },\r\n        ];\r\n\r\n    proteinData.forEach((protein, index) => {\r\n      const row = worksheet.addRow(['', cleanText(protein.name), protein.quantity, protein.extra, protein.extraValue]);\r\n      row.eachCell((cell, colNumber) => {\r\n        if (colNumber >= 2) {\r\n          if (index >= proteinData.length - 2 || colNumber === 2 || colNumber === 3) {\r\n            applyThinBorder(cell);\r\n          }\r\n          if (colNumber === 3) {\r\n            cell.numFmt = '#,##0';\r\n            cell.alignment = { horizontal: 'right' };\r\n          }\r\n          if (colNumber === 4) cell.alignment = { horizontal: 'left' };\r\n          if (colNumber === 5) cell.alignment = { horizontal: 'right' };\r\n        }\r\n      });\r\n    });\r\n\r\n    worksheet.addRow({});\r\n    worksheet.addRow({});\r\n\r\n    // 🟢 2. Pedidos\r\n    let mealCounter = 0;\r\n    const pedidos = orders.map((order, index) => {\r\n      mealCounter += 1;\r\n      const meal = order.meals?.[0] || {};\r\n      const paymentValue = order.payment || (typeof meal.payment === 'object' && meal.payment?.name) || meal.payment || 'Efectivo';\r\n      if (!paymentValue || (typeof paymentValue === 'object' && !('name' in paymentValue))) {\r\n        console.warn(`Invalid payment data in order ${order.id || index}:`, { order, paymentValue });\r\n      }\r\n      return {\r\n        N: mealCounter,\r\n        Dirección: cleanText(meal.address?.address),\r\n        Teléfono: cleanText(meal.address?.phoneNumber),\r\n        Total: order.total || 0,\r\n        MétodoDePago: cleanText(paymentValue),\r\n        Domiciliario: cleanText(order.deliveryPerson || 'Sin asignar'),\r\n      };\r\n    });\r\n\r\n    if (pedidos.length === 0) {\r\n      pedidos.push({ N: '-', Dirección: '-', Teléfono: '-', Total: '-', MétodoDePago: '-', Domiciliario: '-' });\r\n    }\r\n\r\n    worksheet.columns = [\r\n      { key: 'N', width: 10 },\r\n      { key: 'Dirección', width: 30 },\r\n      { key: 'Teléfono', width: 15 },\r\n      { key: 'Total', width: 15 },\r\n      { key: 'MétodoDePago', width: 15 },\r\n      { key: 'Domiciliario', width: 25 },\r\n    ];\r\n\r\n    const pedidosHeaderRow = proteinData.length + 4;\r\n    const headerRow = worksheet.getRow(pedidosHeaderRow);\r\n    headerRow.values = ['N', 'Dirección', 'Teléfono', 'Total', 'Método de Pago', 'Domiciliario'];\r\n    headerRow.eachCell(cell => {\r\n      cell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF0066CC' } };\r\n      cell.font = { color: { argb: 'FFFFFFFF' }, bold: true };\r\n      cell.alignment = { horizontal: 'center' };\r\n      applyThinBorder(cell);\r\n    });\r\n\r\n    pedidos.forEach(pedido => {\r\n      const row = worksheet.addRow(pedido);\r\n      row.eachCell(cell => applyThinBorder(cell));\r\n    });\r\n\r\n    worksheet.addRow({});\r\n    worksheet.addRow({});\r\n\r\n    // 🟠 3. Resumen de Totales\r\n    worksheet.addRow([]);\r\n    const resumenRow = worksheet.lastRow.number;\r\n    worksheet.getCell(`C${resumenRow}`).value = 'Resumen de Totales';\r\n    worksheet.mergeCells(`C${resumenRow}:D${resumenRow}`);\r\n    const resumenCell = worksheet.getCell(`C${resumenRow}`);\r\n    resumenCell.font = { bold: true, color: { argb: 'FFFFFFFF' } };\r\n    resumenCell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF0066CC' } };\r\n    resumenCell.alignment = { horizontal: 'center' };\r\n    applyThinBorder(resumenCell);\r\n    applyThinBorder(worksheet.getCell(`D${resumenRow}`));\r\n\r\n    const resumenData = [\r\n      ['Total Efectivo', totals.cash || 0],\r\n      ['Total Daviplata', totals.daviplata || 0],\r\n      ['Total Nequi', totals.nequi || 0],\r\n      ['Total General', (totals.cash || 0) + (totals.daviplata || 0) + (totals.nequi || 0)],\r\n    ];\r\n\r\n    resumenData.forEach(([label, value]) => {\r\n      const row = worksheet.addRow(['', '', label, value]);\r\n      row.getCell(3).alignment = { horizontal: 'left' };\r\n      row.getCell(4).alignment = { horizontal: 'right' };\r\n      row.getCell(4).numFmt = '$#,##0';\r\n      row.getCell(4).font = { bold: true };\r\n      applyThinBorder(row.getCell(3));\r\n      applyThinBorder(row.getCell(4));\r\n    });\r\n\r\n    worksheet.addRow({});\r\n    worksheet.addRow({});\r\n\r\n    // 🔵 4. Resumen por Domiciliarios\r\n    worksheet.addRow(['', 'Resumen por Domiciliarios']);\r\n    const resumenDomiciliariosRow = worksheet.lastRow.number;\r\n    worksheet.mergeCells(resumenDomiciliariosRow, 2, resumenDomiciliariosRow, 6);\r\n    const deliveryHeader = worksheet.getCell(`B${resumenDomiciliariosRow}`);\r\n    deliveryHeader.font = { bold: true, color: { argb: 'FFFFFFFF' } };\r\n    deliveryHeader.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF0066CC' } };\r\n    deliveryHeader.alignment = { horizontal: 'center' };\r\n    for (let i = 2; i <= 6; i++) applyThinBorder(worksheet.getCell(resumenDomiciliariosRow, i));\r\n\r\n    worksheet.addRow(['', 'Domiciliario', 'Efectivo', 'Daviplata', 'Nequi', 'Total']);\r\n    const domHeader = worksheet.lastRow;\r\n    domHeader.eachCell((cell, colNumber) => {\r\n      if (colNumber >= 2) {\r\n        cell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF28A745' } };\r\n        cell.font = { color: { argb: 'FFFFFFFF' }, bold: true };\r\n        cell.alignment = { horizontal: 'center' };\r\n        applyThinBorder(cell);\r\n      }\r\n    });\r\n\r\n    Object.entries(deliveryPersons).forEach(([name, data]) => {\r\n      const row = worksheet.addRow([\r\n        '',\r\n        cleanText(name),\r\n        data.cash || 0,\r\n        data.daviplata || 0,\r\n        data.nequi || 0,\r\n        data.total || 0,\r\n      ]);\r\n      row.eachCell((cell, colNumber) => {\r\n        if (colNumber >= 2) {\r\n          if (colNumber >= 3) {\r\n            cell.numFmt = '$#,##0';\r\n            cell.alignment = { horizontal: 'right' };\r\n          }\r\n          applyThinBorder(cell);\r\n        }\r\n      });\r\n    });\r\n\r\n    const buffer = await workbook.xlsx.writeBuffer();\r\n    const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });\r\n    const link = document.createElement('a');\r\n    link.href = window.URL.createObjectURL(blob);\r\n    link.download = `pedidos_${new Date().toISOString().slice(0, 10)}.xlsx`;\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  } catch (error) {\r\n    console.error('Error al exportar Excel:', error);\r\n    alert('Error al generar el archivo Excel: ' + error.message);\r\n  }\r\n};","// src/components/Admin/utilities/exportToPDF.js\r\nimport jsPDF from 'jspdf';\r\nimport autoTable from 'jspdf-autotable';\r\n\r\nexport const exportToPDF = async (orders, totals = {}, deliveryPersons = {}) => {\r\n  try {\r\n    const doc = new jsPDF();\r\n\r\n    const logoUrl = '/logo.png'; // Asegúrate de que esta ruta sea accesible\r\n    try {\r\n      doc.addImage(logoUrl, 'PNG', 160, 10, 30, 20);\r\n    } catch (imgError) {\r\n      console.warn('No se pudo cargar el logo para el PDF:', imgError);\r\n    }\r\n\r\n    doc.setFontSize(16);\r\n    doc.text('Gestión de Pedidos', 14, 20);\r\n    doc.setFontSize(12);\r\n    const now = new Date();\r\n    const dateStr = now.toLocaleDateString('es-CO');\r\n    const timeStr = now.toLocaleTimeString('es-CO', { hour: '2-digit', minute: '2-digit', hour12: true });\r\n    doc.text(`Fecha: ${dateStr} ${timeStr}`, 14, 30);\r\n\r\nlet mealCounter = 0;\r\nconst pedidosBody = orders.map((order) => {\r\n  mealCounter += 1;\r\n  const meal = order.meals?.[0] || {};\r\n  const paymentMethod = order.payment?.name || order.payment || meal.payment?.name || meal.payment || 'Efectivo';\r\n\r\n  return [\r\n    mealCounter,\r\n    meal.address?.address || '',\r\n    meal.address?.phoneNumber || '',\r\n    `$${order.total?.toLocaleString('es-CO') || '0'}`,\r\n    paymentMethod,\r\n    order?.deliveryPerson || ''\r\n  ];\r\n});\r\n\r\nif (pedidosBody.length === 0) pedidosBody.push(Array(6).fill('-'));\r\n\r\n\r\n    if (pedidosBody.length === 0) pedidosBody.push(Array(5).fill('-'));\r\n\r\n    autoTable(doc, {\r\n      startY: 40,\r\n      head: [['N', 'Dirección', 'Teléfono', 'Total', 'Domiciliario']],\r\n      body: pedidosBody,\r\n      styles: { fontSize: 8, cellPadding: 2, overflow: 'linebreak' },\r\n      headStyles: { fillColor: [0, 102, 204], textColor: 255, fontStyle: 'bold', lineWidth: 0.2, lineColor: [0, 0, 0] },\r\n      alternateRowStyles: { fillColor: [245, 245, 245] },\r\n      columnStyles: {\r\n        1: { cellWidth: 'wrap' },\r\n        3: { halign: 'right' }\r\n      },\r\n      tableLineColor: [0, 0, 0],\r\n      tableLineWidth: 0.2,\r\n      didDrawPage: (data) => {\r\n        doc.setFontSize(10);\r\n        doc.text(`Página ${data.pageNumber}`, 180, 287);\r\n      }\r\n    });\r\n\r\n    const finalY = doc.lastAutoTable.finalY + 10;\r\n    doc.setFontSize(14);\r\n    doc.text('Resumen de Totales', 14, finalY);\r\n\r\n    autoTable(doc, {\r\n      startY: finalY + 5,\r\n      head: [['Concepto', 'Monto']],\r\n      body: [\r\n        ['Total Efectivo', `$${totals.cash?.toLocaleString('es-CO') || '0'}`],\r\n        ['Total Daviplata', `$${totals.daviplata?.toLocaleString('es-CO') || '0'}`],\r\n        ['Total Nequi', `$${totals.nequi?.toLocaleString('es-CO') || '0'}`],\r\n        ['Total General', `$${(totals.cash + totals.daviplata + totals.nequi || 0).toLocaleString('es-CO')}`]\r\n      ],\r\n      styles: { fontSize: 10, cellPadding: 2, overflow: 'linebreak' },\r\n      headStyles: { fillColor: [0, 102, 204], textColor: 255, fontStyle: 'bold', lineWidth: 0.2, lineColor: [0, 0, 0] },\r\n      columnStyles: { 1: { halign: 'right' } },\r\n      tableLineColor: [0, 0, 0],\r\n      tableLineWidth: 0.2\r\n    });\r\n\r\n    const deliveryY = doc.lastAutoTable.finalY + 10;\r\n    doc.setFontSize(14);\r\n    doc.text('Resumen por Domiciliarios', 14, deliveryY);\r\n\r\n    const deliveryBody = Object.entries(deliveryPersons).map(([name, data]) => [\r\n      name || '',\r\n      `$${data.cash?.toLocaleString('es-CO') || '0'}`,\r\n      `$${data.daviplata?.toLocaleString('es-CO') || '0'}`,\r\n      `$${data.nequi?.toLocaleString('es-CO') || '0'}`,\r\n      `$${data.total?.toLocaleString('es-CO') || '0'}`\r\n    ]);\r\n\r\n    autoTable(doc, {\r\n      startY: deliveryY + 5,\r\n      head: [['Domiciliario', 'Efectivo', 'Daviplata', 'Nequi', 'Total']],\r\n      body: deliveryBody.length > 0 ? deliveryBody : [['-', '-', '-', '-', '-']],\r\n      styles: { fontSize: 8, cellPadding: 2, overflow: 'linebreak' },\r\n      headStyles: { fillColor: [0, 102, 204], textColor: 255, fontStyle: 'bold', lineWidth: 0.2, lineColor: [0, 0, 0] },\r\n      columnStyles: {\r\n        1: { halign: 'right' },\r\n        2: { halign: 'right' },\r\n        3: { halign: 'right' },\r\n        4: { halign: 'right' }\r\n      },\r\n      tableLineColor: [0, 0, 0],\r\n      tableLineWidth: 0.2\r\n    });\r\n\r\n    doc.save(`pedidos_${new Date().toISOString().split('T')[0]}.pdf`);\r\n  } catch (error) {\r\n    console.error('Error al generar el PDF:', error);\r\n    alert('Error al generar el PDF: ' + error.message);\r\n  }\r\n};","// src/components/Admin/utilities/exportToCSV.js\r\nexport const exportToCSV = (orders, totals, deliveryPersons, setSuccess) => {\r\n  const headers = [\r\n    'ID Pedido', 'Nº Bandeja', 'Sopa', 'Principio', 'Proteína', 'Bebida', 'Cubiertos', 'Acompañamientos', 'Adiciones', 'Notas',\r\n    'Hora de Entrega', 'Dirección', 'Tipo de Lugar', 'Nombre del Local', 'Nombre del Destinatario', 'Detalles de Unidad',\r\n    'Teléfono', 'Pago (Bandeja)', 'Total (COP)', 'Pago (General)', 'Domiciliario', 'Estado', 'Fecha de Creación', 'Última Actualización'\r\n  ];\r\n\r\n  const orderRows = orders.flatMap(order => \r\n    order.meals.map((meal, index) => [\r\n      order.id, index + 1, meal.soup?.name || meal.soup || 'Sin sopa',\r\n      Array.isArray(meal.principle) ? meal.principle.map(p => p.name || p).join(', ') : meal.principle?.name || meal.principle || 'Sin principio',\r\n      meal.protein?.name || meal.protein || 'Sin proteína', meal.drink?.name || meal.drink || 'Sin bebida',\r\n      meal.cutlery?.name || meal.cutlery || 'No', meal.sides?.map(s => s.name || s).join(', ') || 'Ninguno',\r\n      meal.additions?.map(a => `${a.name || ''}${a.protein || a.replacement ? ` (${a.protein || a.replacement})` : ''} (${a.quantity || 1})`).join(', ') || 'Ninguna',\r\n      meal.notes || 'Ninguna', meal.time?.name || meal.time || 'No especificada', meal.address?.address || 'Sin dirección',\r\n      meal.address?.addressType || 'No especificado', meal.address?.localName || '', meal.address?.recipientName || '',\r\n      meal.address?.unitDetails || '', meal.address?.phoneNumber || 'No especificado',\r\n      meal.payment?.name || meal.payment || 'Efectivo', `$${order.total?.toLocaleString('es-CO') || '0'}`,\r\n      order.payment || 'Efectivo', order.deliveryPerson || 'Sin asignar', order.status || 'Pendiente',\r\n      order.createdAt ? new Date(order.createdAt.seconds * 1000).toLocaleString('es-CO') : 'N/A',\r\n      order.updatedAt ? new Date(order.updatedAt.seconds * 1000).toLocaleString('es-CO') : 'N/A',\r\n    ].map(cell => `\"${String(cell || '').replace(/\"/g, '\"\"')}\"`))\r\n  );\r\n\r\n  const totalsRows = [\r\n    ['Total Efectivo', `$${totals.cash.toLocaleString('es-CO')}`],\r\n    ['Total Daviplata', `$${totals.daviplata.toLocaleString('es-CO')}`],\r\n    ['Total Nequi', `$${totals.nequi.toLocaleString('es-CO')}`],\r\n    ['Total General', `$${(totals.cash + totals.daviplata + totals.nequi).toLocaleString('es-CO')}`],\r\n  ].map(row => row.map(cell => `\"${String(cell || '').replace(/\"/g, '\"\"')}\"`));\r\n\r\n  const deliveryRows = Object.entries(deliveryPersons).map(([name, data]) => [\r\n    name, `$${data.cash.toLocaleString('es-CO')}`, `$${data.daviplata.toLocaleString('es-CO')}`, \r\n    `$${data.nequi.toLocaleString('es-CO')}`, `$${data.total.toLocaleString('es-CO')}`\r\n  ].map(cell => `\"${String(cell || '').replace(/\"/g, '\"\"')}\"`));\r\n\r\n  const csvContent = [\r\n    headers.join(','),\r\n    ...orderRows,\r\n    '',\r\n    '\"Resumen de Totales\"',\r\n    '\"Concepto\",\"Monto (COP)\"',\r\n    ...totalsRows,\r\n    '\"Resumen por Domiciliarios\"',\r\n    '\"Domiciliario\",\"Efectivo (COP)\",\"Daviplata (COP)\",\"Nequi (COP)\",\"Total (COP)\"',\r\n    ...deliveryRows,\r\n  ].join('\\n');\r\n\r\n  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n  const url = window.URL.createObjectURL(blob);\r\n  const a = document.createElement('a');\r\n  a.href = url;\r\n  a.download = `pedidos_${new Date().toISOString().split('T')[0]}.csv`;\r\n  a.click();\r\n  window.URL.revokeObjectURL(url);\r\n  setSuccess('Pedidos exportados a CSV.');\r\n};","// src/components/Admin/utils.js\r\nexport const cleanText = (text) => {\r\n  if (text == null) return '';\r\n  if (typeof text === 'string') return text.replace(' NUEVO', '').trim();\r\n  if (typeof text === 'boolean') return text.toString();\r\n  if (typeof text === 'object' && text?.name) return text.name.replace(' NUEVO', '').trim();\r\n  return String(text).replace(' NUEVO', '').trim();\r\n};\r\n\r\nexport const getNestedProperty = (obj, path) => {\r\n  if (!obj || !path) return '';\r\n  return path.split('.').reduce((acc, part) => (acc && acc[part] !== undefined ? acc[part] : ''), obj);\r\n};\r\n\r\nexport const getAddressDisplay = (address) => {\r\n  if (!address?.address) return 'Sin dirección';\r\n  let display = address.address;\r\n  switch (address.addressType) {\r\n    case 'school': if (address.recipientName) display += ` (Recibe: ${cleanText(address.recipientName)})`; break;\r\n    case 'complex': if (address.unitDetails) display += ` (${cleanText(address.unitDetails)})`; break;\r\n    case 'shop': if (address.localName) display += ` (${cleanText(address.localName)})`; break;\r\n    default: break;\r\n  }\r\n  return display;\r\n};\r\n\r\nexport const getMealDetailsDisplay = (meal) => {\r\n  const components = [];\r\n  const soupDisplay = meal.soupReplacement?.name || meal.soupReplacement ? `${cleanText(meal.soupReplacement?.name || meal.soupReplacement)} (por sopa)` : meal.soup?.name || meal.soup ? cleanText(meal.soup?.name || meal.soup) : 'Sin sopa';\r\n  components.push(`Sopa: ${soupDisplay}`);\r\n  let principleDisplay;\r\n  if (meal.principleReplacement?.name || meal.principleReplacement) {\r\n    principleDisplay = `${cleanText(meal.principleReplacement?.name || meal.principleReplacement)} (por principio)`;\r\n  } else if (Array.isArray(meal.principle) && meal.principle.length > 0) {\r\n    const principleNames = meal.principle.map(p => cleanText(p.name || p)).filter(Boolean);\r\n    principleDisplay = principleNames.length > 0 ? principleNames.join(', ') : 'Sin principio';\r\n  } else if (meal.principle?.name || meal.principle) {\r\n    principleDisplay = cleanText(meal.principle?.name || meal.principle);\r\n  } else {\r\n    principleDisplay = 'Sin principio';\r\n  }\r\n  components.push(`Principio: ${principleDisplay}`);\r\n  components.push(`Proteína: ${meal.protein?.name || meal.protein ? cleanText(meal.protein?.name || meal.protein) : 'Sin proteína'}`);\r\n  const drinkName = meal.drink?.name || meal.drink || '';\r\n  components.push(`Bebida: ${drinkName === 'Juego de mango' ? 'Jugo de mango' : cleanText(drinkName) || 'Sin bebida'}`);\r\n  components.push(`Cubiertos: ${meal.cutlery?.name === 'Sí' || meal.cutlery === true || meal.cutlery === 'true' ? 'Sí' : 'No'}`);\r\n  const sides = meal.sides?.length > 0 ? meal.sides.map(s => cleanText(s.name || s)).filter(Boolean).join(', ') : 'Ninguno';\r\n  components.push(`Acompañamientos: ${sides}`);\r\n  const additions = meal.additions?.length > 0 ? meal.additions.map(a => `${cleanText(a.name || a)}${a.protein || a.replacement ? ` (${cleanText(a.protein || a.replacement)})` : ''} (${a.quantity || 1})`).join(', ') : 'Ninguna';\r\n  components.push(`Adiciones: ${additions}`);\r\n  components.push(`Notas: ${meal.notes ? cleanText(meal.notes) : 'Ninguna'}`);\r\n  components.push(`Hora de Entrega: ${meal.time?.name || meal.time ? cleanText(meal.time?.name || meal.time) : 'No especificada'}`);\r\n  components.push(`Dirección: ${getAddressDisplay(meal.address)}`);\r\n  let addressTypeDisplay = '';\r\n  switch (meal.address?.addressType) {\r\n    case 'house': addressTypeDisplay = 'Casa/Apto'; break;\r\n    case 'school': addressTypeDisplay = 'Colegio/Oficina'; break;\r\n    case 'complex': addressTypeDisplay = 'Conjunto'; break;\r\n    case 'shop': addressTypeDisplay = 'Tienda/Local'; break;\r\n    default: addressTypeDisplay = 'No especificado'; break;\r\n  }\r\n  components.push(`Tipo de Lugar: ${addressTypeDisplay}`);\r\n  components.push(`Teléfono: ${meal.address?.phoneNumber ? cleanText(meal.address.phoneNumber) : 'No especificado'}`);\r\n  if (meal.address?.addressType === 'shop' && meal.address?.localName) components.push(`Nombre del Local: ${cleanText(meal.address.localName)}`);\r\n  if (meal.address?.addressType === 'school' && meal.address?.recipientName) components.push(`Recibe: ${cleanText(meal.address.recipientName)}`);\r\n  if (meal.address?.addressType === 'complex' && meal.address?.unitDetails) components.push(`Unidad: ${cleanText(meal.address.unitDetails)}`);\r\n  components.push(`Pago: ${meal.payment?.name || meal.payment ? cleanText(meal.payment?.name || meal.payment) : 'Efectivo'}`);\r\n  return components.join('\\n');\r\n};\r\n\r\nexport const areMealsIdentical = (meals) => {\r\n  if (!meals || meals.length <= 1) return { areIdentical: false, count: 1 };\r\n  const fieldsToCompare = [\r\n    'soup', 'soupReplacement', 'principle', 'principleReplacement', 'protein', 'drink', 'cutlery', 'notes', 'time', 'payment',\r\n    'address.address', 'address.addressType', 'address.phoneNumber', 'address.localName', 'address.recipientName', 'address.unitDetails', 'sides', 'additions'\r\n  ];\r\n  const getMealSignature = (meal) => {\r\n    return fieldsToCompare.map(field => {\r\n      const value = getNestedProperty(meal, field);\r\n      if (field === 'sides' && Array.isArray(value)) return value.map(s => cleanText(s.name || s)).sort().join(',');\r\n      if (field === 'additions' && Array.isArray(value)) return value.map(a => `${cleanText(a.name || a)}${a.protein || a.replacement ? `:${cleanText(a.protein || a.replacement)}` : ''}:${a.quantity || 1}`).sort().join(';');\r\n      if (field === 'principle' && Array.isArray(value)) return value.map(p => cleanText(p.name || p)).sort().join(',');\r\n      return cleanText(value);\r\n    }).join('|');\r\n  };\r\n  const firstSignature = getMealSignature(meals[0]);\r\n  const areIdentical = meals.every(meal => getMealSignature(meal) === firstSignature);\r\n  return { areIdentical, count: meals.length };\r\n};","// src/components/Admin/TablaPedidos.js\r\nimport React, { useRef, useEffect, useState, useMemo } from 'react';\r\nimport { classNames } from '../../utils/classNames.js';\r\nimport { cleanText, getAddressDisplay } from './utils.js';\r\nimport { calculateMealPrice } from '../../utils/MealCalculations';\r\nimport {\r\n  ArrowDownTrayIcon,\r\n  ChevronLeftIcon,\r\n  ChevronRightIcon,\r\n  InformationCircleIcon,\r\n  PencilIcon,\r\n  TrashIcon,\r\n  EllipsisVerticalIcon,\r\n  PlusIcon\r\n} from '@heroicons/react/24/outline';\r\n\r\n// NUEVO: pagos\r\nimport PaymentSplitEditor from '../common/PaymentSplitEditor';\r\nimport { summarizePayments, sumPaymentsByMethod, defaultPaymentsForOrder } from '../../utils/payments';\r\n\r\n// Firestore para persistir pagos\r\nimport { db } from '../../config/firebase';\r\nimport { updateDoc, doc, getDoc } from 'firebase/firestore';\r\n\r\n/* ===========================\r\n   Helpers de resumen (in-file)\r\n   =========================== */\r\n\r\nconst normKey = (s) => (s || '').toString().trim().toLowerCase();\r\nconst normalizePaymentMethodKey = (method) => {\r\n  const raw = normKey(\r\n    typeof method === 'string'\r\n      ? method\r\n      : method?.name || method?.label || method?.title || method?.method || method?.type || ''\r\n  );\r\n  if (raw.includes('efect')) return 'cash';\r\n  if (raw.includes('cash')) return 'cash';\r\n  if (raw.includes('nequi')) return 'nequi';\r\n  if (raw.includes('davi')) return 'daviplata';\r\n  return 'other';\r\n};\r\n\r\nconst paymentsRowsFromOrder = (order, fallbackBuilder) => {\r\n  const total = Math.floor(Number(order?.total || 0)) || 0;\r\n\r\n  if (Array.isArray(order?.payments) && order.payments.length) {\r\n    return order.payments.map((p) => ({\r\n      methodKey: normalizePaymentMethodKey(p.method),\r\n      amount: Math.floor(Number(p.amount || 0)) || 0,\r\n    }));\r\n  }\r\n\r\n  const fb = typeof fallbackBuilder === 'function' ? (fallbackBuilder(order) || []) : [];\r\n  if (fb.length) {\r\n    return fb.map((p) => ({\r\n      methodKey: normalizePaymentMethodKey(p.method),\r\n      amount: Math.floor(Number(p.amount || 0)) || 0,\r\n    }));\r\n  }\r\n\r\n  return [{ methodKey: 'other', amount: total }];\r\n};\r\n\r\nconst sumPaymentsByDeliveryAndType = (orders, { fallbackBuilder } = {}) => {\r\n  const acc = {};\r\n  const ensureBucket = (person, bucket) => {\r\n    acc[person] = acc[person] || {};\r\n    acc[person][bucket] = acc[person][bucket] || { cash: 0, nequi: 0, daviplata: 0, other: 0, total: 0 };\r\n    return acc[person][bucket];\r\n  };\r\n  const bump = (obj, methodKey, amount) => {\r\n    if (!amount) return;\r\n    obj[methodKey] = (obj[methodKey] || 0) + amount;\r\n    obj.total += amount;\r\n  };\r\n\r\n  (orders || []).forEach((order) => {\r\n    const person = String(order?.deliveryPerson || 'JUAN').trim(); // default \"JUAN\" si no hay asignado\r\n    const isBreakfast = Array.isArray(order?.breakfasts) || order?.type === 'breakfast';\r\n    const bucket = isBreakfast ? 'breakfast' : 'lunch';\r\n    const rows = paymentsRowsFromOrder(order, fallbackBuilder);\r\n    const byType = ensureBucket(person, bucket);\r\n    const byTotal = ensureBucket(person, 'total');\r\n    rows.forEach(({ methodKey, amount }) => {\r\n      bump(byType, methodKey, amount);\r\n      bump(byTotal, methodKey, amount);\r\n    });\r\n  });\r\n\r\n  return acc;\r\n};\r\n\r\nconst money = (n) => `$${Math.floor(n || 0).toLocaleString('es-CO')}`;\r\n// === NUEVO: mostrar solo método(s) sin montos ===\r\nconst methodLabel = (k) =>\r\n  k === 'cash' ? 'Efectivo' : k === 'nequi' ? 'Nequi' : k === 'daviplata' ? 'Daviplata' : '';\r\n\r\nconst paymentMethodsOnly = (order) => {\r\n  const rows = paymentsRowsFromOrder(order, defaultPaymentsForOrder);\r\n  const names = [...new Set(rows.map((r) => methodLabel(r.methodKey)).filter(Boolean))];\r\n  if (names.length) return names.join(' + ');\r\n\r\n  const legacy =\r\n    order?.payment ||\r\n    order?.paymentMethod ||\r\n    order?.meals?.[0]?.payment?.name ||\r\n    order?.meals?.[0]?.paymentMethod ||\r\n    order?.breakfasts?.[0]?.payment?.name ||\r\n    order?.breakfasts?.[0]?.paymentMethod || '';\r\n  return String(legacy).trim() || 'Sin pago';\r\n};\r\n/* =======================\r\n   Component principal\r\n   ======================= */\r\n\r\nconst TablaPedidos = ({\r\n  theme,\r\n  orders,\r\n  searchTerm,\r\n  setSearchTerm,\r\n  totals, // puede venir del padre; si no, calculamos localmente con split\r\n  isLoading,\r\n  paginatedOrders,\r\n  currentPage,\r\n  totalPages,\r\n  setCurrentPage,\r\n  itemsPerPage,\r\n  setItemsPerPage,\r\n  deliveryPersons,\r\n  handleEditOrder,\r\n  handleDeleteOrder,\r\n  handleStatusChange,\r\n  handleSort,\r\n  getSortIcon,\r\n  setShowMealDetails,\r\n  editingDeliveryId,\r\n  setEditingDeliveryId,\r\n  editForm,\r\n  setEditForm,\r\n  handleDeliveryChange,\r\n  sortOrder,\r\n  showProteinModal,\r\n  setShowProteinModal,\r\n  isMenuOpen,\r\n  setIsMenuOpen,\r\n  handleOpenPreview,\r\n  handleOpenExcelPreview,\r\n  handleExport,\r\n  handleDeleteAllOrders,\r\n  setShowConfirmDeleteAll,\r\n  exportToExcel,\r\n  exportToPDF,\r\n  exportToCSV,\r\n  setShowAddOrderModal,\r\n  orderTypeFilter,\r\n  setOrderTypeFilter,\r\n  uniqueDeliveryPersons,\r\n}) => {\r\n  const currentDate = new Date().toLocaleDateString('es-CO', {\r\n    weekday: 'long',\r\n    month: 'long',\r\n    day: 'numeric',\r\n  });\r\n\r\n  const menuRef = useRef(null);\r\n  const [deliveryDraft, setDeliveryDraft] = useState('');\r\n  const lastAssignedRef = useRef('');\r\n\r\n  useEffect(() => {\r\n    function handleClickOutside(event) {\r\n      if (menuRef.current && !menuRef.current.contains(event.target)) {\r\n        setIsMenuOpen(false);\r\n      }\r\n    }\r\n    if (isMenuOpen) document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, [isMenuOpen, setIsMenuOpen]);\r\n\r\n  /* ===== Toast flotante estilo “éxito” ===== */\r\n  const [toast, setToast] = useState(null); // { type: 'success'|'warning'|'error', text: string }\r\n  const toastTimer = useRef(null);\r\n  const showToast = (type, text) => {\r\n    setToast({ type, text });\r\n    if (toastTimer.current) clearTimeout(toastTimer.current);\r\n    toastTimer.current = setTimeout(() => setToast(null), 2600);\r\n  };\r\n  useEffect(() => () => toastTimer.current && clearTimeout(toastTimer.current), []);\r\n\r\n  // ====== Split de pagos: estado para modal local ======\r\n  const [editingPaymentsOrder, setEditingPaymentsOrder] = useState(null);\r\n\r\n  // ✅ Incluye tus colecciones reales\r\n  const EXTRA_COLLECTIONS = [\r\n    'orders',\r\n    'deliveryOrders',\r\n    'tableOrders',\r\n    'deliveryBreakfastOrders', // <— importante para desayunos\r\n    'breakfastOrders',\r\n    'domicilioOrders'\r\n  ];\r\n\r\n  // ✅ Heurística afinada a tus nombres reales\r\n  const resolveCollectionName = (order) => {\r\n    if (order?.__collection) return order.__collection;\r\n    if (order?.collectionName) return order.collectionName;\r\n\r\n    const isBreakfast =\r\n      order?.type === 'breakfast' ||\r\n      Array.isArray(order?.breakfasts);\r\n\r\n    if (isBreakfast) return 'deliveryBreakfastOrders';\r\n    return 'orders'; // almuerzos\r\n  };\r\n\r\n  // ✅ Busca la orden probando todas las variantes conocidas\r\n  const findExistingOrderRef = async (order) => {\r\n    const id = order?.id;\r\n    if (!id) throw new Error('Order sin id');\r\n\r\n    const preferred = [];\r\n    if (order?.__collection) preferred.push(order.__collection);\r\n    if (order?.collectionName && order?.collectionName !== order?.__collection) {\r\n      preferred.push(order.collectionName);\r\n    }\r\n\r\n    const guess = resolveCollectionName(order);\r\n    const BASE = ['orders', 'deliveryOrders', 'tableOrders', 'deliveryBreakfastOrders', 'breakfastOrders'];\r\n    const orderedBase = [guess, ...BASE.filter((c) => c !== guess)];\r\n\r\n    const candidates = [\r\n      ...preferred.filter(Boolean),\r\n      ...orderedBase,\r\n      ...EXTRA_COLLECTIONS,\r\n    ].filter((v, i, a) => !!v && a.indexOf(v) === i); // únicos\r\n\r\n    for (const col of candidates) {\r\n      const ref = doc(db, col, id);\r\n      const snap = await getDoc(ref);\r\n      if (snap.exists()) return ref;\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  const savePaymentsForOrder = async (order, payments) => {\r\n    const sum = (payments || []).reduce(\r\n      (a, b) => a + (Math.floor(Number(b.amount || 0)) || 0),\r\n      0\r\n    );\r\n    const total = Math.floor(Number(order.total || 0)) || 0;\r\n\r\n    if (sum !== total) {\r\n      showToast(\r\n        'warning',\r\n        `La suma de pagos (${sum.toLocaleString('es-CO')}) no coincide con el total (${total.toLocaleString('es-CO')}).`\r\n      );\r\n      return false;\r\n    }\r\n\r\n    const ref = await findExistingOrderRef(order);\r\n    if (!ref) {\r\n      showToast(\r\n        'error',\r\n        'No se pudo guardar los pagos: la orden no existe en una colección conocida.'\r\n      );\r\n      return false;\r\n    }\r\n\r\n    const payload = {\r\n      payments: (payments || []).map((p) => ({\r\n        method: typeof p.method === 'string' ? p.method : p?.method?.name || '',\r\n        amount: Math.floor(Number(p.amount || 0)) || 0,\r\n        note: p.note || '',\r\n      })),\r\n      updatedAt: new Date(),\r\n    };\r\n\r\n    try {\r\n      await updateDoc(ref, payload);\r\n      showToast('success', 'Pagos actualizados correctamente.');\r\n      return true;\r\n    } catch (e) {\r\n      console.error('[Pagos] updateDoc error', e);\r\n      const code = e?.code || '';\r\n      if (code === 'permission-denied') {\r\n        showToast('error', 'Permisos insuficientes para guardar pagos.');\r\n      } else {\r\n        showToast('error', 'No se pudo guardar los pagos.');\r\n      }\r\n      return false;\r\n    }\r\n  };\r\n\r\n  // Totales superiores (tiles) - Muestra todos los totales\r\n  const totalsDisplay = useMemo(() => {\r\n    const acc = { cash: 0, nequi: 0, daviplata: 0, other: 0, total: 0 };\r\n    \r\n    (orders || []).forEach((order) => {\r\n      // Para los métodos específicos\r\n      if (order.payments && Array.isArray(order.payments)) {\r\n        order.payments.forEach(payment => {\r\n          const methodKey = normalizePaymentMethodKey(payment.method);\r\n          const amount = Math.floor(Number(payment.amount || 0)) || 0;\r\n          if (amount <= 0) return;\r\n          \r\n          acc[methodKey] = (acc[methodKey] || 0) + amount;\r\n          acc.total += amount;\r\n        });\r\n      } else {\r\n        // Estructura antigua\r\n        const methodKey = normalizePaymentMethodKey(order.payment || order.paymentMethod);\r\n        const amount = Math.floor(Number(order.total || 0)) || 0;\r\n        if (amount <= 0) return;\r\n        \r\n        acc[methodKey] = (acc[methodKey] || 0) + amount;\r\n        acc.total += amount;\r\n      }\r\n    });\r\n    \r\n    return acc;\r\n  }, [orders]);\r\n\r\n  // ===== Resumen por Domiciliarios (exacto con split) =====\r\n  const resumen = useMemo(\r\n    () => sumPaymentsByDeliveryAndType(orders || [], { \r\n      fallbackBuilder: defaultPaymentsForOrder,\r\n      // Solo incluir pedidos no liquidados en el resumen\r\n      filter: order => !order.settled \r\n    }),\r\n    [orders]\r\n  );\r\n  const resumenPersons = useMemo(\r\n    () => Object.keys(resumen).sort((a, b) => a.localeCompare(b, 'es')),\r\n    [resumen]\r\n  );\r\n\r\n  const handleSettle = async (person, buckets) => {\r\n    try {\r\n      const personKey = String(person || '').trim();\r\n      const toSettle = (orders || []).filter((o) => {\r\n        const normalized = String(o?.deliveryPerson || 'JUAN').trim();\r\n        return !o?.settled && normalized === personKey;\r\n      });\r\n\r\n      if (!toSettle.length) {\r\n        showToast('warning', `No hay pedidos pendientes para liquidar de ${personKey}.`);\r\n        return;\r\n      }\r\n\r\n      // Calcular totales por método de pago\r\n      const totals = {\r\n        cash: 0,\r\n        nequi: 0,\r\n        daviplata: 0\r\n      };\r\n\r\n      toSettle.forEach(order => {\r\n        const payments = order.payments || [];\r\n        payments.forEach(payment => {\r\n          const methodKey = normalizePaymentMethodKey(payment.method);\r\n          if (methodKey in totals) {\r\n            totals[methodKey] += Math.floor(Number(payment.amount || 0));\r\n          }\r\n        });\r\n      });\r\n\r\n      let ok = 0, fail = 0;\r\n\r\n      for (const order of toSettle) {\r\n        const ref = await findExistingOrderRef(order);\r\n        if (!ref) { fail++; continue; }\r\n\r\n        try {\r\n          // Determinar qué métodos de pago están presentes\r\n          const payments = order.payments || [];\r\n          const hasPaymentMethod = (method) => \r\n            payments.some(p => normalizePaymentMethodKey(p.method) === method);\r\n          \r\n          // Determinar qué métodos están presentes\r\n          const hasNequi = hasPaymentMethod('nequi');\r\n          const hasDaviplata = hasPaymentMethod('daviplata');\r\n          const hasCash = hasPaymentMethod('cash');\r\n          \r\n      // Construir el objeto de actualización\r\n      const updateData = {\r\n        settledAt: new Date().toISOString(),\r\n      };\r\n\r\n      // Marcar como settled y actualizar el estado de liquidación de cada método\r\n      updateData.settled = true;\r\n      updateData.paymentSettled = {\r\n        ...(order.paymentSettled || {}),\r\n        nequi: hasNequi ? true : (order.paymentSettled?.nequi || false),\r\n        daviplata: hasDaviplata ? true : (order.paymentSettled?.daviplata || false),\r\n        cash: hasCash ? true : (order.paymentSettled?.cash || false)\r\n      };          await updateDoc(ref, updateData);\r\n          ok++;\r\n        } catch (e) {\r\n          console.error('[Liquidar] updateDoc error', e);\r\n          fail++;\r\n        }\r\n      }\r\n\r\n      if (fail === 0) {\r\n        showToast('success', `Domiciliario liquidado: ${personKey} (${ok} órdenes).`);\r\n      } else {\r\n        showToast('warning', `Liquidado con advertencias: ${personKey}. OK: ${ok}, errores: ${fail}.`);\r\n      }\r\n    } catch (e) {\r\n      console.error('[Liquidar] error general', e);\r\n      showToast('error', 'Ocurrió un error al liquidar.');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* TOAST FLOTANTE */}\r\n      {toast && (\r\n        <div className=\"fixed right-4 top-4 z-[10002]\">\r\n          <div\r\n            className={classNames(\r\n              'rounded-xl px-4 py-3 shadow-lg border',\r\n              toast.type === 'success' && 'bg-green-600 text-white border-green-500',\r\n              toast.type === 'warning' && 'bg-yellow-400 text-black border-yellow-300',\r\n              toast.type === 'error' && 'bg-red-600 text-white border-red-500'\r\n            )}\r\n          >\r\n            <span className=\"font-semibold\">{toast.text}</span>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\r\n        <h2 className=\"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100 mb-6\">\r\n          Gestión de Pedidos Domicilios\r\n        </h2>\r\n\r\n        {/* Totals Section */}\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6 text-sm text-gray-700 dark:text-gray-300\">\r\n          <div className={classNames('p-3 sm:p-4 rounded-lg shadow-sm', theme === 'dark' ? 'bg-gray-700' : 'bg-gray-100')}>\r\n            <p className=\"font-semibold text-sm sm:text-base\">Total Efectivo</p>\r\n            <p className=\"text-lg sm:text-xl font-bold\">${Math.floor(totalsDisplay.cash || 0).toLocaleString('es-CO')}</p>\r\n          </div>\r\n          <div className={classNames('p-3 sm:p-4 rounded-lg shadow-sm', theme === 'dark' ? 'bg-gray-700' : 'bg-gray-100')}>\r\n            <p className=\"font-semibold text-sm sm:text-base\">Total Daviplata</p>\r\n            <p className=\"text-lg sm:text-xl font-bold\">${Math.floor(totalsDisplay.daviplata || 0).toLocaleString('es-CO')}</p>\r\n          </div>\r\n          <div className={classNames('p-3 sm:p-4 rounded-lg shadow-sm', theme === 'dark' ? 'bg-gray-700' : 'bg-gray-100')}>\r\n            <p className=\"font-semibold text-sm sm:text-base\">Total Nequi</p>\r\n            <p className=\"text-lg sm:text-xl font-bold\">${Math.floor(totalsDisplay.nequi || 0).toLocaleString('es-CO')}</p>\r\n          </div>\r\n          <div className={classNames('p-3 sm:p-4 rounded-lg shadow-sm', theme === 'dark' ? 'bg-gray-700' : 'bg-gray-100')}>\r\n            <p className=\"font-semibold text-sm sm:text-base\">Total General</p>\r\n            <p className=\"text-lg sm:text-xl font-bold\">\r\n              ${Math.floor((totalsDisplay.cash || 0) + (totalsDisplay.daviplata || 0) + (totalsDisplay.nequi || 0)).toLocaleString('es-CO')}\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Search, Proteins, Date, and Menu */}\r\n        <div className=\"flex flex-wrap justify-center sm:justify-between items-center mb-6 gap-3 sm:gap-4\">\r\n          <input\r\n            type=\"text\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n            placeholder=\"Buscar pedidos...\"\r\n            className={classNames(\r\n              'p-2 sm:p-3 rounded-lg border focus:outline-none focus:ring-2 focus:ring-blue-500 w-full sm:max-w-xs shadow-sm text-sm sm:text-base transition-all duration-200',\r\n              theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-300 bg-white text-gray-900'\r\n            )}\r\n          />\r\n          <div className=\"flex flex-wrap items-center justify-center sm:justify-end gap-2\">\r\n            <button\r\n              onClick={() => setShowProteinModal(true)}\r\n              className={classNames(\r\n                'flex items-center justify-center gap-2 px-3 py-2 sm:px-5 sm:py-3 rounded-lg text-xs sm:text-sm font-semibold transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 flex-shrink-0',\r\n                theme === 'dark' ? 'bg-gray-600 hover:bg-gray-500 text-white border border-gray-500' : 'bg-gray-200 hover:bg-gray-300 text-gray-900 border border-gray-400'\r\n              )}\r\n            >\r\n              <PlusIcon className=\"w-4 h-4\" />\r\n              <span className=\"hidden md:inline\">Proteínas del Día</span>\r\n            </button>\r\n            <div\r\n              className={classNames(\r\n                'flex items-center justify-center gap-2 px-3 py-2 sm:px-5 sm:py-3 rounded-lg text-xs sm:text-sm font-semibold shadow-sm border transition-colors duration-200 flex-shrink-0',\r\n                theme === 'dark' ? 'bg-gray-700 text-white border-gray-500' : 'bg-gray-200 text-gray-900 border-gray-400'\r\n              )}\r\n            >\r\n              {currentDate}\r\n            </div>\r\n            <div className=\"relative flex-shrink-0\" ref={menuRef}>\r\n              <button\r\n                onClick={() => setIsMenuOpen(!isMenuOpen)}\r\n                className={classNames('flex items-center justify-center p-2 rounded-lg text-xs sm:text-sm font-medium transition-all duration-200', 'focus:outline-none focus:ring-2 focus:ring-blue-500')}\r\n                aria-label=\"Opciones de menú\"\r\n              >\r\n                <EllipsisVerticalIcon className={classNames('w-6 h-6', theme === 'dark' ? 'text-gray-200 hover:text-white' : 'text-gray-700 hover:text-gray-900')} />\r\n              </button>\r\n              {isMenuOpen && (\r\n                <div className={classNames('absolute right-0 mt-2 w-48 rounded-lg shadow-xl z-50', theme === 'dark' ? 'bg-gray-700 text-gray-200' : 'bg-white text-gray-900')}>\r\n                  <div className=\"py-1\">\r\n                    <button onClick={() => { setOrderTypeFilter('breakfast'); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200\">Ver Desayunos</button>\r\n                    <button onClick={() => { setOrderTypeFilter('lunch'); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200\">Ver Almuerzos</button>\r\n                    <button onClick={() => { setOrderTypeFilter('all'); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200\">Ver Todos</button>\r\n                    <button onClick={() => { setShowAddOrderModal(true); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200\">Generar Orden</button>\r\n                    <button onClick={() => { handleOpenPreview(); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200\">Vista Previa PDF</button>\r\n                    <button onClick={() => { handleOpenExcelPreview(); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200\">Vista Previa Excel</button>\r\n                    <button onClick={() => { handleExport(exportToExcel, 'Excel'); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200 flex items-center\">\r\n                      <ArrowDownTrayIcon className=\"w-4 h-4 mr-2\" /> Exportar Excel\r\n                    </button>\r\n                    <button onClick={() => { handleExport(exportToPDF, 'PDF'); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200 flex items-center\">\r\n                      <ArrowDownTrayIcon className=\"w-4 h-4 mr-2\" /> Exportar PDF\r\n                    </button>\r\n                    <button onClick={() => { handleExport(exportToCSV, 'CSV'); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200 flex items-center\">\r\n                      <ArrowDownTrayIcon className=\"w-4 h-4 mr-2\" /> Exportar CSV\r\n                    </button>\r\n                    <button onClick={() => { setShowConfirmDeleteAll(true); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200 text-red-500\">Eliminar Todos</button>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Orders Table */}\r\n        <div className={classNames('p-3 sm:p-4 rounded-2xl shadow-xl max-h-[70vh] overflow-y-auto custom-scrollbar transition-all duration-300', theme === 'dark' ? 'bg-gray-800' : 'bg-white')}>\r\n          {isLoading ? (\r\n            <div className=\"flex justify-center items-center h-40\">\r\n              <div className=\"animate-spin rounded-full h-12 w-12 border-t-4 border-blue-500\"></div>\r\n            </div>\r\n          ) : (\r\n            <>\r\n              <div className=\"overflow-x-auto\">\r\n                <table className=\"min-w-full text-left border-collapse text-sm\">\r\n                  <thead>\r\n                    <tr className={classNames('font-semibold sticky top-0 z-10 shadow-sm', theme === 'dark' ? 'bg-gray-700 text-gray-200' : 'bg-gray-100 text-gray-700')}>\r\n                      <th className=\"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('orderNumber')}>Nº {getSortIcon('orderNumber')}</th>\r\n                      <th className=\"p-2 sm:p-3 border-b whitespace-nowrap\">Detalles</th>\r\n                      <th className=\"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('address')}>Dirección {getSortIcon('address')}</th>\r\n                      <th className=\"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('phone')}>Teléfono {getSortIcon('phone')}</th>\r\n                      <th className=\"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('time')}>Hora {getSortIcon('time')}</th>\r\n                      <th className=\"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('payment')}>Pago {getSortIcon('payment')}</th>\r\n                      <th className=\"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('total')}>Total {getSortIcon('total')}</th>\r\n                      <th className=\"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('deliveryPerson')}>Domiciliario {getSortIcon('deliveryPerson')}</th>\r\n                      <th className=\"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('status')}>Estado {getSortIcon('status')}</th>\r\n                      <th className=\"p-2 sm:p-3 border-b whitespace-nowrap\">Acciones</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {paginatedOrders.length === 0 ? (\r\n                      <tr>\r\n                        <td colSpan=\"10\" className=\"p-6 text-center text-gray-500 dark:text-gray-400\">No se encontraron pedidos. Intenta ajustar tu búsqueda o filtros.</td>\r\n                      </tr>\r\n                    ) : (\r\n                      paginatedOrders.map((order, index) => {\r\n                        const displayNumber =\r\n                          sortOrder === 'asc'\r\n                            ? (currentPage - 1) * itemsPerPage + index + 1\r\n                            : paginatedOrders.length - ((currentPage - 1) * itemsPerPage + index);\r\n\r\n                        const addressDisplay = getAddressDisplay(order.meals?.[0]?.address || order.breakfasts?.[0]?.address);\r\n\r\n                        const rawLegacy = cleanText(\r\n                          order.payment ||\r\n                          order.meals?.[0]?.payment?.name ||\r\n                          order.breakfasts?.[0]?.payment?.name ||\r\n                          'Sin pago'\r\n                        );\r\n\r\n                        const paymentDisplay = paymentMethodsOnly(order);\r\n\r\n                        const statusClass =\r\n                          order.status === 'Pendiente' ? 'bg-yellow-500 text-black'\r\n                            : order.status === 'Entregado' ? 'bg-green-500 text-white'\r\n                            : order.status === 'Cancelado' ? 'bg-red-500 text-white'\r\n                            : '';\r\n\r\n                        const timeValue = order.meals?.[0]?.time || order.breakfasts?.[0]?.time;\r\n                        let displayTime = 'N/A';\r\n                        if (typeof timeValue === 'string') displayTime = timeValue;\r\n                        else if (typeof timeValue === 'object' && timeValue !== null) displayTime = timeValue.name || 'N/A';\r\n\r\n                        return (\r\n                          <tr\r\n                            key={order.id}\r\n                            className={classNames(\r\n                              'border-b transition-colors duration-150',\r\n                              theme === 'dark' ? 'border-gray-700 hover:bg-gray-700' : 'border-gray-200 hover:bg-gray-50',\r\n                              index % 2 === 0 ? (theme === 'dark' ? 'bg-gray-750' : 'bg-gray-50') : ''\r\n                            )}\r\n                          >\r\n                            <td className=\"p-2 sm:p-3 text-gray-300\">{displayNumber}</td>\r\n                            <td className=\"p-2 sm:p-3 text-gray-300\">\r\n                              <button\r\n                                onClick={() => setShowMealDetails(order)}\r\n                                className=\"text-blue-400 hover:text-blue-300 text-xs sm:text-sm flex items-center\"\r\n                                title=\"Ver detalles de la bandeja\"\r\n                              >\r\n                                <InformationCircleIcon className=\"w-4 h-4 mr-1\" />\r\n                                Ver\r\n                              </button>\r\n                            </td>\r\n                            <td className=\"p-2 sm:p-3 text-gray-300 max-w-[150px] sm:max-w-xs overflow-hidden text-ellipsis whitespace-nowrap\">\r\n                              {addressDisplay}\r\n                            </td>\r\n                            <td className=\"p-2 sm:p-3 text-gray-300 whitespace-nowrap\">\r\n                              {order.meals?.[0]?.address?.phoneNumber ||\r\n                                order.breakfasts?.[0]?.address?.phoneNumber ||\r\n                                'N/A'}\r\n                            </td>\r\n                            <td className=\"p-2 sm:p-3 text-gray-300 whitespace-nowrap\">{displayTime}</td>\r\n                            <td className=\"p-2 sm:p-3 text-gray-300 whitespace-nowrap\">{paymentDisplay}</td>\r\n                            <td className=\"p-2 sm:p-3 text-gray-300 whitespace-nowrap\">\r\n                              ${order.total?.toLocaleString('es-CO') || '0'}\r\n                            </td>\r\n                            <td className=\"p-2 sm:p-3 text-gray-300 whitespace-nowrap\">\r\n                              {editingDeliveryId === order.id ? (\r\n                                <>\r\n                                  <input\r\n                                    list={`delivery-list-${order.id}`}\r\n                                    value={deliveryDraft}\r\n                                    onChange={(e) => setDeliveryDraft(e.target.value)}\r\n                                    onKeyDown={(e) => {\r\n                                      if (e.key === 'Enter') {\r\n                                        const valueToSave = (deliveryDraft || '').trim() || 'Sin asignar';\r\n                                        handleDeliveryChange(order.id, valueToSave);\r\n                                        if (valueToSave !== 'Sin asignar') lastAssignedRef.current = valueToSave;\r\n                                        setEditingDeliveryId(null);\r\n                                      } else if (e.key === 'Escape') {\r\n                                        setEditingDeliveryId(null);\r\n                                      }\r\n                                    }}\r\n                                    onBlur={() => {\r\n                                      const valueToSave = (deliveryDraft || '').trim() || 'Sin asignar';\r\n                                      handleDeliveryChange(order.id, valueToSave);\r\n                                      if (valueToSave !== 'Sin asignar') lastAssignedRef.current = valueToSave;\r\n                                      setEditingDeliveryId(null);\r\n                                    }}\r\n                                    placeholder=\"Escribe y Enter…\"\r\n                                    className={classNames(\r\n                                      'w-40 p-1 rounded-md border text-sm',\r\n                                      theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                                      'focus:outline-none focus:ring-1 focus:ring-blue-500'\r\n                                    )}\r\n                                    autoFocus\r\n                                  />\r\n                                  <datalist id={`delivery-list-${order.id}`}>\r\n                                    <option value=\"Sin asignar\" />\r\n                                    {uniqueDeliveryPersons.map((person) => (\r\n                                      <option key={person} value={person} />\r\n                                    ))}\r\n                                  </datalist>\r\n                                </>\r\n                              ) : (\r\n                                <span\r\n                                  onClick={() => {\r\n                                    const initial = order.deliveryPerson || lastAssignedRef.current || '';\r\n                                    setDeliveryDraft(initial);\r\n                                    setEditingDeliveryId(order.id);\r\n                                  }}\r\n                                  className=\"cursor-pointer hover:text-blue-400\"\r\n                                  title=\"Click para editar; Enter para guardar\"\r\n                                >\r\n                                  {order.deliveryPerson || 'Sin asignar'}\r\n                                </span>\r\n                              )}\r\n                            </td>\r\n                            <td className=\"p-2 sm:p-3 whitespace-nowrap\">\r\n                              <select\r\n                                value={order.status || 'Pendiente'}\r\n                                onChange={async (e) => {\r\n                                  const value = e.target.value;\r\n                                  try {\r\n                                    const maybePromise = handleStatusChange(order.id, value);\r\n                                    if (maybePromise && typeof maybePromise.then === 'function') {\r\n                                      await maybePromise;\r\n                                    }\r\n                                    showToast('success', 'Estado actualizado correctamente.');\r\n                                  } catch (err) {\r\n                                    console.error('[Estado] error al actualizar', err);\r\n                                    showToast('error', 'No se pudo actualizar el estado.');\r\n                                  }\r\n                                }}\r\n                                className={classNames(\r\n                                  'px-2 py-1 rounded-full text-xs font-semibold appearance-none cursor-pointer',\r\n                                  statusClass,\r\n                                  theme === 'dark' ? 'bg-opacity-70' : 'bg-opacity-90',\r\n                                  'focus:outline-none focus:ring-2 focus:ring-blue-500'\r\n                                )}\r\n                              >\r\n                                <option value=\"Pendiente\">Pendiente</option>\r\n                                <option value=\"En Preparación\">En Preparación</option>\r\n                                <option value=\"En Camino\">En Camino</option>\r\n                                <option value=\"Entregado\">Entregado</option>\r\n                                <option value=\"Cancelado\">Cancelado</option>\r\n                              </select>\r\n                            </td>\r\n                            <td className=\"p-2 sm:p-3 whitespace-nowrap\">\r\n                              <div className=\"flex gap-2\">\r\n                                <button\r\n                                  onClick={() => handleEditOrder(order)}\r\n                                  className=\"text-blue-500 hover:text-blue-400 transition-colors duration-150 p-1 rounded-md\"\r\n                                  title=\"Editar pedido\"\r\n                                  aria-label={`Editar pedido ${displayNumber}`}\r\n                                >\r\n                                  <PencilIcon className=\"w-5 h-5\" />\r\n                                </button>\r\n                                <button\r\n                                  onClick={() => setEditingPaymentsOrder(order)}\r\n                                  className=\"text-indigo-500 hover:text-indigo-400 transition-colors duration-150 p-1 rounded-md\"\r\n                                  title=\"Editar pagos (split)\"\r\n                                  aria-label={`Editar pagos del pedido ${displayNumber}`}\r\n                                >\r\n                                  💳\r\n                                </button>\r\n                                <button\r\n                                  onClick={() => handleDeleteOrder(order.id)}\r\n                                  className=\"text-red-500 hover:text-red-400 transition-colors duration-150 p-1 rounded-md\"\r\n                                  title=\"Eliminar pedido\"\r\n                                  aria-label={`Eliminar pedido ${displayNumber}`}\r\n                                >\r\n                                  <TrashIcon className=\"w-5 h-5\" />\r\n                                </button>\r\n                              </div>\r\n                            </td>\r\n                          </tr>\r\n                        );\r\n                      })\r\n                    )}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n\r\n              {/* Pagination */}\r\n              <div className=\"flex flex-wrap justify-between items-center mt-6 gap-3\">\r\n                <div className=\"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300\">\r\n                  <span>Pedidos por página:</span>\r\n                  <select\r\n                    value={itemsPerPage}\r\n                    onChange={(e) => { setItemsPerPage(Number(e.target.value)); setCurrentPage(1); }}\r\n                    className={classNames('p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-300 bg-white text-gray-900')}\r\n                  >\r\n                    <option value=\"10\">10</option>\r\n                    <option value=\"20\">20</option>\r\n                    <option value=\"30\">30</option>\r\n                    <option value=\"50\">50</option>\r\n                  </select>\r\n                </div>\r\n                <div className=\"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300\">\r\n                  <button\r\n                    onClick={() => setCurrentPage((prev) => Math.max(prev - 1, 1))}\r\n                    disabled={currentPage === 1}\r\n                    className={classNames(\r\n                      'p-2 rounded-md transition-colors duration-200',\r\n                      currentPage === 1 ? 'text-gray-400 dark:text-gray-600 cursor-not-allowed' : theme === 'dark' ? 'hover:bg-gray-700 text-gray-200' : 'hover:bg-gray-100 text-gray-700'\r\n                    )}\r\n                  >\r\n                    <ChevronLeftIcon className=\"w-5 h-5\" />\r\n                  </button>\r\n                  <span>Página {currentPage} de {totalPages}</span>\r\n                  <button\r\n                    onClick={() => setCurrentPage((prev) => Math.min(prev + 1, totalPages))}\r\n                    disabled={currentPage === totalPages}\r\n                    className={classNames(\r\n                      'p-2 rounded-md transition-colors duration-200',\r\n                      currentPage === totalPages ? 'text-gray-400 dark:text-gray-600 cursor-not-allowed' : theme === 'dark' ? 'hover:bg-gray-700 text-gray-200' : 'hover:bg-gray-100 text-gray-700'\r\n                    )}\r\n                  >\r\n                    <ChevronRightIcon className=\"w-5 h-5\" />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        {/* === Resumen por Domiciliarios (ÚNICO) === */}\r\n        <div className=\"mt-8 space-y-6\">\r\n          <h2 className=\"text-xl sm:text-2xl font-bold\">Resumen por Domiciliarios</h2>\r\n\r\n          {resumenPersons.length === 0 ? (\r\n            <div className={classNames(\r\n              \"rounded-2xl p-6 text-center\",\r\n              theme === 'dark' ? 'bg-gray-800 text-gray-300' : 'bg-white text-gray-700'\r\n            )}>\r\n              No hay datos para el resumen de domiciliarios.\r\n            </div>\r\n          ) : (\r\n            <div className=\"grid grid-cols-1 gap-6\">\r\n              {resumenPersons.map((person) => {\r\n                const buckets = resumen[person] || {};\r\n                const lunch = buckets.lunch || { cash:0, nequi:0, daviplata:0, other:0, total:0 };\r\n                const breakfast = buckets.breakfast || { cash:0, nequi:0, daviplata:0, other:0, total:0 };\r\n                const overall = buckets.total || { cash:0, nequi:0, daviplata:0, other:0, total:0 };\r\n\r\n                return (\r\n                  <div key={person} className={classNames(\r\n                    \"rounded-2xl p-4 sm:p-5 shadow-sm\",\r\n                    theme === 'dark' ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'\r\n                  )}>\r\n                    <div className=\"flex items-center justify-between mb-3\">\r\n                      <h3 className=\"text-base sm:text-lg font-semibold\">{person}</h3>\r\n                      <button\r\n                        onClick={() => handleSettle(person, buckets)}\r\n                        className=\"text-xs px-3 py-1.5 rounded-md bg-indigo-600 hover:bg-indigo-700 text-white\"\r\n                      >\r\n                        Liquidar ▸\r\n                      </button>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                      {/* Almuerzo */}\r\n                      <div>\r\n                        <div className=\"text-sm font-medium mb-2\">Almuerzo</div>\r\n                        <div className={classNames(\r\n                          \"rounded-lg p-3 sm:p-4 border\",\r\n                          theme === 'dark' ? 'bg-gray-800/60 border-gray-700' : 'bg-gray-50 border-gray-200'\r\n                        )}>\r\n                          <div className=\"flex justify-between text-sm my-0.5\"><span>Efectivo</span><span className=\"font-semibold\">{money(lunch.cash)}</span></div>\r\n                          <div className=\"flex justify-between text-sm my-0.5\"><span>Daviplata</span><span className=\"font-semibold\">{money(lunch.daviplata)}</span></div>\r\n                          <div className=\"flex justify-between text-sm my-0.5\"><span>Nequi</span><span className=\"font-semibold\">{money(lunch.nequi)}</span></div>\r\n                          {lunch.other > 0 && (\r\n                            <div className=\"flex justify-between text-sm my-0.5\"><span>Otros</span><span className=\"font-semibold\">{money(lunch.other)}</span></div>\r\n                          )}\r\n                          <div className=\"h-px my-2 bg-gray-200 dark:bg-gray-700\" />\r\n                          <div className=\"flex justify-between text-sm\"><span className=\"font-medium\">Total</span><span className=\"font-bold\">{money(lunch.total)}</span></div>\r\n                        </div>\r\n                      </div>\r\n\r\n                      {/* Desayuno */}\r\n                      <div>\r\n                        <div className=\"text-sm font-medium mb-2\">Desayuno</div>\r\n                        <div className={classNames(\r\n                          \"rounded-lg p-3 sm:p-4 border\",\r\n                          theme === 'dark' ? 'bg-gray-800/60 border-gray-700' : 'bg-gray-50 border-gray-200'\r\n                        )}>\r\n                          <div className=\"flex justify-between text-sm my-0.5\"><span>Efectivo</span><span className=\"font-semibold\">{money(breakfast.cash)}</span></div>\r\n                          <div className=\"flex justify-between text-sm my-0.5\"><span>Daviplata</span><span className=\"font-semibold\">{money(breakfast.daviplata)}</span></div>\r\n                          <div className=\"flex justify-between text-sm my-0.5\"><span>Nequi</span><span className=\"font-semibold\">{money(breakfast.nequi)}</span></div>\r\n                          {breakfast.other > 0 && (\r\n                            <div className=\"flex justify-between text-sm my-0.5\"><span>Otros</span><span className=\"font-semibold\">{money(breakfast.other)}</span></div>\r\n                          )}\r\n                          <div className=\"h-px my-2 bg-gray-200 dark:bg-gray-700\" />\r\n                          <div className=\"flex justify-between text-sm\"><span className=\"font-medium\">Total</span><span className=\"font-bold\">{money(breakfast.total)}</span></div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"mt-4\">\r\n                      <div className=\"text-sm font-medium mb-2\">Total general</div>\r\n                      <div className={classNames(\r\n                        \"rounded-lg p-3 sm:p-4 border\",\r\n                        theme === 'dark' ? 'bg-gray-800/60 border-gray-700' : 'bg-gray-50 border-gray-200'\r\n                      )}>\r\n                        <div className=\"flex justify-between text-sm my-0.5\"><span>Efectivo</span><span className=\"font-semibold\">{money(overall.cash)}</span></div>\r\n                        <div className=\"flex justify-between text-sm my-0.5\"><span>Daviplata</span><span className=\"font-semibold\">{money(overall.daviplata)}</span></div>\r\n                        <div className=\"flex justify-between text-sm my-0.5\"><span>Nequi</span><span className=\"font-semibold\">{money(overall.nequi)}</span></div>\r\n                        {overall.other > 0 && (\r\n                          <div className=\"flex justify-between text-sm my-0.5\"><span>Otros</span><span className=\"font-semibold\">{money(overall.other)}</span></div>\r\n                        )}\r\n                        <div className=\"h-px my-2 bg-gray-200 dark:bg-gray-700\" />\r\n                        <div className=\"flex justify-between text-sm\"><span className=\"font-medium\">Total</span><span className=\"font-bold\">{money(overall.total)}</span></div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Modal de edición de pagos (split) */}\r\n      {editingPaymentsOrder && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10001]\">\r\n          <div className={classNames('p-4 sm:p-6 rounded-lg max-w-xl w-full max-h-[80vh] overflow-y-auto', theme === 'dark' ? 'bg-gray-800 text-gray-200' : 'bg-white text-gray-900')}>\r\n            <h3 className=\"text-lg font-semibold mb-4\">\r\n              Editar pagos — Orden #{editingPaymentsOrder.id.slice(0, 8)}\r\n            </h3>\r\n\r\n            <PaymentSplitEditor\r\n              theme={theme}\r\n              total={editingPaymentsOrder.total || 0}\r\n              value={\r\n                Array.isArray(editingPaymentsOrder.payments) && editingPaymentsOrder.payments.length\r\n                  ? editingPaymentsOrder.payments\r\n                  : defaultPaymentsForOrder(editingPaymentsOrder)\r\n              }\r\n              onChange={(rows) => {\r\n                setEditingPaymentsOrder((prev) => ({ ...prev, payments: rows }));\r\n              }}\r\n            />\r\n\r\n            <div className=\"mt-4 flex gap-2 justify-end\">\r\n              <button onClick={() => setEditingPaymentsOrder(null)} className=\"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 text-sm\">\r\n                Cancelar\r\n              </button>\r\n              <button\r\n                onClick={async () => {\r\n                  const ok = await savePaymentsForOrder(editingPaymentsOrder, editingPaymentsOrder.payments || []);\r\n                  if (ok) setEditingPaymentsOrder(null);\r\n                }}\r\n                className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 text-sm\"\r\n              >\r\n                Guardar\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default TablaPedidos;\r\n","// src/components/Admin/InteraccionesPedidos.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Dialog, Transition } from '@headlessui/react';\r\nimport { XMarkIcon, TrashIcon, PencilIcon } from '@heroicons/react/24/outline';\r\nimport { classNames } from '../../utils/classNames';\r\nimport OrderSummary from '../OrderSummary';\r\nimport BreakfastOrderSummary from '../BreakfastOrderSummary';\r\nimport { db } from '../../config/firebase';\r\nimport { deleteDoc, doc, updateDoc, onSnapshot, collection } from 'firebase/firestore';\r\nimport OptionSelector from '../OptionSelector';\r\nimport { calculateTotal } from '../../utils/MealCalculations';\r\nimport { calculateBreakfastPrice } from '../../utils/BreakfastCalculations';\r\n\r\n\r\n// ===================== Helpers para hidratación =====================\r\nconst normalizeName = (s) => (s || '').replace(/\\s*NUEVO\\s*$/i, '').trim();\r\n\r\nconst byName = (list, value) => {\r\n  if (!value) return null;\r\n  const name = typeof value === 'string' ? value : value?.name;\r\n  return list.find((o) => normalizeName(o.name) === normalizeName(name)) || null;\r\n};\r\n\r\nconst manyByName = (list, arr) => (Array.isArray(arr) ? arr.map((v) => byName(list, v)).filter(Boolean) : []);\r\n\r\nconst ensureAddress = (addr = {}, fallback = {}) => ({\r\n  address: addr.address ?? fallback.address ?? '',\r\n  phoneNumber: addr.phoneNumber ?? fallback.phoneNumber ?? '',\r\n  addressType: addr.addressType ?? fallback.addressType ?? '',\r\n  localName: addr.localName ?? fallback.localName ?? '',\r\n  unitDetails: addr.unitDetails ?? fallback.unitDetails ?? '',\r\n  recipientName: addr.recipientName ?? fallback.recipientName ?? '',\r\n});\r\n\r\nconst InteraccionesPedidos = ({\r\n  theme,\r\n  showProteinModal,\r\n  setShowProteinModal,\r\n  newProtein,\r\n  setNewProtein,\r\n  handleAddProtein,\r\n  proteins,\r\n  totalProteinUnits,\r\n  isLoading,\r\n  showMealDetails,\r\n  setShowMealDetails,\r\n  editingOrder,\r\n  setEditingOrder,\r\n  editForm,\r\n  handleMealFormFieldChange,\r\n  handleEditFormFieldChange,\r\n  handleSaveEdit,\r\n  showConfirmDeleteAll,\r\n  setShowConfirmDeleteAll,\r\n  confirmText,\r\n  setConfirmText,\r\n  handleDeleteAllOrders,\r\n  setError,\r\n  setSuccess,\r\n  showAddOrderModal,\r\n  setShowAddOrderModal,\r\n  newOrderForm,\r\n  handleNewOrderMealFormFieldChange,\r\n  handleNewOrderFieldChange,\r\n  handleAddOrderSubmit,\r\n  uniqueDeliveryPersons,\r\n}) => {\r\n  const [soups, setSoups] = useState([]);\r\n  const [soupReplacements, setSoupReplacements] = useState([]);\r\n  const [principles, setPrinciples] = useState([]);\r\n  const [menuProteins, setMenuProteins] = useState([]);\r\n  const [drinks, setDrinks] = useState([]);\r\n  const [sides, setSides] = useState([]);\r\n  const [additions, setAdditions] = useState([]);\r\n  const [paymentMethods, setPaymentMethods] = useState([]);\r\n\r\n  const [breakfastEggs, setBreakfastEggs] = useState([]);\r\n  const [breakfastBroths, setBreakfastBroths] = useState([]);\r\n  const [breakfastRiceBread, setBreakfastRiceBread] = useState([]);\r\n  const [breakfastDrinks, setBreakfastDrinks] = useState([]);\r\n  const [breakfastAdditions, setBreakfastAdditions] = useState([]);\r\n  const [breakfastTypes, setBreakfastTypes] = useState([]);\r\n  const [breakfastProteins, setBreakfastProteins] = useState([]);\r\n\r\n  // NUEVO: estado usado por el modal de proteínas\r\n  const [editingProtein, setEditingProtein] = useState(null);\r\n\r\n  // ===================== Carga de catálogos =====================\r\n  useEffect(() => {\r\n    const mapSetter = {\r\n      soups: setSoups,\r\n      soupReplacements: setSoupReplacements,\r\n      principles: setPrinciples,\r\n      proteins: setMenuProteins,\r\n      drinks: setDrinks,\r\n      sides: setSides,\r\n      additions: setAdditions,\r\n      paymentMethods: setPaymentMethods,\r\n      breakfastEggs: setBreakfastEggs,\r\n      breakfastBroths: setBreakfastBroths,\r\n      breakfastRiceBread: setBreakfastRiceBread,\r\n      breakfastDrinks: setBreakfastDrinks,\r\n      breakfastAdditions: setBreakfastAdditions,\r\n      breakfastTypes: setBreakfastTypes,\r\n      breakfastProteins: setBreakfastProteins,\r\n    };\r\n\r\n    const listen = (name) =>\r\n      onSnapshot(collection(db, name), (snap) => mapSetter[name](snap.docs.map((d) => ({ id: d.id, ...d.data() }))));\r\n\r\n    const unsubs = [\r\n      listen('soups'),\r\n      listen('soupReplacements'),\r\n      listen('principles'),\r\n      listen('proteins'),\r\n      listen('drinks'),\r\n      listen('sides'),\r\n      listen('additions'),\r\n      listen('paymentMethods'),\r\n      listen('breakfastEggs'),\r\n      listen('breakfastBroths'),\r\n      listen('breakfastRiceBread'),\r\n      listen('breakfastDrinks'),\r\n      listen('breakfastAdditions'),\r\n      listen('breakfastTypes'),\r\n      listen('breakfastProteins'),\r\n    ];\r\n    return () => unsubs.forEach((u) => u && u());\r\n  }, []);\r\n\r\n  // ===================== Editar Breakfast (setter anidado) =====================\r\n  const handleBreakfastFormFieldChange = (index, field, value) => {\r\n    const list = Array.isArray(editForm.breakfasts) ? [...editForm.breakfasts] : [];\r\n    if (!list[index]) list[index] = {};\r\n    if (field.includes('.')) {\r\n      const [parent, child] = field.split('.');\r\n      list[index] = { ...list[index], [parent]: { ...(list[index][parent] || {}), [child]: value } };\r\n    } else {\r\n      list[index] = { ...list[index], [field]: value };\r\n    }\r\n    handleEditFormFieldChange('breakfasts', list);\r\n  };\r\n\r\n  // Passthrough inmediato para OptionSelector de desayuno\r\n  const handleBreakfastImmediate = (idx, field, value) => {\r\n    handleBreakfastFormFieldChange(idx, field, value);\r\n  };\r\n\r\n  // ===================== Hidratación segura del formulario =====================\r\n  const hydratedOrderIdRef = React.useRef(null);\r\n\r\n  // Reset de bandera cuando cierras/abres otra orden\r\n  useEffect(() => {\r\n    if (!editingOrder) hydratedOrderIdRef.current = null;\r\n  }, [editingOrder]);\r\n\r\n  useEffect(() => {\r\n    if (!editingOrder) return;\r\n\r\n    const catalogsLoaded =\r\n      soups.length ||\r\n      principles.length ||\r\n      menuProteins.length ||\r\n      drinks.length ||\r\n      sides.length ||\r\n      additions.length ||\r\n      breakfastTypes.length ||\r\n      breakfastBroths.length ||\r\n      breakfastEggs.length ||\r\n      breakfastRiceBread.length ||\r\n      breakfastDrinks.length ||\r\n      breakfastAdditions.length ||\r\n      breakfastProteins.length;\r\n\r\n    if (!catalogsLoaded) return;\r\n\r\n    if (hydratedOrderIdRef.current === editingOrder.id) return; // evita rehidrataciones\r\n\r\n    const fallbackAddress = editingOrder.address || {};\r\n\r\n    // Total preferimos recalcular solo para almuerzos; para desayuno respetamos total existente\r\n    const computedTotal =\r\n      typeof editingOrder.total === 'number'\r\n        ? editingOrder.total\r\n        : editingOrder.type === 'breakfast'\r\n        ? editingOrder.total || 0\r\n        : Array.isArray(editingOrder.meals)\r\n        ? Number(calculateTotal(editingOrder.meals) || 0)\r\n        : 0;\r\n\r\n    handleEditFormFieldChange('total', computedTotal);\r\n    handleEditFormFieldChange('payment', editingOrder.payment || '');\r\n    handleEditFormFieldChange('status', editingOrder.status || 'Pendiente');\r\n    handleEditFormFieldChange('deliveryPerson', editingOrder.deliveryPerson || '');\r\n\r\n    if (editingOrder.type === 'breakfast') {\r\n      const breakfasts = (editingOrder.breakfasts || []).map((b) => ({\r\n        type: byName(breakfastTypes, b.type),\r\n        broth: byName(breakfastBroths, b.broth),\r\n        eggs: byName(breakfastEggs, b.eggs),\r\n        riceBread: byName(breakfastRiceBread, b.riceBread),\r\n        drink: byName(breakfastDrinks, b.drink),\r\n        protein: byName(breakfastProteins, b.protein),\r\n        additions: Array.isArray(b.additions)\r\n          ? b.additions\r\n              .map((a) => {\r\n                const full = byName(breakfastAdditions, a);\r\n                return full ? { ...full, quantity: a.quantity || 1 } : null;\r\n              })\r\n              .filter(Boolean)\r\n          : [],\r\n        cutlery: !!b.cutlery,\r\n        time: typeof b.time === 'string' ? b.time : b.time?.name || '',\r\n        address: ensureAddress(b.address, fallbackAddress),\r\n        notes: b.notes || '',\r\n      }));\r\n      handleEditFormFieldChange('breakfasts', breakfasts);\r\n    } else {\r\n      const meals = (editingOrder.meals || []).map((m) => ({\r\n        soup: byName(soups, m.soup),\r\n        soupReplacement:\r\n          typeof m.soupReplacement === 'string' ? m.soupReplacement : m.soupReplacement?.replacement || '',\r\n        principle: Array.isArray(m.principle) ? m.principle.map((p) => byName(principles, p)).filter(Boolean) : [],\r\n        principleReplacement:\r\n          typeof m.principleReplacement === 'string'\r\n            ? m.principleReplacement\r\n            : m.principleReplacement?.replacement || '',\r\n        protein: byName(menuProteins, m.protein),\r\n        drink: byName(drinks, m.drink),\r\n        sides: manyByName(sides, m.sides),\r\n        additions: Array.isArray(m.additions)\r\n          ? m.additions\r\n              .map((a) => {\r\n                const full = byName(additions, a);\r\n                return full ? { ...full, quantity: a.quantity || 1, price: a.price ?? full.price ?? 0 } : null;\r\n              })\r\n              .filter(Boolean)\r\n          : [],\r\n        cutlery: !!m.cutlery,\r\n        time: typeof m.time === 'string' ? m.time : m.time?.name || '',\r\n        address: ensureAddress(m.address, fallbackAddress),\r\n        notes: m.notes || '',\r\n      }));\r\n      handleEditFormFieldChange('meals', meals);\r\n    }\r\n\r\n    hydratedOrderIdRef.current = editingOrder.id;\r\n  }, [\r\n    editingOrder,\r\n    soups,\r\n    principles,\r\n    menuProteins,\r\n    drinks,\r\n    sides,\r\n    additions,\r\n    breakfastTypes,\r\n    breakfastBroths,\r\n    breakfastEggs,\r\n    breakfastRiceBread,\r\n    breakfastDrinks,\r\n    breakfastAdditions,\r\n    breakfastProteins,\r\n    handleEditFormFieldChange,\r\n  ]);\r\n\r\n  // Recalcular total en edición cuando cambian meals (solo almuerzo)\r\n  useEffect(() => {\r\n    if (!editingOrder || editingOrder.type === 'breakfast') return;\r\n    const computed = Number(calculateTotal(editForm.meals || [])) || 0;\r\n    if (computed !== (editForm.total || 0)) {\r\n      handleEditFormFieldChange('total', computed);\r\n    }\r\n  }, [editingOrder, editForm.meals, handleEditFormFieldChange, calculateTotal]);\r\n\r\n  // Soporta lunch (meals) y breakfast (breakfasts)\r\n  const mealsForDetails = Array.isArray(showMealDetails?.meals)\r\n    ? showMealDetails.meals\r\n    : Array.isArray(showMealDetails?.breakfasts)\r\n    ? showMealDetails.breakfasts\r\n    : [];\r\n\r\n    // Recalcular total en edición cuando cambian breakfasts (solo desayunos)\r\nuseEffect(() => {\r\n  if (!editingOrder || editingOrder.type !== 'breakfast') return;\r\n  const list = editForm.breakfasts || [];\r\n  const computed = list.reduce(\r\n    (sum, b) => sum + Number(calculateBreakfastPrice(b, 3, breakfastTypes) || 0),\r\n    0\r\n  );\r\n  if (computed !== (editForm.total || 0)) {\r\n    handleEditFormFieldChange('total', computed);\r\n  }\r\n}, [editingOrder, editForm.breakfasts, breakfastTypes, handleEditFormFieldChange]);\r\n\r\n\r\n  const handleDeleteProtein = async (proteinId) => {\r\n    try {\r\n      await deleteDoc(doc(db, 'dailyProteins', proteinId));\r\n      setSuccess('Proteína eliminada correctamente.');\r\n    } catch (error) {\r\n      setError(`Error al eliminar proteína: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  const handleEditProtein = (protein) => {\r\n    setEditingProtein(protein);\r\n  };\r\n\r\n  const handleUpdateProtein = async () => {\r\n    if (!editingProtein.name || !editingProtein.quantity || isNaN(editingProtein.quantity) || Number(editingProtein.quantity) <= 0) {\r\n      setError('Por favor, ingrese un nombre de proteína válido y una cantidad mayor a 0.');\r\n      return;\r\n    }\r\n    try {\r\n      await updateDoc(doc(db, 'dailyProteins', editingProtein.id), {\r\n        name: editingProtein.name.trim(),\r\n        quantity: Number(editingProtein.quantity),\r\n      });\r\n      setSuccess('Proteína actualizada correctamente.');\r\n      setEditingProtein(null);\r\n    } catch (error) {\r\n      setError(`Error al actualizar proteína: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  const handleCancelEditProtein = () => {\r\n    setEditingProtein(null);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {/* Diálogo para gestionar proteínas */}\r\n      <Transition show={showProteinModal} as={React.Fragment}>\r\n        <Dialog as=\"div\" className=\"relative z-50\" onClose={() => { setShowProteinModal(false); setEditingProtein(null); }}>\r\n          <Transition.Child as={React.Fragment} enter=\"ease-out duration-300\" enterFrom=\"opacity-0\" enterTo=\"opacity-100\" leave=\"ease-in duration-200\" leaveFrom=\"opacity-100\" leaveTo=\"opacity-0\">\r\n            <div className=\"fixed inset-0 bg-black bg-opacity-50\" />\r\n          </Transition.Child>\r\n          <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n            <Transition.Child as={React.Fragment} enter=\"ease-out duration-300\" enterFrom=\"opacity-0 scale-95\" enterTo=\"opacity-100 scale-100\" leave=\"ease-in duration-200\" leaveFrom=\"opacity-100 scale-100\" leaveTo=\"opacity-0 scale-95\">\r\n              <Dialog.Panel\r\n                className={\r\n                  classNames(\r\n                    'w-full max-w-md p-6 rounded-lg shadow-md',\r\n                    theme === 'dark' ? 'bg-gray-800 text-gray-200' : 'bg-gray-50 text-gray-900'\r\n                  )\r\n                }\r\n              >\r\n                <div className=\"flex justify-between items-center mb-4\">\r\n                  <Dialog.Title className=\"text-lg font-medium\">{editingProtein ? 'Editar Proteína' : 'Gestionar Proteínas'}</Dialog.Title>\r\n                  <button onClick={() => { setShowProteinModal(false); setEditingProtein(null); }} className=\"text-gray-500 hover:text-gray-400\" aria-label=\"Cerrar modal\">\r\n                    <XMarkIcon className=\"w-5 h-5\" />\r\n                  </button>\r\n                </div>\r\n                <div className=\"space-y-4\">\r\n                  {editingProtein ? (\r\n                    <>\r\n                      <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Nombre</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={editingProtein.name}\r\n                          onChange={(e) => setEditingProtein({ ...editingProtein, name: e.target.value })}\r\n                          className={classNames(\r\n                            'w-full p-2 rounded-md border text-sm',\r\n                            theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                            'focus:outline-none focus:ring-1 focus:ring-blue-500'\r\n                          )}\r\n                          placeholder=\"Ej: Pollo\"\r\n                        />\r\n                      </div>\r\n                      <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Cantidad</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          value={editingProtein.quantity}\r\n                          onChange={(e) => setEditingProtein({ ...editingProtein, quantity: e.target.value })}\r\n                          className={classNames(\r\n                            'w-full p-2 rounded-md border text-sm',\r\n                            theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                            'focus:outline-none focus:ring-1 focus:ring-blue-500'\r\n                          )}\r\n                          placeholder=\"Ej: 50\"\r\n                          min=\"0\"\r\n                        />\r\n                      </div>\r\n                      <div className=\"flex justify-end gap-2\">\r\n                        <button onClick={handleCancelEditProtein} className={classNames('px-4 py-2 rounded-md text-sm font-medium', theme === 'dark' ? 'bg-gray-600 hover:bg-gray-700 text-gray-200' : 'bg-gray-200 hover:bg-gray-300 text-gray-900')}>Cancelar</button>\r\n                        <button onClick={handleUpdateProtein} disabled={isLoading} className={classNames('px-4 py-2 rounded-md text-sm font-medium', isLoading ? 'bg-gray-400 cursor-not-allowed' : theme === 'dark' ? 'bg-blue-600 hover:bg-blue-700 text-white' : 'bg-blue-500 hover:bg-blue-600 text-white')}>\r\n                          {isLoading ? 'Guardando...' : 'Actualizar'}\r\n                        </button>\r\n                      </div>\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Nombre</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={newProtein.name}\r\n                          onChange={(e) => setNewProtein({ ...newProtein, name: e.target.value })}\r\n                          className={classNames(\r\n                            'w-full p-2 rounded-md border text-sm',\r\n                            theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                            'focus:outline-none focus:ring-1 focus:ring-blue-500'\r\n                          )}\r\n                          placeholder=\"Ej: Pollo\"\r\n                        />\r\n                      </div>\r\n                      <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Cantidad</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          value={newProtein.quantity}\r\n                          onChange={(e) => setNewProtein({ ...newProtein, quantity: e.target.value })}\r\n                          className={classNames(\r\n                            'w-full p-2 rounded-md border text-sm',\r\n                            theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                            'focus:outline-none focus:ring-1 focus:ring-blue-500'\r\n                          )}\r\n                          placeholder=\"Ej: 50\"\r\n                          min=\"0\"\r\n                        />\r\n                      </div>\r\n                      <div className=\"flex justify-end gap-2\">\r\n                        <button onClick={() => setShowProteinModal(false)} className={classNames('px-4 py-2 rounded-md text-sm font-medium', theme === 'dark' ? 'bg-gray-600 hover:bg-gray-700 text-gray-200' : 'bg-gray-200 hover:bg-gray-300 text-gray-900')}>Cancelar</button>\r\n                        <button onClick={handleAddProtein} disabled={isLoading} className={classNames('px-4 py-2 rounded-md text-sm font-medium', isLoading ? 'bg-gray-400 cursor-not-allowed' : theme === 'dark' ? 'bg-blue-600 hover:bg-blue-700 text-white' : 'bg-blue-500 hover:bg-blue-600 text-white')}>\r\n                          {isLoading ? 'Guardando...' : 'Agregar'}\r\n                        </button>\r\n                      </div>\r\n                    </>\r\n                  )}\r\n                </div>\r\n                <div className=\"mt-6\">\r\n                  <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                    Proteínas Registradas (Total: {totalProteinUnits} unidades)\r\n                  </h3>\r\n                  {proteins.length === 0 ? (\r\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400\">No hay proteínas registradas.</p>\r\n                  ) : (\r\n                    <ul className=\"space-y-2\">\r\n                      {proteins.map((protein) => (\r\n                        <li key={protein.id} className={classNames('flex justify-between items-center p-2 rounded-md', theme === 'dark' ? 'bg-gray-700' : 'bg-gray-100')}>\r\n                          <span className=\"text-sm\">\r\n                            {protein.name}: {protein.quantity} unidades\r\n                          </span>\r\n                          <div className=\"flex gap-2\">\r\n                            <button onClick={() => handleEditProtein(protein)} className=\"text-blue-500 hover:text-blue-400 transition-colors duration-150 p-1 rounded-md\" title=\"Editar proteína\" aria-label={`Editar ${protein.name}`}>\r\n                              <PencilIcon className=\"w-4 h-4\" />\r\n                            </button>\r\n                            <button onClick={() => handleDeleteProtein(protein.id)} className=\"text-red-500 hover:text-red-400 transition-colors duration-150 p-1 rounded-md\" title=\"Eliminar proteína\" aria-label={`Eliminar ${protein.name}`}>\r\n                              <TrashIcon className=\"w-4 h-4\" />\r\n                            </button>\r\n                          </div>\r\n                        </li>\r\n                      ))}\r\n                    </ul>\r\n                  )}\r\n                </div>\r\n              </Dialog.Panel>\r\n            </Transition.Child>\r\n          </div>\r\n        </Dialog>\r\n      </Transition>\r\n\r\n      {/* Diálogo para detalles del pedido */}\r\n      <Transition show={showMealDetails !== null} as={React.Fragment}>\r\n        <Dialog as=\"div\" className=\"relative z-50\" onClose={() => setShowMealDetails(null)}>\r\n          <Transition.Child as={React.Fragment} enter=\"ease-out duration-300\" enterFrom=\"opacity-0\" enterTo=\"opacity-100\" leave=\"ease-in duration-200\" leaveFrom=\"opacity-100\" leaveTo=\"opacity-0\">\r\n            <div className=\"fixed inset-0 bg-black bg-opacity-50\" />\r\n          </Transition.Child>\r\n          <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n            <Transition.Child as={React.Fragment} enter=\"ease-out duration-300\" enterFrom=\"opacity-0 scale-95\" enterTo=\"opacity-100 scale-100\" leave=\"ease-in duration-200\" leaveFrom=\"opacity-100 scale-100\" leaveTo=\"opacity-0 scale-95\">\r\n              <Dialog.Panel className={classNames('w-full max-w-2xl p-6 rounded-lg shadow-xl max-h-[80vh] overflow-y-auto', theme === 'dark' ? 'bg-gray-800 text-gray-200' : 'bg-gray-50 text-gray-900')}>\r\n                <Dialog.Title className=\"text-lg font-medium mb-4 flex justify-between items-center\">\r\n                  Detalles del Pedido\r\n                  <button onClick={() => setShowMealDetails(null)} className=\"text-gray-500 hover:text-gray-400\" aria-label=\"Cerrar detalles\">\r\n                    <XMarkIcon className=\"w-5 h-5\" />\r\n                  </button>\r\n                </Dialog.Title>\r\n                {showMealDetails && (\r\n                  <>\r\n                    {showMealDetails?.type === 'breakfast' ? (\r\n                      <BreakfastOrderSummary items={showMealDetails.breakfasts || mealsForDetails} user={{ role: 3 }} statusClass=\"bg-white\" showSaveButton={false} />\r\n                    ) : (\r\n                      <OrderSummary meals={mealsForDetails} isTableOrder={false} isWaiterView={true} statusClass=\"bg-white\" />\r\n                    )}\r\n                    <div className=\"mt-3 text-xs sm:text-sm\">\r\n                      <p className=\"font-medium\">Estado: {showMealDetails.status || 'Pendiente'}</p>\r\n                      <p className=\"font-medium\">Domiciliario: {showMealDetails.deliveryPerson || 'Sin asignar'}</p>\r\n                 {showMealDetails?.type === 'breakfast' ? (\r\n  <p className=\"font-medium\">\r\n    Total del pedido: ${\r\n      ((showMealDetails.breakfasts || []).reduce(\r\n        (sum, b) => sum + Number(calculateBreakfastPrice(b, 3, breakfastTypes) || 0),\r\n        0\r\n      )).toLocaleString('es-CO')\r\n    }\r\n  </p>\r\n) : (\r\n  typeof showMealDetails.total === 'number' && (\r\n <p className=\"font-medium\">\r\n  Total del pedido: ${\r\n    (\r\n      Array.isArray(showMealDetails?.meals)\r\n        ? Number(calculateTotal(showMealDetails.meals) || 0)\r\n        : Number(showMealDetails?.total || 0)\r\n    ).toLocaleString('es-CO')\r\n  }\r\n</p>\r\n\r\n  )\r\n)}\r\n\r\n                    </div>\r\n                  </>\r\n                )}\r\n              </Dialog.Panel>\r\n            </Transition.Child>\r\n          </div>\r\n        </Dialog>\r\n      </Transition>\r\n\r\n      {/* Diálogo para editar pedido */}\r\n      <Transition show={editingOrder !== null} as={React.Fragment}>\r\n        <Dialog as=\"div\" className=\"relative z-50\" onClose={() => setEditingOrder(null)}>\r\n          <Transition.Child as={React.Fragment} enter=\"ease-out duration-300\" enterFrom=\"opacity-0\" enterTo=\"opacity-100\" leave=\"ease-in duration-200\" leaveFrom=\"opacity-100\" leaveTo=\"opacity-0\">\r\n            <div className=\"fixed inset-0 bg-black bg-opacity-50\" />\r\n          </Transition.Child>\r\n          <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n            <Transition.Child as={React.Fragment} enter=\"ease-out duration-300\" enterFrom=\"opacity-0 scale-95\" enterTo=\"opacity-100 scale-100\" leave=\"ease-in duration-200\" leaveFrom=\"opacity-100 scale-100\" leaveTo=\"opacity-0 scale-95\">\r\n              <Dialog.Panel className={classNames('w-full max-w-2xl p-6 rounded-lg shadow-xl max-h-[80vh] overflow-y-auto', theme === 'dark' ? 'bg-gray-800 text-gray-200' : 'bg-gray-50 text-gray-900')}>\r\n                <Dialog.Title className=\"text-lg font-medium mb-4 flex justify-between items-center\">\r\n                  Editar Pedido\r\n                  <button onClick={() => setEditingOrder(null)} className=\"text-gray-500 hover:text-gray-400\" aria-label=\"Cerrar edición\">\r\n                    <XMarkIcon className=\"w-5 h-5\" />\r\n                  </button>\r\n                </Dialog.Title>\r\n                {(() => {\r\n                  const editItems = editingOrder?.type === 'breakfast' ? editForm.breakfasts || [] : editForm.meals || [];\r\n\r\n                  return editItems.map((row, idx) => (\r\n                    <div key={idx} className=\"mb-6 p-4 border rounded-md border-gray-200 dark:border-gray-600\">\r\n                      <h3 className=\"font-medium mb-2\">{editingOrder?.type === 'breakfast' ? `Desayuno ${idx + 1}` : `Bandeja ${idx + 1}`}</h3>\r\n\r\n                      {editingOrder?.type === 'breakfast' ? (\r\n                        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Tipo</label>\r\n                            <OptionSelector title=\"Tipo\" emoji=\"🥞\" options={breakfastTypes} selected={row.type || null} multiple={false} onImmediateSelect={(v) => handleBreakfastImmediate(idx, 'type', v)} />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Caldo</label>\r\n                            <OptionSelector title=\"Caldo\" emoji=\"🥣\" options={breakfastBroths} selected={row.broth || null} multiple={false} onImmediateSelect={(v) => handleBreakfastImmediate(idx, 'broth', v)} />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Huevos</label>\r\n                            <OptionSelector title=\"Huevos\" emoji=\"🥚\" options={breakfastEggs} selected={row.eggs || null} multiple={false} onImmediateSelect={(v) => handleBreakfastImmediate(idx, 'eggs', v)} />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Arroz/Pan</label>\r\n                            <OptionSelector title=\"Arroz/Pan\" emoji=\"🍞\" options={breakfastRiceBread} selected={row.riceBread || null} multiple={false} onImmediateSelect={(v) => handleBreakfastImmediate(idx, 'riceBread', v)} />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Bebida</label>\r\n                            <OptionSelector title=\"Bebida\" emoji=\"🥤\" options={breakfastDrinks} selected={row.drink || null} multiple={false} onImmediateSelect={(v) => handleBreakfastImmediate(idx, 'drink', v)} />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Proteína</label>\r\n                            <OptionSelector title=\"Proteína\" emoji=\"🍖\" options={breakfastProteins} selected={row.protein || null} multiple={false} onImmediateSelect={(v) => handleBreakfastImmediate(idx, 'protein', v)} />\r\n                          </div>\r\n                          <div className=\"sm:col-span-2\">\r\n                            <label className=\"block text-sm font-medium mb-1\">Adiciones</label>\r\n                            <OptionSelector\r\n                              title=\"Adiciones\"\r\n                              emoji=\"➕\"\r\n                              options={breakfastAdditions}\r\n                              selected={row.additions || []}\r\n                              multiple={true}\r\n                              onImmediateSelect={(sel) => handleBreakfastImmediate(idx, 'additions', sel.map((a) => ({ name: a.name, quantity: a.quantity || 1 })))}\r\n                            />\r\n                          </div>\r\n\r\n                          {/* Operativos desayuno */}\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Cubiertos</label>\r\n                            <input type=\"checkbox\" checked={!!row.cutlery} onChange={(e) => handleBreakfastFormFieldChange(idx, 'cutlery', e.target.checked)} className=\"h-4 w-4\" />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Hora de Entrega</label>\r\n                            <input\r\n                              type=\"text\"\r\n                              value={typeof row.time === 'string' ? row.time : row.time?.name || ''}\r\n                              onChange={(e) => handleBreakfastFormFieldChange(idx, 'time', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            />\r\n                          </div>\r\n                          <div className=\"sm:col-span-2\">\r\n                            <label className=\"block text-sm font-medium mb-1\">Dirección</label>\r\n                            <input\r\n                              type=\"text\"\r\n                              value={row.address?.address || ''}\r\n                              onChange={(e) => handleBreakfastFormFieldChange(idx, 'address.address', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Teléfono</label>\r\n                            <input\r\n                              type=\"text\"\r\n                              value={row.address?.phoneNumber || ''}\r\n                              onChange={(e) => handleBreakfastFormFieldChange(idx, 'address.phoneNumber', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Tipo de Dirección</label>\r\n                            <select\r\n                              value={row.address?.addressType || ''}\r\n                              onChange={(e) => handleBreakfastFormFieldChange(idx, 'address.addressType', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            >\r\n                              <option value=\"\">Seleccione</option>\r\n                              <option value=\"house\">Casa/Apto</option>\r\n                              <option value=\"school\">Colegio/Oficina</option>\r\n                              <option value=\"complex\">Conjunto</option>\r\n                              <option value=\"shop\">Tienda/Local</option>\r\n                            </select>\r\n                          </div>\r\n                          {row.address?.addressType === 'shop' && (\r\n                            <div>\r\n                              <label className=\"block text-sm font-medium mb-1\">Nombre del Local</label>\r\n                              <input\r\n                                type=\"text\"\r\n                                value={row.address?.localName || ''}\r\n                                onChange={(e) => handleBreakfastFormFieldChange(idx, 'address.localName', e.target.value)}\r\n                                className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                              />\r\n                            </div>\r\n                          )}\r\n                          {row.address?.addressType === 'school' && (\r\n                            <div>\r\n                              <label className=\"block text-sm font-medium mb-1\">Nombre del destinatario</label>\r\n                              <input\r\n                                type=\"text\"\r\n                                value={row.address?.recipientName || ''}\r\n                                onChange={(e) => handleBreakfastFormFieldChange(idx, 'address.recipientName', e.target.value)}\r\n                                className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                              />\r\n                            </div>\r\n                          )}\r\n                          {row.address?.addressType === 'complex' && (\r\n                            <div>\r\n                              <label className=\"block text-sm font-medium mb-1\">Detalles (Torre/Apto)</label>\r\n                              <input\r\n                                type=\"text\"\r\n                                value={row.address?.unitDetails || ''}\r\n                                onChange={(e) => handleBreakfastFormFieldChange(idx, 'address.unitDetails', e.target.value)}\r\n                                className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                              />\r\n                            </div>\r\n                          )}\r\n                          <div className=\"sm:col-span-2\">\r\n                            <label className=\"block text-sm font-medium mb-1\">Notas</label>\r\n                            <input\r\n                              type=\"text\"\r\n                              value={row.notes || ''}\r\n                              onChange={(e) => handleBreakfastFormFieldChange(idx, 'notes', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Sopa o reemplazo</label>\r\n                            <OptionSelector title=\"Sopa\" emoji=\"🥣\" options={soups} selected={row.soup || null} multiple={false} onImmediateSelect={(v) => handleMealFormFieldChange(idx, 'soup', v)} />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Principio</label>\r\n                            <OptionSelector\r\n                              title=\"Principio\"\r\n                              emoji=\"🍚\"\r\n                              options={principles}\r\n                              selected={row.principle || []}\r\n                              multiple={true}\r\n                              showConfirmButton={true}\r\n                              onImmediateSelect={(selection) => handleMealFormFieldChange(idx, 'principle', selection)}\r\n                              onConfirm={({ selection }) => handleMealFormFieldChange(idx, 'principle', selection)}\r\n                            />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Proteína</label>\r\n                            <OptionSelector title=\"Proteína\" emoji=\"🍖\" options={menuProteins} selected={row.protein || null} multiple={false} onImmediateSelect={(v) => handleMealFormFieldChange(idx, 'protein', v)} />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Bebida</label>\r\n                            <OptionSelector title=\"Bebida\" emoji=\"🥤\" options={drinks} selected={row.drink || null} multiple={false} onImmediateSelect={(v) => handleMealFormFieldChange(idx, 'drink', v)} />\r\n                          </div>\r\n                          <div className=\"sm:col-span-2\">\r\n                            <label className=\"block text-sm font-medium mb-1\">Acompañamientos</label>\r\n                            <OptionSelector title=\"Acompañamientos\" emoji=\"🥗\" options={sides} selected={row.sides || []} multiple={true} onImmediateSelect={(selection) => handleMealFormFieldChange(idx, 'sides', selection)} />\r\n                          </div>\r\n                          <div className=\"sm:col-span-2\">\r\n                            <label className=\"block text-sm font-medium mb-1\">Adiciones</label>\r\n                            <OptionSelector\r\n                              title=\"Adiciones\"\r\n                              emoji=\"➕\"\r\n                              options={additions}\r\n                              selected={row.additions || []}\r\n                              multiple={true}\r\n                              onImmediateSelect={(sel) =>\r\n                                handleMealFormFieldChange(\r\n                                  idx,\r\n                                  'additions',\r\n                                  sel.map((a) => ({\r\n                                    id: a.id,\r\n                                    name: a.name,\r\n                                    price: a.price || 0,\r\n                                    protein: a.protein || '',\r\n                                    replacement: a.replacement || '',\r\n                                    quantity: a.quantity || 1,\r\n                                  }))\r\n                                )\r\n                              }\r\n                            />\r\n                          </div>\r\n\r\n                          {/* Operativos almuerzo */}\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Cubiertos</label>\r\n                            <input type=\"checkbox\" checked={!!row.cutlery} onChange={(e) => handleMealFormFieldChange(idx, 'cutlery', e.target.checked)} className=\"h-4 w-4\" />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Hora de Entrega</label>\r\n                            <input\r\n                              type=\"text\"\r\n                              value={typeof row.time === 'string' ? row.time : row.time?.name || ''}\r\n                              onChange={(e) => handleMealFormFieldChange(idx, 'time', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            />\r\n                          </div>\r\n                          <div className=\"sm:col-span-2\">\r\n                            <label className=\"block text-sm font-medium mb-1\">Dirección</label>\r\n                            <input\r\n                              type=\"text\"\r\n                              value={row.address?.address || ''}\r\n                              onChange={(e) => handleMealFormFieldChange(idx, 'address.address', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Teléfono</label>\r\n                            <input\r\n                              type=\"text\"\r\n                              value={row.address?.phoneNumber || ''}\r\n                              onChange={(e) => handleMealFormFieldChange(idx, 'address.phoneNumber', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Tipo de Dirección</label>\r\n                            <select\r\n                              value={row.address?.addressType || ''}\r\n                              onChange={(e) => handleMealFormFieldChange(idx, 'address.addressType', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            >\r\n                              <option value=\"\">Seleccione</option>\r\n                              <option value=\"house\">Casa/Apto</option>\r\n                              <option value=\"school\">Colegio/Oficina</option>\r\n                              <option value=\"complex\">Conjunto</option>\r\n                              <option value=\"shop\">Tienda/Local</option>\r\n                            </select>\r\n                          </div>\r\n                          {row.address?.addressType === 'shop' && (\r\n                            <div>\r\n                              <label className=\"block text-sm font-medium mb-1\">Nombre del Local</label>\r\n                              <input\r\n                                type=\"text\"\r\n                                value={row.address?.localName || ''}\r\n                                onChange={(e) => handleMealFormFieldChange(idx, 'address.localName', e.target.value)}\r\n                                className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                              />\r\n                            </div>\r\n                          )}\r\n                          {row.address?.addressType === 'school' && (\r\n                            <div>\r\n                              <label className=\"block text-sm font-medium mb-1\">Nombre del destinatario</label>\r\n                              <input\r\n                                type=\"text\"\r\n                                value={row.address?.recipientName || ''}\r\n                                onChange={(e) => handleMealFormFieldChange(idx, 'address.recipientName', e.target.value)}\r\n                                className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                              />\r\n                            </div>\r\n                          )}\r\n                          {row.address?.addressType === 'complex' && (\r\n                            <div>\r\n                              <label className=\"block text-sm font-medium mb-1\">Detalles (Torre/Apto)</label>\r\n                              <input\r\n                                type=\"text\"\r\n                                value={row.address?.unitDetails || ''}\r\n                                onChange={(e) => handleMealFormFieldChange(idx, 'address.unitDetails', e.target.value)}\r\n                                className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                              />\r\n                            </div>\r\n                          )}\r\n                          <div className=\"sm:col-span-2\">\r\n                            <label className=\"block text-sm font-medium mb-1\">Notas</label>\r\n                            <input\r\n                              type=\"text\"\r\n                              value={row.notes || ''}\r\n                              onChange={(e) => handleMealFormFieldChange(idx, 'notes', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  ));\r\n                })()}\r\n\r\n                {/* Campos de la orden principal */}\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-6\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Total</label>\r\n                    <input\r\n                      type=\"number\"\r\n                      value={editForm.total || 0}\r\n                      onChange={(e) => handleEditFormFieldChange('total', Number(e.target.value))}\r\n                      className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Estado</label>\r\n                    <select\r\n                      value={editForm.status || 'Pendiente'}\r\n                      onChange={(e) => handleEditFormFieldChange('status', e.target.value)}\r\n                      className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                    >\r\n                      <option value=\"Pendiente\">Pendiente</option>\r\n                      <option value=\"En Preparación\">En Preparación</option>\r\n                      <option value=\"En Camino\">En Camino</option>\r\n                      <option value=\"Entregado\">Entregado</option>\r\n                      <option value=\"Cancelado\">Cancelado</option>\r\n                    </select>\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Método de Pago</label>\r\n                    <OptionSelector\r\n                      title=\"Método de Pago\"\r\n                      emoji=\"💳\"\r\n                      options={paymentMethods}\r\n                      selected={paymentMethods.find((m) => m.name === editForm.payment) || null}\r\n                      multiple={false}\r\n                      onImmediateSelect={(v) => handleEditFormFieldChange('payment', v?.name || '')}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Domiciliario</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={editForm.deliveryPerson || 'Sin asignar'}\r\n                      onChange={(e) => handleEditFormFieldChange('deliveryPerson', e.target.value)}\r\n                      className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"mt-6 flex justify-end gap-2\">\r\n                  <button onClick={() => setEditingOrder(null)} className={classNames('px-4 py-2 rounded-md text-sm font-medium', theme === 'dark' ? 'bg-gray-600 hover:bg-gray-700 text-gray-200' : 'bg-gray-200 hover:bg-gray-300 text-gray-900')}>\r\n                    Cancelar\r\n                  </button>\r\n                  <button onClick={handleSaveEdit} disabled={isLoading} className={classNames('px-4 py-2 rounded-md text-sm font-medium', isLoading ? 'bg-gray-400 cursor-not-allowed' : theme === 'dark' ? 'bg-blue-600 hover:bg-blue-700 text-white' : 'bg-blue-500 hover:bg-blue-600 text-white')}>\r\n                    {isLoading ? 'Guardando...' : 'Guardar Cambios'}\r\n                  </button>\r\n                </div>\r\n              </Dialog.Panel>\r\n            </Transition.Child>\r\n          </div>\r\n        </Dialog>\r\n      </Transition>\r\n\r\n\r\n      {/* Diálogo para confirmar eliminación de todos los pedidos */}\r\n      <Transition show={showConfirmDeleteAll} as={React.Fragment}>\r\n        <Dialog as=\"div\" className=\"relative z-50\" onClose={() => setShowConfirmDeleteAll(false)}>\r\n          <Transition.Child\r\n            as={React.Fragment}\r\n            enter=\"ease-out duration-300\"\r\n            enterFrom=\"opacity-0\"\r\n            enterTo=\"opacity-100\"\r\n            leave=\"ease-in duration-200\"\r\n            leaveFrom=\"opacity-100\"\r\n            leaveTo=\"opacity-0\"\r\n          >\r\n            <div className=\"fixed inset-0 bg-black bg-opacity-50\" />\r\n          </Transition.Child>\r\n          <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n            <Transition.Child\r\n              as={React.Fragment}\r\n              enter=\"ease-out duration-300\"\r\n              enterFrom=\"opacity-0 scale-95\"\r\n              enterTo=\"opacity-100 scale-100\"\r\n              leave=\"ease-in duration-200\"\r\n              leaveFrom=\"opacity-100 scale-100\"\r\n              leaveTo=\"opacity-0 scale-95\"\r\n            >\r\n              <Dialog.Panel className={classNames(\r\n                \"w-full max-w-sm p-6 rounded-lg shadow-md text-center\",\r\n                theme === 'dark' ? 'bg-gray-800 text-gray-200' : 'bg-gray-50 text-gray-900'\r\n              )}>\r\n                <Dialog.Title className=\"text-lg font-medium mb-4\">Confirmar Eliminación Masiva</Dialog.Title>\r\n                <p className=\"mb-4\">\r\n                  Estás a punto de eliminar <span className=\"font-bold text-red-500\">TODOS</span> los pedidos.\r\n                  Esta acción es irreversible. Para confirmar, escribe \"confirmar\" a continuación:\r\n                </p>\r\n                <input\r\n                  type=\"text\"\r\n                  value={confirmText}\r\n                  onChange={e => setConfirmText(e.target.value)}\r\n                  className={classNames(\r\n                    \"w-full p-2 rounded-md border text-center text-sm\",\r\n                    theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                    \"focus:outline-none focus:ring-1 focus:ring-red-500\"\r\n                  )}\r\n                  placeholder=\"escribe 'confirmar'\"\r\n                />\r\n                <div className=\"mt-6 flex justify-center gap-2\">\r\n                  <button\r\n                    onClick={() => { setShowConfirmDeleteAll(false); setConfirmText(''); }}\r\n                    className={classNames(\r\n                      \"px-4 py-2 rounded-md text-sm font-medium\",\r\n                      theme === 'dark' ? 'bg-gray-600 hover:bg-gray-700 text-gray-200' : 'bg-gray-200 hover:bg-gray-300 text-gray-900'\r\n                    )}\r\n                  >\r\n                    Cancelar\r\n                  </button>\r\n                  <button\r\n                    onClick={handleDeleteAllOrders}\r\n                    disabled={isLoading || confirmText.toLowerCase() !== 'confirmar'}\r\n                    className={classNames(\r\n                      \"px-4 py-2 rounded-md text-sm font-medium\",\r\n                      isLoading || confirmText.toLowerCase() !== 'confirmar' ? 'bg-gray-400 cursor-not-allowed' : 'bg-red-600 hover:bg-red-700 text-white'\r\n                    )}\r\n                  >\r\n                    {isLoading ? 'Eliminando...' : 'Eliminar Todos'}\r\n                  </button>\r\n                </div>\r\n              </Dialog.Panel>\r\n            </Transition.Child>\r\n          </div>\r\n        </Dialog>\r\n      </Transition>\r\n\r\n      {/* Diálogo para generar nueva orden */}\r\n      <Transition show={showAddOrderModal} as={React.Fragment}>\r\n        <Dialog as=\"div\" className=\"relative z-50\" onClose={() => setShowAddOrderModal(false)}>\r\n          <Transition.Child\r\n            as={React.Fragment}\r\n            enter=\"ease-out duration-300\"\r\n            enterFrom=\"opacity-0\"\r\n            enterTo=\"opacity-100\"\r\n            leave=\"ease-in duration-200\"\r\n            leaveFrom=\"opacity-100\"\r\n            leaveTo=\"opacity-0\"\r\n          >\r\n            <div className=\"fixed inset-0 bg-black bg-opacity-50\" />\r\n          </Transition.Child>\r\n          <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n            <Transition.Child\r\n              as={React.Fragment}\r\n              enter=\"ease-out duration-300\"\r\n              enterFrom=\"opacity-0 scale-95\"\r\n              enterTo=\"opacity-100 scale-100\"\r\n              leave=\"ease-in duration-200\"\r\n              leaveFrom=\"opacity-100 scale-100\"\r\n              leaveTo=\"opacity-0 scale-95\"\r\n            >\r\n              <Dialog.Panel className={classNames(\r\n                \"w-full max-w-2xl p-6 rounded-lg shadow-xl max-h-[80vh] overflow-y-auto\",\r\n                theme === 'dark' ? 'bg-gray-800 text-gray-200' : 'bg-gray-50 text-gray-900'\r\n              )}>\r\n                <Dialog.Title className=\"text-lg font-medium mb-4 flex justify-between items-center\">\r\n                  Generar Nueva Orden\r\n                  <button\r\n                    onClick={() => setShowAddOrderModal(false)}\r\n                    className=\"text-gray-500 hover:text-gray-400\"\r\n                    aria-label=\"Cerrar formulario de nueva orden\"\r\n                  >\r\n                    <XMarkIcon className=\"w-5 h-5\" />\r\n                  </button>\r\n                </Dialog.Title>\r\n                {newOrderForm.meals.map((meal, mealIndex) => (\r\n                  <div key={mealIndex} className=\"mb-6 p-4 border rounded-md border-gray-200 dark:border-gray-600\">\r\n                    <h3 className=\"font-medium mb-2\">Bandeja {mealIndex + 1}</h3>\r\n<div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n  <div>\r\n    <label className=\"block text-sm font-medium mb-1\">Sopa o reemplazo</label>\r\n    <OptionSelector\r\n      title=\"Sopa\"\r\n      emoji=\"🥣\"\r\n      options={soups}\r\n      selected={typeof meal.soup === 'string' ? soups.find(s => s.name === meal.soup) : meal.soup}\r\n      multiple={false}\r\n      onImmediateSelect={(v) => handleNewOrderMealFormFieldChange(mealIndex, 'soup', v)}\r\n    />\r\n  </div>\r\n\r\n  <div>\r\n    <label className=\"block text-sm font-medium mb-1\">Principio</label>\r\n    <OptionSelector\r\n      title=\"Principio\"\r\n      emoji=\"🍚\"\r\n      options={principles}\r\n      selected={Array.isArray(meal.principle) ? meal.principle : []}\r\n      multiple={true}\r\n      showConfirmButton={true}\r\n      onImmediateSelect={(selection) => handleNewOrderMealFormFieldChange(mealIndex, 'principle', selection)}\r\n      onConfirm={({ selection }) => handleNewOrderMealFormFieldChange(mealIndex, 'principle', selection)}\r\n    />\r\n  </div>\r\n\r\n  <div>\r\n    <label className=\"block text-sm font-medium mb-1\">Proteína</label>\r\n    <OptionSelector\r\n      title=\"Proteína\"\r\n      emoji=\"🍖\"\r\n      options={menuProteins}\r\n      selected={typeof meal.protein === 'string' ? menuProteins.find(p => p.name === meal.protein) : meal.protein}\r\n      multiple={false}\r\n      onImmediateSelect={(v) => handleNewOrderMealFormFieldChange(mealIndex, 'protein', v)}\r\n    />\r\n  </div>\r\n\r\n  <div>\r\n    <label className=\"block text-sm font-medium mb-1\">Bebida</label>\r\n    <OptionSelector\r\n      title=\"Bebida\"\r\n      emoji=\"🥤\"\r\n      options={drinks}\r\n      selected={typeof meal.drink === 'string' ? drinks.find(d => d.name === meal.drink) : meal.drink}\r\n      multiple={false}\r\n      onImmediateSelect={(v) => handleNewOrderMealFormFieldChange(mealIndex, 'drink', v)}\r\n    />\r\n  </div>\r\n\r\n  <div className=\"sm:col-span-2\">\r\n    <label className=\"block text-sm font-medium mb-1\">Acompañamientos</label>\r\n    <OptionSelector\r\n      title=\"Acompañamientos\"\r\n      emoji=\"🥗\"\r\n      options={sides}\r\n      selected={Array.isArray(meal.sides) ? meal.sides : []}\r\n      multiple={true}\r\n      onImmediateSelect={(selection) => handleNewOrderMealFormFieldChange(mealIndex, 'sides', selection)}\r\n    />\r\n  </div>\r\n\r\n  <div className=\"sm:col-span-2\">\r\n    <label className=\"block text-sm font-medium mb-1\">Adiciones</label>\r\n    <OptionSelector\r\n      title=\"Adiciones\"\r\n      emoji=\"➕\"\r\n      options={additions}\r\n      selected={Array.isArray(meal.additions) ? meal.additions : []}\r\n      multiple={true}\r\nonImmediateSelect={(sel) =>\r\n  handleNewOrderMealFormFieldChange(\r\n    mealIndex,\r\n    'additions',\r\n    sel.map(a => ({\r\n      id: a.id,\r\n      name: a.name,\r\n      price: a.price || 0,\r\n      protein: a.protein || '',\r\n      replacement: a.replacement || '',\r\n      quantity: a.quantity || 1\r\n    }))\r\n  )\r\n}\r\n\r\n    />\r\n  </div>\r\n\r\n  {/* Campos operativos */}\r\n  <div>\r\n    <label className=\"block text-sm font-medium mb-1\">Cubiertos</label>\r\n    <input\r\n      type=\"checkbox\"\r\n      checked={!!meal.cutlery}\r\n      onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'cutlery', e.target.checked)}\r\n      className=\"h-4 w-4\"\r\n    />\r\n  </div>\r\n\r\n  <div>\r\n    <label className=\"block text-sm font-medium mb-1\">Hora de Entrega</label>\r\n    <input\r\n      type=\"text\"\r\n      value={typeof meal.time === 'string' ? meal.time : (meal.time?.name || '')}\r\n      onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'time', e.target.value)}\r\n      className={classNames(\r\n        \"w-full p-2 rounded-md border text-sm\",\r\n        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n      )}\r\n    />\r\n  </div>\r\n\r\n  <div className=\"sm:col-span-2\">\r\n    <label className=\"block text-sm font-medium mb-1\">Dirección</label>\r\n    <input\r\n      type=\"text\"\r\n      value={meal.address?.address || ''}\r\n      onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'address.address', e.target.value)}\r\n      className={classNames(\r\n        \"w-full p-2 rounded-md border text-sm\",\r\n        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n      )}\r\n    />\r\n  </div>\r\n\r\n  <div>\r\n    <label className=\"block text-sm font-medium mb-1\">Teléfono</label>\r\n    <input\r\n      type=\"text\"\r\n      value={meal.address?.phoneNumber || ''}\r\n      onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'address.phoneNumber', e.target.value)}\r\n      className={classNames(\r\n        \"w-full p-2 rounded-md border text-sm\",\r\n        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n      )}\r\n    />\r\n  </div>\r\n\r\n  <div>\r\n    <label className=\"block text-sm font-medium mb-1\">Tipo de Dirección</label>\r\n    <select\r\n      value={meal.address?.addressType || ''}\r\n      onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'address.addressType', e.target.value)}\r\n      className={classNames(\r\n        \"w-full p-2 rounded-md border text-sm\",\r\n        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n      )}\r\n    >\r\n      <option value=\"\">Seleccione</option>\r\n      <option value=\"house\">Casa/Apto</option>\r\n      <option value=\"school\">Colegio/Oficina</option>\r\n      <option value=\"complex\">Conjunto</option>\r\n      <option value=\"shop\">Tienda/Local</option>\r\n    </select>\r\n  </div>\r\n\r\n  {meal.address?.addressType === 'shop' && (\r\n    <div>\r\n      <label className=\"block text-sm font-medium mb-1\">Nombre del Local</label>\r\n      <input\r\n        type=\"text\"\r\n        value={meal.address?.localName || ''}\r\n        onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'address.localName', e.target.value)}\r\n        className={classNames(\r\n          \"w-full p-2 rounded-md border text-sm\",\r\n          theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n          \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n        )}\r\n      />\r\n    </div>\r\n  )}\r\n\r\n  {meal.address?.addressType === 'school' && (\r\n    <div>\r\n      <label className=\"block text-sm font-medium mb-1\">Nombre del destinatario</label>\r\n      <input\r\n        type=\"text\"\r\n        value={meal.address?.recipientName || ''}\r\n        onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'address.recipientName', e.target.value)}\r\n        className={classNames(\r\n          \"w-full p-2 rounded-md border text-sm\",\r\n          theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n          \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n        )}\r\n      />\r\n    </div>\r\n  )}\r\n\r\n  {meal.address?.addressType === 'complex' && (\r\n    <div>\r\n      <label className=\"block text-sm font-medium mb-1\">Detalles (Torre/Apto)</label>\r\n      <input\r\n        type=\"text\"\r\n        value={meal.address?.unitDetails || ''}\r\n        onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'address.unitDetails', e.target.value)}\r\n        className={classNames(\r\n          \"w-full p-2 rounded-md border text-sm\",\r\n          theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n          \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n        )}\r\n      />\r\n    </div>\r\n  )}\r\n\r\n  <div className=\"sm:col-span-2\">\r\n    <label className=\"block text-sm font-medium mb-1\">Notas</label>\r\n    <input\r\n      type=\"text\"\r\n      value={meal.notes || ''}\r\n      onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'notes', e.target.value)}\r\n      className={classNames(\r\n        \"w-full p-2 rounded-md border text-sm\",\r\n        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n      )}\r\n    />\r\n  </div>\r\n</div>\r\n\r\n\r\n                  </div>\r\n                ))}\r\n                {/* Campos de la orden principal */}\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-6\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Total</label>\r\n                    <input\r\n                      type=\"number\"\r\n                      value={newOrderForm.total || 0}\r\n                      onChange={e => handleNewOrderFieldChange('total', Number(e.target.value))}\r\n                      className={classNames(\r\n                        \"w-full p-2 rounded-md border text-sm\",\r\n                        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n                      )}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Estado</label>\r\n                    <select\r\n                      value={newOrderForm.status || 'Pendiente'}\r\n                      onChange={e => handleNewOrderFieldChange('status', e.target.value)}\r\n                      className={classNames(\r\n                        \"w-full p-2 rounded-md border text-sm\",\r\n                        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n                      )}\r\n                    >\r\n                      <option value=\"Pendiente\">Pendiente</option>\r\n                      <option value=\"En Preparación\">En Preparación</option>\r\n                      <option value=\"En Camino\">En Camino</option>\r\n                      <option value=\"Entregado\">Entregado</option>\r\n                      <option value=\"Cancelado\">Cancelado</option>\r\n                    </select>\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Método de Pago</label>\r\n                    <select\r\n                      value={newOrderForm.payment || 'Efectivo'}\r\n                      onChange={e => handleNewOrderFieldChange('payment', e.target.value)}\r\n                      className={classNames(\r\n                        \"w-full p-2 rounded-md border text-sm\",\r\n                        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n                      )}\r\n                    >\r\n                      <option value=\"Efectivo\">Efectivo</option>\r\n                      <option value=\"Daviplata\">Daviplata</option>\r\n                      <option value=\"Nequi\">Nequi</option>\r\n                    </select>\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Domiciliario</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={newOrderForm.deliveryPerson || 'Sin asignar'}\r\n                      onChange={e => handleNewOrderFieldChange('deliveryPerson', e.target.value)}\r\n                      className={classNames(\r\n                        \"w-full p-2 rounded-md border text-sm\",\r\n                        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n                      )}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"mt-6 flex justify-end gap-2\">\r\n                  <button\r\n                    onClick={() => setShowAddOrderModal(false)}\r\n                    className={classNames(\r\n                      \"px-4 py-2 rounded-md text-sm font-medium\",\r\n                      theme === 'dark' ? 'bg-gray-600 hover:bg-gray-700 text-gray-200' : 'bg-gray-200 hover:bg-gray-300 text-gray-900'\r\n                    )}\r\n                  >\r\n                    Cancelar\r\n                  </button>\r\n                  <button\r\n                    onClick={handleAddOrderSubmit}\r\n                    disabled={isLoading}\r\n                    className={classNames(\r\n                      \"px-4 py-2 rounded-md text-sm font-medium\",\r\n                      isLoading ? 'bg-gray-400 cursor-not-allowed' : theme === 'dark' ? 'bg-blue-600 hover:bg-blue-700 text-white' : 'bg-blue-500 hover:bg-blue-600 text-white'\r\n                    )}\r\n                  >\r\n                    {isLoading ? 'Guardando...' : 'Crear Orden'}\r\n                  </button>\r\n                </div>\r\n              </Dialog.Panel>\r\n            </Transition.Child>\r\n          </div>\r\n        </Dialog>\r\n      </Transition>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InteraccionesPedidos;","// src/components/Admin/OrderManagement.jsx\r\nimport React, { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { db } from '../../config/firebase.js';\r\nimport {\r\n  collection,\r\n  onSnapshot,\r\n  updateDoc,\r\n  doc,\r\n  deleteDoc,\r\n  getDocs,\r\n  query,\r\n  where,\r\n  writeBatch,\r\n  addDoc,\r\n  serverTimestamp\r\n} from 'firebase/firestore';\r\nimport { exportToExcel } from './utilities/exportToExcel.js';\r\nimport { exportToPDF } from './utilities/exportToPDF.js';\r\nimport { exportToCSV } from './utilities/exportToCSV.js';\r\nimport { generatePreviewHtml } from './utilities/previewOrders.js';\r\nimport { generateExcelPreviewHtml } from './utilities/previewExcel.js';\r\nimport { cleanText } from './utils.js';\r\nimport TablaPedidos from './TablaPedidos.js';\r\nimport InteraccionesPedidos from './InteraccionesPedidos.js';\r\n\r\nconst OrderManagement = ({ setError, setSuccess, theme }) => {\r\n  const [orders, setOrders] = useState([]);\r\n  const [editingOrder, setEditingOrder] = useState(null);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [totals, setTotals] = useState({ cash: 0, daviplata: 0, nequi: 0 });\r\n  const [editForm, setEditForm] = useState({ meals: [], total: 0, status: '', payment: '', deliveryPerson: '' });\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [itemsPerPage, setItemsPerPage] = useState(10);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [showConfirmDeleteAll, setShowConfirmDeleteAll] = useState(false);\r\n  const [confirmText, setConfirmText] = useState('');\r\n  const [showMealDetails, setShowMealDetails] = useState(null);\r\n  const [editingDeliveryId, setEditingDeliveryId] = useState(null);\r\n  const [deliveryPersons, setDeliveryPersons] = useState({});\r\n  const [sortBy, setSortBy] = useState('createdAt.seconds');\r\n  const [sortOrder, setSortOrder] = useState('desc');\r\n  const [proteins, setProteins] = useState([]);\r\n  const [newProtein, setNewProtein] = useState({ name: '', quantity: '' });\r\n  const [showProteinModal, setShowProteinModal] = useState(false);\r\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\r\n  const [showAddOrderModal, setShowAddOrderModal] = useState(false);\r\n  const [orderTypeFilter, setOrderTypeFilter] = useState('all');\r\n  const [newOrderForm, setNewOrderForm] = useState({\r\n    meals: [\r\n      {\r\n        soup: '',\r\n        soupReplacement: '',\r\n        principle: [{ name: '' }],\r\n        principleReplacement: '',\r\n        protein: '',\r\n        drink: '',\r\n        cutlery: '',\r\n        sides: [],\r\n        additions: [],\r\n        notes: '',\r\n        address: {\r\n          address: '',\r\n          phoneNumber: '',\r\n          addressType: '',\r\n          localName: '',\r\n          recipientName: ''\r\n        },\r\n        time: '',\r\n        payment: 'Efectivo'\r\n      }\r\n    ],\r\n    total: 0,\r\n    status: 'Pendiente',\r\n    payment: 'Efectivo',\r\n    deliveryPerson: 'Sin asignar',\r\n    type: 'lunch'\r\n  });\r\n\r\n  const totalProteinUnits = useMemo(\r\n    () => proteins.reduce((sum, p) => sum + Number(p.quantity || 0), 0),\r\n    [proteins]\r\n  );\r\n\r\n  const logActivity = useCallback(async (action, details = {}) => {\r\n    try {\r\n      await addDoc(collection(db, 'userActivity'), {\r\n        action,\r\n        timestamp: serverTimestamp(),\r\n        details\r\n      });\r\n    } catch (error) {\r\n      console.error('Error al registrar actividad:', error);\r\n    }\r\n  }, []);\r\n\r\n  const handleExport = (exportFunction, format) => {\r\n    try {\r\n      exportFunction(orders, totals, deliveryPersons, totalProteinUnits, proteins);\r\n      setSuccess(`Exportado correctamente como ${format}.`);\r\n      logActivity(`Exportó pedidos como ${format}`, { format });\r\n    } catch (error) {\r\n      console.error(`Error al exportar ${format}:`, error);\r\n      setError(`Error al exportar ${format}: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  const fetchOrders = useCallback(() => {\r\n    setIsLoading(true);\r\n\r\n    let latestLunch = [];\r\n    let latestBreakfast = [];\r\n\r\n    const recompute = () => {\r\n      const merged = [...latestLunch, ...latestBreakfast];\r\n\r\n      setOrders(merged);\r\n\r\n      const newTotals = { cash: 0, daviplata: 0, nequi: 0, general: 0 };\r\n      const newDeliveryPersons = {};\r\n\r\n      merged.forEach((order) => {\r\n        if (order.status !== 'Cancelado') {\r\n          const paymentSummary = order.paymentSummary || { Efectivo: 0, Daviplata: 0, Nequi: 0 };\r\n          newTotals.cash += paymentSummary['Efectivo'] || 0;\r\n          newTotals.daviplata += paymentSummary['Daviplata'] || 0;\r\n          newTotals.nequi += paymentSummary['Nequi'] || 0;\r\n          newTotals.general += order.total || 0;\r\n\r\n          const deliveryPerson = order.deliveryPerson || 'Sin asignar';\r\n          if (deliveryPerson !== 'Sin asignar') {\r\n            if (!newDeliveryPersons[deliveryPerson]) {\r\n              newDeliveryPersons[deliveryPerson] = {\r\n                almuerzo: { efectivo: 0, daviplata: 0, nequi: 0, total: 0 },\r\n                desayuno: { efectivo: 0, daviplata: 0, nequi: 0, total: 0 }\r\n              };\r\n            }\r\n            const bucket = order.type === 'breakfast' ? 'desayuno' : 'almuerzo';\r\n            const paymentType = cleanText(order.payment || 'Efectivo').toLowerCase();\r\n            const amount = order.total || 0;\r\n\r\n            if (paymentType === 'efectivo') newDeliveryPersons[deliveryPerson][bucket].efectivo += amount;\r\n            else if (paymentType === 'daviplata') newDeliveryPersons[deliveryPerson][bucket].daviplata += amount;\r\n            else if (paymentType === 'nequi') newDeliveryPersons[deliveryPerson][bucket].nequi += amount;\r\n\r\n            newDeliveryPersons[deliveryPerson][bucket].total += amount;\r\n          }\r\n        }\r\n      });\r\n\r\n      setTotals(newTotals);\r\n      setDeliveryPersons(newDeliveryPersons);\r\n      setIsLoading(false);\r\n    };\r\n\r\n    const unsubLunch = onSnapshot(\r\n      collection(db, 'orders'),\r\n      (snapshot) => {\r\n        latestLunch = snapshot.docs.map((doc) => {\r\n          const data = doc.data();\r\n          const meals =\r\n            Array.isArray(data.meals) && data.meals.length > 0\r\n              ? data.meals\r\n              : [{ address: {}, payment: { name: 'Efectivo' }, time: {} }];\r\n\r\n        return {\r\n            id: doc.id,\r\n            type: 'lunch',\r\n            ...data,\r\n            meals: meals.map((meal) => ({\r\n              ...meal,\r\n              address: meal.address || {},\r\n              payment:\r\n                meal.payment && typeof meal.payment === 'object' && meal.payment.name\r\n                  ? meal.payment\r\n                  : { name: meal.payment || 'Efectivo' },\r\n              time: meal.time || {}\r\n            })),\r\n            payment: data.payment || (meals[0]?.payment?.name || 'Efectivo'),\r\n            paymentSummary: data.paymentSummary || { Efectivo: 0, Daviplata: 0, Nequi: 0 },\r\n            total: data.total || 0,\r\n            deliveryPerson: data.deliveryPerson || 'Sin asignar',\r\n            status: data.status || 'Pendiente'\r\n          };\r\n        });\r\n        recompute();\r\n      },\r\n      (error) => {\r\n        setError(`Error al cargar almuerzos: ${error.message}`);\r\n        setIsLoading(false);\r\n      }\r\n    );\r\n\r\n    const unsubBreakfast = onSnapshot(\r\n      collection(db, 'deliveryBreakfastOrders'),\r\n      (snapshot) => {\r\n        latestBreakfast = snapshot.docs.map((doc) => {\r\n          const data = doc.data();\r\n          return {\r\n            id: doc.id,\r\n            type: 'breakfast',\r\n            ...data,\r\n            payment: data.payment || (data.breakfasts?.[0]?.payment?.name || 'Efectivo'),\r\n            paymentSummary: data.paymentSummary || { Efectivo: 0, Daviplata: 0, Nequi: 0 },\r\n            total: data.total || 0,\r\n            deliveryPerson: data.deliveryPerson || 'Sin asignar',\r\n            status: data.status || 'Pendiente'\r\n          };\r\n        });\r\n        recompute();\r\n      },\r\n      (error) => {\r\n        setError(`Error al cargar desayunos: ${error.message}`);\r\n        setIsLoading(false);\r\n      }\r\n    );\r\n\r\n    return () => {\r\n      unsubLunch();\r\n      unsubBreakfast();\r\n    };\r\n  }, [setError]);\r\n\r\n  const fetchProteins = useCallback(() => {\r\n    const today = new Date().toISOString().split('T')[0];\r\n    const proteinsColRef = query(collection(db, 'dailyProteins'), where('date', '==', today));\r\n    const unsubscribe = onSnapshot(\r\n      proteinsColRef,\r\n      (snapshot) => {\r\n        const proteinsData = snapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() }));\r\n        setProteins(proteinsData);\r\n      },\r\n      (error) => {\r\n        setError(`Error al cargar proteínas: ${error.message}`);\r\n      }\r\n    );\r\n    return () => unsubscribe();\r\n  }, [setError]);\r\n\r\n  useEffect(() => {\r\n    const unsubscribeOrders = fetchOrders();\r\n    const unsubscribeProteins = fetchProteins();\r\n    return () => {\r\n      unsubscribeOrders();\r\n      unsubscribeProteins();\r\n    };\r\n  }, [fetchOrders, fetchProteins]);\r\n\r\n  const filteredOrders = useMemo(() => {\r\n    return orders.filter((order) => {\r\n      const lowerSearchTerm = (searchTerm || '').toLowerCase();\r\n\r\n      const addrObj = order.meals?.[0]?.address || order.breakfasts?.[0]?.address || {};\r\n      const address = (addrObj.address || '').toLowerCase();\r\n      const phone = (addrObj.phoneNumber || '').toLowerCase();\r\n\r\n      const timeObj = order.meals?.[0]?.time || order.breakfasts?.[0]?.time;\r\n      const time = (typeof timeObj === 'string' ? timeObj : timeObj?.name || '').toLowerCase();\r\n\r\n      const payment = cleanText(\r\n        order.payment || order.meals?.[0]?.payment?.name || order.breakfasts?.[0]?.payment?.name || ''\r\n      ).toLowerCase();\r\n\r\n      const deliveryPerson = (order.deliveryPerson || '').toLowerCase();\r\n      const status = (order.status || '').toLowerCase();\r\n\r\n      return (\r\n        (orderTypeFilter === 'all' || order.type === orderTypeFilter) &&\r\n        (address.includes(lowerSearchTerm) ||\r\n          phone.includes(lowerSearchTerm) ||\r\n          time.includes(lowerSearchTerm) ||\r\n          payment.includes(lowerSearchTerm) ||\r\n          deliveryPerson.includes(lowerSearchTerm) ||\r\n          status.includes(lowerSearchTerm))\r\n      );\r\n    });\r\n  }, [orders, searchTerm, orderTypeFilter]);\r\n\r\n  // Totales visibles\r\n  const displayedTotals = useMemo(() => {\r\n    const t = { cash: 0, daviplata: 0, nequi: 0, general: 0 };\r\n    filteredOrders.forEach((order) => {\r\n      if (order.status === 'Cancelado') return;\r\n      const ps = order.paymentSummary || { Efectivo: 0, Daviplata: 0, Nequi: 0 };\r\n      t.cash += ps['Efectivo'] || 0;\r\n      t.daviplata += ps['Daviplata'] || 0;\r\n      t.nequi += ps['Nequi'] || 0;\r\n      t.general += order.total || 0;\r\n    });\r\n    return t;\r\n  }, [filteredOrders]);\r\n\r\n  const sortedOrders = useMemo(() => {\r\n    return [...filteredOrders].sort((a, b) => {\r\n      const getValue = (obj, path, currentFilteredOrdersArray) => {\r\n        if (path === 'orderNumber') return obj ? currentFilteredOrdersArray.indexOf(obj) : -1;\r\n\r\n        if (path.startsWith('createdAt')) {\r\n          const ts = obj.createdAt;\r\n          if (ts && typeof ts.toMillis === 'function') return ts.toMillis();\r\n          if (ts instanceof Date) return ts.getTime();\r\n          return ts && ts.seconds ? ts.seconds * 1000 : 0;\r\n        }\r\n\r\n        const readPath = (o, p) =>\r\n          p.split('.').reduce((acc, part) => (acc && acc[part] !== undefined ? acc[part] : undefined), o);\r\n\r\n        let value = readPath(obj, path);\r\n\r\n        if ((value === undefined || value === null || value === '') && path.startsWith('meals.0.')) {\r\n          const altPath = path.replace(/^meals\\.0\\./, 'breakfasts.0.');\r\n          value = readPath(obj, altPath);\r\n        }\r\n\r\n        if (path.endsWith('.time.name') && typeof value !== 'string') {\r\n          value = value?.name || '';\r\n        }\r\n\r\n        return typeof value === 'number' ? value : cleanText(value) || '';\r\n      };\r\n\r\n      const valueA = getValue(a, sortBy, filteredOrders);\r\n      const valueB = getValue(b, sortBy, filteredOrders);\r\n\r\n      if (typeof valueA === 'string' && typeof valueB === 'string') {\r\n        return sortOrder === 'asc' ? valueA.localeCompare(valueB) : valueB.localeCompare(valueA);\r\n      }\r\n      return sortOrder === 'asc' ? valueA - valueB : valueB - valueA;\r\n    });\r\n  }, [filteredOrders, sortBy, sortOrder]);\r\n\r\n  const totalPages = Math.ceil(sortedOrders.length / itemsPerPage);\r\n  const paginatedOrders = useMemo(() => {\r\n    const start = (currentPage - 1) * itemsPerPage;\r\n    const end = start + itemsPerPage;\r\n    return sortedOrders.slice(start, end);\r\n  }, [sortedOrders, currentPage, itemsPerPage]);\r\n\r\n  const handleSort = (key) => {\r\n    if (sortBy === key) {\r\n      setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\r\n    } else {\r\n      setSortBy(key);\r\n      setSortOrder('asc');\r\n    }\r\n    setCurrentPage(1);\r\n  };\r\n\r\n  const getSortIcon = (key) => {\r\n    if (sortBy !== key) return null;\r\n    return sortOrder === 'asc' ? (\r\n      <svg className=\"w-4 h-4 inline ml-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M5 15l7-7 7 7\" />\r\n      </svg>\r\n    ) : (\r\n      <svg className=\"w-4 h-4 inline ml-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 9l-7 7-7-7\" />\r\n      </svg>\r\n    );\r\n  };\r\n\r\n  const handleAddProtein = async () => {\r\n    if (\r\n      !newProtein.name ||\r\n      !newProtein.quantity ||\r\n      isNaN(newProtein.quantity) ||\r\n      Number(newProtein.quantity) <= 0\r\n    ) {\r\n      setError('Por favor, ingrese un nombre de proteína válido y una cantidad mayor a 0.');\r\n      return;\r\n    }\r\n    setIsLoading(true);\r\n    try {\r\n      await addDoc(collection(db, 'dailyProteins'), {\r\n        name: newProtein.name.trim(),\r\n        quantity: Number(newProtein.quantity),\r\n        date: new Date().toISOString().split('T')[0],\r\n        createdAt: new Date()\r\n      });\r\n      setNewProtein({ name: '', quantity: '' });\r\n      setShowProteinModal(false);\r\n      setSuccess('Proteína agregada correctamente.');\r\n      logActivity(`Agregó proteína: ${newProtein.name} (${newProtein.quantity} unidades)`, {\r\n        proteinName: newProtein.name,\r\n        quantity: Number(newProtein.quantity)\r\n      });\r\n    } catch (error) {\r\n      setError(`Error al agregar proteína: ${error.message}`);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleEditOrder = useCallback((order) => {\r\n    setEditingOrder(order);\r\n\r\n    const defaultAddress = {\r\n      address: '',\r\n      phoneNumber: '',\r\n      addressType: '',\r\n      localName: '',\r\n      recipientName: '',\r\n      unitDetails: ''\r\n    };\r\n\r\n    if (order.type === 'breakfast') {\r\n      const breakfasts =\r\n        Array.isArray(order.breakfasts) && order.breakfasts.length > 0\r\n          ? order.breakfasts.map((b) => ({\r\n              ...b,\r\n              address: b.address || { ...defaultAddress },\r\n              additions: Array.isArray(b.additions) ? b.additions : [],\r\n              cutlery: typeof b.cutlery === 'boolean' ? b.cutlery : !!b.cutlery,\r\n              time: b.time || '',\r\n              notes: b.notes || '',\r\n              type: b.type || null,\r\n              eggs: b.eggs || null,\r\n              broth: b.broth || null,\r\n              riceBread: b.riceBread || null,\r\n              drink: b.drink || null,\r\n              protein: b.protein || null\r\n            }))\r\n          : [\r\n              {\r\n                type: null,\r\n                eggs: null,\r\n                broth: null,\r\n                riceBread: null,\r\n                drink: null,\r\n                protein: null,\r\n                additions: [],\r\n                notes: '',\r\n                cutlery: false,\r\n                time: '',\r\n                address: { ...defaultAddress }\r\n              }\r\n            ];\r\n\r\n      setEditForm({\r\n        id: order.id,\r\n        breakfasts,\r\n        total: order.total || 0,\r\n        status: order.status || 'Pendiente',\r\n        payment: order.payment ? cleanText(order.payment) : 'Efectivo',\r\n        deliveryPerson: order.deliveryPerson || 'Sin asignar',\r\n        type: 'breakfast'\r\n      });\r\n      return;\r\n    }\r\n\r\n    const meals =\r\n      Array.isArray(order.meals) && order.meals.length > 0\r\n        ? order.meals.map((meal) => ({\r\n            ...meal,\r\n            address: meal.address || { ...defaultAddress },\r\n            payment: meal.payment ? cleanText(meal.payment?.name || meal.payment) : 'Efectivo',\r\n            additions: Array.isArray(meal.additions) ? meal.additions : [],\r\n            principle: Array.isArray(meal.principle)\r\n              ? meal.principle\r\n              : meal.principle\r\n              ? [{ name: meal.principle.name || meal.principle }]\r\n              : [],\r\n            cutlery: typeof meal.cutlery === 'boolean' ? meal.cutlery : !!meal.cutlery,\r\n            sides: Array.isArray(meal.sides) ? meal.sides : [],\r\n            soup: meal.soup || '',\r\n            soupReplacement: meal.soupReplacement || '',\r\n            protein: meal.protein || '',\r\n            drink: meal.drink || '',\r\n            time: meal.time || '',\r\n            notes: meal.notes || ''\r\n          }))\r\n        : [\r\n            {\r\n              soup: '',\r\n              soupReplacement: '',\r\n              principle: [{ name: '' }],\r\n              principleReplacement: '',\r\n              protein: '',\r\n              drink: '',\r\n              cutlery: false,\r\n              sides: [],\r\n              additions: [],\r\n              notes: '',\r\n              address: { ...defaultAddress },\r\n              time: '',\r\n              payment: 'Efectivo'\r\n            }\r\n          ];\r\n\r\n    setEditForm({\r\n      id: order.id,\r\n      meals,\r\n      total: order.total || 0,\r\n      status: order.status || 'Pendiente',\r\n      payment: order.payment ? cleanText(order.payment) : 'Efectivo',\r\n      deliveryPerson: order.deliveryPerson || 'Sin asignar',\r\n      type: 'lunch'\r\n    });\r\n  }, []);\r\n\r\n  const handleEditFormFieldChange = (field, value) => {\r\n    setEditForm((prev) => ({ ...prev, [field]: value }));\r\n  };\r\n\r\n  const handleEditOrderMealFormFieldChange = (mealIndex, field, value) => {\r\n    setEditForm((prev) => {\r\n      const newMeals = [...(prev.meals || [])];\r\n      if (!newMeals[mealIndex]) newMeals[mealIndex] = { address: {}, payment: {}, time: {} };\r\n\r\n      if (field.includes('.')) {\r\n        const [parent, child] = field.split('.');\r\n        newMeals[mealIndex] = {\r\n          ...newMeals[mealIndex],\r\n          [parent]: { ...(newMeals[mealIndex][parent] || {}), [child]: value }\r\n        };\r\n      } else if (field === 'sides') {\r\n        if (Array.isArray(value)) {\r\n          newMeals[mealIndex] = { ...newMeals[mealIndex], sides: value };\r\n        } else {\r\n          newMeals[mealIndex] = {\r\n            ...newMeals[mealIndex],\r\n            sides: String(value)\r\n              .split(',')\r\n              .map((s) => ({ name: s.trim() }))\r\n              .filter((s) => s.name)\r\n          };\r\n        }\r\n      } else if (field === 'additions') {\r\n        if (Array.isArray(value)) {\r\n          newMeals[mealIndex] = { ...newMeals[mealIndex], additions: value };\r\n        } else {\r\n          newMeals[mealIndex] = {\r\n            ...newMeals[mealIndex],\r\n            additions: String(value)\r\n              .split(';')\r\n              .map((a) => {\r\n                const [name, proteinOrReplacement = '', quantity = '1'] = a.split(',');\r\n                return {\r\n                  name: name.trim(),\r\n                  [proteinOrReplacement.includes('por') ? 'replacement' : 'protein']: proteinOrReplacement.trim(),\r\n                  quantity: Number(quantity) || 1\r\n                };\r\n              })\r\n              .filter((a) => a.name)\r\n          };\r\n        }\r\n      } else if (field === 'principle') {\r\n        if (Array.isArray(value)) {\r\n          newMeals[mealIndex] = { ...newMeals[mealIndex], principle: value };\r\n        } else {\r\n          newMeals[mealIndex] = {\r\n            ...newMeals[mealIndex],\r\n            principle: String(value)\r\n              .split(',')\r\n              .map((p) => ({ name: p.trim() }))\r\n              .filter((p) => p.name)\r\n          };\r\n        }\r\n      } else {\r\n        newMeals[mealIndex] = { ...newMeals[mealIndex], [field]: value };\r\n      }\r\n\r\n      return { ...prev, meals: newMeals };\r\n    });\r\n  };\r\n\r\n  const handleSaveEdit = async () => {\r\n    if (!editingOrder) return;\r\n    setIsLoading(true);\r\n    try {\r\n      const oldOrder = orders.find((o) => o.id === editingOrder.id);\r\n      const previousState = oldOrder\r\n        ? {\r\n            meals: oldOrder.meals,\r\n            breakfasts: oldOrder.breakfasts,\r\n            total: oldOrder.total,\r\n            status: oldOrder.status,\r\n            payment: oldOrder.payment,\r\n            deliveryPerson: oldOrder.deliveryPerson,\r\n            type: oldOrder.type\r\n          }\r\n        : {};\r\n\r\n      const paymentSummary = {\r\n        Efectivo: editForm.payment === 'Efectivo' ? Number(editForm.total) || 0 : 0,\r\n        Daviplata: editForm.payment === 'Daviplata' ? Number(editForm.total) || 0 : 0,\r\n        Nequi: editForm.payment === 'Nequi' ? Number(editForm.total) || 0 : 0\r\n      };\r\n\r\n      let updateDataBase = {\r\n        total: Number(editForm.total) || 0,\r\n        status: editForm.status || 'Pendiente',\r\n        payment: editForm.payment || 'Efectivo',\r\n        deliveryPerson: editForm.deliveryPerson || 'Sin asignar',\r\n        paymentSummary,\r\n        updatedAt: new Date(),\r\n        type: editForm.type || editingOrder.type || 'lunch'\r\n      };\r\n\r\n      if ((editingOrder.type || editForm.type) === 'breakfast') {\r\n        const updatedBreakfastsForDB = (editForm.breakfasts || []).map((b) => ({\r\n          type: b.type ? { name: (typeof b.type === 'string' ? b.type : b.type.name) || '' } : null,\r\n          eggs: b.eggs ? { name: (typeof b.eggs === 'string' ? b.eggs : b.eggs.name) || '' } : null,\r\n          broth: b.broth ? { name: (typeof b.broth === 'string' ? b.broth : b.broth.name) || '' } : null,\r\n          riceBread: b.riceBread ? { name: (typeof b.riceBread === 'string' ? b.riceBread : b.riceBread.name) || '' } : null,\r\n          drink: b.drink ? { name: (typeof b.drink === 'string' ? b.drink : b.drink.name) || '' } : null,\r\n          protein: b.protein ? { name: (typeof b.protein === 'string' ? b.protein : b.protein.name) || '' } : null,\r\n          additions: Array.isArray(b.additions)\r\n            ? b.additions\r\n                .map((a) => ({ name: a.name || '', quantity: Number(a.quantity) || 1 }))\r\n                .filter((a) => a.name)\r\n            : [],\r\n          notes: b.notes || '',\r\n          cutlery: !!b.cutlery,\r\n          time: b.time ? { name: (typeof b.time === 'string' ? b.time : b.time.name) || '' } : null,\r\n          address: {\r\n            address: b.address?.address || '',\r\n            phoneNumber: b.address?.phoneNumber || '',\r\n            addressType: b.address?.addressType || '',\r\n            localName: b.address?.localName || '',\r\n            recipientName: b.address?.recipientName || '',\r\n            unitDetails: b.address?.unitDetails || ''\r\n          }\r\n        }));\r\n\r\n        updateDataBase = { ...updateDataBase, breakfasts: updatedBreakfastsForDB };\r\n        await updateDoc(doc(db, 'deliveryBreakfastOrders', editingOrder.id), updateDataBase);\r\n\r\n        logActivity(`Editó (desayuno) el pedido ${editingOrder.id}`, {\r\n          orderId: editingOrder.id,\r\n          previousState,\r\n          newState: { ...editForm, breakfasts: updatedBreakfastsForDB }\r\n        });\r\n      } else {\r\n        const updatedMealsForDB = (editForm.meals || []).map((meal) => ({\r\n          soup: meal.soup ? { name: (typeof meal.soup === 'string' ? meal.soup : meal.soup.name) || '' } : null,\r\n          soupReplacement: meal.soupReplacement\r\n            ? { name: (typeof meal.soupReplacement === 'string' ? meal.soupReplacement : meal.soupReplacement.name) || '' }\r\n            : null,\r\n          principle: Array.isArray(meal.principle)\r\n            ? meal.principle\r\n                .map((p) => ({ name: (typeof p === 'string' ? p : p.name) || '' }))\r\n                .filter((p) => p.name)\r\n            : [],\r\n          principleReplacement: meal.principleReplacement\r\n            ? { name: (typeof meal.principleReplacement === 'string' ? meal.principleReplacement : meal.principleReplacement.name) || '' }\r\n            : null,\r\n          protein: meal.protein ? { name: (typeof meal.protein === 'string' ? meal.protein : meal.protein.name) || '' } : null,\r\n          drink: meal.drink ? { name: (typeof meal.drink === 'string' ? meal.drink : meal.drink.name) || '' } : null,\r\n          cutlery: !!meal.cutlery,\r\n          time: meal.time ? { name: (typeof meal.time === 'string' ? meal.time : meal.time.name) || '' } : null,\r\n          payment: meal.payment\r\n            ? { name: (typeof meal.payment === 'string' ? meal.payment : meal.payment.name) || 'Efectivo' }\r\n            : { name: 'Efectivo' },\r\n          sides: Array.isArray(meal.sides)\r\n            ? meal.sides\r\n                .map((s) => ({ name: (typeof s === 'string' ? s : s.name) || '' }))\r\n                .filter((s) => s.name)\r\n            : [],\r\n          additions: Array.isArray(meal.additions)\r\n            ? meal.additions.map((a) => ({\r\n                name: a.name || '',\r\n                protein: a.protein || '',\r\n                replacement: a.replacement || '',\r\n                quantity: Number(a.quantity) || 1\r\n              }))\r\n            : [],\r\n          notes: meal.notes || '',\r\n          address: {\r\n            address: meal.address?.address || '',\r\n            phoneNumber: meal.address?.phoneNumber || '',\r\n            addressType: meal.address?.addressType || '',\r\n            localName: meal.address?.localName || '',\r\n            recipientName: meal.address?.recipientName || '',\r\n            unitDetails: meal.address?.unitDetails || ''\r\n          }\r\n        }));\r\n\r\n        updateDataBase = { ...updateDataBase, meals: updatedMealsForDB };\r\n        await updateDoc(doc(db, 'orders', editingOrder.id), updateDataBase);\r\n\r\n        logActivity(`Editó (almuerzo) el pedido ${editingOrder.id}`, {\r\n          orderId: editingOrder.id,\r\n          previousState,\r\n          newState: { ...editForm, meals: updatedMealsForDB }\r\n        });\r\n      }\r\n\r\n      setEditingOrder(null);\r\n      setSuccess('Pedido actualizado correctamente.');\r\n    } catch (error) {\r\n      setError(`Error al guardar: ${error.message}`);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteOrder = async (orderId) => {\r\n    setIsLoading(true);\r\n    try {\r\n      const orderToDelete = orders.find((o) => o.id === orderId);\r\n      await deleteDoc(doc(db, orderToDelete.type === 'breakfast' ? 'deliveryBreakfastOrders' : 'orders', orderId));\r\n      setSuccess('Pedido eliminado correctamente.');\r\n      if (orderToDelete) {\r\n        logActivity(`Eliminó el pedido con ID: ${orderId}`, {\r\n          orderId,\r\n          deletedOrderDetails: {\r\n            meals: orderToDelete.meals,\r\n            total: orderToDelete.total,\r\n            status: orderToDelete.status,\r\n            payment: orderToDelete.payment,\r\n            deliveryPerson: orderToDelete.deliveryPerson,\r\n            type: orderToDelete.type\r\n          }\r\n        });\r\n      } else {\r\n        logActivity(`Eliminó el pedido con ID: ${orderId} (detalles no disponibles)`);\r\n      }\r\n    } catch (error) {\r\n      setError(`Error al eliminar: ${error.message}`);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteAllOrders = async () => {\r\n    if (confirmText.toLowerCase() !== 'confirmar') {\r\n      setError('Por favor, escribe \"confirmar\" para proceder.');\r\n      return;\r\n    }\r\n    setIsLoading(true);\r\n    try {\r\n      const batch = writeBatch(db);\r\n      const ordersSnapshot = await getDocs(collection(db, 'orders'));\r\n      const breakfastOrdersSnapshot = await getDocs(collection(db, 'deliveryBreakfastOrders'));\r\n      ordersSnapshot.forEach((docRef) => batch.delete(docRef.ref));\r\n      breakfastOrdersSnapshot.forEach((docRef) => batch.delete(docRef.ref));\r\n      await batch.commit();\r\n      setShowConfirmDeleteAll(false);\r\n      setConfirmText('');\r\n      setSuccess('Todos los pedidos han sido eliminados.');\r\n      logActivity('Eliminó todos los pedidos', { count: ordersSnapshot.size + breakfastOrdersSnapshot.size });\r\n    } catch (error) {\r\n      setError(`Error al eliminar todos los pedidos: ${error.message}`);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleStatusChange = async (orderId, newStatus) => {\r\n    try {\r\n      const oldOrder = orders.find((o) => o.id === orderId);\r\n      const previousStatus = oldOrder ? oldOrder.status : 'Desconocido';\r\n      const collectionName = oldOrder.type === 'breakfast' ? 'deliveryBreakfastOrders' : 'orders';\r\n\r\n      await updateDoc(doc(db, collectionName, orderId), { status: newStatus, updatedAt: new Date() });\r\n\r\n      if (newStatus === 'Cancelado' && oldOrder && previousStatus !== 'Cancelado') {\r\n        const paymentType = cleanText(oldOrder.payment || 'Efectivo');\r\n        const amount = oldOrder.total || 0;\r\n        const deliveryPerson = cleanText(oldOrder.deliveryPerson || '');\r\n\r\n        setTotals((prev) => {\r\n          const newTotals = { ...prev };\r\n          if (paymentType.toLowerCase() === 'efectivo') {\r\n            newTotals.cash = Math.max(0, newTotals.cash - amount);\r\n          } else if (paymentType.toLowerCase() === 'daviplata') {\r\n            newTotals.daviplata = Math.max(0, newTotals.daviplata - amount);\r\n          } else if (paymentType.toLowerCase() === 'nequi') {\r\n            newTotals.nequi = Math.max(0, newTotals.nequi - amount);\r\n          }\r\n          return newTotals;\r\n        });\r\n\r\n        if (deliveryPerson && deliveryPerson !== 'Sin asignar') {\r\n          setDeliveryPersons((prev) => {\r\n            const newDeliveryPersons = { ...prev };\r\n            if (newDeliveryPersons[deliveryPerson]) {\r\n              const bucket = oldOrder.type === 'breakfast' ? 'desayuno' : 'almuerzo';\r\n              const person = { ...newDeliveryPersons[deliveryPerson] };\r\n              const b = {\r\n                ...(person[bucket] || { efectivo: 0, daviplata: 0, nequi: 0, total: 0 })\r\n              };\r\n\r\n              const pt = paymentType.toLowerCase();\r\n              if (pt === 'efectivo') b.efectivo = Math.max(0, (b.efectivo || 0) - amount);\r\n              else if (pt === 'daviplata') b.daviplata = Math.max(0, (b.daviplata || 0) - amount);\r\n              else if (pt === 'nequi') b.nequi = Math.max(0, (b.nequi || 0) - amount);\r\n              b.total = Math.max(0, (b.total || 0) - amount);\r\n\r\n              person[bucket] = b;\r\n              newDeliveryPersons[deliveryPerson] = person;\r\n\r\n              const remaining = (person.almuerzo?.total || 0) + (person.desayuno?.total || 0);\r\n              if (remaining === 0) delete newDeliveryPersons[deliveryPerson];\r\n            }\r\n            return newDeliveryPersons;\r\n          });\r\n        }\r\n      }\r\n\r\n      setSuccess('Estado actualizado correctamente.');\r\n      logActivity(`Actualizó el estado del pedido ${orderId} a: ${newStatus}`, {\r\n        orderId,\r\n        previousStatus,\r\n        newStatus\r\n      });\r\n    } catch (error) {\r\n      setError(`Error al actualizar estado: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  const handleDeliveryChange = async (orderId, deliveryPerson) => {\r\n    try {\r\n      const oldOrder = orders.find((o) => o.id === orderId);\r\n      const collectionName = oldOrder.type === 'breakfast' ? 'deliveryBreakfastOrders' : 'orders';\r\n      const previousDeliveryPerson = oldOrder ? oldOrder.deliveryPerson : 'Desconocido';\r\n\r\n      await updateDoc(doc(db, collectionName, orderId), {\r\n        deliveryPerson: deliveryPerson || null,\r\n        updatedAt: new Date()\r\n      });\r\n      setEditingDeliveryId(null);\r\n      setSuccess('Domiciliario actualizado correctamente.');\r\n      logActivity(`Asignó/Actualizó domiciliario para el pedido ${orderId} a: ${deliveryPerson || 'Sin asignar'}`, {\r\n        orderId,\r\n        previousDeliveryPerson,\r\n        newDeliveryPerson: deliveryPerson || 'Sin asignar'\r\n      });\r\n    } catch (error) {\r\n      setError(`Error al actualizar domiciliario: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  const handleOpenPreview = () => {\r\n    const previewWindow = window.open('', '_blank');\r\n    previewWindow.document.write(generatePreviewHtml(filteredOrders, displayedTotals, deliveryPersons));\r\n    previewWindow.document.close();\r\n    logActivity('Abrió la vista previa de pedidos (PDF)', { type: 'PDF Preview' });\r\n  };\r\n\r\n  const handleOpenExcelPreview = () => {\r\n    const previewWindow = window.open('', '_blank');\r\n    previewWindow.document.write(\r\n      generateExcelPreviewHtml(filteredOrders, displayedTotals, deliveryPersons, totalProteinUnits, proteins)\r\n    );\r\n    previewWindow.document.close();\r\n    logActivity('Abrió la vista previa de pedidos (Excel)', { type: 'Excel Preview' });\r\n  };\r\n\r\n  const handleNewOrderFieldChange = (field, value) => {\r\n    setNewOrderForm((prev) => ({ ...prev, [field]: value }));\r\n  };\r\n\r\n  const handleNewOrderMealFormFieldChange = (mealIndex, field, value) => {\r\n    setNewOrderForm((prev) => {\r\n      const newMeals = [...prev.meals];\r\n      if (!newMeals[mealIndex]) {\r\n        newMeals[mealIndex] = { address: {}, payment: {}, time: {} };\r\n      }\r\n      if (field.includes('.')) {\r\n        const [parent, child] = field.split('.');\r\n        newMeals[mealIndex] = { ...newMeals[mealIndex], [parent]: { ...newMeals[mealIndex][parent], [child]: value } };\r\n      } else if (field === 'sides') {\r\n        newMeals[mealIndex] = {\r\n          ...newMeals[mealIndex],\r\n          sides: value\r\n            .split(',')\r\n            .map((s) => ({ name: s.trim() }))\r\n            .filter((s) => s.name)\r\n        };\r\n      } else if (field === 'additions') {\r\n        newMeals[mealIndex] = {\r\n          ...newMeals[mealIndex],\r\n          additions: value\r\n            .split(';')\r\n            .map((a) => {\r\n              const [name, proteinOrReplacement = '', quantity = '1'] = a.split(',');\r\n              return {\r\n                name: name.trim(),\r\n                [proteinOrReplacement.includes('por') ? 'replacement' : 'protein']: proteinOrReplacement.trim(),\r\n                quantity: Number(quantity) || 1\r\n              };\r\n            })\r\n            .filter((a) => a.name)\r\n        };\r\n      } else if (field === 'principle') {\r\n        newMeals[mealIndex] = {\r\n          ...newMeals[mealIndex],\r\n          principle: value\r\n            .split(',')\r\n            .map((p) => ({ name: p.trim() }))\r\n            .filter((p) => p.name)\r\n        };\r\n      } else {\r\n        newMeals[mealIndex] = { ...newMeals[mealIndex], [field]: value };\r\n      }\r\n      return { ...prev, meals: newMeals };\r\n    });\r\n  };\r\n\r\n  const handleAddOrderSubmit = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      const normalizedMeals = newOrderForm.meals.map((meal) => ({\r\n        ...meal,\r\n        soup: meal.soup ? { name: meal.soup } : null,\r\n        soupReplacement: meal.soupReplacement ? { name: meal.soupReplacement } : null,\r\n        principle: Array.isArray(meal.principle)\r\n          ? meal.principle.map((p) => ({ name: p.name || p }))\r\n          : meal.principle\r\n          ? [{ name: meal.principle }]\r\n          : [],\r\n        principleReplacement: meal.principleReplacement ? { name: meal.principleReplacement } : null,\r\n        protein: meal.protein ? { name: meal.protein } : null,\r\n        drink: meal.drink ? { name: meal.drink } : null,\r\n        cutlery: meal.cutlery ? { name: meal.cutlery } : null,\r\n        time: meal.time ? { name: meal.time } : null,\r\n        payment: newOrderForm.payment ? { name: newOrderForm.payment } : { name: 'Efectivo' },\r\n        sides: Array.isArray(meal.sides) ? meal.sides.map((s) => ({ name: s.name || s })) : [],\r\n        additions: Array.isArray(meal.additions)\r\n          ? meal.additions.map((a) => ({\r\n              name: a.name || '',\r\n              protein: a.protein || '',\r\n              replacement: a.replacement || '',\r\n              quantity: a.quantity || 1\r\n            }))\r\n          : []\r\n      }));\r\n\r\n      const paymentSummary = {\r\n        Efectivo: newOrderForm.payment === 'Efectivo' ? Number(newOrderForm.total) || 0 : 0,\r\n        Daviplata: newOrderForm.payment === 'Daviplata' ? Number(newOrderForm.total) || 0 : 0,\r\n        Nequi: newOrderForm.payment === 'Nequi' ? Number(newOrderForm.total) || 0 : 0\r\n      };\r\n\r\n      const orderData = {\r\n        ...newOrderForm,\r\n        meals: normalizedMeals,\r\n        total: Number(newOrderForm.total) || 0,\r\n        status: newOrderForm.status || 'Pendiente',\r\n        payment: newOrderForm.payment || 'Efectivo',\r\n        deliveryPerson: newOrderForm.deliveryPerson || 'Sin asignar',\r\n        paymentSummary,\r\n        createdAt: serverTimestamp(),\r\n        type: newOrderForm.type || 'lunch'\r\n      };\r\n\r\n      const collectionName = newOrderForm.type === 'breakfast' ? 'deliveryBreakfastOrders' : 'orders';\r\n      const docRef = await addDoc(collection(db, collectionName), orderData);\r\n      setSuccess('Orden agregada correctamente.');\r\n      logActivity(`Agregó una nueva orden (Total: $${newOrderForm.total.toLocaleString('es-CO')})`, {\r\n        orderId: docRef.id,\r\n        newOrderDetails: { ...newOrderForm, meals: normalizedMeals }\r\n      });\r\n      setShowAddOrderModal(false);\r\n      setNewOrderForm({\r\n        meals: [\r\n          {\r\n            soup: '',\r\n            soupReplacement: '',\r\n            principle: [{ name: '' }],\r\n            principleReplacement: '',\r\n            protein: '',\r\n            drink: '',\r\n            cutlery: '',\r\n            sides: [],\r\n            additions: [],\r\n            notes: '',\r\n            address: {\r\n              address: '',\r\n              phoneNumber: '',\r\n              addressType: '',\r\n              localName: '',\r\n              recipientName: ''\r\n            },\r\n            time: '',\r\n            payment: 'Efectivo'\r\n          }\r\n        ],\r\n        total: 0,\r\n        status: 'Pendiente',\r\n        payment: 'Efectivo',\r\n        deliveryPerson: 'Sin asignar',\r\n        type: 'lunch'\r\n      });\r\n    } catch (error) {\r\n      setError(`Error al agregar orden: ${error.message}`);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Compat para el datalist de domiciliarios en TablaPedidos\r\n  const deliveryPersonsCompat = useMemo(() => {\r\n    const r = {};\r\n    for (const [person, data] of Object.entries(deliveryPersons || {})) {\r\n      const cash = (data?.almuerzo?.efectivo || 0) + (data?.desayuno?.efectivo || 0);\r\n      const daviplata = (data?.almuerzo?.daviplata || 0) + (data?.desayuno?.daviplata || 0);\r\n      const nequi = (data?.almuerzo?.nequi || 0) + (data?.desayuno?.nequi || 0);\r\n      const total = (data?.almuerzo?.total || 0) + (data?.desayuno?.total || 0);\r\n      r[person] = { cash, daviplata, nequi, total };\r\n    }\r\n    return r;\r\n  }, [deliveryPersons]);\r\n\r\n  const uniqueDeliveryPersons = useMemo(() => Object.keys(deliveryPersons || {}), [deliveryPersons]);\r\n\r\n  return (\r\n    <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\r\n      <InteraccionesPedidos\r\n        theme={theme}\r\n        showProteinModal={showProteinModal}\r\n        setShowProteinModal={setShowProteinModal}\r\n        newProtein={newProtein}\r\n        setNewProtein={setNewProtein}\r\n        handleAddProtein={handleAddProtein}\r\n        proteins={proteins}\r\n        totalProteinUnits={totalProteinUnits}\r\n        isLoading={isLoading}\r\n        showMealDetails={showMealDetails}\r\n        setShowMealDetails={setShowMealDetails}\r\n        editingOrder={editingOrder}\r\n        setEditingOrder={setEditingOrder}\r\n        editForm={editForm}\r\n        handleMealFormFieldChange={handleEditOrderMealFormFieldChange}\r\n        handleEditFormFieldChange={handleEditFormFieldChange}\r\n        handleSaveEdit={handleSaveEdit}\r\n        showConfirmDeleteAll={showConfirmDeleteAll}\r\n        setShowConfirmDeleteAll={setShowConfirmDeleteAll}\r\n        confirmText={confirmText}\r\n        setConfirmText={setConfirmText}\r\n        handleDeleteAllOrders={handleDeleteAllOrders}\r\n        setError={setError}\r\n        setSuccess={setSuccess}\r\n        showAddOrderModal={showAddOrderModal}\r\n        setShowAddOrderModal={setShowAddOrderModal}\r\n        newOrderForm={newOrderForm}\r\n        handleNewOrderMealFormFieldChange={handleNewOrderMealFormFieldChange}\r\n        handleNewOrderFieldChange={handleNewOrderFieldChange}\r\n        handleAddOrderSubmit={handleAddOrderSubmit}\r\n        uniqueDeliveryPersons={uniqueDeliveryPersons}\r\n      />\r\n\r\n      <TablaPedidos\r\n        theme={theme}\r\n        orders={orders}\r\n        searchTerm={searchTerm}\r\n        setSearchTerm={setSearchTerm}\r\n        totals={displayedTotals}\r\n        isLoading={isLoading}\r\n        paginatedOrders={paginatedOrders}\r\n        currentPage={currentPage}\r\n        totalPages={totalPages}\r\n        setCurrentPage={setCurrentPage}\r\n        itemsPerPage={itemsPerPage}\r\n        setItemsPerPage={setItemsPerPage}\r\n        deliveryPersons={deliveryPersonsCompat}\r\n        handleEditOrder={handleEditOrder}\r\n        handleDeleteOrder={handleDeleteOrder}\r\n        handleStatusChange={handleStatusChange}\r\n        handleSort={handleSort}\r\n        getSortIcon={getSortIcon}\r\n        setShowMealDetails={setShowMealDetails}\r\n        editingDeliveryId={editingDeliveryId}\r\n        setEditingDeliveryId={setEditingDeliveryId}\r\n        editForm={editForm}\r\n        setEditForm={setEditForm}\r\n        handleDeliveryChange={handleDeliveryChange}\r\n        sortOrder={sortOrder}\r\n        showProteinModal={showProteinModal}\r\n        setShowProteinModal={setShowProteinModal}\r\n        isMenuOpen={isMenuOpen}\r\n        setIsMenuOpen={setIsMenuOpen}\r\n        handleOpenPreview={handleOpenPreview}\r\n        handleOpenExcelPreview={handleOpenExcelPreview}\r\n        handleExport={handleExport}\r\n        handleDeleteAllOrders={handleDeleteAllOrders}\r\n        setShowConfirmDeleteAll={setShowConfirmDeleteAll}\r\n        exportToExcel={exportToExcel}\r\n        exportToPDF={exportToPDF}\r\n        exportToCSV={exportToCSV}\r\n        setShowAddOrderModal={setShowAddOrderModal}\r\n        orderTypeFilter={orderTypeFilter}\r\n        setOrderTypeFilter={setOrderTypeFilter}\r\n        uniqueDeliveryPersons={uniqueDeliveryPersons}\r\n      />\r\n\r\n      {/* 🔥 Se eliminó el bloque de \"Resumen por Domiciliarios\" aquí para evitar duplicados.\r\n          Ahora el resumen aparece SOLO dentro de TablaPedidos. */}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OrderManagement;\r\n","//src/components/Admin/utilities/previewOrders.js\r\nexport const generatePreviewHtml = (orders, totals, deliveryPersons) => {\r\n  let mealCounter = 0;\r\n  const pedidosBody = orders.flatMap((order) => {\r\n    if (!order || !Array.isArray(order.meals) || order.meals.length === 0) return [];\r\n    return order.meals.filter(meal => meal).map((meal) => {\r\n      mealCounter += 1;\r\n      return [\r\n        mealCounter,\r\n        meal?.address?.address || '',\r\n        meal?.address?.phoneNumber || '',\r\n        `$${order.total?.toLocaleString('es-CO') || '0'}`,\r\n        order?.deliveryPerson || ''\r\n      ];\r\n    });\r\n  });\r\n\r\n  if (pedidosBody.length === 0) pedidosBody.push(Array(5).fill('-'));\r\n\r\n  const deliveryBody = Object.entries(deliveryPersons).map(([name, data]) => [\r\n    name || '',\r\n    `$${data.cash?.toLocaleString('es-CO') || '0'}`,\r\n    `$${data.daviplata?.toLocaleString('es-CO') || '0'}`,\r\n    `$${data.nequi?.toLocaleString('es-CO') || '0'}`,\r\n    `$${data.total?.toLocaleString('es-CO') || '0'}`\r\n  ]);\r\n\r\n  const now = new Date();\r\n  const dateStr = now.toLocaleDateString('es-CO');\r\n  const timeStr = now.toLocaleTimeString('es-CO', { hour: '2-digit', minute: '2-digit', hour12: true });\r\n\r\n  return `\r\n    <html>\r\n      <head>\r\n        <title>Previsualización de Pedidos</title>\r\n        <style>\r\n          body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }\r\n          h1 { text-align: center; font-size: 24px; }\r\n          p.date { text-align: center; font-size: 12px; }\r\n          table { width: 100%; border-collapse: collapse; margin-top: 20px; }\r\n          th, td { padding: 8px; border: 1px solid black; }\r\n          th { background-color: #0066cc; color: white; font-weight: bold; }\r\n          td { text-align: left; }\r\n          td:nth-child(4) { text-align: right; }\r\n          tr:nth-child(even) { background-color: #f5f5f5; }\r\n          .totals-table { width: 50%; }\r\n          .delivery-table th:nth-child(n+2), .delivery-table td:nth-child(n+2) { text-align: right; }\r\n          .button-container { margin-top: 20px; text-align: center; }\r\n          .button { padding: 10px 20px; background-color: #0066cc; color: white; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }\r\n          .button.print { background-color: #28a745; }\r\n          @media print {\r\n              .button-container { display: none; }\r\n          }\r\n        </style>\r\n      </head>\r\n      <body>\r\n        <h1>Gestión de Pedidos</h1>\r\n        <p class=\"date\">Fecha: ${dateStr} ${timeStr}</p>\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th>N</th>\r\n              <th>Dirección</th>\r\n              <th>Teléfono</th>\r\n              <th>Total</th>\r\n              <th>Domiciliario</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            ${pedidosBody.map(row => `\r\n              <tr>\r\n                <td>${row[0]}</td>\r\n                <td>${row[1]}</td>\r\n                <td>${row[2]}</td>\r\n                <td>${row[3]}</td>\r\n                <td>${row[4]}</td>\r\n              </tr>\r\n            `).join('')}\r\n          </tbody>\r\n        </table>\r\n        <h2 style=\"margin-top: 20px; font-size: 18px;\">Resumen de Totales</h2>\r\n        <table class=\"totals-table\">\r\n          <tbody>\r\n            <tr><td style=\"padding: 8px;\">Total Efectivo</td><td style=\"padding: 8px; text-align: right;\">${pedidosBody.length > 0 ? `$${totals.cash?.toLocaleString('es-CO') || '0'}` : '$0'}</td></tr>\r\n            <tr><td style=\"padding: 8px;\">Total Daviplata</td><td style=\"padding: 8px; text-align: right;\">${pedidosBody.length > 0 ? `$${totals.daviplata?.toLocaleString('es-CO') || '0'}` : '$0'}</td></tr>\r\n            <tr><td style=\"padding: 8px;\">Total Nequi</td><td style=\"padding: 8px; text-align: right;\">${pedidosBody.length > 0 ? `$${totals.nequi?.toLocaleString('es-CO') || '0'}` : '$0'}</td></tr>\r\n            <tr><td style=\"padding: 8px;\">Total General</td><td style=\"padding: 8px; text-align: right;\">${pedidosBody.length > 0 ? `$${(totals.cash + totals.daviplata + totals.nequi || 0).toLocaleString('es-CO')}` : '$0'}</td></tr>\r\n          </tbody>\r\n        </table>\r\n        <h2 style=\"margin-top: 20px; font-size: 18px;\">Resumen por Domiciliarios</h2>\r\n        <table class=\"delivery-table\">\r\n          <thead>\r\n            <tr>\r\n              <th>Domiciliario</th>\r\n              <th>Efectivo</th>\r\n              <th>Daviplata</th>\r\n              <th>Nequi</th>\r\n              <th>Total</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            ${deliveryBody.map(row => `\r\n              <tr>\r\n                <td>${row[0]}</td>\r\n                <td>${row[1]}</td>\r\n                <td>${row[2]}</td>\r\n                <td>${row[3]}</td>\r\n                <td>${row[4]}</td>\r\n              </tr>\r\n            `).join('')}\r\n          </tbody>\r\n        </table>\r\n        <div class=\"button-container\">\r\n          <button class=\"button print\" onclick=\"window.print()\">Imprimir</button>\r\n          <button class=\"button\" onclick=\"window.close()\">Cerrar Previsualización</button>\r\n        </div>\r\n      </body>\r\n    </html>\r\n  `;\r\n};","//src/components/Admin/utilities/previewExcel.js\r\nexport const generateExcelPreviewHtml = (orders, totals, deliveryPersons, totalProteinUnits = 0, proteins = []) => {\r\n  let mealCounter = 0;\r\n  const pedidosBody = orders.map((order) => {\r\n    mealCounter += 1;\r\n    const meal = order.meals?.[0] || {};\r\n    const payment = order.payment?.name || order.payment || meal?.payment?.name || meal?.payment || 'Efectivo';\r\n\r\n    return [\r\n      mealCounter,\r\n      meal?.address?.address || '',\r\n      meal?.address?.phoneNumber || '',\r\n      `$${order.total?.toLocaleString('es-CO') || '0'}`,\r\n      payment,\r\n      order?.deliveryPerson || ''\r\n    ];\r\n  });\r\n\r\n  if (pedidosBody.length === 0) pedidosBody.push(Array(6).fill('-'));\r\n\r\n  const deliveryBody = Object.entries(deliveryPersons).map(([name, data]) => [\r\n    name || '',\r\n    `$${data.cash?.toLocaleString('es-CO') || '0'}`,\r\n    `$${data.daviplata?.toLocaleString('es-CO') || '0'}`,\r\n    `$${data.nequi?.toLocaleString('es-CO') || '0'}`,\r\n    `$${data.total?.toLocaleString('es-CO') || '0'}`\r\n  ]);\r\n\r\n  const proteinsBody = proteins.length === 0\r\n    ? [['-', '-']]\r\n    : proteins.map((protein, index) => {\r\n        const isPenultimate = index === proteins.length - 2;\r\n        const isLast = index === proteins.length - 1;\r\n        return [\r\n          protein.name || 'Sin nombre',\r\n          protein.quantity?.toLocaleString('es-CO') || '0',\r\n          isPenultimate ? 'TOTAL PROTEÍNAS:' : isLast ? 'Fecha actual:' : '',\r\n          isPenultimate ? totalProteinUnits.toLocaleString('es-CO') : isLast ? new Date().toLocaleDateString('es-CO', { day: '2-digit', month: '2-digit', year: 'numeric' }) : ''\r\n        ];\r\n      });\r\n\r\n  // Se calculan los totales de forma precisa\r\n  const calculatedTotals = {\r\n    cash: totals.cash || 0,\r\n    daviplata: totals.daviplata || 0,\r\n    nequi: totals.nequi || 0\r\n  };\r\n  const totalGeneral = calculatedTotals.cash + calculatedTotals.daviplata + calculatedTotals.nequi;\r\n\r\n  return `\r\n    <html>\r\n      <head>\r\n        <title>Previsualización de Excel</title>\r\n        <style>\r\n          body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }\r\n          h1 { text-align: center; font-size: 24px; }\r\n          table { width: 100%; border-collapse: collapse; }\r\n          th, td { padding: 8px; border: 1px solid black; }\r\n          th { background-color: #0066cc; color: white; font-weight: bold; text-align: center; font-size: 16px; }\r\n          td { text-align: left; vertical-align: middle; }\r\n          td:nth-child(4), td:nth-child(6) { text-align: right; }\r\n          tr:nth-child(even) { background-color: #f5f5f5; }\r\n          .totals-table { width: 50%; margin-left: auto; margin-right: auto; }\r\n\r\n          .proteins-container { width: auto; margin: 0 auto; max-width: 700px; }\r\n          .proteins-table {\r\n            border-collapse: collapse;\r\n            font-size: 14px;\r\n            width: 100%;\r\n            max-width: 700px;\r\n          }\r\n          .proteins-table th, .proteins-table td {\r\n            padding: 6px 12px;\r\n            border: 1px solid black;\r\n            white-space: nowrap;\r\n          }\r\n          .proteins-table th:nth-child(1), .proteins-table td:nth-child(1) { width: 160px; text-align: left; }\r\n          .proteins-table th:nth-child(2), .proteins-table td:nth-child(2) { width: 80px; text-align: right; }\r\n          .proteins-table th:nth-child(3), .proteins-table td:nth-child(3) { width: 220px; text-align: left; }\r\n\r\n          .delivery-table th { background-color: #0066cc; color: white; font-weight: bold; text-align: center; font-size: 16px; }\r\n          .delivery-table .green-header th { background-color: #28a745; }\r\n          .delivery-table td:nth-child(n+2) { text-align: right; }\r\n\r\n          .spacer { height: 16px; }\r\n          .button-container { margin-top: 20px; text-align: center; }\r\n          .button { padding: 10px 20px; background-color: #0066cc; color: white; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }\r\n          .button.print { background-color: #28a745; }\r\n          @media print { .button-container { display: none; } }\r\n        </style>\r\n      </head>\r\n      <body>\r\n        <h1>Gestión de Pedidos</h1>\r\n        <div class=\"spacer\"></div>\r\n\r\n        <div class=\"proteins-container\">\r\n          <table class=\"proteins-table\" aria-label=\"Resumen de proteínas\">\r\n            <thead>\r\n              <tr>\r\n                <th style=\"background-color: #0066cc; color: white; border: 1px solid black;\">Proteína</th>\r\n                <th style=\"background-color: #0066cc; color: white; border: 1px solid black;\">Unidades</th>\r\n                <th style=\"background-color: #0066cc; color: white; border: 1px solid black;\"></th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              ${proteinsBody.map((row, index) => {\r\n                const thirdColumn = row[2] ? `\r\n                  <td style=\"padding: 0;\">\r\n                    <div style=\"display: flex; width: 100%; height: 100%;\">\r\n                      <div style=\"flex: 1; padding: 6px 12px; font-weight: bold; display: flex; align-items: center;\">${row[2]}</div>\r\n                      <div style=\"width: 1px; background-color: black;\"></div>\r\n                      <div style=\"flex: 1; padding: 6px 12px; display: flex; justify-content: flex-end; align-items: center; font-weight: ${row[2] === 'TOTAL PROTEÍNAS:' ? 'bold' : 'normal'};\">${row[3]}</div>\r\n                    </div>\r\n                  </td>\r\n                ` : '<td style=\"border: none; background-color: white;\"></td>';\r\n\r\n                return `\r\n                  <tr>\r\n                    <td title=\"${row[0]}\">${row[0]}</td>\r\n                    <td style=\"text-align: right;\">${row[1]}</td>\r\n                    ${thirdColumn}\r\n                  </tr>\r\n                `;\r\n              }).join('')}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        <div class=\"spacer\"></div><div class=\"spacer\"></div>\r\n\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th>N</th>\r\n              <th>Dirección</th>\r\n              <th>Teléfono</th>\r\n              <th>Total</th>\r\n              <th>Método de Pago</th>\r\n              <th>Domiciliario</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            ${pedidosBody.map(row => `\r\n              <tr>\r\n                <td>${row[0]}</td>\r\n                <td>${row[1]}</td>\r\n                <td>${row[2]}</td>\r\n                <td>${row[3]}</td>\r\n                <td>${row[4]}</td>\r\n                <td>${row[5]}</td>\r\n              </tr>\r\n            `).join('')}\r\n          </tbody>\r\n        </table>\r\n\r\n        <div class=\"spacer\"></div><div class=\"spacer\"></div>\r\n\r\n        <table class=\"totals-table\">\r\n          <thead>\r\n            <tr><th colspan=\"2\">Resumen de Totales</th></tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr><td>Total Efectivo</td><td style=\"text-align: right;\">$${calculatedTotals.cash.toLocaleString('es-CO')}</td></tr>\r\n            <tr><td>Total Daviplata</td><td style=\"text-align: right;\">$${calculatedTotals.daviplata.toLocaleString('es-CO')}</td></tr>\r\n            <tr><td>Total Nequi</td><td style=\"text-align: right;\">$${calculatedTotals.nequi.toLocaleString('es-CO')}</td></tr>\r\n            <tr><td>Total General</td><td style=\"text-align: right;\">$${totalGeneral.toLocaleString('es-CO')}</td></tr>\r\n          </tbody>\r\n        </table>\r\n\r\n        <div class=\"spacer\"></div><div class=\"spacer\"></div>\r\n\r\n        <table class=\"delivery-table\">\r\n          <thead>\r\n            <tr><th colspan=\"5\">Resumen por Domiciliarios</th></tr>\r\n            <tr class=\"green-header\">\r\n              <th>Domiciliario</th>\r\n              <th>Efectivo</th>\r\n              <th>Daviplata</th>\r\n              <th>Nequi</th>\r\n              <th>Total</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            ${deliveryBody.map(row => `\r\n              <tr>\r\n                <td>${row[0]}</td>\r\n                <td>${row[1]}</td>\r\n                <td>${row[2]}</td>\r\n                <td>${row[3]}</td>\r\n                <td>${row[4]}</td>\r\n              </tr>\r\n            `).join('')}\r\n          </tbody>\r\n        </table>\r\n\r\n        <div class=\"button-container\">\r\n          <button class=\"button print\" onclick=\"window.print()\">Imprimir</button>\r\n          <button class=\"button\" onclick=\"window.close()\">Cerrar Previsualización</button>\r\n          <button class=\"button\" onclick=\"window.opener.postMessage('downloadExcel', '*')\">Descargar Excel</button>\r\n        </div>\r\n      </body>\r\n    </html>\r\n  `;\r\n};","// src/utils/classNames.js\r\nexport function classNames(...classes) {\r\n  return classes.filter(Boolean).join(' ');\r\n}"],"names":["toInt","v","n","Math","floor","Number","isFinite","normKey","s","toString","trim","toLowerCase","buildMethodOptions","catalogMethods","Array","isArray","length","names","map","m","name","label","filter","Boolean","from","Set","PaymentSplitEditor","_ref","theme","total","value","onChange","disabled","methods","useMemo","rows","setRows","useState","sanitized","r","_r$method","method","amount","note","useEffect","_r$method2","sum","reduce","acc","diff","ok","emit","next","handleChange","idx","key","val","i","_jsxs","className","classNames","children","_jsx","type","onClick","fill5050","half","rest","split3","a","b","c","setAllTo","e","target","min","step","placeholder","_","removeRow","addRow","unused","find","some","max","toLocaleString","abs","norm","normalizePaymentMethodKey","methodLike","raw","title","payment","t","includes","pickMethodLabel","extractOrderPayments","order","_order$meals$0$paymen","_order$meals","_order$meals$","_order$meals2","_order$meals2$","_order$breakfasts$0$p","_order$breakfasts","_order$breakfasts$","_order$breakfasts2","_order$breakfasts2$","_order$paymentMethod","payments","p","methodKey","rawLabel","legacySources","meals","paymentMethod","breakfasts","summarizePayments","paymentsRows","arguments","undefined","agg","asText","cash","push","nequi","daviplata","other","join","defaultPaymentsForOrder","sumPaymentsByMethod","orders","out","amt","isSalonOrder","_order$breakfasts5","_order$breakfasts5$","__collection","orderType","calcMethodTotalsAll","tableOrders","breakfastOrders","nequiTotal","daviplataTotal","nequiPendiente","daviplatasPendiente","cashSalon","cashClientesSettled","cashClientesPendiente","totalLiquidado","totalPendiente","totalDomicilios","totalSalon","accumulate","list","o","isSalon","_o$paymentSettled","settled","paymentSettled","_o$paymentSettled2","_o$paymentSettled3","cashCaja","exportToExcel","async","totals","deliveryPersons","totalProteinUnits","proteins","_proteins","_proteins2","_proteins3","_proteins4","workbook","ExcelJS","worksheet","addWorksheet","cleanText","text","replace","String","applyThinBorder","cell","border","top","style","color","argb","left","bottom","right","proteinHeaderRow","lastRow","number","mergeCells","ourHeader","getCell","font","bold","fill","pattern","fgColor","alignment","horizontal","getRow","values","eachCell","colNumber","proteinData","quantity","extra","extraValue","slice","Date","getDate","padStart","getMonth","getFullYear","forEach","protein","index","numFmt","mealCounter","pedidos","_meal$payment","_meal$address","_meal$address2","meal","paymentValue","console","warn","id","N","Dirección","address","Teléfono","phoneNumber","Total","MétodoDePago","Domiciliario","deliveryPerson","columns","width","pedidosHeaderRow","headerRow","pedido","resumenRow","resumenCell","row","resumenDomiciliariosRow","deliveryHeader","Object","entries","_ref2","data","buffer","xlsx","writeBuffer","blob","Blob","link","document","createElement","href","window","URL","createObjectURL","download","toISOString","body","appendChild","click","removeChild","error","alert","message","exportToPDF","_totals$cash","_totals$daviplata","_totals$nequi","doc","jsPDF","logoUrl","addImage","imgError","setFontSize","now","dateStr","toLocaleDateString","timeStr","toLocaleTimeString","hour","minute","hour12","pedidosBody","_order$payment","_order$total","autoTable","startY","head","styles","fontSize","cellPadding","overflow","headStyles","fillColor","textColor","fontStyle","lineWidth","lineColor","alternateRowStyles","columnStyles","cellWidth","halign","tableLineColor","tableLineWidth","didDrawPage","pageNumber","finalY","lastAutoTable","deliveryY","deliveryBody","_data$cash","_data$daviplata","_data$nequi","_data$total","save","split","exportToCSV","setSuccess","orderRows","flatMap","_meal$soup","_meal$principle","_meal$protein","_meal$drink","_meal$cutlery","_meal$sides","_meal$additions","_meal$time","_meal$address3","_meal$address4","_meal$address5","_meal$address6","soup","principle","drink","cutlery","sides","additions","replacement","notes","time","addressType","localName","recipientName","unitDetails","status","createdAt","seconds","updatedAt","totalsRows","deliveryRows","csvContent","url","revokeObjectURL","getAddressDisplay","display","paymentsRowsFromOrder","fallbackBuilder","fb","money","searchTerm","setSearchTerm","isLoading","paginatedOrders","currentPage","totalPages","setCurrentPage","itemsPerPage","setItemsPerPage","handleEditOrder","handleDeleteOrder","handleStatusChange","handleSort","getSortIcon","setShowMealDetails","editingDeliveryId","setEditingDeliveryId","editForm","setEditForm","handleDeliveryChange","sortOrder","showProteinModal","setShowProteinModal","isMenuOpen","setIsMenuOpen","handleOpenPreview","handleOpenExcelPreview","handleExport","handleDeleteAllOrders","setShowConfirmDeleteAll","setShowAddOrderModal","orderTypeFilter","setOrderTypeFilter","uniqueDeliveryPersons","currentDate","weekday","month","day","menuRef","useRef","deliveryDraft","setDeliveryDraft","lastAssignedRef","handleClickOutside","event","current","contains","addEventListener","removeEventListener","toast","setToast","toastTimer","showToast","clearTimeout","setTimeout","editingPaymentsOrder","setEditingPaymentsOrder","EXTRA_COLLECTIONS","findExistingOrderRef","Error","preferred","collectionName","guess","resolveCollectionName","orderedBase","candidates","indexOf","col","ref","db","getDoc","exists","totalsDisplay","resumen","ensureBucket","person","bucket","bump","obj","byType","byTotal","sumPaymentsByDeliveryAndType","resumenPersons","keys","sort","localeCompare","_Fragment","PlusIcon","EllipsisVerticalIcon","ArrowDownTrayIcon","colSpan","_order$meals3","_order$meals3$","_order$breakfasts3","_order$breakfasts3$","_order$meals4","_order$meals4$","_order$meals4$$paymen","_order$breakfasts4","_order$breakfasts4$","_order$breakfasts4$$p","_order$meals5","_order$meals5$","_order$meals6","_order$meals6$","_order$meals6$$addres","_order$breakfasts6","_order$breakfasts6$","_order$breakfasts6$$a","displayNumber","addressDisplay","paymentDisplay","_order$meals$$payment","_order$breakfasts$$pa","methodLabel","k","legacy","paymentMethodsOnly","statusClass","timeValue","displayTime","InformationCircleIcon","onKeyDown","valueToSave","onBlur","autoFocus","initial","maybePromise","then","err","PencilIcon","TrashIcon","prev","ChevronLeftIcon","ChevronRightIcon","buckets","lunch","breakfast","overall","personKey","toSettle","normalized","fail","_order$paymentSettled","_order$paymentSettled2","_order$paymentSettled3","hasPaymentMethod","hasNequi","hasDaviplata","hasCash","updateData","settledAt","updateDoc","handleSettle","payload","_p$method","code","savePaymentsForOrder","normalizeName","byName","ensureAddress","_addr$address","_addr$phoneNumber","_ref3","_addr$addressType","_ref4","_addr$localName","_ref5","_addr$unitDetails","_ref6","_addr$recipientName","addr","fallback","_ref7","newProtein","setNewProtein","handleAddProtein","showMealDetails","editingOrder","setEditingOrder","handleMealFormFieldChange","handleEditFormFieldChange","handleSaveEdit","showConfirmDeleteAll","confirmText","setConfirmText","setError","showAddOrderModal","newOrderForm","handleNewOrderMealFormFieldChange","handleNewOrderFieldChange","handleAddOrderSubmit","soups","setSoups","soupReplacements","setSoupReplacements","principles","setPrinciples","menuProteins","setMenuProteins","drinks","setDrinks","setSides","setAdditions","paymentMethods","setPaymentMethods","breakfastEggs","setBreakfastEggs","breakfastBroths","setBreakfastBroths","breakfastRiceBread","setBreakfastRiceBread","breakfastDrinks","setBreakfastDrinks","breakfastAdditions","setBreakfastAdditions","breakfastTypes","setBreakfastTypes","breakfastProteins","setBreakfastProteins","editingProtein","setEditingProtein","mapSetter","listen","onSnapshot","collection","snap","docs","d","unsubs","u","handleBreakfastFormFieldChange","field","parent","child","handleBreakfastImmediate","hydratedOrderIdRef","React","fallbackAddress","computedTotal","calculateTotal","_b$time","broth","eggs","riceBread","full","_m$soupReplacement","_m$principleReplaceme","_m$time","arr","soupReplacement","principleReplacement","_ref8","_a$price","price","computed","mealsForDetails","calculateBreakfastPrice","Transition","show","as","Dialog","onClose","Child","enter","enterFrom","enterTo","leave","leaveFrom","leaveTo","Panel","Title","XMarkIcon","handleCancelEditProtein","isNaN","handleEditProtein","deleteDoc","proteinId","handleDeleteProtein","BreakfastOrderSummary","items","user","role","showSaveButton","OrderSummary","isTableOrder","isWaiterView","_row$time","_row$address","_row$address2","_row$address3","_row$address4","_row$address5","_row$address6","_row$address7","_row$address8","_row$address9","_row$time2","_row$address0","_row$address1","_row$address10","_row$address11","_row$address12","_row$address13","_row$address14","_row$address15","_row$address16","OptionSelector","emoji","options","selected","multiple","onImmediateSelect","sel","checked","showConfirmButton","selection","onConfirm","_ref9","mealIndex","_meal$address7","_meal$address8","_meal$address9","_ref0","setOrders","setTotals","setIsLoading","setDeliveryPersons","sortBy","setSortBy","setSortOrder","setProteins","setNewOrderForm","logActivity","useCallback","action","details","addDoc","timestamp","serverTimestamp","fetchOrders","latestLunch","latestBreakfast","recompute","merged","newTotals","general","newDeliveryPersons","paymentSummary","Efectivo","Daviplata","Nequi","almuerzo","efectivo","desayuno","paymentType","unsubLunch","snapshot","_meals$","_meals$$payment","unsubBreakfast","_data$breakfasts","_data$breakfasts$","_data$breakfasts$$pay","fetchProteins","today","proteinsColRef","query","where","unsubscribe","proteinsData","unsubscribeOrders","unsubscribeProteins","filteredOrders","_order$meals3$$paymen","_order$breakfasts3$$p","lowerSearchTerm","addrObj","phone","timeObj","displayedTotals","ps","sortedOrders","getValue","path","currentFilteredOrdersArray","startsWith","ts","toMillis","getTime","readPath","part","_value","endsWith","valueA","valueB","ceil","start","end","defaultAddress","batch","writeBatch","ordersSnapshot","getDocs","breakfastOrdersSnapshot","docRef","delete","commit","count","size","deliveryPersonsCompat","_data$almuerzo","_data$desayuno","_data$almuerzo2","_data$desayuno2","_data$almuerzo3","_data$desayuno3","_data$almuerzo4","_data$desayuno4","InteraccionesPedidos","date","proteinName","handleEditOrderMealFormFieldChange","newMeals","proteinOrReplacement","oldOrder","previousState","updateDataBase","updatedBreakfastsForDB","_b$address","_b$address2","_b$address3","_b$address4","_b$address5","_b$address6","orderId","newState","updatedMealsForDB","normalizedMeals","orderData","newOrderDetails","TablaPedidos","orderToDelete","deletedOrderDetails","newStatus","previousStatus","_person$almuerzo","_person$desayuno","pt","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","previousDeliveryPerson","newDeliveryPerson","previewWindow","open","write","generatePreviewHtml","close","proteinsBody","_protein$quantity","isPenultimate","isLast","year","calculatedTotals","totalGeneral","thirdColumn","generateExcelPreviewHtml","exportFunction","format","_len","classes","_key"],"sourceRoot":""}