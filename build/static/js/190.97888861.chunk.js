"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[190],{6190:(e,t,a)=>{a.r(t),a.d(t,{default:()=>S});var r=a(5043),n=a(1958),l=a(5472),i=a(9626),o=a(2311),s=a(8662),d=a(7591),c=a(1252),g=a(2811),m=a(9248),u=a(8224),p=a(6365),x=a(2549);function h(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter(Boolean).join(" ")}var b=a(9223),y=a.n(b);var v=a(7762),f=a(557),N=a.n(f);var j=a(579);const w=e=>null==e?"":"string"===typeof e?e.replace(" NUEVO","").trim():"boolean"===typeof e?e.toString():"object"===typeof e&&null!==e&&void 0!==e&&e.name?e.name.replace(" NUEVO","").trim():String(e).replace(" NUEVO","").trim(),k=(e,t)=>e&&t?t.split(".").reduce((e,t)=>e&&void 0!==e[t]?e[t]:"",e):"",C=e=>{if(null===e||void 0===e||!e.address)return"Sin direcci\xf3n";let t=e.address;switch(e.addressType){case"school":e.recipientName&&(t+=` (Recibe: ${w(e.recipientName)})`);break;case"complex":e.unitDetails&&(t+=` (${w(e.unitDetails)})`);break;case"shop":e.localName&&(t+=` (${w(e.localName)})`)}return t},$=e=>{var t,a,r,n,l,i,o,s,d,c,g,m,u,p,x,h,b,y,v,f,N,j,k,$,S;const P=[],D=null!==(t=e.soupReplacement)&&void 0!==t&&t.name||e.soupReplacement?`${w((null===(a=e.soupReplacement)||void 0===a?void 0:a.name)||e.soupReplacement)} (por sopa)`:null!==(r=e.soup)&&void 0!==r&&r.name||e.soup?w((null===(n=e.soup)||void 0===n?void 0:n.name)||e.soup):"Sin sopa";let E;var T;if(P.push(`Sopa: ${D}`),null!==(l=e.principleReplacement)&&void 0!==l&&l.name||e.principleReplacement)E=`${w((null===(T=e.principleReplacement)||void 0===T?void 0:T.name)||e.principleReplacement)} (por principio)`;else if(Array.isArray(e.principle)&&e.principle.length>0){const t=e.principle.map(e=>w(e.name||e)).filter(Boolean);E=t.length>0?t.join(", "):"Sin principio"}else if(null!==(i=e.principle)&&void 0!==i&&i.name||e.principle){var O;E=w((null===(O=e.principle)||void 0===O?void 0:O.name)||e.principle)}else E="Sin principio";P.push(`Principio: ${E}`),P.push(`Prote\xedna: ${null!==(o=e.protein)&&void 0!==o&&o.name||e.protein?w((null===(s=e.protein)||void 0===s?void 0:s.name)||e.protein):"Sin prote\xedna"}`);const F="Juego de mango"===((null===(d=e.drink)||void 0===d?void 0:d.name)||e.drink)?"Jugo de mango":(null===(c=e.drink)||void 0===c?void 0:c.name)||e.drink;P.push(`Bebida: ${F?w(F):"Sin bebida"}`),P.push("Cubiertos: "+("S\xed"===(null===(g=e.cutlery)||void 0===g?void 0:g.name)||!0===e.cutlery||"true"===e.cutlery?"S\xed":"No"));const L=(null===(m=e.sides)||void 0===m?void 0:m.length)>0?e.sides.map(e=>w(e.name||e)).filter(Boolean).join(", "):"Ninguno";P.push(`Acompa\xf1amientos: ${L}`);const A=(null===(u=e.additions)||void 0===u?void 0:u.length)>0?e.additions.map(e=>`${w(e.name||e)}${e.protein||e.replacement?` (${w(e.protein||e.replacement)})`:""} (${e.quantity||1})`).join(", "):"Ninguna";P.push(`Adiciones: ${A}`),P.push(`Notas: ${e.notes?w(e.notes):"Ninguna"}`),P.push(`Hora de Entrega: ${null!==(p=e.time)&&void 0!==p&&p.name||e.time?w((null===(x=e.time)||void 0===x?void 0:x.name)||e.time):"No especificada"}`),P.push(`Direcci\xf3n: ${C(e.address)}`);let R="";switch(null===(h=e.address)||void 0===h?void 0:h.addressType){case"house":R="Casa/Apto";break;case"school":R="Colegio/Oficina";break;case"complex":R="Conjunto";break;case"shop":R="Tienda/Local";break;default:R="No especificado"}return P.push(`Tipo de Lugar: ${R}`),P.push(`Tel\xe9fono: ${null!==(b=e.address)&&void 0!==b&&b.phoneNumber?w(e.address.phoneNumber):"No especificado"}`),"shop"===(null===(y=e.address)||void 0===y?void 0:y.addressType)&&null!==(v=e.address)&&void 0!==v&&v.localName&&P.push(`Nombre del Local: ${w(e.address.localName)}`),"school"===(null===(f=e.address)||void 0===f?void 0:f.addressType)&&null!==(N=e.address)&&void 0!==N&&N.recipientName&&P.push(`Recibe: ${w(e.address.recipientName)}`),"complex"===(null===(j=e.address)||void 0===j?void 0:j.addressType)&&null!==(k=e.address)&&void 0!==k&&k.unitDetails&&P.push(`Unidad: ${w(e.address.unitDetails)}`),P.push(`Pago: ${null!==($=e.payment)&&void 0!==$&&$.name||e.payment?w((null===(S=e.payment)||void 0===S?void 0:S.name)||e.payment):"Efectivo"}`),P.join("\n")},S=e=>{var t;let{setError:a,setSuccess:b,theme:f}=e;const[S,P]=(0,r.useState)([]),[D,E]=(0,r.useState)(null),[T,O]=(0,r.useState)(""),[F,L]=(0,r.useState)({cash:0,daviplata:0,nequi:0}),[A,R]=(0,r.useState)({meals:[],total:0,status:"",payment:"",deliveryPerson:""}),[q,z]=(0,r.useState)(1),[I,M]=(0,r.useState)(10),[U,B]=(0,r.useState)(!0),[G,V]=(0,r.useState)(!1),[W,H]=(0,r.useState)(""),[J,Y]=(0,r.useState)(null),[_,Z]=(0,r.useState)(null),[Q,K]=(0,r.useState)({}),[X,ee]=(0,r.useState)("createdAt.seconds"),[te,ae]=(0,r.useState)("desc"),[re,ne]=(0,r.useState)([]),[le,ie]=(0,r.useState)({name:"",quantity:""}),[oe,se]=(0,r.useState)(!1),de=(0,r.useCallback)(()=>{B(!0);const e=(0,l.rJ)(n.db,"orders"),t=(0,l.aQ)(e,e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));P(t);const a={cash:0,daviplata:0,nequi:0},r={};t.forEach(e=>{const t=e.paymentSummary||{};if(a.cash+=t.Efectivo||0,a.daviplata+=t.Daviplata||0,a.nequi+=t.Nequi||0,e.deliveryPerson){var n,l,i,o,s;const t=w(e.deliveryPerson);r[t]||(r[t]={cash:0,daviplata:0,nequi:0,total:0});const a=w(e.payment||(null===(n=e.meals)||void 0===n||null===(l=n[0])||void 0===l||null===(i=l.payment)||void 0===i?void 0:i.name)||(null===(o=e.meals)||void 0===o||null===(s=o[0])||void 0===s?void 0:s.payment)||"Efectivo"),d=e.total||0;"Efectivo"===a?r[t].cash+=d:"Daviplata"===a?r[t].daviplata+=d:"Nequi"===a&&(r[t].nequi+=d),r[t].total+=d}}),L(a),K(r),B(!1)},e=>{a(`Error al cargar pedidos: ${e.message}`),B(!1)});return()=>t()},[a]),ce=(0,r.useCallback)(()=>{const e=(new Date).toISOString().split("T")[0],t=(0,l.P)((0,l.rJ)(n.db,"dailyProteins"),(0,l._M)("date","==",e)),r=(0,l.aQ)(t,e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));ne(t)},e=>{a(`Error al cargar prote\xednas: ${e.message}`)});return()=>r()},[a]);(0,r.useEffect)(()=>{const e=de(),t=ce();return()=>{e(),t()}},[de,ce]);const ge=(0,r.useCallback)(e=>{var t;E(e),R({meals:(null===(t=e.meals)||void 0===t?void 0:t.map(e=>{var t;return{...e,address:e.address||{},payment:e.payment?w((null===(t=e.payment)||void 0===t?void 0:t.name)||e.payment):"Efectivo",additions:e.additions||[],principle:Array.isArray(e.principle)?e.principle:e.principle?[{name:e.principle.name||e.principle}]:[],cutlery:e.cutlery||null,sides:e.sides||[]}}))||[],total:e.total||0,status:e.status||"Pendiente",payment:e.payment?w(e.payment):"Efectivo",deliveryPerson:e.deliveryPerson||""})},[]),me=async(e,t)=>{B(!0);try{await(0,l.mZ)((0,l.H9)(n.db,"orders",e),{deliveryPerson:w(t)||null,updatedAt:new Date}),b("Domiciliario asignado correctamente.")}catch(r){a(`Error al asignar domiciliario: ${r.message}`)}finally{Z(null),B(!1)}},ue=(e,t,a)=>{R(r=>{const n=[...r.meals];let l={...n[e]};if(t.startsWith("address.")){const e=t.split(".")[1];l.address={...l.address,[e]:a}}else"additions"===t?l.additions=a.split(";").map(e=>{const[t,a="",r="",n="1"]=e.split(",").map(e=>e.trim());return{name:t,protein:a,replacement:r,quantity:parseInt(n)||1}}).filter(e=>e.name):"principle"===t?l.principle=a?a.split(",").map(e=>({name:e.trim()})).filter(e=>e.name):[]:"sides"===t?l.sides=a.split(",").map(e=>({name:e.trim()})).filter(e=>e.name):"cutlery"===t?l.cutlery={name:a}:l[t]=["soup","soupReplacement","protein","drink","time","payment","principleReplacement"].includes(t)?{name:a}:a;return n[e]=l,{...r,meals:n}})},pe=(0,r.useMemo)(()=>S.map((e,t)=>({...e,originalIndex:t})).filter(e=>{var t,a;const r=T.toLowerCase(),n=(null===(t=e.id)||void 0===t?void 0:t.toLowerCase().includes(r))||!1,l=null===(a=e.meals)||void 0===a?void 0:a.some(e=>{var t,a,n,l,i,o,s,d,c,g,m,u,p,x,h;return[(null===(t=e.soup)||void 0===t?void 0:t.name)||e.soup||"",(null===(a=e.soupReplacement)||void 0===a?void 0:a.name)||e.soupReplacement||"",Array.isArray(e.principle)?e.principle.map(e=>e.name||e).join(", "):(null===(n=e.principle)||void 0===n?void 0:n.name)||e.principle||"",(null===(l=e.principleReplacement)||void 0===l?void 0:l.name)||e.principleReplacement||"",(null===(i=e.protein)||void 0===i?void 0:i.name)||e.protein||"",(null===(o=e.drink)||void 0===o?void 0:o.name)||e.drink||"",e.notes||"",(null===(s=e.time)||void 0===s?void 0:s.name)||e.time||"",(null===(d=e.payment)||void 0===d?void 0:d.name)||e.payment||"",(null===(c=e.address)||void 0===c?void 0:c.address)||"",(null===(g=e.address)||void 0===g?void 0:g.phoneNumber)||"",(null===(m=e.address)||void 0===m?void 0:m.localName)||"",(null===(u=e.address)||void 0===u?void 0:u.recipientName)||"",(null===(p=e.address)||void 0===p?void 0:p.unitDetails)||"",(null===(x=e.sides)||void 0===x?void 0:x.map(e=>e.name||e).join(", "))||"",(null===(h=e.additions)||void 0===h?void 0:h.map(e=>`${e.name||""}${e.protein||e.replacement?` (${e.protein||e.replacement})`:""} (${e.quantity||1})`).join(", "))||""].map(e=>w(e).toLowerCase()).some(e=>e.includes(r))});return n||l}).sort((e,t)=>{const a=k(e,X)||"",r=k(t,X)||"";return"total"===X?"asc"===te?(a||0)-(r||0):(r||0)-(a||0):"asc"===te?String(a).localeCompare(String(r)):String(r).localeCompare(String(a))}),[S,T,X,te]),xe=Math.ceil(pe.length/I),he=pe.slice((q-1)*I,q*I),be=re.reduce((e,t)=>e+t.quantity,0),ye=()=>{const e=((e,t,a)=>{var r,n,l;let i=0;const o=e.flatMap(e=>e&&Array.isArray(e.meals)&&0!==e.meals.length?e.meals.filter(e=>e).map(t=>{var a,r,n;return i+=1,[i,(null===t||void 0===t||null===(a=t.address)||void 0===a?void 0:a.address)||"",(null===t||void 0===t||null===(r=t.address)||void 0===r?void 0:r.phoneNumber)||"",`$${(null===(n=e.total)||void 0===n?void 0:n.toLocaleString("es-CO"))||"0"}`,(null===e||void 0===e?void 0:e.deliveryPerson)||""]}):[]);0===o.length&&o.push(Array(5).fill("-"));const s=Object.entries(a).map(e=>{var t,a,r,n;let[l,i]=e;return[l||"",`$${(null===(t=i.cash)||void 0===t?void 0:t.toLocaleString("es-CO"))||"0"}`,`$${(null===(a=i.daviplata)||void 0===a?void 0:a.toLocaleString("es-CO"))||"0"}`,`$${(null===(r=i.nequi)||void 0===r?void 0:r.toLocaleString("es-CO"))||"0"}`,`$${(null===(n=i.total)||void 0===n?void 0:n.toLocaleString("es-CO"))||"0"}`]}),d=new Date;return`\n    <html>\n      <head>\n        <title>Previsualizaci\xf3n de Pedidos</title>\n        <style>\n          body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }\n          h1 { text-align: center; font-size: 24px; }\n          p.date { text-align: center; font-size: 12px; }\n          table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n          th, td { padding: 8px; border: 1px solid black; }\n          th { background-color: #0066cc; color: white; font-weight: bold; }\n          td { text-align: left; }\n          td:nth-child(4) { text-align: right; }\n          tr:nth-child(even) { background-color: #f5f5f5; }\n          .totals-table { width: 50%; }\n          .delivery-table th:nth-child(n+2), .delivery-table td:nth-child(n+2) { text-align: right; }\n          .button-container { margin-top: 20px; text-align: center; }\n          .button { padding: 10px 20px; background-color: #0066cc; color: white; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }\n          .button.print { background-color: #28a745; }\n          @media print {\n              .button-container { display: none; }\n          }\n        </style>\n      </head>\n      <body>\n        <h1>Gesti\xf3n de Pedidos</h1>\n        <p class="date">Fecha: ${d.toLocaleDateString("es-CO")} ${d.toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit",hour12:!0})}</p>\n        <table>\n          <thead>\n            <tr>\n              <th>N</th>\n              <th>Direcci\xf3n</th>\n              <th>Tel\xe9fono</th>\n              <th>Total</th>\n              <th>Domiciliario</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${o.map(e=>`\n              <tr>\n                <td>${e[0]}</td>\n                <td>${e[1]}</td>\n                <td>${e[2]}</td>\n                <td>${e[3]}</td>\n                <td>${e[4]}</td>\n              </tr>\n            `).join("")}\n          </tbody>\n        </table>\n        <h2 style="margin-top: 20px; font-size: 18px;">Resumen de Totales</h2>\n        <table class="totals-table">\n          <tbody>\n            <tr><td style="padding: 8px;">Total Efectivo</td><td style="padding: 8px; text-align: right;">${o.length>0?`$${(null===(r=t.cash)||void 0===r?void 0:r.toLocaleString("es-CO"))||"0"}`:"$0"}</td></tr>\n            <tr><td style="padding: 8px;">Total Daviplata</td><td style="padding: 8px; text-align: right;">${o.length>0?`$${(null===(n=t.daviplata)||void 0===n?void 0:n.toLocaleString("es-CO"))||"0"}`:"$0"}</td></tr>\n            <tr><td style="padding: 8px;">Total Nequi</td><td style="padding: 8px; text-align: right;">${o.length>0?`$${(null===(l=t.nequi)||void 0===l?void 0:l.toLocaleString("es-CO"))||"0"}`:"$0"}</td></tr>\n            <tr><td style="padding: 8px;">Total General</td><td style="padding: 8px; text-align: right;">${o.length>0?`$${(t.cash+t.daviplata+t.nequi||0).toLocaleString("es-CO")}`:"$0"}</td></tr>\n          </tbody>\n        </table>\n        <h2 style="margin-top: 20px; font-size: 18px;">Resumen por Domiciliarios</h2>\n        <table class="delivery-table">\n          <thead>\n            <tr>\n              <th>Domiciliario</th>\n              <th>Efectivo</th>\n              <th>Daviplata</th>\n              <th>Nequi</th>\n              <th>Total</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${s.map(e=>`\n              <tr>\n                <td>${e[0]}</td>\n                <td>${e[1]}</td>\n                <td>${e[2]}</td>\n                <td>${e[3]}</td>\n                <td>${e[4]}</td>\n              </tr>\n            `).join("")}\n          </tbody>\n        </table>\n        <div class="button-container">\n          <button class="button print" onclick="window.print()">Imprimir</button>\n          <button class="button" onclick="window.close()">Cerrar Previsualizaci\xf3n</button>\n        </div>\n      </body>\n    </html>\n  `})(S,F,Q),t=window.open("","_blank");t.document.write(e),t.document.close()},ve=()=>{const e=function(e,t,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],l=0;const i=e.map(e=>{var t,a,r,n,i,o;l+=1;const s=(null===(t=e.meals)||void 0===t?void 0:t[0])||{},d=(null===(a=e.payment)||void 0===a?void 0:a.name)||e.payment||(null===s||void 0===s||null===(r=s.payment)||void 0===r?void 0:r.name)||(null===s||void 0===s?void 0:s.payment)||"Efectivo";return[l,(null===s||void 0===s||null===(n=s.address)||void 0===n?void 0:n.address)||"",(null===s||void 0===s||null===(i=s.address)||void 0===i?void 0:i.phoneNumber)||"",`$${(null===(o=e.total)||void 0===o?void 0:o.toLocaleString("es-CO"))||"0"}`,d,(null===e||void 0===e?void 0:e.deliveryPerson)||""]});0===i.length&&i.push(Array(6).fill("-"));const o=Object.entries(a).map(e=>{var t,a,r,n;let[l,i]=e;return[l||"",`$${(null===(t=i.cash)||void 0===t?void 0:t.toLocaleString("es-CO"))||"0"}`,`$${(null===(a=i.daviplata)||void 0===a?void 0:a.toLocaleString("es-CO"))||"0"}`,`$${(null===(r=i.nequi)||void 0===r?void 0:r.toLocaleString("es-CO"))||"0"}`,`$${(null===(n=i.total)||void 0===n?void 0:n.toLocaleString("es-CO"))||"0"}`]}),s=0===n.length?[["-","-"]]:n.map((e,t)=>{var a;const l=t===n.length-2,i=t===n.length-1;return[e.name||"Sin nombre",(null===(a=e.quantity)||void 0===a?void 0:a.toLocaleString("es-CO"))||"0",l?"TOTAL PROTE\xcdNAS:":i?"Fecha actual:":"",l?r.toLocaleString("es-CO"):i?(new Date).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}):""]}),d={cash:t.cash||0,daviplata:t.daviplata||0,nequi:t.nequi||0},c=d.cash+d.daviplata+d.nequi;return`\n    <html>\n      <head>\n        <title>Previsualizaci\xf3n de Excel</title>\n        <style>\n          body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }\n          h1 { text-align: center; font-size: 24px; }\n          table { width: 100%; border-collapse: collapse; }\n          th, td { padding: 8px; border: 1px solid black; }\n          th { background-color: #0066cc; color: white; font-weight: bold; text-align: center; font-size: 16px; }\n          td { text-align: left; vertical-align: middle; }\n          td:nth-child(4), td:nth-child(6) { text-align: right; }\n          tr:nth-child(even) { background-color: #f5f5f5; }\n          .totals-table { width: 50%; margin-left: auto; margin-right: auto; }\n\n          .proteins-container { width: auto; margin: 0 auto; max-width: 700px; }\n          .proteins-table {\n            border-collapse: collapse;\n            font-size: 14px;\n            width: 100%;\n            max-width: 700px;\n          }\n          .proteins-table th, .proteins-table td {\n            padding: 6px 12px;\n            border: 1px solid black;\n            white-space: nowrap;\n          }\n          .proteins-table th:nth-child(1), .proteins-table td:nth-child(1) { width: 160px; text-align: left; }\n          .proteins-table th:nth-child(2), .proteins-table td:nth-child(2) { width: 80px; text-align: right; }\n          .proteins-table th:nth-child(3), .proteins-table td:nth-child(3) { width: 220px; text-align: left; }\n\n          .delivery-table th { background-color: #0066cc; color: white; font-weight: bold; text-align: center; font-size: 16px; }\n          .delivery-table .green-header th { background-color: #28a745; }\n          .delivery-table td:nth-child(n+2) { text-align: right; }\n\n          .spacer { height: 16px; }\n          .button-container { margin-top: 20px; text-align: center; }\n          .button { padding: 10px 20px; background-color: #0066cc; color: white; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }\n          .button.print { background-color: #28a745; }\n          @media print { .button-container { display: none; } }\n        </style>\n      </head>\n      <body>\n        <h1>Gesti\xf3n de Pedidos</h1>\n        <div class="spacer"></div>\n\n        <div class="proteins-container">\n          <table class="proteins-table" aria-label="Resumen de prote\xednas">\n            <thead>\n              <tr>\n                <th style="background-color: #0066cc; color: white; border: 1px solid black;">Prote\xedna</th>\n                <th style="background-color: #0066cc; color: white; border: 1px solid black;">Unidades</th>\n                <th style="background-color: #0066cc; color: white; border: 1px solid black;"></th>\n              </tr>\n            </thead>\n            <tbody>\n              ${s.map((e,t)=>{const a=e[2]?`\n                  <td style="padding: 0;">\n                    <div style="display: flex; width: 100%; height: 100%;">\n                      <div style="flex: 1; padding: 6px 12px; font-weight: bold; display: flex; align-items: center;">${e[2]}</div>\n                      <div style="width: 1px; background-color: black;"></div>\n                      <div style="flex: 1; padding: 6px 12px; display: flex; justify-content: flex-end; align-items: center; font-weight: ${"TOTAL PROTE\xcdNAS:"===e[2]?"bold":"normal"};">${e[3]}</div>\n                    </div>\n                  </td>\n                `:'<td style="border: none; background-color: white;"></td>';return`\n                  <tr>\n                    <td title="${e[0]}">${e[0]}</td>\n                    <td style="text-align: right;">${e[1]}</td>\n                    ${a}\n                  </tr>\n                `}).join("")}\n            </tbody>\n          </table>\n        </div>\n\n        <div class="spacer"></div><div class="spacer"></div>\n\n        <table>\n          <thead>\n            <tr>\n              <th>N</th>\n              <th>Direcci\xf3n</th>\n              <th>Tel\xe9fono</th>\n              <th>Total</th>\n              <th>M\xe9todo de Pago</th>\n              <th>Domiciliario</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${i.map(e=>`\n              <tr>\n                <td>${e[0]}</td>\n                <td>${e[1]}</td>\n                <td>${e[2]}</td>\n                <td>${e[3]}</td>\n                <td>${e[4]}</td>\n                <td>${e[5]}</td>\n              </tr>\n            `).join("")}\n          </tbody>\n        </table>\n\n        <div class="spacer"></div><div class="spacer"></div>\n\n        <table class="totals-table">\n          <thead>\n            <tr><th colspan="2">Resumen de Totales</th></tr>\n          </thead>\n          <tbody>\n            <tr><td>Total Efectivo</td><td style="text-align: right;">$${d.cash.toLocaleString("es-CO")}</td></tr>\n            <tr><td>Total Daviplata</td><td style="text-align: right;">$${d.daviplata.toLocaleString("es-CO")}</td></tr>\n            <tr><td>Total Nequi</td><td style="text-align: right;">$${d.nequi.toLocaleString("es-CO")}</td></tr>\n            <tr><td>Total General</td><td style="text-align: right;">$${c.toLocaleString("es-CO")}</td></tr>\n          </tbody>\n        </table>\n\n        <div class="spacer"></div><div class="spacer"></div>\n\n        <table class="delivery-table">\n          <thead>\n            <tr><th colspan="5">Resumen por Domiciliarios</th></tr>\n            <tr class="green-header">\n              <th>Domiciliario</th>\n              <th>Efectivo</th>\n              <th>Daviplata</th>\n              <th>Nequi</th>\n              <th>Total</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${o.map(e=>`\n              <tr>\n                <td>${e[0]}</td>\n                <td>${e[1]}</td>\n                <td>${e[2]}</td>\n                <td>${e[3]}</td>\n                <td>${e[4]}</td>\n              </tr>\n            `).join("")}\n          </tbody>\n        </table>\n\n        <div class="button-container">\n          <button class="button print" onclick="window.print()">Imprimir</button>\n          <button class="button" onclick="window.close()">Cerrar Previsualizaci\xf3n</button>\n          <button class="button" onclick="window.opener.postMessage('downloadExcel', '*')">Descargar Excel</button>\n        </div>\n      </body>\n    </html>\n  `}(S,F,Q,be,re),t=window.open("","_blank");t.document.write(e),t.document.close()},fe=e=>{X===e?ae("asc"===te?"desc":"asc"):(ee(e),ae("asc"))},Ne=e=>X!==e?null:"asc"===te?(0,j.jsx)(i.A,{className:"w-4 h-4 inline ml-1"}):(0,j.jsx)(o.A,{className:"w-4 h-4 inline ml-1"});return(0,j.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,j.jsx)("style",{children:".headlessui-menu-items { z-index: 50 !important; }"}),(0,j.jsx)("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100 mb-6",children:"Gesti\xf3n de Pedidos"}),(0,j.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6 text-sm text-gray-700 dark:text-gray-300",children:[(0,j.jsxs)("div",{className:h("p-4 rounded-lg shadow-sm","dark"===f?"bg-gray-700":"bg-gray-100"),children:[(0,j.jsx)("p",{className:"font-semibold",children:"Total Efectivo"}),(0,j.jsxs)("p",{className:"text-lg font-bold",children:["$",F.cash.toLocaleString("es-CO")]})]}),(0,j.jsxs)("div",{className:h("p-4 rounded-lg shadow-sm","dark"===f?"bg-gray-700":"bg-gray-100"),children:[(0,j.jsx)("p",{className:"font-semibold",children:"Total Daviplata"}),(0,j.jsxs)("p",{className:"text-lg font-bold",children:["$",F.daviplata.toLocaleString("es-CO")]})]}),(0,j.jsxs)("div",{className:h("p-4 rounded-lg shadow-sm","dark"===f?"bg-gray-700":"bg-gray-100"),children:[(0,j.jsx)("p",{className:"font-semibold",children:"Total Nequi"}),(0,j.jsxs)("p",{className:"text-lg font-bold",children:["$",F.nequi.toLocaleString("es-CO")]})]}),(0,j.jsxs)("div",{className:h("p-4 rounded-lg shadow-sm","dark"===f?"bg-gray-700":"bg-gray-100"),children:[(0,j.jsx)("p",{className:"font-semibold",children:"Total General"}),(0,j.jsxs)("p",{className:"text-lg font-bold",children:["$",(F.cash+F.daviplata+F.nequi).toLocaleString("es-CO")]})]})]}),(0,j.jsx)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6 gap-4",children:(0,j.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 w-full sm:w-auto",children:[(0,j.jsx)("input",{type:"text",value:T,onChange:e=>O(e.target.value),placeholder:"Buscar pedidos...",className:h("p-3 rounded-lg border focus:outline-none focus:ring-2 focus:ring-blue-500 w-full sm:w-96 shadow-sm text-base transition-all duration-200","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900")}),(0,j.jsxs)("div",{className:"relative z-60 flex items-center gap-4",children:[(0,j.jsxs)("button",{onClick:()=>se(!0),className:h("flex items-center p-3 rounded-lg shadow-sm text-sm font-medium transition-all duration-200","dark"===f?"bg-gray-700 text-white hover:bg-gray-600":"bg-gray-100 text-gray-900 hover:bg-gray-200"),children:[(0,j.jsx)(s.A,{className:"w-5 h-5 mr-2"}),"Prote\xednas del D\xeda"]}),(0,j.jsxs)("span",{className:h("flex items-center p-3 rounded-lg shadow-sm text-sm font-medium transition-all duration-200","dark"===f?"bg-gray-700 text-gray-200 hover:bg-gray-600":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Fecha: ",(new Date).toLocaleDateString("es-CO",{day:"numeric",month:"long",year:"numeric"})]}),(0,j.jsx)("div",{className:"relative",children:(0,j.jsxs)(x.W1,{children:[(0,j.jsxs)(x.IU,{className:h("flex items-center p-2 transition-all duration-200","dark"===f?"text-gray-300 hover:text-gray-200":"text-gray-700 hover:text-gray-900"),children:[(0,j.jsx)("span",{className:"sr-only",children:"Abrir men\xfa de opciones"}),(0,j.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,j.jsx)("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zm0 6a2 2 0 110-4 2 2 0 010 4zm0 6a2 2 0 110-4 2 2 0 010 4z"})})]}),(0,j.jsxs)(x.c,{className:"absolute top-full right-0 mt-2 w-48 origin-top-right rounded-md bg-white dark:bg-gray-800 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-50",children:[(0,j.jsx)(x.Dr,{children:e=>{let{active:t}=e;return(0,j.jsx)("button",{onClick:()=>(async(e,t,a,r,n)=>{try{const l=new(y().Workbook),i=l.addWorksheet("Gesti\xf3n de Pedidos"),o=e=>null==e?"":"string"===typeof e?e.replace(" NUEVO","").trim():"boolean"===typeof e?e.toString():"object"===typeof e&&null!==e&&void 0!==e&&e.name?e.name.replace(" NUEVO","").trim():String(e).replace(" NUEVO","").trim(),s=e=>{e.border={top:{style:"thin",color:{argb:"FF000000"}},left:{style:"thin",color:{argb:"FF000000"}},bottom:{style:"thin",color:{argb:"FF000000"}},right:{style:"thin",color:{argb:"FF000000"}}}};i.addRow(["","PROTE\xcdNAS DEL D\xcdA"]);const d=i.lastRow.number;i.mergeCells(d,2,d,3);const c=i.getCell(`B${d}`);c.font={bold:!0,color:{argb:"FFFFFFFF"}},c.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF0066CC"}},c.alignment={horizontal:"center"},i.getRow(d+1).values=["","Prote\xedna","Unidades","",""],i.getRow(d+1).eachCell((e,t)=>{2!==t&&3!==t||(e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF28A745"}},e.font={color:{argb:"FFFFFFFF"},bold:!0},e.alignment={horizontal:"center"},s(e)),4!==t&&5!==t||(e.value="")});const g=0===n.length?[{name:"-",quantity:"-",extra:"",extraValue:""}]:[...n.slice(0,-2),{name:n[n.length-2].name,quantity:n[n.length-2].quantity,extra:"TOTAL PROTE\xcdNAS:",extraValue:r.toLocaleString("es-CO")},{name:n[n.length-1].name,quantity:n[n.length-1].quantity,extra:"Fecha actual:",extraValue:`${String((new Date).getDate()).padStart(2,"0")}/${String((new Date).getMonth()+1).padStart(2,"0")}/${(new Date).getFullYear()}`}];g.forEach((e,t)=>{i.addRow(["",e.name,e.quantity,e.extra,e.extraValue]).eachCell((e,a)=>{a>=2&&((t>=g.length-2||2===a||3===a)&&s(e),3===a&&(e.numFmt="#,##0",e.alignment={horizontal:"right"}),4===a&&(e.alignment={horizontal:"left"}),5===a&&(e.alignment={horizontal:"right"}))})}),i.addRow({}),i.addRow({});let m=0;const u=e.map(e=>{var t,a,r,n;m+=1;const l=(null===(t=e.meals)||void 0===t?void 0:t[0])||{};return{N:m,"Direcci\xf3n":o(null===(a=l.address)||void 0===a?void 0:a.address),"Tel\xe9fono":o(null===(r=l.address)||void 0===r?void 0:r.phoneNumber),Total:e.total||0,"M\xe9todoDePago":o(e.payment||(null===(n=l.payment)||void 0===n?void 0:n.name)||l.payment||"Efectivo"),Domiciliario:o(e.deliveryPerson)}});0===u.length&&u.push({N:"-","Direcci\xf3n":"-","Tel\xe9fono":"-",Total:"-","M\xe9todoDePago":"-",Domiciliario:"-"}),i.columns=[{key:"N",width:10},{key:"Direcci\xf3n",width:30},{key:"Tel\xe9fono",width:15},{key:"Total",width:15},{key:"M\xe9todoDePago",width:15},{key:"Domiciliario",width:25}];const p=g.length+4,x=i.getRow(p);x.values=["N","Direcci\xf3n","Tel\xe9fono","Total","M\xe9todo de Pago","Domiciliario"],x.eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF0066CC"}},e.font={color:{argb:"FFFFFFFF"},bold:!0},e.alignment={horizontal:"center"},s(e)}),u.forEach(e=>{i.addRow(e).eachCell(e=>s(e))}),i.addRow({}),i.addRow({}),i.addRow([]);const h=i.lastRow.number;i.getCell(`C${h}`).value="Resumen de Totales",i.mergeCells(`C${h}:D${h}`);const b=i.getCell(`C${h}`);b.font={bold:!0,color:{argb:"FFFFFFFF"}},b.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF0066CC"}},b.alignment={horizontal:"center"},s(b),s(i.getCell(`D${h}`)),[["Total Efectivo",t.cash||0],["Total Daviplata",t.daviplata||0],["Total Nequi",t.nequi||0],["Total General",t.cash+t.daviplata+t.nequi||0]].forEach(e=>{let[t,a]=e;const r=i.addRow(["","",t,a]);r.getCell(3).alignment={horizontal:"left"},r.getCell(4).alignment={horizontal:"right"},r.getCell(4).numFmt="$#,##0",r.getCell(4).font={bold:!0},s(r.getCell(3)),s(r.getCell(4))}),i.addRow({}),i.addRow({}),i.addRow(["","Resumen por Domiciliarios"]);const v=i.lastRow.number;i.mergeCells(v,2,v,6);const f=i.getCell(`B${v}`);f.font={bold:!0,color:{argb:"FFFFFFFF"}},f.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF0066CC"}},f.alignment={horizontal:"center"};for(let e=2;e<=6;e++)s(i.getCell(v,e));i.addRow(["","Domiciliario","Efectivo","Daviplata","Nequi","Total"]),i.lastRow.eachCell((e,t)=>{t>=2&&(e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF28A745"}},e.font={color:{argb:"FFFFFFFF"},bold:!0},e.alignment={horizontal:"center"},s(e))}),Object.entries(a).forEach(e=>{let[t,a]=e;i.addRow(["",o(t),a.cash||0,a.daviplata||0,a.nequi||0,a.total||0]).eachCell((e,t)=>{t>=2&&(t>=3&&(e.numFmt="$#,##0",e.alignment={horizontal:"right"}),s(e))})});const N=await l.xlsx.writeBuffer(),j=new Blob([N],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),w=document.createElement("a");w.href=window.URL.createObjectURL(j),w.download=`pedidos_${(new Date).toISOString().slice(0,10)}.xlsx`,document.body.appendChild(w),w.click(),document.body.removeChild(w)}catch(l){console.error("Error al exportar Excel:",l),alert("Error al generar el archivo Excel: "+l.message)}})(S,F,Q,be,re),className:h("group flex rounded-t-md items-center w-full px-2 py-2 text-sm",t?"dark"===f?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-900":"dark"===f?"bg-gray-800 text-gray-200":"bg-white text-gray-900"),children:"Exportar a Excel"})}}),(0,j.jsx)(x.Dr,{children:e=>{let{active:t}=e;return(0,j.jsx)("button",{onClick:()=>async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{var r,n,l;const o=new v.default,s="/logo.png";try{o.addImage(s,"PNG",160,10,30,20)}catch(i){console.warn("No se pudo cargar el logo para el PDF:",i)}o.setFontSize(16),o.text("Gesti\xf3n de Pedidos",14,20),o.setFontSize(12);const d=new Date,c=d.toLocaleDateString("es-CO"),g=d.toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit",hour12:!0});o.text(`Fecha: ${c} ${g}`,14,30);let m=0;const u=e.map(e=>{var t,a,r,n,l,i;m+=1;const o=(null===(t=e.meals)||void 0===t?void 0:t[0])||{},s=(null===(a=e.payment)||void 0===a?void 0:a.name)||e.payment||(null===(r=o.payment)||void 0===r?void 0:r.name)||o.payment||"Efectivo";return[m,(null===(n=o.address)||void 0===n?void 0:n.address)||"",(null===(l=o.address)||void 0===l?void 0:l.phoneNumber)||"",`$${(null===(i=e.total)||void 0===i?void 0:i.toLocaleString("es-CO"))||"0"}`,s,(null===e||void 0===e?void 0:e.deliveryPerson)||""]});0===u.length&&u.push(Array(6).fill("-")),0===u.length&&u.push(Array(5).fill("-")),N()(o,{startY:40,head:[["N","Direcci\xf3n","Tel\xe9fono","Total","Domiciliario"]],body:u,styles:{fontSize:8,cellPadding:2,overflow:"linebreak"},headStyles:{fillColor:[0,102,204],textColor:255,fontStyle:"bold",lineWidth:.2,lineColor:[0,0,0]},alternateRowStyles:{fillColor:[245,245,245]},columnStyles:{1:{cellWidth:"wrap"},3:{halign:"right"}},tableLineColor:[0,0,0],tableLineWidth:.2,didDrawPage:e=>{o.setFontSize(10),o.text(`P\xe1gina ${e.pageNumber}`,180,287)}});const p=o.lastAutoTable.finalY+10;o.setFontSize(14),o.text("Resumen de Totales",14,p),N()(o,{startY:p+5,head:[["Concepto","Monto"]],body:[["Total Efectivo",`$${(null===(r=t.cash)||void 0===r?void 0:r.toLocaleString("es-CO"))||"0"}`],["Total Daviplata",`$${(null===(n=t.daviplata)||void 0===n?void 0:n.toLocaleString("es-CO"))||"0"}`],["Total Nequi",`$${(null===(l=t.nequi)||void 0===l?void 0:l.toLocaleString("es-CO"))||"0"}`],["Total General",`$${(t.cash+t.daviplata+t.nequi||0).toLocaleString("es-CO")}`]],styles:{fontSize:10,cellPadding:2,overflow:"linebreak"},headStyles:{fillColor:[0,102,204],textColor:255,fontStyle:"bold",lineWidth:.2,lineColor:[0,0,0]},columnStyles:{1:{halign:"right"}},tableLineColor:[0,0,0],tableLineWidth:.2});const x=o.lastAutoTable.finalY+10;o.setFontSize(14),o.text("Resumen por Domiciliarios",14,x);const h=Object.entries(a).map(e=>{var t,a,r,n;let[l,i]=e;return[l||"",`$${(null===(t=i.cash)||void 0===t?void 0:t.toLocaleString("es-CO"))||"0"}`,`$${(null===(a=i.daviplata)||void 0===a?void 0:a.toLocaleString("es-CO"))||"0"}`,`$${(null===(r=i.nequi)||void 0===r?void 0:r.toLocaleString("es-CO"))||"0"}`,`$${(null===(n=i.total)||void 0===n?void 0:n.toLocaleString("es-CO"))||"0"}`]});N()(o,{startY:x+5,head:[["Domiciliario","Efectivo","Daviplata","Nequi","Total"]],body:h.length>0?h:[["-","-","-","-","-"]],styles:{fontSize:8,cellPadding:2,overflow:"linebreak"},headStyles:{fillColor:[0,102,204],textColor:255,fontStyle:"bold",lineWidth:.2,lineColor:[0,0,0]},columnStyles:{1:{halign:"right"},2:{halign:"right"},3:{halign:"right"},4:{halign:"right"}},tableLineColor:[0,0,0],tableLineWidth:.2}),o.save(`pedidos_${(new Date).toISOString().split("T")[0]}.pdf`)}catch(o){console.error("Error al generar el PDF:",o),alert("Error al generar el PDF: "+o.message)}}(S,F,Q),className:h("group flex items-center w-full px-2 py-2 text-sm",t?"dark"===f?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-900":"dark"===f?"bg-gray-800 text-gray-200":"bg-white text-gray-900"),children:"Exportar a PDF"})}}),(0,j.jsx)(x.Dr,{children:e=>{let{active:t}=e;return(0,j.jsx)("button",{onClick:ye,className:h("group flex items-center w-full px-2 py-2 text-sm",t?"dark"===f?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-900":"dark"===f?"bg-gray-800 text-gray-200":"bg-white text-gray-900"),children:"Previsualizar (HTML)"})}}),(0,j.jsx)(x.Dr,{children:e=>{let{active:t}=e;return(0,j.jsx)("button",{onClick:ve,className:h("group flex items-center w-full px-2 py-2 text-sm",t?"dark"===f?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-900":"dark"===f?"bg-gray-800 text-gray-200":"bg-white text-gray-900"),children:"Previsualizar Excel"})}}),(0,j.jsx)(x.Dr,{children:e=>{let{active:t}=e;return(0,j.jsx)("button",{onClick:()=>((e,t,a,r)=>{const n=e.flatMap(e=>e.meals.map((t,a)=>{var r,n,l,i,o,s,d,c,g,m,u,p,x,h,b,y;return[e.id,a+1,(null===(r=t.soup)||void 0===r?void 0:r.name)||t.soup||"Sin sopa",Array.isArray(t.principle)?t.principle.map(e=>e.name||e).join(", "):(null===(n=t.principle)||void 0===n?void 0:n.name)||t.principle||"Sin principio",(null===(l=t.protein)||void 0===l?void 0:l.name)||t.protein||"Sin prote\xedna",(null===(i=t.drink)||void 0===i?void 0:i.name)||t.drink||"Sin bebida",(null===(o=t.cutlery)||void 0===o?void 0:o.name)||t.cutlery||"No",(null===(s=t.sides)||void 0===s?void 0:s.map(e=>e.name||e).join(", "))||"Ninguno",(null===(d=t.additions)||void 0===d?void 0:d.map(e=>`${e.name||""}${e.protein||e.replacement?` (${e.protein||e.replacement})`:""} (${e.quantity||1})`).join(", "))||"Ninguna",t.notes||"Ninguna",(null===(c=t.time)||void 0===c?void 0:c.name)||t.time||"No especificada",(null===(g=t.address)||void 0===g?void 0:g.address)||"Sin direcci\xf3n",(null===(m=t.address)||void 0===m?void 0:m.addressType)||"No especificado",(null===(u=t.address)||void 0===u?void 0:u.localName)||"",(null===(p=t.address)||void 0===p?void 0:p.recipientName)||"",(null===(x=t.address)||void 0===x?void 0:x.unitDetails)||"",(null===(h=t.address)||void 0===h?void 0:h.phoneNumber)||"No especificado",(null===(b=t.payment)||void 0===b?void 0:b.name)||t.payment||"Efectivo",`$${(null===(y=e.total)||void 0===y?void 0:y.toLocaleString("es-CO"))||"0"}`,e.payment||"Efectivo",e.deliveryPerson||"Sin asignar",e.status||"Pendiente",e.createdAt?new Date(1e3*e.createdAt.seconds).toLocaleString("es-CO"):"N/A",e.updatedAt?new Date(1e3*e.updatedAt.seconds).toLocaleString("es-CO"):"N/A"].map(e=>`"${String(e||"").replace(/"/g,'""')}"`)})),l=[["Total Efectivo",`$${t.cash.toLocaleString("es-CO")}`],["Total Daviplata",`$${t.daviplata.toLocaleString("es-CO")}`],["Total Nequi",`$${t.nequi.toLocaleString("es-CO")}`],["Total General",`$${(t.cash+t.daviplata+t.nequi).toLocaleString("es-CO")}`]].map(e=>e.map(e=>`"${String(e||"").replace(/"/g,'""')}"`)),i=Object.entries(a).map(e=>{let[t,a]=e;return[t,`$${a.cash.toLocaleString("es-CO")}`,`$${a.daviplata.toLocaleString("es-CO")}`,`$${a.nequi.toLocaleString("es-CO")}`,`$${a.total.toLocaleString("es-CO")}`].map(e=>`"${String(e||"").replace(/"/g,'""')}"`)}),o=[["ID Pedido","N\xba Bandeja","Sopa","Principio","Prote\xedna","Bebida","Cubiertos","Acompa\xf1amientos","Adiciones","Notas","Hora de Entrega","Direcci\xf3n","Tipo de Lugar","Nombre del Local","Nombre del Destinatario","Detalles de Unidad","Tel\xe9fono","Pago (Bandeja)","Total (COP)","Pago (General)","Domiciliario","Estado","Fecha de Creaci\xf3n","\xdaltima Actualizaci\xf3n"].join(","),...n,"",'"Resumen de Totales"','"Concepto","Monto (COP)"',...l,'"Resumen por Domiciliarios"','"Domiciliario","Efectivo (COP)","Daviplata (COP)","Nequi (COP)","Total (COP)"',...i].join("\n"),s=new Blob([o],{type:"text/csv;charset=utf-8;"}),d=window.URL.createObjectURL(s),c=document.createElement("a");c.href=d,c.download=`pedidos_${(new Date).toISOString().split("T")[0]}.csv`,c.click(),window.URL.revokeObjectURL(d),r("Pedidos exportados a CSV.")})(S,F,Q,b),className:h("group flex items-center w-full px-2 py-2 text-sm",t?"dark"===f?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-900":"dark"===f?"bg-gray-800 text-gray-200":"bg-white text-gray-900"),children:"Exportar a CSV"})}}),(0,j.jsx)(x.Dr,{children:e=>{let{active:t}=e;return(0,j.jsx)("button",{onClick:()=>V(!0),className:h("group flex rounded-b-md items-center w-full px-2 py-2 text-sm",t?"dark"===f?"bg-gray-700 text-red-400":"bg-gray-100 text-red-600":"dark"===f?"bg-gray-800 text-red-400":"bg-white text-red-600"),children:"Borrar Todos"})}})]})]})})]})]})}),oe&&(0,j.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 animate-fadeIn",role:"dialog","aria-modal":"true","aria-labelledby":"protein-modal-title",children:(0,j.jsxs)("div",{className:h("p-6 sm:p-8 rounded-2xl shadow-2xl w-full max-w-md max-h-[85vh] overflow-y-auto transition-all duration-300 transform scale-95 animate-scaleIn","dark"===f?"bg-gray-800":"bg-white"),children:[(0,j.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,j.jsx)("h2",{id:"protein-modal-title",className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"Prote\xednas del D\xeda"}),(0,j.jsx)("button",{onClick:()=>{se(!1),ie({name:"",quantity:""})},className:"text-gray-400 hover:text-gray-200 transition-colors duration-150 p-1 rounded-full","aria-label":"Cerrar modal de prote\xednas",children:(0,j.jsx)(d.A,{className:"h-6 w-6"})})]}),(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Nombre de Prote\xedna:"}),(0,j.jsx)("input",{type:"text",value:le.name,onChange:e=>ie({...le,name:e.target.value}),placeholder:"Ej: Pollo",className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-gray-50 text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Unidades:"}),(0,j.jsx)("input",{type:"number",value:le.quantity,onChange:e=>ie({...le,quantity:e.target.value}),placeholder:"Ej: 10",min:"1",className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-gray-50 text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]})]}),(0,j.jsx)("button",{onClick:async()=>{if(!le.name||!le.quantity||isNaN(le.quantity)||Number(le.quantity)<=0)a("Por favor, ingrese un nombre de prote\xedna v\xe1lido y una cantidad mayor a 0.");else{B(!0);try{await(0,l.gS)((0,l.rJ)(n.db,"dailyProteins"),{name:le.name.trim(),quantity:Number(le.quantity),date:(new Date).toISOString().split("T")[0],createdAt:new Date}),ie({name:"",quantity:""}),se(!1),b("Prote\xedna agregada correctamente.")}catch(e){a(`Error al agregar prote\xedna: ${e.message}`)}finally{B(!1)}}},className:h("w-full bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-lg shadow-md transition-all duration-200 text-sm font-medium",U?"opacity-50 cursor-not-allowed":""),disabled:U,children:U?"Agregando...":"Agregar Prote\xedna"}),(0,j.jsxs)("div",{className:"mt-4",children:[(0,j.jsx)("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Lista de Prote\xednas"}),0===re.length?(0,j.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No hay prote\xednas registradas para hoy."}):(0,j.jsx)("ul",{className:"space-y-2",children:re.map(e=>(0,j.jsxs)("li",{className:h("p-2 rounded-lg","dark"===f?"bg-gray-700":"bg-gray-50"),children:[e.name,": ",e.quantity," unidades"]},e.id))}),(0,j.jsxs)("p",{className:"mt-4 text-gray-700 dark:text-gray-300 font-semibold",children:["Total de unidades: ",be]})]})]}),(0,j.jsx)("button",{onClick:()=>{se(!1),ie({name:"",quantity:""})},className:"mt-4 w-full bg-gray-600 hover:bg-gray-700 text-white p-3 rounded-lg shadow-md transition-all duration-200 text-sm font-medium",children:"Cerrar"})]})}),(0,j.jsx)("div",{className:h("p-4 rounded-2xl shadow-xl max-h-[70vh] overflow-y-auto custom-scrollbar transition-all duration-300","dark"===f?"bg-gray-800":"bg-white"),children:U?(0,j.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,j.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-4 border-blue-500"})}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:"overflow-x-auto",children:(0,j.jsxs)("table",{className:"min-w-full text-left border-collapse text-sm",children:[(0,j.jsx)("thead",{children:(0,j.jsxs)("tr",{className:h("font-semibold sticky top-0 z-10 shadow-sm","dark"===f?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700"),children:[(0,j.jsxs)("th",{className:"p-3 border-b cursor-pointer",onClick:()=>fe("orderNumber"),children:["N\xba ",Ne("orderNumber")]}),(0,j.jsx)("th",{className:"p-3 border-b",children:"Detalles"}),(0,j.jsxs)("th",{className:"p-3 border-b cursor-pointer",onClick:()=>fe("meals.0.address.address"),children:["Direcci\xf3n ",Ne("meals.0.address.address")]}),(0,j.jsxs)("th",{className:"p-3 border-b cursor-pointer",onClick:()=>fe("meals.0.address.phoneNumber"),children:["Tel\xe9fono ",Ne("meals.0.address.phoneNumber")]}),(0,j.jsxs)("th",{className:"p-3 border-b cursor-pointer",onClick:()=>fe("meals.0.time.name"),children:["Hora ",Ne("meals.0.time.name")]}),(0,j.jsxs)("th",{className:"p-3 border-b cursor-pointer",onClick:()=>fe("payment"),children:["Pago ",Ne("payment")]}),(0,j.jsxs)("th",{className:"p-3 border-b cursor-pointer",onClick:()=>fe("total"),children:["Total ",Ne("total")]}),(0,j.jsxs)("th",{className:"p-3 border-b cursor-pointer",onClick:()=>fe("deliveryPerson"),children:["Domiciliario ",Ne("deliveryPerson")]}),(0,j.jsxs)("th",{className:"p-3 border-b cursor-pointer",onClick:()=>fe("status"),children:["Estado ",Ne("status")]}),(0,j.jsx)("th",{className:"p-3 border-b",children:"Acciones"})]})}),(0,j.jsx)("tbody",{children:0===he.length?(0,j.jsx)("tr",{children:(0,j.jsx)("td",{colSpan:"10",className:"p-6 text-center text-gray-500 dark:text-gray-400",children:"No se encontraron pedidos. Intenta ajustar tu b\xfasqueda o filtros."})}):he.map((e,t)=>{var r,i,o,s,d,u,p,x,y,v,N,k,$,S,P,D;const E="asc"===te?(q-1)*I+t+1:pe.length-((q-1)*I+t),T=C(null===(r=e.meals)||void 0===r||null===(i=r[0])||void 0===i?void 0:i.address),O=w(e.payment||(null===(o=e.meals)||void 0===o||null===(s=o[0])||void 0===s||null===(d=s.payment)||void 0===d?void 0:d.name)||(null===(u=e.meals)||void 0===u||null===(p=u[0])||void 0===p?void 0:p.payment)||"Sin pago"),F="Pendiente"===e.status?"bg-yellow-500 text-black":"Entregado"===e.status?"bg-green-500 text-white":"Cancelado"===e.status?"bg-red-500 text-white":"";return(0,j.jsxs)("tr",{className:h("border-b transition-colors duration-150","dark"===f?"border-gray-700 hover:bg-gray-700":"border-gray-200 hover:bg-gray-50",t%2===0?"dark"===f?"bg-gray-750":"bg-gray-50":""),children:[(0,j.jsx)("td",{className:"p-3 text-gray-900 dark:text-gray-300 font-semibold",children:E}),(0,j.jsx)("td",{className:"p-3 text-gray-900 dark:text-gray-300",children:(0,j.jsx)("div",{className:"flex items-center h-full",children:(0,j.jsx)("button",{onClick:()=>Y(e),className:"text-blue-500 hover:text-blue-400 transition-colors duration-150 p-1 rounded-md",title:"Ver detalles de la bandeja","aria-label":`Ver detalles del pedido ${e.id}`,children:(0,j.jsx)(c.A,{className:"w-5 h-5"})})})}),(0,j.jsx)("td",{className:"p-3 text-gray-900 dark:text-gray-300 max-w-[200px] truncate",title:T,children:T}),(0,j.jsx)("td",{className:"p-3 text-gray-900 dark:text-gray-300",children:w(null===(x=e.meals)||void 0===x||null===(y=x[0])||void 0===y||null===(v=y.address)||void 0===v?void 0:v.phoneNumber)}),(0,j.jsx)("td",{className:"p-3 text-gray-900 dark:text-gray-300",children:w((null===(N=e.meals)||void 0===N||null===(k=N[0])||void 0===k||null===($=k.time)||void 0===$?void 0:$.name)||(null===(S=e.meals)||void 0===S||null===(P=S[0])||void 0===P?void 0:P.time))}),(0,j.jsx)("td",{className:"p-3 text-gray-900 dark:text-gray-300",children:O}),(0,j.jsxs)("td",{className:"p-3 text-gray-900 dark:text-gray-300 font-medium",children:["$",(null===(D=e.total)||void 0===D?void 0:D.toLocaleString("es-CO"))||"0"]}),(0,j.jsx)("td",{className:"p-3 text-gray-900 dark:text-gray-300",children:_===e.id?(0,j.jsx)("input",{type:"text",value:A.deliveryPerson||"",onChange:e=>R({...A,deliveryPerson:e.target.value}),onBlur:t=>me(e.id,t.target.value),onKeyPress:t=>"Enter"===t.key&&me(e.id,t.target.value),className:h("w-full p-2 rounded-lg border text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-gray-200 text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500"),autoFocus:!0,"aria-label":`Editar domiciliario para pedido ${e.id}`}):(0,j.jsx)("span",{onClick:()=>{Z(e.id),R(t=>({...t,deliveryPerson:e.deliveryPerson||""}))},className:"cursor-pointer hover:underline",title:"Click para editar",children:e.deliveryPerson||"Sin asignar"})}),(0,j.jsx)("td",{className:"p-3 text-gray-900 dark:text-gray-300",children:(0,j.jsxs)("select",{value:e.status||"Pendiente",onChange:t=>(async(e,t)=>{B(!0);try{await(0,l.mZ)((0,l.H9)(n.db,"orders",e),{status:t,updatedAt:new Date}),b("Estado actualizado correctamente.")}catch(r){a(`Error al actualizar estado: ${r.message}`)}finally{B(!1)}})(e.id,t.target.value),className:h("p-2 rounded-lg text-xs font-medium border focus:outline-none focus:ring-2 focus:ring-blue-500",F,"dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900"),"aria-label":`Cambiar estado del pedido ${e.id}`,children:[(0,j.jsx)("option",{value:"Pendiente",children:"Pendiente"}),(0,j.jsx)("option",{value:"En Preparaci\xf3n",children:"En Preparaci\xf3n"}),(0,j.jsx)("option",{value:"En Camino",children:"En Camino"}),(0,j.jsx)("option",{value:"Entregado",children:"Entregado"}),(0,j.jsx)("option",{value:"Cancelado",children:"Cancelado"})]})}),(0,j.jsxs)("td",{className:"p-3 flex space-x-2 items-center",children:[(0,j.jsx)("button",{onClick:()=>ge(e),className:"text-blue-500 hover:text-blue-400 transition-colors duration-150 p-1 rounded-md",title:"Editar pedido","aria-label":`Editar pedido ${e.id}`,children:(0,j.jsx)(g.A,{className:"w-5 h-5"})}),(0,j.jsx)("button",{onClick:()=>(async e=>{B(!0);try{await(0,l.kd)((0,l.H9)(n.db,"orders",e)),b("Pedido eliminado correctamente.")}catch(t){a(`Error al eliminar: ${t.message}`)}finally{B(!1)}})(e.id),className:"text-red-500 hover:text-red-400 transition-colors duration-150 p-1 rounded-md",title:"Eliminar pedido","aria-label":`Eliminar pedido ${e.id}`,children:(0,j.jsx)(m.A,{className:"w-5 h-5"})})]})]},e.id)})})]})}),(0,j.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center mt-6 gap-4",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Pedidos por p\xe1gina:"}),(0,j.jsxs)("select",{value:I,onChange:e=>{M(Number(e.target.value)),z(1)},className:h("p-2 rounded-lg border text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900"),"aria-label":"Seleccionar n\xfamero de pedidos por p\xe1gina",children:[(0,j.jsx)("option",{value:10,children:"10"}),(0,j.jsx)("option",{value:20,children:"20"}),(0,j.jsx)("option",{value:30,children:"30"}),(0,j.jsx)("option",{value:50,children:"50"})]})]}),(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)("button",{onClick:()=>z(e=>Math.max(e-1,1)),disabled:1===q,className:h("p-2 rounded-lg transition-all duration-200",1===q?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"),"aria-label":"P\xe1gina anterior",children:(0,j.jsx)(u.A,{className:"w-5 h-5"})}),(0,j.jsxs)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["P\xe1gina ",q," de ",xe]}),(0,j.jsx)("button",{onClick:()=>z(e=>Math.min(e+1,xe)),disabled:q===xe,className:h("p-2 rounded-lg transition-all duration-200",q===xe?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"),"aria-label":"P\xe1gina siguiente",children:(0,j.jsx)(p.A,{className:"w-5 h-5"})})]})]})]})}),(0,j.jsxs)("div",{className:"mt-8",children:[(0,j.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 mb-4",children:"Resumen por Domiciliarios"}),(0,j.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:0===Object.keys(Q).length?(0,j.jsx)("p",{className:"col-span-full text-center text-gray-500 dark:text-gray-400 p-4",children:"No hay datos de domiciliarios disponibles."}):Object.entries(Q).map(e=>{let[t,a]=e;return(0,j.jsxs)("div",{className:h("p-5 rounded-lg shadow-md","dark"===f?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700"),children:[(0,j.jsx)("p",{className:"font-semibold text-lg mb-2",children:t}),(0,j.jsxs)("p",{className:"text-base",children:["Efectivo: ",(0,j.jsxs)("span",{className:"font-medium",children:["$",a.cash.toLocaleString("es-CO")]})]}),(0,j.jsxs)("p",{className:"text-base",children:["Daviplata: ",(0,j.jsxs)("span",{className:"font-medium",children:["$",a.daviplata.toLocaleString("es-CO")]})]}),(0,j.jsxs)("p",{className:"text-base",children:["Nequi: ",(0,j.jsxs)("span",{className:"font-medium",children:["$",a.nequi.toLocaleString("es-CO")]})]}),(0,j.jsxs)("p",{className:"text-base font-bold mt-2",children:["Total: ",(0,j.jsxs)("span",{className:"text-blue-500",children:["$",a.total.toLocaleString("es-CO")]})]})]},t)})})]}),J&&(0,j.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 animate-fadeIn",role:"dialog","aria-modal":"true","aria-labelledby":"meal-details-title",children:(0,j.jsxs)("div",{className:h("p-6 sm:p-8 rounded-2xl shadow-2xl w-full max-w-md max-h-[85vh] overflow-y-auto transition-all duration-300 transform scale-95 animate-scaleIn","dark"===f?"bg-gray-800":"bg-white"),children:[(0,j.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,j.jsxs)("h2",{id:"meal-details-title",className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:["Detalles del Pedido #",J.id]}),(0,j.jsx)("button",{onClick:()=>Y(null),className:"text-gray-400 hover:text-gray-200 transition-colors duration-150 p-1 rounded-full","aria-label":"Cerrar detalles del pedido",children:(0,j.jsx)(d.A,{className:"h-6 w-6"})})]}),(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Estado:"}),(0,j.jsx)("span",{className:h("px-3 py-1 rounded-full text-sm font-medium","Pendiente"===J.status?"bg-yellow-500 text-black":"Entregado"===J.status?"bg-green-500 text-white":"bg-red-500 text-white"),children:J.status||"Pendiente"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Fecha de Creaci\xf3n:"}),(0,j.jsx)("p",{className:"text-gray-900 dark:text-gray-100",children:J.createdAt?new Date(1e3*J.createdAt.seconds).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Total del Pedido:"}),(0,j.jsxs)("p",{className:"text-gray-900 dark:text-gray-100 font-bold text-lg",children:["$",(null===(t=J.total)||void 0===t?void 0:t.toLocaleString("es-CO"))||"0"]})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Domiciliario Asignado:"}),(0,j.jsx)("p",{className:"text-gray-900 dark:text-gray-100",children:J.deliveryPerson||"Sin asignar"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Resumen de Almuerzos:"}),(e=>{const{areIdentical:t,count:a}=(e=>{if(!e||e.length<=1)return{areIdentical:!1,count:1};const t=["soup","soupReplacement","principle","principleReplacement","protein","drink","cutlery","notes","time","payment","address.address","address.addressType","address.phoneNumber","address.localName","address.recipientName","address.unitDetails","sides","additions"],a=e=>t.map(t=>{const a=k(e,t);return"sides"===t&&Array.isArray(a)?a.map(e=>w(e.name||e)).sort().join(","):"additions"===t&&Array.isArray(a)?a.map(e=>`${w(e.name||e)}${e.protein||e.replacement?`:${w(e.protein||e.replacement)}`:""}:${e.quantity||1}`).sort().join(";"):"principle"===t&&Array.isArray(a)?a.map(e=>w(e.name||e)).sort().join(","):w(a)}).join("|"),r=a(e[0]);return{areIdentical:e.every(e=>a(e)===r),count:e.length}})(J.meals);return t&&a>1?(0,j.jsxs)("div",{className:h("p-4 rounded-lg mb-4","dark"===f?"bg-gray-700":"bg-gray-50"),children:[(0,j.jsxs)("h4",{className:"text-md font-semibold text-gray-900 dark:text-gray-100 mb-2",children:[a," almuerzos id\xe9nticos"]}),(0,j.jsx)("pre",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap font-sans break-words",children:$(J.meals[0])})]}):null===(e=J.meals)||void 0===e?void 0:e.map((e,t)=>(0,j.jsxs)("div",{className:h("p-4 rounded-lg mb-4","dark"===f?"bg-gray-700":"bg-gray-50"),children:[(0,j.jsxs)("h4",{className:"text-md font-semibold text-gray-900 dark:text-gray-100 mb-2",children:["Almuerzo #",t+1]}),(0,j.jsx)("pre",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap font-sans break-words",children:$(e)})]},t))})()]})]}),(0,j.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,j.jsx)("button",{onClick:()=>{ge(J),Y(null)},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-lg shadow-md transition-all duration-200 text-sm font-medium","aria-label":`Editar pedido ${J.id}`,children:"Editar Pedido"}),(0,j.jsx)("button",{onClick:()=>Y(null),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white p-3 rounded-lg shadow-md transition-all duration-200 text-sm font-medium",children:"Cerrar"})]})]})}),D&&(0,j.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 animate-fadeIn",role:"dialog","aria-modal":"true","aria-labelledby":"edit-order-title",children:(0,j.jsxs)("div",{className:h("p-6 sm:p-8 rounded-2xl shadow-2xl w-full max-w-lg max-h-[85vh] overflow-y-auto transition-all duration-300 transform scale-95 animate-scaleIn","dark"===f?"bg-gray-800":"bg-white"),children:[(0,j.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,j.jsxs)("h2",{id:"edit-order-title",className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:["Editar Pedido #",D.id]}),(0,j.jsx)("button",{onClick:()=>E(null),className:"text-gray-400 hover:text-gray-200 transition-colors duration-150 p-1 rounded-full","aria-label":"Cerrar edici\xf3n de pedido",children:(0,j.jsx)(d.A,{className:"h-6 w-6"})})]}),(0,j.jsxs)("div",{className:"space-y-6",children:[A.meals.map((e,t)=>{var a,r,n,l,i,o,s,d,c,g,m,u,p,x,b,y,v,N;return(0,j.jsxs)("div",{className:h("p-4 rounded-lg","dark"===f?"bg-gray-700":"bg-gray-50"),children:[(0,j.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:["Almuerzo #",t+1]}),(0,j.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Sopa:"}),(0,j.jsx)("input",{type:"text",value:(null===(a=e.soup)||void 0===a?void 0:a.name)||e.soup||"",onChange:e=>ue(t,"soup",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Sopa de Reemplazo:"}),(0,j.jsx)("input",{type:"text",value:(null===(r=e.soupReplacement)||void 0===r?void 0:r.name)||e.soupReplacement||"",onChange:e=>ue(t,"soupReplacement",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Principio:"}),(0,j.jsx)("input",{type:"text",value:Array.isArray(e.principle)?e.principle.map(e=>e.name||e).join(", "):(null===(n=e.principle)||void 0===n?void 0:n.name)||e.principle||"",onChange:e=>ue(t,"principle",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Principio de Reemplazo:"}),(0,j.jsx)("input",{type:"text",value:(null===(l=e.principleReplacement)||void 0===l?void 0:l.name)||e.principleReplacement||"",onChange:e=>ue(t,"principleReplacement",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Prote\xedna:"}),(0,j.jsx)("input",{type:"text",value:(null===(i=e.protein)||void 0===i?void 0:i.name)||e.protein||"",onChange:e=>ue(t,"protein",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Bebida:"}),(0,j.jsx)("input",{type:"text",value:(null===(o=e.drink)||void 0===o?void 0:o.name)||e.drink||"",onChange:e=>ue(t,"drink",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Cubiertos:"}),(0,j.jsxs)("select",{value:(null===(s=e.cutlery)||void 0===s?void 0:s.name)||e.cutlery||"No",onChange:e=>ue(t,"cutlery",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500"),children:[(0,j.jsx)("option",{value:"S\xed",children:"S\xed"}),(0,j.jsx)("option",{value:"No",children:"No"})]})]}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Acompa\xf1amientos:"}),(0,j.jsx)("input",{type:"text",value:e.sides.map(e=>e.name||e).join(", "),onChange:e=>ue(t,"sides",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Adiciones (nombre,prote\xedna/reemplazo,cantidad;...):"}),(0,j.jsx)("input",{type:"text",value:e.additions.map(e=>`${e.name}${e.protein||e.replacement?`,${e.protein||e.replacement}`:""},${e.quantity||1}`).join(";"),onChange:e=>ue(t,"additions",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Notas:"}),(0,j.jsx)("input",{type:"text",value:e.notes||"",onChange:e=>ue(t,"notes",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Hora de Entrega:"}),(0,j.jsx)("input",{type:"text",value:(null===(d=e.time)||void 0===d?void 0:d.name)||e.time||"",onChange:e=>ue(t,"time",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Direcci\xf3n:"}),(0,j.jsx)("input",{type:"text",value:(null===(c=e.address)||void 0===c?void 0:c.address)||"",onChange:e=>ue(t,"address.address",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Tipo de Direcci\xf3n:"}),(0,j.jsxs)("select",{value:(null===(g=e.address)||void 0===g?void 0:g.addressType)||"house",onChange:e=>ue(t,"address.addressType",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500"),children:[(0,j.jsx)("option",{value:"house",children:"Casa/Apto"}),(0,j.jsx)("option",{value:"school",children:"Colegio/Oficina"}),(0,j.jsx)("option",{value:"complex",children:"Conjunto"}),(0,j.jsx)("option",{value:"shop",children:"Tienda/Local"})]})]}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Tel\xe9fono:"}),(0,j.jsx)("input",{type:"text",value:(null===(m=e.address)||void 0===m?void 0:m.phoneNumber)||"",onChange:e=>ue(t,"address.phoneNumber",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]}),"shop"===(null===(u=e.address)||void 0===u?void 0:u.addressType)&&(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Nombre del Local:"}),(0,j.jsx)("input",{type:"text",value:(null===(p=e.address)||void 0===p?void 0:p.localName)||"",onChange:e=>ue(t,"address.localName",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]}),"school"===(null===(x=e.address)||void 0===x?void 0:x.addressType)&&(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Recibe:"}),(0,j.jsx)("input",{type:"text",value:(null===(b=e.address)||void 0===b?void 0:b.recipientName)||"",onChange:e=>ue(t,"address.recipientName",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]}),"complex"===(null===(y=e.address)||void 0===y?void 0:y.addressType)&&(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Unidad:"}),(0,j.jsx)("input",{type:"text",value:(null===(v=e.address)||void 0===v?void 0:v.unitDetails)||"",onChange:e=>ue(t,"address.unitDetails",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"M\xe9todo de Pago:"}),(0,j.jsx)("input",{type:"text",value:(null===(N=e.payment)||void 0===N?void 0:N.name)||e.payment||"Efectivo",onChange:e=>ue(t,"payment",e.target.value),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]})]})]},t)}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Total del Pedido:"}),(0,j.jsx)("input",{type:"number",value:A.total,onChange:e=>R({...A,total:Number(e.target.value)}),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Estado:"}),(0,j.jsxs)("select",{value:A.status,onChange:e=>R({...A,status:e.target.value}),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500"),children:[(0,j.jsx)("option",{value:"Pendiente",children:"Pendiente"}),(0,j.jsx)("option",{value:"En Preparaci\xf3n",children:"En Preparaci\xf3n"}),(0,j.jsx)("option",{value:"En Camino",children:"En Camino"}),(0,j.jsx)("option",{value:"Entregado",children:"Entregado"}),(0,j.jsx)("option",{value:"Cancelado",children:"Cancelado"})]})]}),(0,j.jsxs)("label",{className:"block",children:[(0,j.jsx)("span",{className:"text-gray-700 dark:text-gray-300 text-sm",children:"Domiciliario:"}),(0,j.jsx)("input",{type:"text",value:A.deliveryPerson,onChange:e=>R({...A,deliveryPerson:e.target.value}),className:h("mt-1 w-full p-2 border rounded-lg text-sm","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")})]})]}),(0,j.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,j.jsx)("button",{onClick:async()=>{if(D){B(!0);try{const e=A.meals.map(e=>({...e,soup:e.soup&&"string"===typeof e.soup?{name:e.soup}:e.soup,soupReplacement:e.soupReplacement&&"string"===typeof e.soupReplacement?{name:e.soupReplacement}:e.soupReplacement,principle:Array.isArray(e.principle)?e.principle.map(e=>"string"===typeof e?{name:e}:e):e.principle&&"string"===typeof e.principle?[{name:e.principle}]:e.principle,principleReplacement:e.principleReplacement&&"string"===typeof e.principleReplacement?{name:e.principleReplacement}:e.principleReplacement,protein:e.protein&&"string"===typeof e.protein?{name:e.protein}:e.protein,drink:e.drink&&"string"===typeof e.drink?{name:e.drink}:e.drink,cutlery:e.cutlery&&"string"===typeof e.cutlery?{name:e.cutlery}:e.cutlery,time:e.time&&"string"===typeof e.time?{name:e.time}:e.time,payment:e.payment&&"string"===typeof e.payment?{name:e.payment}:e.payment,sides:Array.isArray(e.sides)?e.sides.map(e=>"string"===typeof e?{name:e}:e):[],additions:Array.isArray(e.additions)?e.additions.map(e=>({name:e.name||"",protein:e.protein||"",replacement:e.replacement||"",quantity:e.quantity||1})):[]}));await(0,l.mZ)((0,l.H9)(n.db,"orders",D.id),{...A,meals:e,updatedAt:new Date}),E(null),b("Pedido actualizado correctamente.")}catch(e){a(`Error al guardar: ${e.message}`)}finally{B(!1)}}},className:h("flex-1 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-lg shadow-md transition-all duration-200 text-sm font-medium",U?"opacity-50 cursor-not-allowed":""),disabled:U,children:U?"Guardando...":"Guardar Cambios"}),(0,j.jsx)("button",{onClick:()=>E(null),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white p-3 rounded-lg shadow-md transition-all duration-200 text-sm font-medium",children:"Cancelar"})]})]})}),G&&(0,j.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 animate-fadeIn",role:"dialog","aria-modal":"true","aria-labelledby":"delete-all-title",children:(0,j.jsxs)("div",{className:h("p-6 sm:p-8 rounded-2xl shadow-2xl w-full max-w-md transition-all duration-300 transform scale-95 animate-scaleIn","dark"===f?"bg-gray-800":"bg-white"),children:[(0,j.jsx)("h2",{id:"delete-all-title",className:"text-xl font-bold text-gray-900 dark:text-gray-100 mb-4",children:"Confirmar Eliminaci\xf3n"}),(0,j.jsx)("p",{className:"text-gray-700 dark:text-gray-300 mb-6",children:'\xbfEst\xe1s seguro de que deseas eliminar todos los pedidos? Escribe "confirmar" para proceder.'}),(0,j.jsx)("input",{type:"text",value:W,onChange:e=>H(e.target.value),placeholder:"Escribe 'confirmar'",className:h("w-full p-2 border rounded-lg text-sm mb-4","dark"===f?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900","focus:outline-none focus:ring-2 focus:ring-blue-500")}),(0,j.jsxs)("div",{className:"flex gap-3",children:[(0,j.jsx)("button",{onClick:async()=>{if("confirmar"===W.toLowerCase()){B(!0);try{const e=(0,l.rJ)(n.db,"orders"),t=(0,l.P)(e),a=await(0,l.GG)(t),r=(0,l.wP)(n.db);a.docs.forEach(e=>r.delete(e.ref)),await r.commit(),b("Todos los pedidos han sido eliminados."),V(!1),H("")}catch(e){a(`Error al eliminar todos los pedidos: ${e.message}`)}finally{B(!1)}}else a('Por favor, escribe "confirmar" para proceder.')},className:h("flex-1 bg-red-600 hover:bg-red-700 text-white p-3 rounded-lg shadow-md transition-all duration-200 text-sm font-medium",U?"opacity-50 cursor-not-allowed":""),disabled:U,children:U?"Eliminando...":"Eliminar Todos"}),(0,j.jsx)("button",{onClick:()=>{V(!1),H("")},className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white p-3 rounded-lg shadow-md transition-all duration-200 text-sm font-medium",children:"Cancelar"})]})]})})]})}}}]);
//# sourceMappingURL=190.97888861.chunk.js.map