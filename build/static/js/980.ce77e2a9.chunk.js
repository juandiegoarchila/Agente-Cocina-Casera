"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[980],{1980:(e,a,t)=>{t.r(a),t.d(a,{default:()=>c});var l=t(5043),s=t(1958),r=t(5472);function d(e,a){let{title:t,titleId:s,...r}=e;return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},r),t?l.createElement("title",{id:s},t):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const n=l.forwardRef(d);var o=t(7591),i=t(579);const c=e=>{let{setError:a,setSuccess:t,theme:d}=e;const[c,m]=(0,l.useState)([]),[u,x]=(0,l.useState)(null),[h,g]=(0,l.useState)(""),[p,v]=(0,l.useState)({cash:0,daviplata:0,nequi:0}),[b,j]=(0,l.useState)({meals:[],total:0,status:"",payment:""});(0,l.useEffect)((()=>{const e=(0,r.aQ)((0,r.rJ)(s.db,"orders"),(e=>{const a=e.docs.map((e=>({id:e.id,...e.data()})));m(a);const t={cash:0,daviplata:0,nequi:0};a.forEach((e=>"Efectivo"===e.payment?t.cash+=e.total||0:"DaviPlata"===e.payment?t.daviplata+=e.total||0:"Nequi"===e.payment?t.nequi+=e.total||0:null)),v(t)}),(e=>a(`Error al cargar pedidos: ${e.message}`)));return()=>e()}),[a]);const y=(e,a,t)=>{const l=[...b.meals];l[e]={...l[e],[a]:t},j({...b,meals:l})},w=c.filter((e=>{var a,t,l,s,r,d,n;const o=(null===(a=e.id)||void 0===a||null===(t=a.toLowerCase)||void 0===t?void 0:t.call(a).includes(h.toLowerCase()))||!1,i=(null===(l=e.meals)||void 0===l?void 0:l.some((e=>Object.values(e).some((e=>null===e||void 0===e?void 0:e.toString().toLowerCase().includes(h.toLowerCase()))))))||!1,c=(null===(s=e.status)||void 0===s||null===(r=s.toLowerCase)||void 0===r?void 0:r.call(s).includes(h.toLowerCase()))||!1,m=(null===(d=e.payment)||void 0===d||null===(n=d.toLowerCase)||void 0===n?void 0:n.call(d).includes(h.toLowerCase()))||!1;return o||i||c||m}));return(0,i.jsxs)("div",{className:"max-w-7xl mx-auto px-2 sm:px-4",children:[(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-2",children:[(0,i.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-100",children:"Lista de Pedidos"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("input",{value:h,onChange:e=>g(e.target.value),placeholder:"Buscar...",className:`p-2 rounded-lg border border-${"dark"===d?"gray-600":"gray-300"} focus:outline-none focus:ring-2 focus:ring-blue-500 w-full sm:w-64 text-${"dark"===d?"white":"gray-900"} bg-${"dark"===d?"gray-700":"white"} text-sm`}),(0,i.jsx)("button",{onClick:()=>{const e=[["ID","Bandeja","Direcci\xf3n","Hora","Pago","Notas","Total","Estado"]].concat(c.map((e=>{var a,t,l,s,r,d,n;return[e.id,null===(a=e.meals)||void 0===a?void 0:a.map((e=>`${e.soup} ${e.principle} ${e.protein}`)).join(" | "),(null===(t=e.meals)||void 0===t||null===(l=t[0])||void 0===l?void 0:l.address)||"",(null===(s=e.meals)||void 0===s||null===(r=s[0])||void 0===r?void 0:r.time)||"",e.payment||"",(null===(d=e.meals)||void 0===d||null===(n=d[0])||void 0===n?void 0:n.notes)||"",e.total||0,e.status||"Pending"]}))).map((e=>e.join(","))).join("\n"),a=new Blob([e],{type:"text/csv"}),t=window.URL.createObjectURL(a),l=document.createElement("a");l.href=t,l.download="orders.csv",l.click()},className:"bg-blue-600 hover:bg-blue-700 p-2 rounded-lg transition-colors text-sm",children:(0,i.jsx)(n,{className:"w-5 h-5"})})]})]}),(0,i.jsx)("div",{className:`bg-${"dark"===d?"gray-800":"white"} p-4 sm:p-6 rounded-xl shadow-lg max-h-[70vh] overflow-y-auto custom-scrollbar`,children:(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)("table",{className:"w-full text-left border-collapse text-xs sm:text-sm",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{className:`bg-${"dark"===d?"gray-700":"gray-300"} text-${"dark"===d?"gray-300":"gray-700"} font-semibold`,children:[(0,i.jsx)("th",{className:"p-2 border-b",children:"N\xba"}),(0,i.jsx)("th",{className:"p-2 border-b",children:"Bandeja"}),(0,i.jsx)("th",{className:"p-2 border-b hidden md:table-cell",children:"Direcci\xf3n"}),(0,i.jsx)("th",{className:"p-2 border-b hidden md:table-cell",children:"Hora"}),(0,i.jsx)("th",{className:"p-2 border-b hidden sm:table-cell",children:"Pago"}),(0,i.jsx)("th",{className:"p-2 border-b hidden lg:table-cell",children:"Notas"}),(0,i.jsx)("th",{className:"p-2 border-b hidden sm:table-cell",children:"Total"}),(0,i.jsx)("th",{className:"p-2 border-b hidden sm:table-cell",children:"Estado"}),(0,i.jsx)("th",{className:"p-2 border-b",children:"Acciones"})]})}),(0,i.jsx)("tbody",{children:0===w.length?(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:"9",className:"p-4 text-gray-400 text-center",children:"No hay pedidos."})}):w.map(((e,l)=>{var d,n,o,c,m,u,h,g;const p=(null===(d=e.meals)||void 0===d?void 0:d.map((e=>{var a;return`${(null===e||void 0===e?void 0:e.soup)||""} ${(null===e||void 0===e?void 0:e.principle)||""} ${(null===e||void 0===e?void 0:e.protein)||""} ${(null===e||void 0===e?void 0:e.drink)||""} ${(null===e||void 0===e||null===(a=e.sides)||void 0===a?void 0:a.join(", "))||""}`})).join(" | "))||"";return(0,i.jsxs)("tr",{className:"border-b "+(l%2===0?"bg-gray-750":""),children:[(0,i.jsx)("td",{className:"p-2 text-gray-300",children:w.length-l}),(0,i.jsx)("td",{className:"p-2 text-gray-300 max-w-[120px] sm:max-w-xs overflow-hidden text-ellipsis whitespace-nowrap",children:p}),(0,i.jsx)("td",{className:"p-2 text-gray-300 hidden md:table-cell",children:(null===(n=e.meals)||void 0===n||null===(o=n[0])||void 0===o?void 0:o.address)||""}),(0,i.jsx)("td",{className:"p-2 text-gray-300 hidden md:table-cell",children:(null===(c=e.meals)||void 0===c||null===(m=c[0])||void 0===m?void 0:m.time)||""}),(0,i.jsx)("td",{className:"p-2 text-gray-300 hidden sm:table-cell",children:e.payment||""}),(0,i.jsx)("td",{className:"p-2 text-gray-300 hidden lg:table-cell",children:(null===(u=e.meals)||void 0===u||null===(h=u[0])||void 0===h?void 0:h.notes)||"N/A"}),(0,i.jsxs)("td",{className:"p-2 text-gray-300 hidden sm:table-cell",children:["$",(null===(g=e.total)||void 0===g?void 0:g.toLocaleString())||"0"]}),(0,i.jsx)("td",{className:"p-2 hidden sm:table-cell",children:(0,i.jsx)("span",{className:"px-2 py-1 rounded-full text-xs "+("Pending"===e.status?"bg-yellow-600 text-yellow-100":"Delivered"===e.status?"bg-green-600 text-green-100":"bg-gray-600 text-gray-100"),children:e.status||"Pending"})}),(0,i.jsxs)("td",{className:"p-2",children:[(0,i.jsx)("button",{onClick:()=>(e=>{x(e),j({meals:e.meals||[],total:e.total||0,status:e.status||"Pending",payment:e.payment||"Efectivo"})})(e),className:"text-blue-400 hover:text-blue-300 mr-2",children:(0,i.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),(0,i.jsx)("button",{onClick:()=>(async e=>{try{await(0,r.kd)((0,r.H9)(s.db,"orders",e)),t("Pedido eliminado")}catch(l){a(`Error: ${l.message}`)}})(e.id),className:"text-red-400 hover:text-red-300",children:(0,i.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5-4h4M7 7h10"})})})]})]},e.id)}))})]})})}),(0,i.jsxs)("div",{className:"mt-4 text-gray-300 text-sm",children:[(0,i.jsxs)("p",{children:["Total Efectivo: $",p.cash.toLocaleString()]}),(0,i.jsxs)("p",{children:["Total DaviPlata: $",p.daviplata.toLocaleString()]}),(0,i.jsxs)("p",{children:["Total Nequi: $",p.nequi.toLocaleString()]})]}),u&&(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,i.jsxs)("div",{className:`bg-${"dark"===d?"gray-800":"white"} p-4 sm:p-6 rounded-xl shadow-lg w-11/12 max-w-md overflow-y-auto max-h-[80vh]`,children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsx)("h2",{className:"text-lg font-bold text-gray-100",children:"Editar Pedido"}),(0,i.jsx)("button",{onClick:()=>x(null),className:"text-gray-400 hover:text-gray-200",children:(0,i.jsx)(o.A,{className:"h-6 w-6"})})]}),b.meals.map(((e,a)=>{var t;return(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsxs)("h3",{className:"text-base font-semibold mb-2",children:["Comida $",a+1]}),(0,i.jsx)("input",{value:e.soup||"",onChange:e=>y(a,"soup",e.target.value),placeholder:"Sopa",className:`w-full p-2 border rounded mb-2 text-${"dark"===d?"white":"gray-900"} bg-${"dark"===d?"gray-700":"gray-200"} text-sm`}),(0,i.jsx)("input",{value:e.principle||"",onChange:e=>y(a,"principle",e.target.value),placeholder:"Principio",className:`w-full p-2 border rounded mb-2 text-${"dark"===d?"white":"gray-900"} bg-${"dark"===d?"gray-700":"gray-200"} text-sm`}),(0,i.jsx)("input",{value:e.protein||"",onChange:e=>y(a,"protein",e.target.value),placeholder:"Prote\xedna",className:`w-full p-2 border rounded mb-2 text-${"dark"===d?"white":"gray-900"} bg-${"dark"===d?"gray-700":"gray-200"} text-sm`}),(0,i.jsx)("input",{value:e.drink||"",onChange:e=>y(a,"drink",e.target.value),placeholder:"Bebida",className:`w-full p-2 border rounded mb-2 text-${"dark"===d?"white":"gray-900"} bg-${"dark"===d?"gray-700":"gray-200"} text-sm`}),(0,i.jsx)("input",{value:(null===(t=e.sides)||void 0===t?void 0:t.join(", "))||"",onChange:e=>y(a,"sides",e.target.value.split(", ")),placeholder:"Acompa\xf1amientos",className:`w-full p-2 border rounded mb-2 text-${"dark"===d?"white":"gray-900"} bg-${"dark"===d?"gray-700":"gray-200"} text-sm`}),(0,i.jsx)("input",{value:e.address||"",onChange:e=>y(a,"address",e.target.value),placeholder:"Direcci\xf3n",className:`w-full p-2 border rounded mb-2 text-${"dark"===d?"white":"gray-900"} bg-${"dark"===d?"gray-700":"gray-200"} text-sm`}),(0,i.jsx)("input",{value:e.time||"",onChange:e=>y(a,"time",e.target.value),placeholder:"Hora",className:`w-full p-2 border rounded mb-2 text-${"dark"===d?"white":"gray-900"} bg-${"dark"===d?"gray-700":"gray-200"} text-sm`}),(0,i.jsx)("input",{value:e.notes||"",onChange:e=>y(a,"notes",e.target.value),placeholder:"Notas",className:`w-full p-2 border rounded mb-2 text-${"dark"===d?"white":"gray-900"} bg-${"dark"===d?"gray-700":"gray-200"} text-sm`})]},a)})),(0,i.jsxs)("label",{className:"block mb-4",children:[(0,i.jsx)("span",{className:"text-gray-300 font-medium text-sm",children:"Pago:"}),(0,i.jsxs)("select",{value:b.payment,onChange:e=>j({...b,payment:e.target.value}),className:`mt-1 w-full p-2 border rounded text-${"dark"===d?"white":"gray-900"} bg-${"dark"===d?"gray-700":"gray-200"} text-sm`,children:[(0,i.jsx)("option",{value:"Efectivo",children:"Efectivo"}),(0,i.jsx)("option",{value:"DaviPlata",children:"DaviPlata"}),(0,i.jsx)("option",{value:"Nequi",children:"Nequi"})]})]}),(0,i.jsxs)("label",{className:"block mb-4",children:[(0,i.jsx)("span",{className:"text-gray-300 font-medium text-sm",children:"Total:"}),(0,i.jsx)("input",{type:"number",value:b.total,onChange:e=>j({...b,total:Number(e.target.value)}),className:`mt-1 w-full p-2 border rounded text-${"dark"===d?"white":"gray-900"} bg-${"dark"===d?"gray-700":"gray-200"} text-sm`})]}),(0,i.jsxs)("label",{className:"block mb-4",children:[(0,i.jsx)("span",{className:"text-gray-300 font-medium text-sm",children:"Estado:"}),(0,i.jsxs)("select",{value:b.status,onChange:e=>j({...b,status:e.target.value}),className:`mt-1 w-full p-2 border rounded text-${"dark"===d?"white":"gray-900"} bg-${"dark"===d?"gray-700":"gray-200"} text-sm`,children:[(0,i.jsx)("option",{value:"Pending",children:"Pendiente"}),(0,i.jsx)("option",{value:"Delivered",children:"Entregado"}),(0,i.jsx)("option",{value:"Cancelled",children:"Cancelado"})]})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("button",{onClick:async()=>{try{await(0,r.mZ)((0,r.H9)(s.db,"orders",u.id),{...b,updatedAt:new Date}),x(null),t("Pedido actualizado")}catch(e){a(`Error: ${e.message}`)}},className:"flex-1 bg-green-600 hover:bg-green-700 text-white p-2 rounded-lg transition-all transform hover:scale-105 text-sm",children:"Guardar"}),(0,i.jsx)("button",{onClick:()=>x(null),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white p-2 rounded-lg transition-all transform hover:scale-105 text-sm",children:"Cancelar"})]})]})})]})}}}]);
//# sourceMappingURL=980.ce77e2a9.chunk.js.map