{"version":3,"file":"static/js/445.b34421c9.chunk.js","mappings":"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","sources":["components/Admin/UserManagement.js","utils/classNames.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { Dialog, Transition, Menu } from '@headlessui/react'; // Import Menu\r\nimport { XMarkIcon, PencilIcon, TrashIcon, InformationCircleIcon, EllipsisVerticalIcon } from '@heroicons/react/24/outline'; // Import EllipsisVerticalIcon\r\nimport { ChevronUpIcon, ChevronDownIcon } from '@heroicons/react/20/solid';\r\nimport { db } from '../../config/firebase';\r\nimport { collection, onSnapshot, updateDoc, doc, deleteDoc, query, where, orderBy, limit, getDocs, runTransaction } from 'firebase/firestore';\r\nimport { classNames } from '../../utils/classNames';\r\n\r\n// Import for export functionalities\r\nimport * as XLSX from 'xlsx';\r\nimport jsPDF from 'jspdf';\r\nimport 'jspdf-autotable';\r\n\r\n// Reused and slightly enhanced from OrderManagement\r\nconst cleanText = (text) => {\r\n  if (text == null) return '';\r\n  if (typeof text === 'string') return text.replace(' NUEVO', '').trim();\r\n  if (typeof text === 'boolean') return text.toString();\r\n  if (typeof text === 'object' && text !== null && 'name' in text) return String(text.name).replace(' NUEVO', '').trim();\r\n  return String(text).replace(' NUEVO', '').trim();\r\n};\r\n\r\nconst getAddressDisplay = (address) => {\r\n  if (!address?.address) return 'Sin dirección';\r\n  let display = address.address;\r\n  switch (address.addressType) {\r\n    case 'school': if (address.recipientName) display += ` (Recibe: ${cleanText(address.recipientName)})`; break;\r\n    case 'complex': if (address.unitDetails) display += ` (${cleanText(address.unitDetails)})`; break;\r\n    case 'shop': if (address.localName) display += ` (${cleanText(address.localName)})`; break;\r\n    default: break;\r\n  }\r\n  return display;\r\n};\r\n\r\n// New utility for debouncing search input\r\nconst debounce = (func, delay) => {\r\n  let timeout;\r\n  return function (...args) {\r\n    const context = this;\r\n    clearTimeout(timeout);\r\n    timeout = setTimeout(() => func.apply(context, args), delay);\r\n  };\r\n};\r\n\r\n// Define role map for easier display and conversion\r\nconst ROLE_MAP = {\r\n  1: 'Cliente',\r\n  2: 'Administrador',\r\n  3: 'Mesero',\r\n  4: 'Domiciliario',\r\n};\r\n\r\nconst UserManagement = ({ setError, setSuccess, theme }) => {\r\n  const [users, setUsers] = useState([]);\r\n  const [editingUser, setEditingUser] = useState(null);\r\n  const [editUserForm, setEditUserForm] = useState({ email: '', role: 1, totalOrders: 0 });\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [fetchError, setFetchError] = useState(null);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [showUserDetailsModal, setShowUserDetailsModal] = useState(null);\r\n  const [pagination, setPagination] = useState({ currentPage: 1, itemsPerPage: 10 });\r\n  const [sortColumn, setSortColumn] = useState(null);\r\n  const [sortOrder, setSortOrder] = useState('asc');\r\n\r\n  const debouncedSetSearchTerm = useCallback(\r\n    debounce((value) => setSearchTerm(value), 300),\r\n    []\r\n  );\r\n\r\n  const sortedAndFilteredUsers = useMemo(() => {\r\n    let currentUsers = users;\r\n\r\n    if (searchTerm) {\r\n      currentUsers = currentUsers.filter(user =>\r\n        user.email.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        user.address.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        ROLE_MAP[user.role]?.toLowerCase().includes(searchTerm.toLowerCase()) // Allow searching by role name\r\n      );\r\n    }\r\n\r\n    if (sortColumn) {\r\n      currentUsers = [...currentUsers].sort((a, b) => {\r\n        let valA, valB;\r\n\r\n        switch (sortColumn) {\r\n          case 'email':\r\n            valA = a.email.toLowerCase();\r\n            valB = b.email.toLowerCase();\r\n            break;\r\n          case 'address':\r\n            valA = a.address.toLowerCase();\r\n            valB = b.address.toLowerCase();\r\n            break;\r\n          case 'role':\r\n            valA = a.role;\r\n            valB = b.role;\r\n            break;\r\n          case 'totalOrders':\r\n            valA = a.totalOrders || 0;\r\n            valB = b.totalOrders || 0;\r\n            break;\r\n          case 'number':\r\n          default:\r\n            valA = a.number;\r\n            valB = b.number;\r\n            break;\r\n        }\r\n\r\n        if (valA < valB) return sortOrder === 'asc' ? -1 : 1;\r\n        if (valA > valB) return sortOrder === 'asc' ? 1 : -1;\r\n        return 0;\r\n      });\r\n    }\r\n\r\n    return currentUsers;\r\n  }, [users, searchTerm, sortColumn, sortOrder]);\r\n\r\n  const totalPages = Math.ceil(sortedAndFilteredUsers.length / pagination.itemsPerPage);\r\n  const paginatedUsers = useMemo(() => {\r\n    const startIndex = (pagination.currentPage - 1) * pagination.itemsPerPage;\r\n    const endIndex = startIndex + pagination.itemsPerPage;\r\n    return sortedAndFilteredUsers.slice(startIndex, endIndex);\r\n  }, [sortedAndFilteredUsers, pagination.currentPage, pagination.itemsPerPage]);\r\n\r\n  useEffect(() => {\r\n    setIsLoading(true);\r\n    const usersCollectionRef = collection(db, 'users');\r\n    const unsubscribe = onSnapshot(usersCollectionRef, async (snapshot) => {\r\n      try {\r\n        const usersData = snapshot.docs.map(doc => ({\r\n          id: doc.id,\r\n          ...doc.data(),\r\n          createdAt: doc.data().createdAt || { seconds: 0 },\r\n        }));\r\n\r\n        usersData.sort((a, b) => {\r\n          const timeA = a.createdAt?.seconds || 0;\r\n          const timeB = b.createdAt?.seconds || 0;\r\n          return timeA - timeB;\r\n        });\r\n\r\n        const usersWithAddresses = await Promise.all(\r\n          usersData.map(async (user, index) => {\r\n            try {\r\n              const ordersQuery = query(\r\n                collection(db, 'orders'),\r\n                where('userId', '==', user.id),\r\n                orderBy('createdAt', 'desc'),\r\n                limit(1)\r\n              );\r\n              const orderSnapshot = await getDocs(ordersQuery);\r\n              let address = 'Sin pedidos';\r\n              if (!orderSnapshot.empty) {\r\n                const orderData = orderSnapshot.docs[0].data();\r\n                address = getAddressDisplay(orderData.meals?.[0]?.address);\r\n              }\r\n              return {\r\n                ...user,\r\n                number: index + 1,\r\n                address,\r\n              };\r\n            } catch (error) {\r\n              console.error(`Error fetching address for user ${user.id}:`, error.message);\r\n              return {\r\n                ...user,\r\n                number: index + 1,\r\n                address: 'Error al cargar dirección',\r\n              };\r\n            }\r\n          })\r\n        );\r\n\r\n        setUsers(usersWithAddresses);\r\n        setFetchError(null);\r\n      } catch (error) {\r\n        console.error('Error in UserManagement onSnapshot:', error);\r\n        setError(`Error al cargar usuarios: ${error.message}`);\r\n        setFetchError(error.message);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    }, (error) => {\r\n      console.error('onSnapshot listener error:', error);\r\n      setError(`Error al cargar usuarios: ${error.message}`);\r\n      setFetchError(error.message);\r\n      setIsLoading(false);\r\n    });\r\n\r\n    return () => unsubscribe();\r\n  }, [setError]);\r\n\r\n  const handleEditUser = useCallback((user) => {\r\n    setEditingUser(user);\r\n    setEditUserForm({\r\n      email: user.email || '',\r\n      role: user.role || 1,\r\n      totalOrders: user.totalOrders || 0,\r\n    });\r\n  }, []);\r\n\r\n  const handleSaveEdit = useCallback(async () => {\r\n    if (!editingUser) return;\r\n    setIsLoading(true);\r\n    try {\r\n      await runTransaction(db, async (transaction) => {\r\n        const userRef = doc(db, 'users', editingUser.id);\r\n        transaction.update(userRef, {\r\n          email: editUserForm.email.trim(),\r\n          role: Number(editUserForm.role),\r\n          totalOrders: Number(editUserForm.totalOrders),\r\n        });\r\n      });\r\n      setEditingUser(null);\r\n      setSuccess('Usuario actualizado con éxito.');\r\n    } catch (error) {\r\n      console.error('Error al guardar usuario:', error);\r\n      setError(`Error al actualizar usuario: ${error.message}`);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [editingUser, editUserForm, setSuccess, setError]);\r\n\r\n  const handleDeleteUser = useCallback(async (userId) => {\r\n    if (!window.confirm('¿Estás seguro de que quieres eliminar este usuario? Esta acción es irreversible.')) {\r\n      return;\r\n    }\r\n    setIsLoading(true);\r\n    try {\r\n      await deleteDoc(doc(db, 'users', userId));\r\n      setSuccess('Usuario eliminado con éxito.');\r\n    } catch (error) {\r\n      console.error('Error al eliminar usuario:', error);\r\n      setError(`Error al eliminar usuario: ${error.message}`);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [setSuccess, setError]);\r\n\r\n  const handlePageChange = useCallback((newPage) => {\r\n    if (newPage >= 1 && newPage <= totalPages) {\r\n      setPagination(prev => ({ ...prev, currentPage: newPage }));\r\n    }\r\n  }, [totalPages]);\r\n\r\n  const handleItemsPerPageChange = useCallback((e) => {\r\n    setPagination({ currentPage: 1, itemsPerPage: Number(e.target.value) });\r\n  }, []);\r\n\r\n  const handleSort = useCallback((columnName) => {\r\n    if (sortColumn === columnName) {\r\n      setSortOrder(prevOrder => (prevOrder === 'asc' ? 'desc' : 'asc'));\r\n    } else {\r\n      setSortColumn(columnName);\r\n      setSortOrder('asc');\r\n    }\r\n    setPagination(prev => ({ ...prev, currentPage: 1 }));\r\n  }, [sortColumn]);\r\n\r\n  const getSortIcon = useCallback((columnName) => {\r\n    if (sortColumn === columnName) {\r\n      return sortOrder === 'asc' ? (\r\n        <ChevronUpIcon className=\"w-4 h-4 inline-block ml-1\" />\r\n      ) : (\r\n        <ChevronDownIcon className=\"w-4 h-4 inline-block ml-1\" />\r\n      );\r\n    }\r\n    return null;\r\n  }, [sortColumn, sortOrder]);\r\n\r\n  // --- Export Functions ---\r\n  const getExportData = useCallback(() => {\r\n    return sortedAndFilteredUsers.map(user => ({\r\n      'Nº': user.number,\r\n      'Email': user.email,\r\n      'Última Dirección': user.address,\r\n      'Rol': ROLE_MAP[user.role],\r\n      'Pedidos': user.totalOrders || 0,\r\n      'ID de Usuario': user.id,\r\n      'Registrado Desde': user.createdAt?.seconds ? new Date(user.createdAt.seconds * 1000).toLocaleDateString('es-CO') : 'N/A',\r\n    }));\r\n  }, [sortedAndFilteredUsers]);\r\n\r\n  const exportToExcel = useCallback(() => {\r\n    const data = getExportData();\r\n    const ws = XLSX.utils.json_to_sheet(data);\r\n    const wb = XLSX.utils.book_new();\r\n    XLSX.utils.book_append_sheet(wb, ws, \"Usuarios\");\r\n    XLSX.writeFile(wb, \"usuarios.xlsx\");\r\n    setSuccess('Usuarios exportados a Excel con éxito.');\r\n  }, [getExportData, setSuccess]);\r\n\r\n  const exportToPDF = useCallback(() => {\r\n    const doc = new jsPDF();\r\n    const data = getExportData();\r\n    const head = [Object.keys(data[0])]; // Get headers from the first object\r\n    const body = data.map(row => Object.values(row));\r\n\r\n    doc.autoTable({\r\n      head: head,\r\n      body: body,\r\n      startY: 20,\r\n      theme: 'grid',\r\n      styles: {\r\n        fontSize: 8,\r\n        cellPadding: 2,\r\n      },\r\n      headStyles: {\r\n        fillColor: [20, 83, 136], // A shade of blue\r\n        textColor: [255, 255, 255],\r\n        fontStyle: 'bold',\r\n      },\r\n      alternateRowStyles: {\r\n        fillColor: [240, 240, 240] // Light gray for alternate rows\r\n      },\r\n      margin: { top: 10, left: 10, right: 10, bottom: 10 },\r\n    });\r\n\r\n    doc.save(\"usuarios.pdf\");\r\n    setSuccess('Usuarios exportados a PDF con éxito.');\r\n  }, [getExportData, setSuccess]);\r\n\r\n  const previewTable = useCallback(() => {\r\n    // This will open a new window/tab with a print-friendly version of the current table data.\r\n    const printWindow = window.open('', '_blank');\r\n    if (!printWindow) {\r\n      setError('Pop-ups bloqueados. Por favor, permita pop-ups para previsualizar.');\r\n      return;\r\n    }\r\n\r\n    const exportData = getExportData();\r\n    let tableHtml = `\r\n      <html>\r\n      <head>\r\n        <title>Previsualización de Usuarios</title>\r\n        <style>\r\n          body { font-family: Arial, sans-serif; margin: 20px; }\r\n          h1 { text-align: center; margin-bottom: 20px; }\r\n          table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }\r\n          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\r\n          th { background-color: #f2f2f2; }\r\n          @media print {\r\n            body { margin: 0; }\r\n            table { font-size: 10pt; }\r\n          }\r\n        </style>\r\n      </head>\r\n      <body>\r\n        <h1>Reporte de Usuarios</h1>\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              ${Object.keys(exportData[0] || {}).map(key => `<th>${key}</th>`).join('')}\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            ${exportData.map(row => `\r\n              <tr>\r\n                ${Object.values(row).map(value => `<td>${value}</td>`).join('')}\r\n              </tr>\r\n            `).join('')}\r\n          </tbody>\r\n        </table>\r\n      </body>\r\n      </html>\r\n    `;\r\n\r\n    printWindow.document.write(tableHtml);\r\n    printWindow.document.close();\r\n    printWindow.focus();\r\n    // printWindow.print(); // Uncomment this line if you want it to automatically open print dialog\r\n  }, [getExportData, setError]);\r\n\r\n\r\n  return (\r\n    <div className=\"max-w-7xl mx-auto px-2 sm:px-4 py-6\">\r\n      <h2 className=\"text-xl sm:text-2xl font-bold mb-6 text-gray-900 dark:text-gray-100\">Gestión de Usuarios</h2>\r\n      {fetchError && (\r\n        <div className=\"mb-4 p-4 bg-red-100 text-red-700 rounded-lg dark:bg-red-900 dark:text-red-200\">\r\n          Error al cargar datos: {fetchError}\r\n        </div>\r\n      )}\r\n\r\n      {/* Search Bar and Export Options */}\r\n      <div className=\"flex flex-col sm:flex-row justify-between items-center mb-4 gap-3 sm:gap-0\">\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Buscar por email, dirección o rol...\"\r\n          onChange={(e) => debouncedSetSearchTerm(e.target.value)}\r\n          className={classNames(\r\n            \"p-2 rounded-md border w-full sm:w-1/2 md:w-1/3\",\r\n            theme === 'dark' ? 'bg-gray-700 border-gray-600 text-gray-100' : 'bg-white border-gray-300 text-gray-900',\r\n            \"focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200\"\r\n          )}\r\n          aria-label=\"Buscar usuarios\"\r\n        />\r\n\r\n        {/* Export Menu */}\r\n        <Menu as=\"div\" className=\"relative inline-block text-left z-20\">\r\n          <div>\r\n            <Menu.Button\r\n              className={classNames(\r\n                \"inline-flex justify-center w-full rounded-md px-2 py-2 text-sm font-medium\",\r\n                theme === 'dark' ? 'bg-gray-700 text-gray-300 hover:bg-gray-600 focus:ring-offset-gray-800' : 'bg-gray-100 text-gray-700 hover:bg-gray-200 focus:ring-offset-white',\r\n                \"focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\"\r\n              )}\r\n              aria-label=\"Opciones de exportación\"\r\n            >\r\n              <EllipsisVerticalIcon className=\"h-5 w-5\" aria-hidden=\"true\" />\r\n            </Menu.Button>\r\n          </div>\r\n\r\n          <Transition\r\n            as={React.Fragment}\r\n            enter=\"transition ease-out duration-100\"\r\n            enterFrom=\"transform opacity-0 scale-95\"\r\n            enterTo=\"transform opacity-100 scale-100\"\r\n            leave=\"transition ease-in duration-75\"\r\n            leaveFrom=\"transform opacity-100 scale-100\"\r\n            leaveTo=\"transform opacity-0 scale-95\"\r\n          >\r\n            <Menu.Items className={classNames(\r\n              \"absolute right-0 mt-2 w-48 origin-top-right divide-y divide-gray-100 rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none\",\r\n              theme === 'dark' ? 'bg-gray-700 divide-gray-600' : 'bg-white divide-gray-100'\r\n            )}>\r\n              <div className=\"py-1\">\r\n                <Menu.Item>\r\n                  {({ active }) => (\r\n                    <button\r\n                      onClick={exportToExcel}\r\n                      className={classNames(\r\n                        active ? (theme === 'dark' ? 'bg-gray-600 text-gray-100' : 'bg-gray-100 text-gray-900') : (theme === 'dark' ? 'text-gray-300' : 'text-gray-700'),\r\n                        'block px-4 py-2 text-sm w-full text-left'\r\n                      )}\r\n                    >\r\n                      Exportar a Excel\r\n                    </button>\r\n                  )}\r\n                </Menu.Item>\r\n                <Menu.Item>\r\n                  {({ active }) => (\r\n                    <button\r\n                      onClick={exportToPDF}\r\n                      className={classNames(\r\n                        active ? (theme === 'dark' ? 'bg-gray-600 text-gray-100' : 'bg-gray-100 text-gray-900') : (theme === 'dark' ? 'text-gray-300' : 'text-gray-700'),\r\n                        'block px-4 py-2 text-sm w-full text-left'\r\n                      )}\r\n                    >\r\n                      Exportar a PDF\r\n                    </button>\r\n                  )}\r\n                </Menu.Item>\r\n                <Menu.Item>\r\n                  {({ active }) => (\r\n                    <button\r\n                      onClick={previewTable}\r\n                      className={classNames(\r\n                        active ? (theme === 'dark' ? 'bg-gray-600 text-gray-100' : 'bg-gray-100 text-gray-900') : (theme === 'dark' ? 'text-gray-300' : 'text-gray-700'),\r\n                        'block px-4 py-2 text-sm w-full text-left'\r\n                      )}\r\n                    >\r\n                      Previsualizar\r\n                    </button>\r\n                  )}\r\n                </Menu.Item>\r\n              </div>\r\n            </Menu.Items>\r\n          </Transition>\r\n        </Menu>\r\n      </div>\r\n\r\n      <div className={classNames(\r\n        \"p-4 sm:p-6 rounded-2xl shadow-xl max-h-[70vh] overflow-y-auto custom-scrollbar\",\r\n        theme === 'dark' ? 'bg-gray-800' : 'bg-white'\r\n      )}>\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"min-w-full text-left border-collapse text-xs sm:text-sm\">\r\n            <thead>\r\n              <tr className={classNames(\r\n                \"font-semibold sticky top-0 z-10\",\r\n                theme === 'dark' ? 'bg-gray-700 text-gray-300' : 'bg-gray-100 text-gray-700'\r\n              )}>\r\n                <th className=\"p-2 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('number')}>\r\n                  Nº {getSortIcon('number')}\r\n                </th>\r\n                <th className=\"p-2 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('email')}>\r\n                  Email {getSortIcon('email')}\r\n                </th>\r\n                <th className=\"p-2 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('address')}>\r\n                  Última Dirección {getSortIcon('address')}\r\n                </th>\r\n                <th className=\"p-2 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('role')}>\r\n                  Rol {getSortIcon('role')}\r\n                </th>\r\n                <th className=\"p-2 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('totalOrders')}>\r\n                  Pedidos {getSortIcon('totalOrders')}\r\n                </th>\r\n                <th className=\"p-2 border-b whitespace-nowrap\">Acciones</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {isLoading ? (\r\n                <tr>\r\n                  <td colSpan=\"6\" className=\"p-6 text-center text-gray-500 dark:text-gray-400\">\r\n                    <div className=\"flex justify-center items-center\">\r\n                      <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500\"></div>\r\n                      <span className=\"ml-3\">Cargando usuarios...</span>\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ) : paginatedUsers.length === 0 && !fetchError ? (\r\n                <tr>\r\n                  <td colSpan=\"6\" className=\"p-6 text-center text-gray-500 dark:text-gray-400\">\r\n                    No se encontraron usuarios.\r\n                  </td>\r\n                </tr>\r\n              ) : (\r\n                paginatedUsers.map((user) => (\r\n                  <tr\r\n                    key={user.id}\r\n                    className={classNames(\r\n                      \"border-b transition-colors duration-150\",\r\n                      theme === 'dark' ? 'border-gray-700 hover:bg-gray-700' : 'border-gray-200 hover:bg-gray-50',\r\n                      user.number % 2 === 0 ? (theme === 'dark' ? 'bg-gray-750' : 'bg-gray-50') : ''\r\n                    )}\r\n                  >\r\n                    <td className=\"p-2 text-gray-900 dark:text-gray-300\">{user.number}</td>\r\n                    <td className=\"p-2 text-gray-900 dark:text-gray-300 font-medium\">{user.email}</td>\r\n                    <td className=\"p-2 text-gray-900 dark:text-gray-300 max-w-[150px] sm:max-w-[250px] overflow-hidden text-ellipsis whitespace-nowrap\" title={user.address}>\r\n                      {user.address}\r\n                    </td>\r\n                    <td className=\"p-2 text-gray-900 dark:text-gray-300\">\r\n                      <span className={classNames(\r\n                        \"px-2 py-1 rounded-full text-xs font-semibold\",\r\n                        user.role === 2 ? 'bg-purple-200 text-purple-800 dark:bg-purple-800 dark:text-purple-200' :\r\n                        user.role === 3 ? 'bg-green-200 text-green-800 dark:bg-green-800 dark:text-green-200' :\r\n                        user.role === 4 ? 'bg-orange-200 text-orange-800 dark:bg-orange-800 dark:text-orange-200' :\r\n                        'bg-blue-200 text-blue-800 dark:bg-blue-800 dark:text-blue-200'\r\n                      )}>\r\n                        {ROLE_MAP[user.role] || 'Desconocido'}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"p-2 text-gray-900 dark:text-gray-300\">{user.totalOrders || 0}</td>\r\n                    <td className=\"p-2 flex space-x-1 items-center\">\r\n                      <button\r\n                        onClick={() => handleEditUser(user)}\r\n                        className=\"text-blue-500 hover:text-blue-400 p-1 rounded-md transition-colors duration-150\"\r\n                        title=\"Editar usuario\"\r\n                        aria-label={`Editar usuario ${user.email}`}\r\n                      >\r\n                        <PencilIcon className=\"w-4 h-4 sm:w-5 sm:h-5\" />\r\n                      </button>\r\n                      <button\r\n                        onClick={() => handleDeleteUser(user.id)}\r\n                        className=\"text-red-500 hover:text-red-400 p-1 rounded-md transition-colors duration-150\"\r\n                        title=\"Eliminar usuario\"\r\n                        aria-label={`Eliminar usuario ${user.email}`}\r\n                      >\r\n                        <TrashIcon className=\"w-4 h-4 sm:w-5 sm:h-5\" />\r\n                      </button>\r\n                      <button\r\n                        onClick={() => setShowUserDetailsModal(user)}\r\n                        className=\"text-gray-500 hover:text-gray-400 p-1 rounded-md transition-colors duration-150\"\r\n                        title=\"Ver detalles del usuario\"\r\n                        aria-label={`Ver detalles del usuario ${user.email}`}\r\n                      >\r\n                        <InformationCircleIcon className=\"w-4 h-4 sm:w-5 sm:h-5\" />\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        {/* Pagination Controls */}\r\n        {sortedAndFilteredUsers.length > 0 && (\r\n          <div className=\"flex flex-col sm:flex-row justify-between items-center mt-6 gap-4\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className=\"text-sm text-gray-500 dark:text-gray-400\">Usuarios por página:</span>\r\n              <select\r\n                value={pagination.itemsPerPage}\r\n                onChange={handleItemsPerPageChange}\r\n                className={classNames(\r\n                  \"p-1 sm:p-2 rounded-lg border text-sm\",\r\n                  theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-300 bg-white text-gray-900'\r\n                )}\r\n                aria-label=\"Seleccionar número de usuarios por página\"\r\n              >\r\n                <option value={5}>5</option>\r\n                <option value={10}>10</option>\r\n                <option value={20}>20</option>\r\n                <option value={30}>30</option>\r\n              </select>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <button\r\n                onClick={() => handlePageChange(pagination.currentPage - 1)}\r\n                disabled={pagination.currentPage === 1}\r\n                className={classNames(\r\n                  \"p-2 rounded-lg transition-all duration-200\",\r\n                  pagination.currentPage === 1 ? 'bg-gray-300 text-gray-500 cursor-not-allowed' : 'bg-blue-600 hover:bg-blue-700 text-white'\r\n                )}\r\n                aria-label=\"Página anterior\"\r\n              >\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1.5} stroke=\"currentColor\" className=\"w-5 h-5\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15.75 19.5L8.25 12l7.5-7.5\" />\r\n                </svg>\r\n              </button>\r\n              <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                Página {pagination.currentPage} de {totalPages}\r\n              </span>\r\n              <button\r\n                onClick={() => handlePageChange(pagination.currentPage + 1)}\r\n                disabled={pagination.currentPage === totalPages}\r\n                className={classNames(\r\n                  \"p-2 rounded-lg transition-all duration-200\",\r\n                  pagination.currentPage === totalPages ? 'bg-gray-300 text-gray-500 cursor-not-allowed' : 'bg-blue-600 hover:bg-blue-700 text-white'\r\n                )}\r\n                aria-label=\"Página siguiente\"\r\n              >\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth={1.5} stroke=\"currentColor\" className=\"w-5 h-5\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M8.25 4.5l7.5 7.5-7.5 7.5\" />\r\n                </svg>\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Edit User Modal */}\r\n      <Transition show={editingUser !== null} as={React.Fragment}>\r\n        <Dialog as=\"div\" className=\"relative z-50\" onClose={() => setEditingUser(null)}>\r\n          <Transition.Child\r\n            as={React.Fragment}\r\n            enter=\"ease-out duration-300\"\r\n            enterFrom=\"opacity-0\"\r\n            enterTo=\"opacity-100\"\r\n            leave=\"ease-in duration-200\"\r\n            leaveFrom=\"opacity-100\"\r\n            leaveTo=\"opacity-0\"\r\n          >\r\n            <div className=\"fixed inset-0 bg-black bg-opacity-50\" />\r\n          </Transition.Child>\r\n          <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n            <Transition.Child\r\n              as={React.Fragment}\r\n              enter=\"ease-out duration-300\"\r\n              enterFrom=\"opacity-0 scale-95\"\r\n              enterTo=\"opacity-100 scale-100\"\r\n              leave=\"ease-in duration-200\"\r\n              leaveFrom=\"opacity-100 scale-100\"\r\n              leaveTo=\"opacity-0 scale-95\"\r\n            >\r\n              <Dialog.Panel className={classNames(\r\n                \"w-full max-w-md p-6 rounded-lg shadow-xl max-h-[80vh] overflow-y-auto\",\r\n                theme === 'dark' ? 'bg-gray-800 text-gray-200' : 'bg-gray-50 text-gray-900'\r\n              )}>\r\n                <div className=\"flex justify-between items-center mb-4\">\r\n                  <Dialog.Title className=\"text-lg font-medium\">\r\n                    Editar Usuario\r\n                  </Dialog.Title>\r\n                  <button\r\n                    onClick={() => setEditingUser(null)}\r\n                    className=\"text-gray-500 hover:text-gray-400 dark:hover:text-gray-300\"\r\n                    aria-label=\"Cerrar modal\"\r\n                  >\r\n                    <XMarkIcon className=\"h-6 w-6\" />\r\n                  </button>\r\n                </div>\r\n                <form onSubmit={(e) => { e.preventDefault(); handleSaveEdit(); }}>\r\n                  <div className=\"space-y-4\">\r\n                    <div>\r\n                      <label htmlFor=\"email-input\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Email</label>\r\n                      <input\r\n                        id=\"email-input\"\r\n                        type=\"email\"\r\n                        value={editUserForm.email}\r\n                        onChange={e => setEditUserForm({ ...editUserForm, email: e.target.value })}\r\n                        className={classNames(\r\n                          \"w-full p-2 rounded-md border text-sm\",\r\n                          theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                          \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n                        )}\r\n                        placeholder=\"Ej: usuario@ejemplo.com\"\r\n                        required\r\n                      />\r\n                    </div>\r\n                    <div>\r\n                      <label htmlFor=\"role-select\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Rol</label>\r\n                      <select\r\n                        id=\"role-select\"\r\n                        value={editUserForm.role}\r\n                        onChange={e => setEditUserForm({ ...editUserForm, role: Number(e.target.value) })}\r\n                        className={classNames(\r\n                          \"w-full p-2 rounded-md border text-sm\",\r\n                          theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                          \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n                        )}\r\n                      >\r\n                        {/* New Role Options */}\r\n                        <option value={1}>Cliente</option>\r\n                        <option value={2}>Administrador</option>\r\n                        <option value={3}>Mesero</option>\r\n                        <option value={4}>Domiciliario</option>\r\n                      </select>\r\n                    </div>\r\n                    <div>\r\n                      <label htmlFor=\"total-orders-input\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Pedidos</label>\r\n                      <input\r\n                        id=\"total-orders-input\"\r\n                        type=\"number\"\r\n                        value={editUserForm.totalOrders}\r\n                        onChange={e => setEditUserForm({ ...editUserForm, totalOrders: Number(e.target.value) })}\r\n                        className={classNames(\r\n                          \"w-full p-2 rounded-md border text-sm\",\r\n                          theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                          \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n                        )}\r\n                        min=\"0\"\r\n                      />\r\n                    </div>\r\n                    <div className=\"flex justify-end gap-2\">\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => setEditingUser(null)}\r\n                        className={classNames(\r\n                          \"px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200\",\r\n                          theme === 'dark' ? 'bg-gray-600 hover:bg-gray-700 text-gray-200' : 'bg-gray-200 hover:bg-gray-300 text-gray-900'\r\n                        )}\r\n                      >\r\n                        Cancelar\r\n                      </button>\r\n                      <button\r\n                        type=\"submit\"\r\n                        disabled={isLoading}\r\n                        className={classNames(\r\n                          \"px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200\",\r\n                          isLoading ? 'bg-gray-400 cursor-not-allowed' : theme === 'dark' ? 'bg-blue-600 hover:bg-blue-700 text-white' : 'bg-blue-500 hover:bg-blue-600 text-white'\r\n                        )}\r\n                      >\r\n                        {isLoading ? 'Guardando...' : 'Guardar'}\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </form>\r\n              </Dialog.Panel>\r\n            </Transition.Child>\r\n          </div>\r\n        </Dialog>\r\n      </Transition>\r\n\r\n      {/* User Details Modal */}\r\n      <Transition show={showUserDetailsModal !== null} as={React.Fragment}>\r\n        <Dialog as=\"div\" className=\"relative z-50\" onClose={() => setShowUserDetailsModal(null)}>\r\n          <Transition.Child\r\n            as={React.Fragment}\r\n            enter=\"ease-out duration-300\"\r\n            enterFrom=\"opacity-0\"\r\n            enterTo=\"opacity-100\"\r\n            leave=\"ease-in duration-200\"\r\n            leaveFrom=\"opacity-100\"\r\n            leaveTo=\"opacity-0\"\r\n          >\r\n            <div className=\"fixed inset-0 bg-black bg-opacity-50\" />\r\n          </Transition.Child>\r\n          <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n            <Transition.Child\r\n              as={React.Fragment}\r\n              enter=\"ease-out duration-300\"\r\n              enterFrom=\"opacity-0 scale-95\"\r\n              enterTo=\"opacity-100 scale-100\"\r\n              leave=\"ease-in duration-200\"\r\n              leaveFrom=\"opacity-100 scale-100\"\r\n              leaveTo=\"opacity-0 scale-95\"\r\n            >\r\n              <Dialog.Panel className={classNames(\r\n                \"w-full max-w-md p-6 rounded-lg shadow-xl max-h-[80vh] overflow-y-auto\",\r\n                theme === 'dark' ? 'bg-gray-800 text-gray-200' : 'bg-gray-50 text-gray-900'\r\n              )}>\r\n                <div className=\"flex justify-between items-center mb-4\">\r\n                  <Dialog.Title className=\"text-lg font-medium\">\r\n                    Detalles del Usuario\r\n                  </Dialog.Title>\r\n                  <button\r\n                    onClick={() => setShowUserDetailsModal(null)}\r\n                    className=\"text-gray-500 hover:text-gray-400 dark:hover:text-gray-300\"\r\n                    aria-label=\"Cerrar modal de detalles\"\r\n                  >\r\n                    <XMarkIcon className=\"h-6 w-6\" />\r\n                  </button>\r\n                </div>\r\n                {showUserDetailsModal && (\r\n                  <div className=\"space-y-3 text-sm\">\r\n                    <p><span className=\"font-semibold\">Email:</span> {showUserDetailsModal.email}</p>\r\n                    <p><span className=\"font-semibold\">ID de Usuario:</span> {showUserDetailsModal.id}</p>\r\n                    <p><span className=\"font-semibold\">Rol:</span> {ROLE_MAP[showUserDetailsModal.role] || 'Desconocido'}</p>\r\n                    <p><span className=\"font-semibold\">Total de Pedidos:</span> {showUserDetailsModal.totalOrders || 0}</p>\r\n                    <p><span className=\"font-semibold\">Última Dirección:</span> {showUserDetailsModal.address}</p>\r\n                    {showUserDetailsModal.createdAt?.seconds && (\r\n                      <p><span className=\"font-semibold\">Registrado Desde:</span> {new Date(showUserDetailsModal.createdAt.seconds * 1000).toLocaleDateString('es-CO', { year: 'numeric', month: 'long', day: 'numeric' })}</p>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </Dialog.Panel>\r\n            </Transition.Child>\r\n          </div>\r\n        </Dialog>\r\n      </Transition>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserManagement;","// src/utils/classNames.js\r\nexport function classNames(...classes) {\r\n  return classes.filter(Boolean).join(' ');\r\n}"],"names":["cleanText","text","replace","trim","toString","String","name","debounce","func","delay","timeout","_len","arguments","length","args","Array","_key","context","this","clearTimeout","setTimeout","apply","ROLE_MAP","_ref","_showUserDetailsModal","setError","setSuccess","theme","users","setUsers","useState","editingUser","setEditingUser","editUserForm","setEditUserForm","email","role","totalOrders","isLoading","setIsLoading","fetchError","setFetchError","searchTerm","setSearchTerm","showUserDetailsModal","setShowUserDetailsModal","pagination","setPagination","currentPage","itemsPerPage","sortColumn","setSortColumn","sortOrder","setSortOrder","debouncedSetSearchTerm","useCallback","value","sortedAndFilteredUsers","useMemo","currentUsers","filter","user","_ROLE_MAP$user$role","toLowerCase","includes","address","sort","a","b","valA","valB","number","totalPages","Math","ceil","paginatedUsers","startIndex","endIndex","slice","useEffect","usersCollectionRef","collection","db","unsubscribe","onSnapshot","async","usersData","snapshot","docs","map","doc","id","data","createdAt","seconds","_a$createdAt","_b$createdAt","usersWithAddresses","Promise","all","index","ordersQuery","query","where","orderBy","limit","orderSnapshot","getDocs","empty","_orderData$meals","_orderData$meals$","display","addressType","recipientName","unitDetails","localName","getAddressDisplay","meals","error","console","message","handleEditUser","handleSaveEdit","runTransaction","userRef","transaction","update","Number","handleDeleteUser","window","confirm","deleteDoc","userId","handlePageChange","newPage","prev","handleItemsPerPageChange","e","target","handleSort","columnName","prevOrder","getSortIcon","_jsx","ChevronUpIcon","className","ChevronDownIcon","getExportData","_user$createdAt","Date","toLocaleDateString","exportToExcel","ws","XLSX","json_to_sheet","wb","book_new","book_append_sheet","exportToPDF","jsPDF","head","Object","keys","body","row","values","autoTable","startY","styles","fontSize","cellPadding","headStyles","fillColor","textColor","fontStyle","alternateRowStyles","margin","top","left","right","bottom","save","previewTable","printWindow","open","exportData","tableHtml","key","join","document","write","close","focus","_jsxs","children","type","placeholder","onChange","classNames","Menu","as","Button","EllipsisVerticalIcon","Transition","React","enter","enterFrom","enterTo","leave","leaveFrom","leaveTo","Items","Item","_ref2","active","onClick","_ref3","_ref4","colSpan","title","PencilIcon","TrashIcon","InformationCircleIcon","disabled","xmlns","fill","viewBox","strokeWidth","stroke","strokeLinecap","strokeLinejoin","d","show","Dialog","onClose","Child","Panel","Title","XMarkIcon","onSubmit","preventDefault","htmlFor","required","min","year","month","day","classes","Boolean"],"sourceRoot":""}