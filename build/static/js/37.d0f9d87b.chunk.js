"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[37],{5343:(e,t,a)=>{a.d(t,{XF:()=>i,Zd:()=>d,_s:()=>n,fz:()=>u});const r=e=>(null!==e&&void 0!==e?e:"").toString().trim().toLowerCase(),s=e=>{const t="string"===typeof e?e:(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.label)||(null===e||void 0===e?void 0:e.title)||(null===e||void 0===e?void 0:e.method)||(null===e||void 0===e?void 0:e.type)||(null===e||void 0===e?void 0:e.payment)||"",a=r(t);return a.includes("efect")||a.includes("cash")?"cash":a.includes("nequi")?"nequi":a.includes("davi")?"daviplata":"other"},l=e=>"string"===typeof e?e:(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.label)||(null===e||void 0===e?void 0:e.title)||(null===e||void 0===e?void 0:e.method)||(null===e||void 0===e?void 0:e.type)||(null===e||void 0===e?void 0:e.payment)||"Otro",o=e=>{var t,a,r,o,i,n,d,c,u,m,x;const v=Math.floor(Number((null===e||void 0===e?void 0:e.total)||0))||0;if(Array.isArray(null===e||void 0===e?void 0:e.payments)&&e.payments.length)return e.payments.map(e=>{const t=Math.floor(Number((null===e||void 0===e?void 0:e.amount)||0))||0;return{methodKey:s(null===e||void 0===e?void 0:e.method),amount:t,rawLabel:l(null===e||void 0===e?void 0:e.method)}});const h=[null!==(t=null===e||void 0===e||null===(a=e.meals)||void 0===a||null===(r=a[0])||void 0===r?void 0:r.paymentMethod)&&void 0!==t?t:null===e||void 0===e||null===(o=e.meals)||void 0===o||null===(i=o[0])||void 0===i?void 0:i.payment,null!==(n=null===e||void 0===e||null===(d=e.breakfasts)||void 0===d||null===(c=d[0])||void 0===c?void 0:c.payment)&&void 0!==n?n:null===e||void 0===e||null===(u=e.breakfasts)||void 0===u||null===(m=u[0])||void 0===m?void 0:m.paymentMethod,null!==(x=null===e||void 0===e?void 0:e.paymentMethod)&&void 0!==x?x:null===e||void 0===e?void 0:e.payment].filter(Boolean);if(h.length){const e=l(h[0]);return[{methodKey:s(h[0]),amount:v,rawLabel:e}]}return[{methodKey:"other",amount:v,rawLabel:"Otro"}]},i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!Array.isArray(e)||!e.length)return"Sin pago";const t=e.reduce((e,t)=>{const a=t.methodKey||s(null===t||void 0===t?void 0:t.method);return e[a]=(e[a]||0)+(Math.floor(Number(t.amount||0))||0),e},{}),a=[];return t.cash&&a.push(`Efectivo $${t.cash.toLocaleString("es-CO")}`),t.nequi&&a.push(`Nequi $${t.nequi.toLocaleString("es-CO")}`),t.daviplata&&a.push(`Daviplata $${t.daviplata.toLocaleString("es-CO")}`),t.other&&!a.length&&a.push(`Otro $${t.other.toLocaleString("es-CO")}`),a.join(" + ")||"Sin pago"},n=e=>{const t=o(e);if(null!==t&&void 0!==t&&t.length)return t.map(e=>{let{methodKey:t,amount:a}=e;return{method:t,amount:a}});return[{method:"cash",amount:Math.floor(Number((null===e||void 0===e?void 0:e.total)||0))||0}]},d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t={cash:0,nequi:0,daviplata:0,other:0,total:0};for(const a of e){const e=o(a);for(const a of e){const e=Math.floor(Number(a.amount||0))||0;t[a.methodKey]=(t[a.methodKey]||0)+e,t.total+=e}}return t},c=e=>{var t,a;if(((null===e||void 0===e?void 0:e.__collection)||"").toLowerCase().includes("table"))return!0;const s=r((null===e||void 0===e?void 0:e.orderType)||(null===e||void 0===e||null===(t=e.breakfasts)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.orderType)||"");return!(!Array.isArray(null===e||void 0===e?void 0:e.breakfasts)||!(s.includes("table")||s.includes("takeaway")||s.includes("para llevar")||s.includes("llevar")))},u=function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const a={nequiTotal:0,daviplataTotal:0,nequiPendiente:0,daviplatasPendiente:0,cashSalon:0,cashClientesSettled:0,cashClientesPendiente:0,totalLiquidado:0,totalPendiente:0,totalDomicilios:0,totalSalon:0},r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];for(const l of e){const e=o(l),i=c(l);for(const o of e){const e=Math.floor(Number((null===o||void 0===o?void 0:o.amount)||0))||0;var t;if(!(e<=0))if(i)a.totalSalon+=e,"cash"===o.methodKey?a.cashSalon+=e:"nequi"===o.methodKey?a.nequiTotal+=e:"daviplata"===o.methodKey&&(a.daviplataTotal+=e),a.totalLiquidado+=e;else if(a.totalDomicilios+=e,"cash"===o.methodKey)null!==l&&void 0!==l&&l.settled||null!==l&&void 0!==l&&null!==(t=l.paymentSettled)&&void 0!==t&&t.cash?(a.cashClientesSettled+=e,a.totalLiquidado+=e):(a.cashClientesPendiente+=e,a.totalPendiente+=e);else if("nequi"===o.methodKey){var r;null!==l&&void 0!==l&&l.settled||null!==l&&void 0!==l&&null!==(r=l.paymentSettled)&&void 0!==r&&r.nequi?(a.nequiTotal+=e,a.totalLiquidado+=e):(a.nequiPendiente+=e,a.totalPendiente+=e)}else if("daviplata"===o.methodKey){var s;null!==l&&void 0!==l&&l.settled||null!==l&&void 0!==l&&null!==(s=l.paymentSettled)&&void 0!==s&&s.daviplata?(a.daviplataTotal+=e,a.totalLiquidado+=e):(a.daviplatasPendiente+=e,a.totalPendiente+=e)}}}};return r(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]),r(e),r(t),a.cashCaja=a.cashSalon+a.cashClientesSettled,a}},6568:(e,t,a)=>{function r(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter(Boolean).join(" ")}a.d(t,{x:()=>r})},9037:(e,t,a)=>{a.r(t),a.d(t,{default:()=>De});var r=a(5043),s=a(1958),l=a(458),o=a(5472),i=a(6568),n=a(7015),d=a(9795),c=a(4645),u=a(7719),m=a(614),x=a(1419),v=a(7118),h=a(4537),g=a(7856),y=a(9855),p=a(3062),b=a(5711),f=a(2382),j=a(8646),w=a(5088);const D="pendiente",N="entregado",k="cancelado",S={[D]:"Pendientes",[N]:"Entregados",[k]:"Cancelados"},A=["#fbbf24","#4ade80","#ef4444","#60a5fa","#a78bfa"],C="Ingresos",O="PedidosDiariosGuardados";var T=a(5343);const M=(e,t,a)=>{const r=new Date;r.setHours(0,0,0,0);let s=new Date(r),l=new Date(r);switch(l.setHours(23,59,59,999),e){case"7_days":default:s.setDate(r.getDate()-6);break;case"30_days":s=new Date(r.getFullYear(),r.getMonth(),1),l=new Date(r.getFullYear(),r.getMonth()+1,0),l.setHours(23,59,59,999);break;case"year":s=new Date(r.getFullYear(),0,1),l=new Date(r.getFullYear(),11,31),l.setHours(23,59,59,999);break;case"custom":s=t?new Date(t):null,s&&s.setHours(0,0,0,0),l=a?new Date(a):null,l&&l.setHours(23,59,59,999)}return{startDate:s,endDate:l}},z=e=>{const t=(null===e||void 0===e?void 0:e.createdAt)||(null===e||void 0===e?void 0:e.timestamp)||(null===e||void 0===e?void 0:e.date),a=null!==t&&void 0!==t&&t.toDate?t.toDate():t?new Date(t):null;return a?a.toISOString().split("T")[0]:null},E=e=>{return"string"===typeof e?e:e&&"object"===typeof e?String(null!==(t=null!==(a=null!==(r=e.name)&&void 0!==r?r:e.value)&&void 0!==a?a:e.label)&&void 0!==t?t:"").trim():"";var t,a,r},F=e=>{if(null!==e&&void 0!==e&&e.isBreakfast)return!0;if("breakfast"===E(null===e||void 0===e?void 0:e.meal).toLowerCase())return!0;if(Array.isArray(null===e||void 0===e?void 0:e.breakfasts)&&e.breakfasts.length>0)return!0;const t=[E(null===e||void 0===e?void 0:e.type),E(null===e||void 0===e?void 0:e.category),E(null===e||void 0===e?void 0:e.group),E(null===e||void 0===e?void 0:e.tag)].concat(Array.isArray(null===e||void 0===e?void 0:e.items)?e.items.map(e=>{var t;return E(null!==(t=null===e||void 0===e?void 0:e.category)&&void 0!==t?t:null===e||void 0===e?void 0:e.type)}):[]).join(" ").toLowerCase();return!(!t.includes("desayun")&&!t.includes("breakfast"))},P=e=>{var t,a,r,s,l;const o=[null===e||void 0===e?void 0:e.orderTypeNormalized,null===e||void 0===e?void 0:e.serviceType,null===e||void 0===e?void 0:e.orderType,null===e||void 0===e?void 0:e.channel,null===e||void 0===e?void 0:e.tipoPedido,null===e||void 0===e?void 0:e.typeOfOrder,null===e||void 0===e||null===(t=e.meals)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.orderType,null===e||void 0===e||null===(r=e.breakfasts)||void 0===r||null===(s=r[0])||void 0===s?void 0:s.orderType];for(const i of o){const e=E(i).toLowerCase();if(e){if(/mesa|table|sal[o\xf3]n|dine/.test(e))return"mesa";if(/llevar|para\s*llevar|take(?:-|\s)?away|to-?go|takeout/.test(e))return"llevar";if(/domicil|deliver|env[i\xed]o/.test(e))return"domicilio"}}return null!==e&&void 0!==e&&e.tableNumber||null!==e&&void 0!==e&&e.mesa||null!==e&&void 0!==e&&e.table?"mesa":null!==e&&void 0!==e&&null!==(l=e.address)&&void 0!==l&&l.address||null!==e&&void 0!==e&&e.deliveryAddress?"domicilio":null},I=(e,t,a,s,l,i,n,d,c,u,m)=>{var x;let v=null,h=null,g=null,y=null,p=null,b=null,f="7_days",j=null,w=null,I="7_days",$=null,L=null,_=null;"function"===typeof s?(v=s,h=e=>{var t;return null===(t=v)||void 0===t?void 0:t("error",e)},g=e=>{var t;return null===(t=v)||void 0===t?void 0:t("success",e)},y=l||null,p=i||null,b=n||null):(h=s,g=l,f=null!==i&&void 0!==i?i:f,j=null!==n&&void 0!==n?n:null,w=null!==d&&void 0!==d?d:null,I=null!==c&&void 0!==c?c:I,$=null!==u&&void 0!==u?u:null,L=null!==m&&void 0!==m?m:null,_=arguments.length>=12?arguments[11]:null,v=null,y=null,p=null,b=null);const[G,q]=(0,r.useState)(!0),[K,B]=(0,r.useState)([]),[J,H]=(0,r.useState)([]),[Y,V]=(0,r.useState)([]),[Q,R]=(0,r.useState)([]),[U,W]=(0,r.useState)([]),[Z,X]=(0,r.useState)([]),[ee,te]=(0,r.useState)({cash:0,cashCaja:0,cashPendiente:0,daviplata:0,nequi:0,expenses:0,expensesByProvider:{total:0,byProvider:{},counts:{}},byCategory:{domiciliosAlmuerzo:0,mesasAlmuerzo:0,llevarAlmuerzo:0,domiciliosDesayuno:0,mesasDesayuno:0,llevarDesayuno:0},grossIncome:0,net:0}),[ae,re]=(0,r.useState)({domicilio_almuerzo:0,domicilio_desayuno:0,mesa_almuerzo:0,llevar_almuerzo:0,mesa_desayuno:0,llevar_desayuno:0}),[se,le]=(0,r.useState)({Pending:0,Delivered:0,Cancelled:0}),[oe,ie]=(0,r.useState)([]),[ne,de]=(0,r.useState)([]),[ce,ue]=(0,r.useState)([]),[me,xe]=(0,r.useState)([]),[ve,he]=(0,r.useState)([]),[ge,ye]=(0,r.useState)([]),pe=(0,r.useRef)({orders:!1,tableOrders:!1,waiterOrders:!1,breakfastOrders:!1,breakfastSalonOrders:!1,users:!1,activity:!1,ingresos:!1,pedidosDiariosGuardados:!1,payments:!1}),be=(0,r.useMemo)(()=>[...J,...Y],[J,Y]),fe=()=>{pe.current.orders&&pe.current.tableOrders&&pe.current.waiterOrders&&pe.current.breakfastOrders&&pe.current.breakfastSalonOrders&&pe.current.users&&pe.current.activity&&pe.current.ingresos&&pe.current.pedidosDiariosGuardados&&pe.current.payments&&q(!1)};(0,r.useEffect)(()=>{const e={domiciliosAlmuerzo:0,mesasAlmuerzo:0,llevarAlmuerzo:0,domiciliosDesayuno:0,mesasDesayuno:0,llevarDesayuno:0};e.domiciliosAlmuerzo=K.reduce((e,t)=>e+Number(t.total||0),0);for(const u of be){const t=Number(u.total||0);if(t<=0)continue;const a=F(u),r=P(u)||"mesa";a?"breakfastOrders"!==u.__collection&&("mesa"===r?e.mesasDesayuno+=t:"llevar"===r?e.llevarDesayuno+=t:"domicilio"===r?e.domiciliosDesayuno+=t:e.mesasDesayuno+=t):"mesa"===r?e.mesasAlmuerzo+=t:"llevar"===r?e.llevarAlmuerzo+=t:"domicilio"===r?e.domiciliosAlmuerzo+=t:e.mesasAlmuerzo+=t}const t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=0,a=0;for(const r of e){const e=Number(r.total||0);if(e<=0)continue;const s=Array.isArray(r.breakfasts)?r.breakfasts:[];if(0===s.length){const s=P(r)||"mesa";"mesa"===s?t+=e:"llevar"===s&&(a+=e);continue}const l=e=>{const t=E(e).toLowerCase();return/mesa|table|sal[o\xf3]n|dine/.test(t)},o=e=>{const t=E(e).toLowerCase();return/llevar|take(?:-|\s)?away|to-?go|takeout/.test(t)},i=s.length,n=s.filter(e=>l(null===e||void 0===e?void 0:e.orderType)).length,d=s.filter(e=>o(null===e||void 0===e?void 0:e.orderType)).length;i>0&&(t+=e*(n/i),a+=e*(d/i))}return{mesa:Math.round(t),llevar:Math.round(a)}}(U||[]);e.mesasDesayuno+=t.mesa,e.llevarDesayuno+=t.llevar;for(const u of Q){var a,r,s,l;const t=Number(u.total||0);if(t<=0)continue;const o=P(u);null!==(a=u.address)&&void 0!==a&&a.address||null!==(r=u.breakfasts)&&void 0!==r&&null!==(s=r[0])&&void 0!==s&&null!==(l=s.address)&&void 0!==l&&l.address;"mesa"===o?e.mesasDesayuno+=t:"llevar"===o?e.llevarDesayuno+=t:e.domiciliosDesayuno+=t}const o=e.mesasAlmuerzo+e.llevarAlmuerzo+e.mesasDesayuno+e.llevarDesayuno,{totalDomicilios:i,totalLiquidado:n}=(0,T.fz)(K),d=o+i;te(t=>({...t,byCategory:{...e,totalDomicilios:i,ingresosSalon:o},grossIncome:d,net:Math.max(d-(t.expenses||0),0)}));const c=[...K,...be,...Q,...U];re(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t={domicilio_almuerzo:0,domicilio_desayuno:0,mesa_almuerzo:0,llevar_almuerzo:0,mesa_desayuno:0,llevar_desayuno:0};for(const a of e){const e=Number(null===a||void 0===a?void 0:a.total)||0;if(e<=0)continue;const r=F(a)?"desayuno":"almuerzo",s=P(a);s&&("domicilio"===s?t[`domicilio_${r}`]+=e:"mesa"===s?t[`mesa_${r}`]+=e:"llevar"===s&&(t[`llevar_${r}`]+=e))}return t}(c))},[K,be,Q,U]),(0,r.useEffect)(()=>{if(!e||!t||!a)return;q(!0);const r=[],s=(0,o.rJ)(e,"orders"),l=(0,o.aQ)(s,e=>{const t=e.docs.map(e=>({id:e.id,__collection:"orders",...e.data()}));B(t);const a={cash:0,daviplata:0,nequi:0},r={Pending:0,Delivered:0,Cancelled:0};t.forEach(e=>{var t;const s=e.paymentSummary||{};a.cash+=Number(s.Efectivo||0),a.daviplata+=Number(s.Daviplata||0),a.nequi+=Number(s.Nequi||0);const l=(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())||"";l===D?r.Pending+=1:l===N?r.Delivered+=1:l===k&&(r.Cancelled+=1)}),le(r);const s=[{name:S[D],value:r.Pending,color:A[0]},{name:S[N],value:r.Delivered,color:A[1]},{name:S[k],value:r.Cancelled,color:A[2]}];ye(s),pe.current.orders||(pe.current.orders=!0,fe())},e=>{var t;null===(t=h)||void 0===t||t(`Error al cargar pedidos: ${e.message}`),pe.current.orders||(pe.current.orders=!0,fe())});r.push(l);const i=(0,o.rJ)(e,"tableOrders"),n=(0,o.aQ)(i,e=>{const t=e.docs.map(e=>({id:e.id,__collection:"tableOrders",...e.data()}));H(t),pe.current.tableOrders||(pe.current.tableOrders=!0,fe())},e=>{var t;null===(t=h)||void 0===t||t(`Error al cargar pedidos de mesa: ${e.message}`),pe.current.tableOrders||(pe.current.tableOrders=!0,fe())});r.push(n);const d=(0,o.rJ)(e,"waiterOrders"),c=(0,o.aQ)(d,e=>{const t=e.docs.map(e=>({id:e.id,__collection:"waiterOrders",...e.data()}));V(t),pe.current.waiterOrders||(pe.current.waiterOrders=!0,fe())},e=>{var t;null===(t=h)||void 0===t||t(`Error al cargar pedidos del mesero: ${e.message}`),pe.current.waiterOrders||(pe.current.waiterOrders=!0,fe())});r.push(c);const u=(0,o.rJ)(e,"deliveryBreakfastOrders"),m=(0,o.aQ)(u,e=>{const t=e.docs.map(e=>({id:e.id,__collection:"deliveryBreakfastOrders",...e.data()}));R(t),pe.current.breakfastOrders||(pe.current.breakfastOrders=!0,fe())},e=>{var t;null===(t=h)||void 0===t||t(`Error al cargar desayunos (delivery): ${e.message}`),pe.current.breakfastOrders||(pe.current.breakfastOrders=!0,fe())});r.push(m);const x=(0,o.rJ)(e,"breakfastOrders"),v=(0,o.aQ)(x,e=>{const t=e.docs.map(e=>({id:e.id,__collection:"breakfastOrders",...e.data()}));W(t),pe.current.breakfastSalonOrders||(pe.current.breakfastSalonOrders=!0,fe())},e=>{var t;null===(t=h)||void 0===t||t(`Error al cargar desayunos de sal\xf3n: ${e.message}`),pe.current.breakfastSalonOrders||(pe.current.breakfastSalonOrders=!0,fe())});r.push(v);const g=(0,o.rJ)(e,"users"),b=(0,o.aQ)(g,e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));X(t),pe.current.users||(pe.current.users=!0,fe())},e=>{var t;null===(t=h)||void 0===t||t(`Error al cargar usuarios: ${e.message}`),pe.current.users||(pe.current.users=!0,fe())});r.push(b);const f=(0,o.rJ)(e,"userActivity"),j=(0,o.aQ)(f,e=>{const t=e.docs.map(e=>{const t=e.data(),a=t.timestamp instanceof o.Dc?t.timestamp.toDate():null;return{id:e.id,...t,timestamp:a}}).sort((e,t)=>(t.timestamp?t.timestamp.getTime():0)-(e.timestamp?e.timestamp.getTime():0));ie(t),pe.current.activity||(pe.current.activity=!0,fe())},e=>{var t;null===(t=h)||void 0===t||t(`Error al cargar actividad: ${e.message}`),pe.current.activity||(pe.current.activity=!0,fe())});r.push(j);const w=(0,o.rJ)(e,C),T=(0,o.aQ)(w,e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));de(t),pe.current.ingresos||(pe.current.ingresos=!0,fe())},e=>{var t;null===(t=h)||void 0===t||t(`Error al cargar ingresos: ${e.message}`),pe.current.ingresos||(pe.current.ingresos=!0,fe())});r.push(T);const M=(0,o.rJ)(e,O),z=(0,o.aQ)(M,e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));ue(t),pe.current.pedidosDiariosGuardados||(pe.current.pedidosDiariosGuardados=!0,fe())},e=>{var t;null===(t=h)||void 0===t||t(`Error al cargar pedidos diarios guardados: ${e.message}`),pe.current.pedidosDiariosGuardados||(pe.current.pedidosDiariosGuardados=!0,fe())});r.push(z);const E=y&&p?(0,o.P)((0,o.rJ)(e,"payments"),(0,o._M)("timestamp",">=",y),(0,o._M)("timestamp","<=",p),(0,o.My)("timestamp","asc")):(0,o.rJ)(e,"payments"),F=(0,o.aQ)(E,e=>{const t=e.docs.map(e=>({id:e.id,...e.data()})).filter(e=>!!e.timestamp);let a=0;const r={},s={};for(const l of t){const e=Number(l.amount||0),t=(l.provider||l.store||"\u2014").toString().trim()||"\u2014";a+=e,r[t]=(r[t]||0)+e,s[t]=(s[t]||0)+1}te(e=>{const t=Math.max((e.grossIncome||0)-a,0);return{...e,expenses:a,expensesByProvider:{total:a,byProvider:r,counts:s},net:t}}),pe.current.payments||(pe.current.payments=!0,fe())},e=>{var t;null===(t=h)||void 0===t||t(`Error al cargar pagos: ${e.message}`),pe.current.payments||(pe.current.payments=!0,fe())});return r.push(F),()=>{r.forEach(e=>e())}},[e,t,a]),(0,r.useEffect)(()=>{const e=(0,T.fz)(K,be,[...Q,...U]);te(t=>({...t,cash:e.cashCaja,cashCaja:e.cashCaja,cashPendiente:e.cashClientesPendiente,daviplata:e.daviplataTotal,nequi:e.nequiTotal,grossIncome:e.totalLiquidado,net:Math.max(e.totalLiquidado-(t.expenses||0),0)}))},[K,be,Q,U]),(0,r.useEffect)(()=>{if(!a)return;const e=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],{startDate:t,endDate:r}=M(f,j,w),s=new Date;s.setHours(0,0,0,0);const l=s.toISOString().split("T")[0];let o;if("year"!==f||_){const e={};if(ne.forEach(a=>{const s=new Date(a.date).toISOString().split("T")[0];if(s>=t.toISOString().split("T")[0]&&s<=r.toISOString().split("T")[0]){var l,o,i,n;const t=a.categories||{};e[s]={"Domicilios Almuerzo":((null===(l=e[s])||void 0===l?void 0:l["Domicilios Almuerzo"])||0)+Number(t.domiciliosAlmuerzo||0),"Domicilios Desayuno":((null===(o=e[s])||void 0===o?void 0:o["Domicilios Desayuno"])||0)+Number(t.domiciliosDesayuno||0),"Mesas/Llevar Almuerzo":((null===(i=e[s])||void 0===i?void 0:i["Mesas/Llevar Almuerzo"])||0)+Number(t.mesasAlmuerzo||0),"Mesas/Llevar Desayuno":((null===(n=e[s])||void 0===n?void 0:n["Mesas/Llevar Desayuno"])||0)+Number(t.mesasDesayuno||0)}}}),s>=t&&s<=r){var i,n,d,c;let a=0,s=0,o=0,u=0;K.forEach(e=>{var s;const l=null!==(s=e.createdAt)&&void 0!==s&&s.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:null;l&&l>=t.toISOString().split("T")[0]&&l<=r.toISOString().split("T")[0]&&(a+=Number(e.total||0))}),be.forEach(e=>{var a;const s=null!==(a=e.createdAt)&&void 0!==a&&a.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:null;if(s&&s>=t.toISOString().split("T")[0]&&s<=r.toISOString().split("T")[0]){F(e)?u+=Number(e.total||0):o+=Number(e.total||0)}}),U.forEach(e=>{var a;const s=null!==(a=e.createdAt)&&void 0!==a&&a.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:z(e);s&&s>=t.toISOString().split("T")[0]&&s<=r.toISOString().split("T")[0]&&(u+=Number(e.total||0))}),Q.forEach(e=>{const a=z(e);if(a&&a>=t.toISOString().split("T")[0]&&a<=r.toISOString().split("T")[0]){var l,o,i,n;const t=Number(e.total||0),a=P(e);null!==(l=e.address)&&void 0!==l&&l.address||null!==(o=e.breakfasts)&&void 0!==o&&null!==(i=o[0])&&void 0!==i&&null!==(n=i.address)&&void 0!==n&&n.address;"mesa"===a||"llevar"===a?u+=t:s+=t}});const m=l;e[m]={"Domicilios Almuerzo":((null===(i=e[m])||void 0===i?void 0:i["Domicilios Almuerzo"])||0)+a,"Domicilios Desayuno":((null===(n=e[m])||void 0===n?void 0:n["Domicilios Desayuno"])||0)+s,"Mesas/Llevar Almuerzo":((null===(d=e[m])||void 0===d?void 0:d["Mesas/Llevar Almuerzo"])||0)+o,"Mesas/Llevar Desayuno":((null===(c=e[m])||void 0===c?void 0:c["Mesas/Llevar Desayuno"])||0)+u}}o=Object.keys(e).sort((e,t)=>new Date(e)-new Date(t)).map(t=>({name:t,"Domicilios Almuerzo":e[t]["Domicilios Almuerzo"]||0,"Domicilios Desayuno":e[t]["Domicilios Desayuno"]||0,"Mesas/Llevar Almuerzo":e[t]["Mesas/Llevar Almuerzo"]||0,"Mesas/Llevar Desayuno":e[t]["Mesas/Llevar Desayuno"]||0}))}else{const t={},a=s.getFullYear();for(let e=0;e<12;e++){const r=`${a}-${String(e+1).padStart(2,"0")}`;t[r]={"Domicilios Almuerzo":0,"Domicilios Desayuno":0,"Mesas/Llevar Almuerzo":0,"Mesas/Llevar Desayuno":0}}ne.forEach(e=>{const r=new Date(e.date);if(r.getFullYear()===a){const a=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`,s=e.categories||{};t[a]["Domicilios Almuerzo"]+=Number(s.domiciliosAlmuerzo||0),t[a]["Domicilios Desayuno"]+=Number(s.domiciliosDesayuno||0),t[a]["Mesas/Llevar Almuerzo"]+=Number(s.mesasAlmuerzo||0),t[a]["Mesas/Llevar Desayuno"]+=Number(s.mesasDesayuno||0)}});const r=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`;let l={da:0,dd:0,ma:0,md:0};K.forEach(e=>{var t;const r=null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()):null;r&&r.getFullYear()===a&&r.getMonth()===s.getMonth()&&(l.da+=Number(e.total||0))}),be.forEach(e=>{var t;const r=null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()):null;if(r&&r.getFullYear()===a&&r.getMonth()===s.getMonth()){F(e)?l.md+=Number(e.total||0):l.ma+=Number(e.total||0)}}),U.forEach(e=>{var t;const r=null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()):null;r&&r.getFullYear()===a&&r.getMonth()===s.getMonth()&&(l.md+=Number(e.total||0))}),Q.forEach(e=>{var t,r,o,i;const n=z(e);if(!n)return;const d=new Date(n);if(d.getFullYear()!==a||d.getMonth()!==s.getMonth())return;const c=Number(e.total||0),u=P(e);null!==(t=e.address)&&void 0!==t&&t.address||null!==(r=e.breakfasts)&&void 0!==r&&null!==(o=r[0])&&void 0!==o&&null!==(i=o.address)&&void 0!==i&&i.address;"mesa"===u||"llevar"===u?l.md+=c:l.dd+=c}),t[r]["Domicilios Almuerzo"]+=l.da,t[r]["Mesas/Llevar Almuerzo"]+=l.ma,t[r]["Domicilios Desayuno"]+=l.dd,t[r]["Mesas/Llevar Desayuno"]+=l.md,o=Object.keys(t).map(a=>({name:e[parseInt(a.split("-")[1])-1],monthKey:a,"Domicilios Almuerzo":t[a]["Domicilios Almuerzo"],"Domicilios Desayuno":t[a]["Domicilios Desayuno"],"Mesas/Llevar Almuerzo":t[a]["Mesas/Llevar Almuerzo"],"Mesas/Llevar Desayuno":t[a]["Mesas/Llevar Desayuno"]}))}xe(o)},[K,be,Q,U,ne,f,j,w,a,_]),(0,r.useEffect)(()=>{if(!a)return;const e=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],{startDate:t,endDate:r}=M(I,$,L),s=new Date;s.setHours(0,0,0,0);const l=s.toISOString().split("T")[0];let o;if("year"!==I||_){const e={};if(ce.forEach(a=>{const s=new Date(a.date).toISOString().split("T")[0];if(s>=t.toISOString().split("T")[0]&&s<=r.toISOString().split("T")[0])if("year"===I&&_){`${new Date(a.date).getFullYear()}-${String(new Date(a.date).getMonth()+1).padStart(2,"0")}`===_&&(e[s]={Domicilios:a.domicilios||0,Mesas:a.mesas||0})}else e[s]={Domicilios:a.domicilios||0,Mesas:a.mesas||0}}),s>=t&&s<=r){let t=0,a=0;if(K.forEach(e=>{var a;(null!==(a=e.createdAt)&&void 0!==a&&a.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:null)===l&&t++}),be.forEach(e=>{var t;(null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:null)===l&&a++}),U.forEach(e=>{var t;(null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:z(e))===l&&a++}),"year"===I&&_){var i,n;if(`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`===_)e[l]={Domicilios:((null===(i=e[l])||void 0===i?void 0:i.Domicilios)||0)+t,Mesas:((null===(n=e[l])||void 0===n?void 0:n.Mesas)||0)+a}}else{var d,c;e[l]={Domicilios:((null===(d=e[l])||void 0===d?void 0:d.Domicilios)||0)+t,Mesas:((null===(c=e[l])||void 0===c?void 0:c.Mesas)||0)+a}}}o=Object.keys(e).sort((e,t)=>new Date(e)-new Date(t)).map(t=>({name:t,Domicilios:e[t].Domicilios,Mesas:e[t].Mesas}))}else{const t={},a=s.getFullYear();for(let e=0;e<12;e++){const r=`${a}-${String(e+1).padStart(2,"0")}`;t[r]={domicilios:0,mesas:0}}ce.forEach(e=>{const r=new Date(e.date);if(r.getFullYear()===a){const a=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`;t[a].domicilios+=e.domicilios||0,t[a].mesas+=e.mesas||0}});const r=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`;let l=0,i=0;K.forEach(e=>{var t;const r=null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()):null;r&&r.getFullYear()===a&&r.getMonth()===s.getMonth()&&l++}),be.forEach(e=>{var t;const r=null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()):null;r&&r.getFullYear()===a&&r.getMonth()===s.getMonth()&&i++}),U.forEach(e=>{var t;const r=null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()):null;r&&r.getFullYear()===a&&r.getMonth()===s.getMonth()&&i++}),t[r].domicilios+=l,t[r].mesas+=i,o=Object.keys(t).map(a=>({name:e[parseInt(a.split("-")[1])-1],monthKey:a,Domicilios:t[a].domicilios,Mesas:t[a].mesas}))}he(o)},[K,be,U,ce,I,$,L,a,_]);const je=(0,r.useCallback)(async()=>{q(!0);try{const r=(new Date).toISOString().split("T")[0];let s=0,l=0,i=0,n=0;K.forEach(e=>{var t;(null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:null)===r&&(s+=Number(e.total||0))}),be.forEach(e=>{var t;if((null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:null)!==r)return;const a=Number(e.total||0);if(a<=0)return;F(e)?n+=a:i+=a}),U.forEach(e=>{var t;(null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:z(e))===r&&(n+=Number(e.total||0))}),Q.forEach(e=>{if(z(e)===r){var t,a,s,o;const r=Number(e.total||0),i=P(e);null!==(t=e.address)&&void 0!==t&&t.address||null!==(a=e.breakfasts)&&void 0!==a&&null!==(s=a[0])&&void 0!==s&&null!==(o=s.address)&&void 0!==o&&o.address;"mesa"===i||"llevar"===i?n+=r:l+=r}});const d=s+l+i+n,c=(0,o.P)((0,o.rJ)(e,C),(0,o._M)("date","==",r)),u=await(0,o.GG)(c),m={date:r,categories:{domiciliosAlmuerzo:s,domiciliosDesayuno:l,mesasAlmuerzo:i,mesasDesayuno:n},totalIncome:d,updatedAt:(0,o.O5)()};var t,a;if(u.empty)await(0,o.gS)((0,o.rJ)(e,C),{...m,createdAt:(0,o.O5)()}),null===(t=g)||void 0===t||t(`Resumen de ingresos para ${r} guardado correctamente.`);else await(0,o.mZ)((0,o.H9)(e,C,u.docs[0].id),m),null===(a=g)||void 0===a||a(`Resumen de ingresos para ${r} actualizado correctamente.`)}catch(s){var r;null===(r=h)||void 0===r||r(`Error al guardar/actualizar resumen de ingresos: ${s.message}`),console.error("Error al guardar ingresos diarios:",s)}finally{q(!1)}},[e,K,be,Q,U,g,h]);(0,r.useEffect)(()=>{if(!a)return;const t=()=>{const a=new Date,r=new Date(a);r.setDate(a.getDate()+1),r.setHours(0,0,5,0);const s=r.getTime()-a.getTime();return setTimeout(async()=>{await(async()=>{try{const t=new Date,a=t.toISOString().split("T")[0],r=new Date(t);r.setDate(r.getDate()-1),r.setHours(0,0,0,0);const s=r.toISOString().split("T")[0],l=(e,t)=>{const a=null!==e&&void 0!==e&&e.toDate?e.toDate():e?new Date(e):null;return!!a&&a.toISOString().split("T")[0]===t};let i=0,n=0,d=0,c=0;K.forEach(e=>{l(e.createdAt,s)&&(i+=Number(e.total||0))}),be.forEach(e=>{if(!l(e.createdAt,s))return;const t=Number(e.total||0);t<=0||(F(e)?c+=t:d+=t)}),U.forEach(e=>{z(e)===s&&(c+=Number(e.total||0))}),Q.forEach(e=>{var t,a,r,l;if(z(e)!==s)return;const o=Number(e.total||0),i=P(e);null!==(t=e.address)&&void 0!==t&&t.address||null!==(a=e.breakfasts)&&void 0!==a&&null!==(r=a[0])&&void 0!==r&&null!==(l=r.address)&&void 0!==l&&l.address,"mesa"===i||"llevar"===i?c+=o:n+=o});const u={date:s,categories:{domiciliosAlmuerzo:i,domiciliosDesayuno:n,mesasAlmuerzo:d,mesasDesayuno:c},totalIncome:i+n+d+c,updatedAt:(0,o.O5)()},m=(0,o.P)((0,o.rJ)(e,C),(0,o._M)("date","==",s)),x=await(0,o.GG)(m);x.empty?await(0,o.gS)((0,o.rJ)(e,C),{...u,createdAt:(0,o.O5)()}):await(0,o.mZ)((0,o.H9)(e,C,x.docs[0].id),u);const v=(0,o.P)((0,o.rJ)(e,C),(0,o._M)("date","==",a));(await(0,o.GG)(v)).empty&&await(0,o.gS)((0,o.rJ)(e,C),{date:a,categories:{domiciliosAlmuerzo:0,domiciliosDesayuno:0,mesasAlmuerzo:0,mesasDesayuno:0},totalIncome:0,createdAt:(0,o.O5)(),updatedAt:(0,o.O5)()})}catch(a){var t;null===(t=h)||void 0===t||t(`Cierre autom\xe1tico: ${a.message}`),console.error("Cierre autom\xe1tico diario",a)}})(),t()},s)},r=t();return()=>clearTimeout(r)},[a,K,be,Q,U,h]);const we=(0,r.useCallback)(async()=>{q(!0);try{const r=(new Date).toISOString().split("T")[0],s=(0,o.P)((0,o.rJ)(e,C),(0,o._M)("date","==",r)),l=await(0,o.GG)(s);if(l.empty){var t;null===(t=g)||void 0===t||t(`No se encontr\xf3 un resumen de ingresos para ${r} para eliminar.`)}else{var a;const t=l.docs[0];await(0,o.kd)((0,o.H9)(e,C,t.id)),null===(a=g)||void 0===a||a(`Resumen de ingresos para ${r} eliminado correctamente.`)}}catch(s){var r;null===(r=h)||void 0===r||r(`Error al eliminar resumen de ingresos: ${s.message}`),console.error("Error al eliminar ingresos diarios:",s)}finally{q(!1)}},[e,g,h]),De=(0,r.useCallback)(async()=>{q(!0);try{const r=(new Date).toISOString().split("T")[0];let s=0,l=0;K.forEach(e=>{var t;(null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:null)===r&&s++}),be.forEach(e=>{var t;(null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:null)===r&&l++}),U.forEach(e=>{var t;(null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:z(e))===r&&l++});const i=(0,o.P)((0,o.rJ)(e,O),(0,o._M)("date","==",r)),n=await(0,o.GG)(i);if(n.empty){var t;await(0,o.gS)((0,o.rJ)(e,O),{date:r,domicilios:s,mesas:l,createdAt:(0,o.O5)(),updatedAt:(0,o.O5)()}),null===(t=g)||void 0===t||t(`Conteo de pedidos diarios para ${r} guardado correctamente.`)}else{var a;const t=n.docs[0];await(0,o.mZ)((0,o.H9)(e,O,t.id),{domicilios:s,mesas:l,updatedAt:(0,o.O5)()}),null===(a=g)||void 0===a||a(`Conteo de pedidos diarios para ${r} actualizado correctamente.`)}}catch(s){var r;null===(r=h)||void 0===r||r(`Error al guardar/actualizar conteo de pedidos diarios: ${s.message}`),console.error("Error al guardar conteo de pedidos diarios:",s)}finally{q(!1)}},[e,K,be,U,g,h]),Ne=(0,r.useCallback)(async()=>{q(!0);try{const r=(new Date).toISOString().split("T")[0],s=(0,o.P)((0,o.rJ)(e,O),(0,o._M)("date","==",r)),l=await(0,o.GG)(s);if(l.empty){var t;null===(t=g)||void 0===t||t(`No se encontr\xf3 un conteo de pedidos diarios para ${r} para eliminar.`)}else{var a;const t=l.docs[0];await(0,o.kd)((0,o.H9)(e,O,t.id)),null===(a=g)||void 0===a||a(`Conteo de pedidos diarios para ${r} eliminado correctamente.`)}}catch(s){var r;null===(r=h)||void 0===r||r(`Error al eliminar conteo de pedidos diarios: ${s.message}`),console.error("Error al eliminar conteo de pedidos diarios:",s)}finally{q(!1)}},[e,g,h]);return{loadingData:G,orders:K,tableOrders:J,waiterOrders:Y,breakfastOrders:Q,breakfastSalonOrders:U,users:Z,totals:ee,statusCounts:se,userActivity:oe,ingresosCategoriasData:me,gastosPorTiendaData:Object.entries((null===ee||void 0===ee||null===(x=ee.expensesByProvider)||void 0===x?void 0:x.byProvider)||{}).map(e=>{let[t,a]=e;return{name:t,value:a}}),pedidosDiariosChartData:ve,statusPieChartData:ge,saleTypeBreakdown:ae,handleSaveDailyIngresos:je,handleDeleteDailyIngresos:we,handleSaveDailyOrders:De,handleDeleteDailyOrders:Ne}};var $=a(5323),L=a(108),_=a(1474),G=a(7734),q=a(2185),K=a(760),B=a(379),J=a(95),H=a(7136),Y=a(6992),V=a(6102),Q=a(7869),R=a(2647),U=a(5686),W=a(8693),Z=a(5469),X=a(1990),ee=a(4919),te=a(2319),ae=a(579);const re=e=>{let{type:t,theme:a,isMobile:r}=e;if("bar"===t){const e=r?5:7;return(0,ae.jsx)("div",{className:"flex h-full items-end justify-around p-4 animate-pulse",children:Array.from({length:e}).map((t,r)=>(0,ae.jsx)("div",{className:(0,i.x)("rounded-t-md","dark"===a?"bg-gray-700":"bg-gray-200","mx-1"),style:{width:100/e-5+"%",height:70*Math.random()+30+"%"}},r))})}return"pie"===t?(0,ae.jsx)("div",{className:"flex justify-center items-center h-full animate-pulse",children:(0,ae.jsx)("div",{className:(0,i.x)(r?"w-32 h-32":"w-40 h-40","rounded-full","dark"===a?"bg-gray-700":"bg-gray-200")})}):null},se=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}),le=e=>{let{active:t,payload:a,label:r,theme:s,chartTextColor:l,copFormatter:o,isOrderChart:i=!1}=e;if(t&&a&&a.length){const e=a.reduce((e,t)=>e+t.value,0),t=i?e=>e.toLocaleString():e=>"function"===typeof o?o(e):o.format(e);return(0,ae.jsxs)($.P.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:5},className:"custom-tooltip p-3 rounded-xl shadow-lg border",style:{backgroundColor:"dark"===s?"rgba(31, 41, 55, 0.95)":"rgba(255, 255, 255, 0.95)",borderColor:"dark"===s?"rgba(75, 85, 99, 0.7)":"rgba(229, 231, 235, 0.7)",backdropFilter:"blur(8px)",color:l,fontSize:"14px"},children:[(0,ae.jsx)("p",{className:"font-bold mb-1",children:r}),a.map((e,a)=>(0,ae.jsxs)("p",{style:{color:e.color||l},children:[e.name,": ",(0,ae.jsx)("span",{className:"font-semibold",children:t(e.value)})]},`item-${a}`)),(0,ae.jsxs)("p",{className:"font-bold mt-2 border-t pt-2",style:{borderColor:"dark"===s?"#4b5563":"#e5e7eb"},children:["Total: ",t(e)]})]})}return null},oe=e=>{let{active:t,payload:a,theme:r,chartTextColor:s}=e;if(t&&a&&a.length){const e=a[0].payload;return(0,ae.jsxs)($.P.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:5},className:"custom-tooltip p-3 rounded-xl shadow-lg border",style:{backgroundColor:"dark"===r?"rgba(31, 41, 55, 0.95)":"rgba(255, 255, 255, 0.95)",borderColor:"dark"===r?"rgba(75, 85, 99, 0.7)":"rgba(229, 231, 235, 0.7)",backdropFilter:"blur(8px)",color:s,fontSize:"14px"},children:[(0,ae.jsx)("p",{className:"font-bold mb-1",style:{color:e.color||s},children:e.name}),(0,ae.jsxs)("p",{children:["Valor: ",(0,ae.jsx)("span",{className:"font-semibold",children:e.value})]}),(0,ae.jsxs)("p",{children:["Porcentaje: ",(0,ae.jsx)("span",{className:"font-semibold",children:`${(100*e.percent).toFixed(1)}%`})]})]})}return null},ie=r.memo(e=>{let{dailySalesChartData:t,dailyOrdersChartData:a,statusPieChartData:l,theme:d="dark",chartTextColor:u="#ffffff",salesFilterRange:m,setSalesFilterRange:x=()=>{},salesCustomStartDate:v,setSalesCustomStartDate:h=()=>{},salesCustomEndDate:g,setSalesCustomEndDate:b=()=>{},ordersFilterRange:f,setOrdersFilterRange:j=()=>{},ordersCustomStartDate:w,setOrdersCustomStartDate:D=()=>{},ordersCustomEndDate:N,setOrdersCustomEndDate:k=()=>{},handleSaveDailyIngresos:S=()=>{},handleDeleteDailyIngresos:C=()=>{},handleSaveDailyOrders:O=()=>{},handleDeleteDailyOrders:T=()=>{},handleSaveDailyExpenses:M=()=>{},handleDeleteDailyExpenses:z=()=>{},loading:E,selectedMonth:F,setSelectedMonth:P=()=>{}}=e;const[I,ie]=(0,r.useState)(!1),[ne,de]=(0,r.useState)([]),[ce,ue]=(0,r.useState)("30_days"),[me,xe]=(0,r.useState)(null),[ve,he]=(0,r.useState)(null),[ge,ye]=(0,r.useState)(null);(0,r.useEffect)(()=>{const e=(0,o.P)((0,o.rJ)(s.db,"payments"),(0,o.My)("timestamp","desc")),t=(0,o.aQ)(e,e=>{de(e.docs.map(e=>({id:e.id,...e.data()})))},e=>console.error(`Error al cargar pagos: ${e.message}`));return()=>t()},[]),(0,r.useEffect)(()=>{const e=()=>{ie((0,te.Fr)())};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const pe=(0,r.useMemo)(()=>{const e=ne.reduce((e,t)=>{if(!t.timestamp)return e;const a=new Date(t.timestamp.toDate()),r=new Date;let s;if(s="7_days"===ce?new Date(r.setDate(r.getDate()-7)):"30_days"===ce?new Date(r.setDate(r.getDate()-30)):"year"===ce?new Date(r.getFullYear(),0,1):"custom"===ce&&me&&ve?new Date(me):new Date(0),"custom"===ce&&ve){const t=new Date(ve);if(a<s||a>t)return e}else if(a<s)return e;const l=a.toISOString().split("T")[0];return e[l]||(e[l]={name:l,Total:0}),e[l].Total+=t.amount,e},{});return Object.values(e).sort((e,t)=>new Date(e.name)-new Date(t.name))},[ne,ce,me,ve]),be=(0,r.useMemo)(()=>ne.reduce((e,t)=>e+t.amount,0),[ne]),fe=(0,r.useMemo)(()=>l.reduce((e,t)=>e+t.value,0),[l]),je=(0,r.useMemo)(()=>{const e=ne.reduce((e,t)=>{const a=t.store||"Desconocido";return e[a]||(e[a]={totalAmount:0,payments:[]}),e[a].totalAmount+=t.amount,e[a].payments.push(t),e},{});return Object.entries(e).map(e=>{let[t,a]=e;return{store:t,...a}}).sort((e,t)=>t.totalAmount-e.totalAmount)},[ne]),we=(0,r.useMemo)(()=>ge?ne.filter(e=>e.store===ge).sort((e,t)=>t.timestamp.toDate()-e.timestamp.toDate()):[],[ne,ge]),De={hidden:{opacity:0,scale:.98,y:10},visible:{opacity:1,scale:1,y:0,transition:{duration:.6,ease:"easeOut"}},exit:{opacity:0,scale:.98,y:10,transition:{duration:.4,ease:"easeIn"}}},Ne=I?"min-w-[700px]":"min-w-0",ke=I?"h-[250px]":"h-[300px]";return(0,ae.jsxs)("div",{className:"flex flex-col gap-12 mb-8 px-4 sm:px-6 lg:px-8 pb-12",children:[(0,ae.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n  .custom-scrollbar::-webkit-scrollbar {\n    width: 8px;\n    height: 8px;\n  }\n  .custom-scrollbar::-webkit-scrollbar-track {\n    background: var(--scrollbar-track-color, #2d3748);\n    border-radius: 10px;\n  }\n  .custom-scrollbar::-webkit-scrollbar-thumb {\n    background: var(--scrollbar-thumb-color, #4a5568);\n    border-radius: 10px;\n  }\n  .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n    background: var(--scrollbar-thumb-hover-color, #64748b);\n  }\n  .custom-scrollbar {\n    scrollbar-width: thin;\n    scrollbar-color: var(--scrollbar-thumb-color, #4a5568) var(--scrollbar-track-color, #2d3748);\n  }\n"}}),(0,ae.jsxs)("div",{className:(0,i.x)("dark"===d?"bg-gray-800":"bg-white",I?"p-4":"p-6","rounded-2xl shadow-xl border","dark"===d?"border-gray-700":"border-gray-200","relative min-h-[450px] flex flex-col"),children:[(0,ae.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ae.jsxs)("h3",{className:"text-xl font-semibold mb-4 text-gray-200 dark:text-gray-100 flex items-center",children:[(0,ae.jsx)(p.A,{className:(0,i.x)(I?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-green-400")}),"Ingresos Diarios"]}),(0,ae.jsxs)(c.AM,{className:"relative",children:[(0,ae.jsx)(c.ut,{className:"p-2 rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",children:(0,ae.jsx)(U.A,{className:(0,i.x)(I?"w-4 h-4":"w-5 h-5","text-gray-400")})}),(0,ae.jsx)(n.e,{as:r.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:(0,ae.jsx)(c.QT,{className:(0,i.x)("absolute z-50 mt-2","right-0 left-auto",I?"w-[150px] text-sm":"w-56","rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none","dark"===d?"bg-gray-700":"bg-white","origin-top-right","max-h-[80vh] overflow-y-auto custom-scrollbar"),children:(0,ae.jsxs)("div",{className:"py-1",children:[(0,ae.jsxs)("button",{onClick:S,disabled:E,className:(0,i.x)("block w-full text-left px-4 py-2 flex items-center transition-colors",I?"text-xs":"text-sm",E?"text-gray-400 cursor-not-allowed":"dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:[(0,ae.jsx)(W.A,{className:(0,i.x)(I?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-blue-400")}),E?"Guardando...":"Guardar Ventas del D\xeda"]}),(0,ae.jsxs)("button",{onClick:()=>C(),disabled:E,className:(0,i.x)("block w-full text-left px-4 py-2 flex items-center mt-1 transition-colors",I?"text-xs":"text-sm",E?"text-gray-400 cursor-not-allowed":"dark"===d?"text-red-300 hover:bg-gray-600":"text-red-600 hover:bg-gray-100"),children:[(0,ae.jsx)(y.A,{className:(0,i.x)(I?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-red-400")}),"Eliminar Ventas del D\xeda"]}),(0,ae.jsx)("div",{className:(0,i.x)("my-1","dark"===d?"border-t border-gray-600":"border-t border-gray-200")}),(0,ae.jsx)("button",{onClick:()=>{x("7_days"),h(null),b(null),P(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",I?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver \xfaltimos 7 d\xedas"}),(0,ae.jsx)("button",{onClick:()=>{x("30_days"),h(null),b(null),P(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",I?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver todo el mes"}),(0,ae.jsx)("button",{onClick:()=>{x("year"),h(null),b(null),P(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",I?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver todo el a\xf1o"}),(0,ae.jsx)("div",{className:(0,i.x)("my-1","dark"===d?"border-t border-gray-600":"border-t border-gray-200")}),(0,ae.jsx)("div",{className:(0,i.x)("px-4 py-2 font-medium text-gray-400",I?"text-xs":"text-sm"),children:"Filtros personalizados"}),(0,ae.jsxs)("div",{className:"px-4 py-2",children:[(0,ae.jsx)("label",{className:(0,i.x)("block font-medium text-gray-400 mb-1",I?"text-xs":"text-sm"),children:"Desde:"}),(0,ae.jsx)("input",{type:"date",value:v?v.toISOString().split("T")[0]:"",onChange:e=>{h(new Date(e.target.value)),x("custom"),P(null)},className:(0,i.x)("block w-full rounded-md shadow-sm p-2",I?"text-xs sm:text-sm":"text-sm","dark"===d?"bg-gray-800 text-gray-200 border-gray-600":"bg-white text-gray-900 border-gray-300")})]}),(0,ae.jsxs)("div",{className:"px-4 py-2",children:[(0,ae.jsx)("label",{className:(0,i.x)("block font-medium text-gray-400 mb-1",I?"text-xs":"text-sm"),children:"Hasta:"}),(0,ae.jsx)("input",{type:"date",value:g?g.toISOString().split("T")[0]:"",onChange:e=>{b(new Date(e.target.value)),x("custom")},className:(0,i.x)("block w-full rounded-md shadow-sm p-2",I?"text-xs sm:text-sm":"text-sm","dark"===d?"bg-gray-800 text-gray-200 border-gray-600":"bg-white text-gray-900 border-gray-300")})]})]})})})]})]}),(0,ae.jsxs)($.P.div,{className:(0,i.x)(I?"overflow-x-auto overflow-y-hidden custom-scrollbar":"overflow-x-hidden overflow-y-hidden","relative flex flex-col flex-grow"),variants:De,initial:"hidden",animate:"visible",exit:"exit",children:["year"===m&&F&&(0,ae.jsxs)($.P.button,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},onClick:()=>P(null),className:"mb-4 text-blue-500 hover:underline text-sm self-start transition-all duration-200",children:[(0,ae.jsx)(Z.A,{className:"w-4 h-4 inline-block mr-2"}),"Volver al resumen anual"]}),E?(0,ae.jsx)(re,{type:"bar",theme:d,isMobile:I}):(0,ae.jsx)("div",{className:(0,i.x)("w-full",ke,Ne),children:(0,ae.jsx)(L.u,{width:"100%",height:"100%",children:(0,ae.jsxs)(_.E,{data:t,margin:{top:20,right:30,left:20,bottom:20},barCategoryGap:I?"0%":"40%",barGap:1,children:[(0,ae.jsx)(G.d,{strokeDasharray:I?"2 2":"3 3",stroke:"dark"===d?"#4b5563":"#e5e7eb",vertical:!1}),(0,ae.jsx)(q.W,{dataKey:"name",stroke:u,tick:{fill:u,fontSize:I?9:11},angle:-45,textAnchor:"end",interval:0,height:60}),(0,ae.jsx)(K.h,{stroke:u,tick:{fill:u,fontSize:I?9:11},tickFormatter:e=>se.format(e),width:I?50:80}),(0,ae.jsx)(B.m,{cursor:{fill:"dark"===d?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)",rx:4},content:(0,ae.jsx)(le,{theme:d,chartTextColor:u,copFormatter:se})}),(0,ae.jsx)(J.s,{wrapperStyle:{color:u,fontSize:I?10:13,paddingTop:"15px",paddingBottom:"20px"},align:"center",verticalAlign:"top",iconType:"circle"}),(0,ae.jsx)(H.y,{dataKey:"Domicilios Almuerzo",fill:"#34D399",stroke:"#34D399",radius:[8,8,0,0],maxBarSize:I?12:25,animationDuration:800,onClick:e=>{"year"===m&&e.monthKey&&P(e.monthKey)}}),(0,ae.jsx)(H.y,{dataKey:"Domicilios Desayuno",fill:"#60A5FA",stroke:"#60A5FA",radius:[8,8,0,0],maxBarSize:I?12:25,animationDuration:800}),(0,ae.jsx)(H.y,{dataKey:"Mesas/Llevar Almuerzo",fill:"#FBBF24",stroke:"#FBBF24",radius:[8,8,0,0],maxBarSize:I?12:25,animationDuration:800}),(0,ae.jsx)(H.y,{dataKey:"Mesas/Llevar Desayuno",fill:"#F472B6",stroke:"#F472B6",radius:[8,8,0,0],maxBarSize:I?12:25,animationDuration:800})]})})})]})]}),(0,ae.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[(0,ae.jsxs)("div",{className:(0,i.x)("dark"===d?"bg-gray-800":"bg-white",I?"p-4":"p-6","rounded-2xl shadow-xl border","dark"===d?"border-gray-700":"border-gray-200","relative min-h-[350px] flex flex-col"),children:[(0,ae.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ae.jsxs)("h3",{className:"text-xl font-semibold mb-4 text-gray-200 dark:text-gray-100 flex items-center",children:[(0,ae.jsx)(p.A,{className:(0,i.x)(I?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-red-400")}),"Gastos Diarios"]}),(0,ae.jsxs)(c.AM,{className:"relative",children:[(0,ae.jsx)(c.ut,{className:"p-2 rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",children:(0,ae.jsx)(U.A,{className:(0,i.x)(I?"w-4 h-4":"w-5 h-5","text-gray-400")})}),(0,ae.jsx)(n.e,{as:r.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:(0,ae.jsx)(c.QT,{className:(0,i.x)("absolute z-50 mt-2","right-0 left-auto",I?"w-[150px] text-sm":"w-56","rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none","dark"===d?"bg-gray-700":"bg-white","origin-top-right","max-h-[80vh] overflow-y-auto custom-scrollbar"),children:(0,ae.jsxs)("div",{className:"py-1",children:[(0,ae.jsxs)("button",{onClick:M,disabled:E,className:(0,i.x)("block w-full text-left px-4 py-2 flex items-center transition-colors",I?"text-xs":"text-sm",E?"text-gray-400 cursor-not-allowed":"dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:[(0,ae.jsx)(W.A,{className:(0,i.x)(I?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-blue-400")}),E?"Guardando...":"Guardar Gastos del D\xeda"]}),(0,ae.jsxs)("button",{onClick:()=>z(),disabled:E,className:(0,i.x)("block w-full text-left px-4 py-2 flex items-center mt-1 transition-colors",I?"text-xs":"text-sm",E?"text-gray-400 cursor-not-allowed":"dark"===d?"text-red-300 hover:bg-gray-600":"text-red-600 hover:bg-gray-100"),children:[(0,ae.jsx)(y.A,{className:(0,i.x)(I?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-red-400")}),"Eliminar Gastos del D\xeda"]}),(0,ae.jsx)("div",{className:(0,i.x)("my-1","dark"===d?"border-t border-gray-600":"border-t border-gray-200")}),(0,ae.jsx)("button",{onClick:()=>{ue("7_days"),xe(null),he(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",I?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver \xfaltimos 7 d\xedas"}),(0,ae.jsx)("button",{onClick:()=>{ue("30_days"),xe(null),he(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",I?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver todo el mes"}),(0,ae.jsx)("button",{onClick:()=>{ue("year"),xe(null),he(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",I?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver todo el a\xf1o"}),(0,ae.jsx)("div",{className:(0,i.x)("my-1","dark"===d?"border-t border-gray-600":"border-t border-gray-200")}),(0,ae.jsx)("div",{className:(0,i.x)("px-4 py-2 font-medium text-gray-400",I?"text-xs":"text-sm"),children:"Filtros personalizados"}),(0,ae.jsxs)("div",{className:"px-4 py-2",children:[(0,ae.jsx)("label",{className:(0,i.x)("block font-medium text-gray-400 mb-1",I?"text-xs":"text-sm"),children:"Desde:"}),(0,ae.jsx)("input",{type:"date",value:me?me.toISOString().split("T")[0]:"",onChange:e=>{xe(new Date(e.target.value)),ue("custom")},className:(0,i.x)("block w-full rounded-md shadow-sm p-2",I?"text-xs sm:text-sm":"text-sm","dark"===d?"bg-gray-800 text-gray-200 border-gray-600":"bg-white text-gray-900 border-gray-300")})]}),(0,ae.jsxs)("div",{className:"px-4 py-2",children:[(0,ae.jsx)("label",{className:(0,i.x)("block font-medium text-gray-400 mb-1",I?"text-xs":"text-sm"),children:"Hasta:"}),(0,ae.jsx)("input",{type:"date",value:ve?ve.toISOString().split("T")[0]:"",onChange:e=>{he(new Date(e.target.value)),ue("custom")},className:(0,i.x)("block w-full rounded-md shadow-sm p-2",I?"text-xs sm:text-sm":"text-sm","dark"===d?"bg-gray-800 text-gray-200 border-gray-600":"bg-white text-gray-900 border-gray-300")})]})]})})})]})]}),(0,ae.jsx)($.P.div,{className:(0,i.x)(I?"overflow-x-auto overflow-y-hidden custom-scrollbar":"overflow-x-hidden overflow-y-hidden","relative flex flex-col flex-grow"),variants:De,initial:"hidden",animate:"visible",exit:"exit",children:E?(0,ae.jsx)(re,{type:"bar",theme:d,isMobile:I}):(0,ae.jsx)("div",{className:(0,i.x)("w-full",ke,Ne),children:(0,ae.jsx)(L.u,{width:"100%",height:"100%",children:(0,ae.jsxs)(_.E,{data:pe,margin:{top:20,right:30,left:20,bottom:20},barCategoryGap:I?"0%":"40%",barGap:1,children:[(0,ae.jsx)(G.d,{strokeDasharray:I?"2 2":"3 3",stroke:"dark"===d?"#4b5563":"#e5e7eb",vertical:!1}),(0,ae.jsx)(q.W,{dataKey:"name",stroke:u,tick:{fill:u,fontSize:I?9:11},angle:-45,textAnchor:"end",interval:0,height:60}),(0,ae.jsx)(K.h,{stroke:u,tick:{fill:u,fontSize:I?9:11},tickFormatter:e=>se.format(e),width:I?50:80}),(0,ae.jsx)(B.m,{cursor:{fill:"dark"===d?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)",rx:4},content:(0,ae.jsx)(le,{theme:d,chartTextColor:u,copFormatter:se})}),(0,ae.jsx)(J.s,{wrapperStyle:{color:u,paddingTop:"15px",fontSize:I?10:13},align:"center",verticalAlign:"top",iconType:"circle"}),(0,ae.jsx)(H.y,{dataKey:"Total",fill:"#EF4444",stroke:"#EF4444",radius:[8,8,0,0],maxBarSize:I?12:25,animationDuration:800})]})})})})]}),(0,ae.jsxs)($.P.div,{className:(0,i.x)(`bg-${"dark"===d?"gray-800":"white"} p-6 rounded-2xl shadow-xl transform transition-all duration-300 hover:scale-[1.02] hover:shadow-2xl border border-${"dark"===d?"gray-700":"gray-200"}`),variants:De,initial:"hidden",animate:"visible",exit:"exit",children:[(0,ae.jsxs)("div",{className:"flex items-center justify-between mb-5",children:[(0,ae.jsx)("h3",{className:"text-2xl font-bold text-gray-100",children:"Gastos"}),(0,ae.jsx)(p.A,{className:"text-red-400 w-10 h-10 animate-pulse"})]}),(0,ae.jsxs)("div",{className:"space-y-4 text-base text-gray-300",children:[(0,ae.jsxs)("div",{className:"flex justify-between items-center text-xl font-semibold",children:[(0,ae.jsx)("span",{className:"text-gray-200",children:"Total de Gastos:"}),(0,ae.jsx)("span",{className:"font-extrabold text-red-400",children:se.format(be)})]}),(0,ae.jsx)("div",{className:"border-t border-dashed my-4",style:{borderColor:"dark"===d?"#4b5563":"#d1d5db"}}),ge?(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsxs)("button",{onClick:()=>ye(null),className:"flex items-center text-blue-400 hover:underline text-sm mb-4 transition-colors",children:[(0,ae.jsx)(Z.A,{className:"w-4 h-4 mr-2"})," Volver a Gastos por Remitente"]}),(0,ae.jsx)("h4",{className:"text-lg font-semibold text-gray-200 mb-3",children:ge}),(0,ae.jsx)("div",{className:(0,i.x)("text-sm max-h-52 overflow-y-auto custom-scrollbar pr-2",I?"overflow-x-auto":"overflow-x-hidden"),children:(0,ae.jsx)("div",{className:"min-w-full inline-block align-middle",children:0===we.length?(0,ae.jsx)("p",{className:"text-gray-500 text-center py-6",children:"No hay movimientos para este remitente en el rango de fechas seleccionado."}):we.map((e,t)=>{var a;return(0,ae.jsxs)("div",{className:"flex items-center py-3 border-b last:border-b-0 transition-colors duration-200 hover:bg-gray-700 dark:hover:bg-gray-800 rounded-md px-2 -mx-2",style:{borderColor:"dark"===d?"#374151":"#e5e7eb"},children:[(0,ae.jsx)("span",{className:"text-gray-400 font-normal mr-3 min-w-[80px]",children:e.name||"N/A"}),(0,ae.jsx)("span",{className:"text-gray-300 font-light text-nowrap mr-3 min-w-[150px]",children:new Date(null===(a=e.timestamp)||void 0===a?void 0:a.toDate()).toLocaleString("es-CO",{dateStyle:"short",timeStyle:"short"})}),(0,ae.jsx)("span",{className:"text-red-300 font-semibold text-right flex-grow",children:se.format(e.amount)})]},t)})})})]}):(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)("p",{className:"text-gray-400 text-sm mb-2",children:"Gastos por Remitente:"}),(0,ae.jsx)("div",{className:"text-sm max-h-52 overflow-y-auto custom-scrollbar pr-2",children:0===je.length?(0,ae.jsx)("p",{className:"text-gray-500 text-center py-6",children:"A\xfan no hay gastos registrados. \xa1Empieza a a\xf1adir algunos! \ud83d\udcdd"}):je.map((e,t)=>(0,ae.jsxs)("button",{onClick:()=>ye(e.store),className:"flex justify-between items-center w-full py-3 border-b last:border-b-0 transition-colors duration-200 hover:bg-gray-700 dark:hover:bg-gray-800 rounded-md px-2 -mx-2 cursor-pointer",style:{borderColor:"dark"===d?"#374151":"#e5e7eb"},children:[(0,ae.jsx)("span",{className:"text-gray-300 flex-1 pr-3 truncate text-left font-medium",children:e.store}),(0,ae.jsxs)("div",{className:"flex flex-col items-end",children:[(0,ae.jsx)("span",{className:"text-red-300 font-semibold",children:se.format(e.totalAmount)}),(0,ae.jsxs)("span",{className:"text-gray-500 text-xs mt-1",children:["(",e.payments.length," movimientos)"]})]})]},t))})]})]})]})]}),(0,ae.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[(0,ae.jsxs)("div",{className:(0,i.x)("dark"===d?"bg-gray-800":"bg-white",I?"p-4":"p-6","rounded-2xl shadow-xl border","dark"===d?"border-gray-700":"border-gray-200","relative min-h-[350px] flex flex-col"),children:[(0,ae.jsxs)("h3",{className:"text-xl font-semibold mb-4 text-gray-200 dark:text-gray-100 flex items-center justify-between",children:[(0,ae.jsxs)("span",{className:"flex items-center",children:[(0,ae.jsx)(X.A,{className:(0,i.x)(I?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-purple-400")}),"Pedidos Diarios"]}),(0,ae.jsxs)(c.AM,{className:"relative",children:[(0,ae.jsx)(c.ut,{className:"p-2 rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",children:(0,ae.jsx)(U.A,{className:(0,i.x)(I?"w-4 h-4":"w-5 h-5","text-gray-400")})}),(0,ae.jsx)(n.e,{as:r.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:(0,ae.jsx)(c.QT,{className:(0,i.x)("absolute z-50 mt-2","right-0 left-auto",I?"w-[150px] text-sm":"w-56","rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none","dark"===d?"bg-gray-700":"bg-white","origin-top-right","max-h-[80vh] overflow-y-auto custom-scrollbar"),children:(0,ae.jsxs)("div",{className:"py-1",children:[(0,ae.jsxs)("button",{onClick:O,disabled:E,className:(0,i.x)("block w-full text-left px-4 py-2 flex items-center transition-colors",I?"text-xs":"text-sm",E?"text-gray-400 cursor-not-allowed":"dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:[(0,ae.jsx)(W.A,{className:(0,i.x)(I?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-blue-400")}),E?"Guardando...":"Guardar Pedidos del D\xeda"]}),(0,ae.jsxs)("button",{onClick:()=>T(),disabled:E,className:(0,i.x)("block w-full text-left px-4 py-2 flex items-center mt-1 transition-colors",I?"text-xs":"text-sm",E?"text-gray-400 cursor-not-allowed":"dark"===d?"text-red-300 hover:bg-gray-600":"text-red-600 hover:bg-gray-100"),children:[(0,ae.jsx)(y.A,{className:(0,i.x)(I?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-red-400")}),"Eliminar Pedidos del D\xeda"]}),(0,ae.jsx)("div",{className:(0,i.x)("my-1","dark"===d?"border-t border-gray-600":"border-t border-gray-200")}),(0,ae.jsx)("button",{onClick:()=>{j("7_days"),D(null),k(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",I?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver \xfaltimos 7 d\xedas"}),(0,ae.jsx)("button",{onClick:()=>{j("30_days"),D(null),k(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",I?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver todo el mes"}),(0,ae.jsx)("button",{onClick:()=>{j("year"),D(null),k(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",I?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver todo el a\xf1o"}),(0,ae.jsx)("div",{className:(0,i.x)("my-1","dark"===d?"border-t border-gray-600":"border-t border-gray-200")}),(0,ae.jsx)("div",{className:(0,i.x)("px-4 py-2 font-medium text-gray-400",I?"text-xs":"text-sm"),children:"Filtros personalizados"}),(0,ae.jsxs)("div",{className:"px-4 py-2",children:[(0,ae.jsx)("label",{className:(0,i.x)("block font-medium text-gray-400 mb-1",I?"text-xs":"text-sm"),children:"Desde:"}),(0,ae.jsx)("input",{type:"date",value:w?w.toISOString().split("T")[0]:"",onChange:e=>{D(new Date(e.target.value)),j("custom")},className:(0,i.x)("block w-full rounded-md shadow-sm p-2",I?"text-xs sm:text-sm":"text-sm","dark"===d?"bg-gray-800 text-gray-200 border-gray-600":"bg-white text-gray-900 border-gray-300")})]}),(0,ae.jsxs)("div",{className:"px-4 py-2",children:[(0,ae.jsx)("label",{className:(0,i.x)("block font-medium text-gray-400 mb-1",I?"text-xs":"text-sm"),children:"Hasta:"}),(0,ae.jsx)("input",{type:"date",value:N?N.toISOString().split("T")[0]:"",onChange:e=>{k(new Date(e.target.value)),j("custom")},className:(0,i.x)("block w-full rounded-md shadow-sm p-2",I?"text-xs sm:text-sm":"text-sm","dark"===d?"bg-gray-800 text-gray-200 border-gray-600":"bg-white text-gray-900 border-gray-300")})]})]})})})]})]}),(0,ae.jsxs)($.P.div,{className:(0,i.x)(I?"overflow-x-auto overflow-y-hidden custom-scrollbar":"overflow-x-hidden overflow-y-hidden","relative flex flex-col flex-grow"),variants:De,initial:"hidden",animate:"visible",exit:"exit",children:["year"===f&&F&&(0,ae.jsxs)($.P.button,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},onClick:()=>P(null),className:"mb-4 text-blue-500 hover:underline text-sm self-start transition-all duration-200",children:[(0,ae.jsx)(Z.A,{className:"w-4 h-4 inline-block mr-2"}),"Volver al resumen anual"]}),E?(0,ae.jsx)(re,{type:"bar",theme:d,isMobile:I}):(0,ae.jsx)("div",{className:(0,i.x)("w-full",ke,Ne),children:(0,ae.jsx)(L.u,{width:"100%",height:"100%",children:(0,ae.jsxs)(_.E,{data:a,margin:{top:20,right:30,left:20,bottom:20},barCategoryGap:I?"0%":"40%",barGap:1,children:[(0,ae.jsx)(G.d,{strokeDasharray:I?"2 2":"3 3",stroke:"dark"===d?"#4b5563":"#e5e7eb",vertical:!1}),(0,ae.jsx)(q.W,{dataKey:"name",stroke:u,tick:{fill:u,fontSize:I?9:11},angle:-45,textAnchor:"end",interval:0,height:60}),(0,ae.jsx)(K.h,{stroke:u,tick:{fill:u,fontSize:I?9:11},width:I?30:50}),(0,ae.jsx)(B.m,{cursor:{fill:"dark"===d?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)",rx:4},content:(0,ae.jsx)(le,{theme:d,chartTextColor:u,copFormatter:e=>e.toLocaleString()})}),(0,ae.jsx)(J.s,{wrapperStyle:{color:u,paddingTop:"10px",fontSize:I?8:12},align:"center",verticalAlign:"top",iconType:"circle"}),(0,ae.jsx)(H.y,{dataKey:"Domicilios",fill:"#8B5CF6",stroke:"#8B5CF6",radius:[10,10,0,0],opacity:1,isAnimationActive:!1,maxBarSize:I?12:25}),(0,ae.jsx)(H.y,{dataKey:"Mesas",fill:"#10B981",stroke:"#10B981",radius:[10,10,0,0],opacity:1,isAnimationActive:!1,maxBarSize:I?12:25})]})})})]})]}),(0,ae.jsxs)($.P.div,{className:(0,i.x)("dark"===d?"bg-gray-800":"bg-white",I?"p-4":"p-6","rounded-2xl shadow-xl border","dark"===d?"border-gray-700":"border-gray-200","relative min-h-[350px] flex flex-col justify-center items-center"),variants:{hidden:{opacity:0,scale:.9},visible:{opacity:1,scale:1,transition:{duration:.7,ease:"easeOut"}},exit:{opacity:0,scale:.9,transition:{duration:.5,ease:"easeIn"}}},initial:"hidden",animate:"visible",exit:"exit",children:[(0,ae.jsxs)("h3",{className:"text-xl font-semibold mb-4 text-gray-200 dark:text-gray-100 flex items-center",children:[(0,ae.jsx)(ee.A,{className:(0,i.x)(I?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-blue-400")}),"Estado de Pedidos"]}),E?(0,ae.jsx)(re,{type:"pie",theme:d,isMobile:I}):(0,ae.jsx)(L.u,{width:"100%",height:"100%",children:(0,ae.jsxs)(Y.r,{children:[(0,ae.jsxs)(V.F,{data:l,cx:"50%",cy:"50%",outerRadius:I?80:120,fill:"#8884d8",dataKey:"value",animationDuration:800,innerRadius:I?40:60,children:[l.map((e,t)=>(0,ae.jsx)(Q.f,{fill:A[t%A.length],stroke:"dark"===d?"#1f2937":"#ffffff",strokeWidth:2},`cell-${t}`)),(0,ae.jsx)(R.J,{value:`${fe} Pedidos`,position:"center",fill:u,fontSize:I?14:18,fontWeight:"bold",dy:I?0:-10}),(0,ae.jsx)(R.J,{value:"Total",position:"center",fill:u,fontSize:I?10:12,dy:15})]}),(0,ae.jsx)(B.m,{content:(0,ae.jsx)(oe,{theme:d,chartTextColor:u})}),(0,ae.jsx)(J.s,{wrapperStyle:{color:u,fontSize:I?10:13,paddingTop:"15px"},align:"center",verticalAlign:"bottom",iconType:"circle",layout:"horizontal"})]})})]})]})]})}),ne=ie,de=(0,r.createContext)(null),ce=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return new Intl.DateTimeFormat("en-CA",{timeZone:"America/Bogota",year:"numeric",month:"2-digit",day:"2-digit"}).format(e)},ue=e=>{if(!e)return"\u2014";const t=Date.now()-new Date(e).getTime(),a=Math.max(0,Math.floor(t/6e4));if(a<1)return"hace segundos";if(1===a)return"hace 1 min";if(a<60)return`hace ${a} min`;const r=Math.floor(a/60);if(1===r)return"hace 1 hora";if(r<24)return`hace ${r} horas`;const s=Math.floor(r/24);return 1===s?"hace 1 d\xeda":`hace ${s} d\xedas`},me=e=>{let{children:t}=e;const[a,s]=(0,r.useState)(ce()),l=(0,r.useCallback)(e=>{e&&s(e)},[]),o=(0,r.useMemo)(()=>{const e=new Date(`${a}T00:00:00.000-05:00`);const t=(e=>new Date(`${e}T23:59:59.999-05:00`))(a);return{selectedDate:a,startOfDay:e,endOfDay:t,setSelectedDate:l,timeAgo:ue,ymdInBogota:ce}},[a]);return(0,ae.jsx)(de.Provider,{value:o,children:t})},xe=()=>(0,r.useContext)(de),ve=360,he="undefined"!==typeof __initial_auth_token?__initial_auth_token:null,ge=e=>{let{theme:t}=e;return(0,ae.jsx)("div",{className:"flex justify-center items-center h-screen bg-gray-900",children:(0,ae.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 "+("dark"===t?"border-emerald-500":"border-emerald-600")})})},ye=e=>{let{show:t,onClose:a,onConfirm:s,confirmText:l,setConfirmText:o,theme:c}=e;return(0,ae.jsx)(n.e,{show:t,as:r.Fragment,children:(0,ae.jsxs)(d.lG,{as:"div",className:"relative z-50",onClose:a,children:[(0,ae.jsx)(n.e.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,ae.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50"})}),(0,ae.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,ae.jsx)(n.e.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,ae.jsxs)(d.lG.Panel,{className:(0,i.x)("w-full max-w-sm p-6 rounded-lg shadow-md text-center","dark"===c?"bg-gray-800 text-gray-200":"bg-white text-gray-900"),children:[(0,ae.jsxs)(d.lG.Title,{className:"text-lg font-medium mb-4 flex items-center justify-center gap-2 text-red-500",children:[(0,ae.jsx)(u.A,{className:"w-6 h-6"}),"Confirmar Limpieza de Actividad"]}),(0,ae.jsxs)("p",{className:"mb-4 text-sm",children:["Est\xe1s a punto de eliminar ",(0,ae.jsx)("span",{className:"font-bold text-red-500",children:"TODAS"}),' las actividades. Esta acci\xf3n es irreversible. Para confirmar, escribe "confirmar":']}),(0,ae.jsx)("input",{type:"text",value:l,onChange:e=>o(e.target.value),className:(0,i.x)("w-full p-2 rounded-md border text-center text-sm","dark"===c?"border-gray-600 bg-gray-700 text-white":"border-gray-200 bg-white text-gray-900","focus:outline-none focus:ring-1 focus:ring-red-500"),placeholder:"escribe 'confirmar'"}),(0,ae.jsxs)("div",{className:"mt-6 flex justify-center gap-2",children:[(0,ae.jsx)("button",{onClick:a,className:(0,i.x)("px-4 py-2 rounded-md text-sm font-medium","dark"===c?"bg-gray-600 hover:bg-gray-700 text-gray-200":"bg-gray-200 hover:bg-gray-300 text-gray-900"),children:"Cancelar"}),(0,ae.jsx)("button",{onClick:s,className:"px-4 py-2 rounded-md text-sm font-medium bg-red-600 hover:bg-red-700 text-white",children:"Limpiar Actividad"})]})]})})})]})})},pe=e=>{let{show:t,onClose:a,details:s,theme:l}=e;return(0,ae.jsx)(n.e,{show:t,as:r.Fragment,children:(0,ae.jsxs)(d.lG,{as:"div",className:"relative z-50",onClose:a,children:[(0,ae.jsx)(n.e.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,ae.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50"})}),(0,ae.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,ae.jsx)(n.e.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,ae.jsxs)(d.lG.Panel,{className:(0,i.x)("w-full max-w-md p-6 rounded-lg shadow-md","dark"===l?"bg-gray-800 text-gray-200":"bg-white text-gray-900"),children:[(0,ae.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,ae.jsx)(d.lG.Title,{className:"text-lg font-medium",children:"Detalle de Actividad"}),(0,ae.jsx)("button",{onClick:a,className:"p-1 rounded-full hover:bg-gray-700 transition",children:(0,ae.jsx)(m.A,{className:"w-5 h-5 text-gray-400"})})]}),(0,ae.jsx)("pre",{className:"text-xs whitespace-pre-wrap p-4 bg-gray-700 rounded-lg text-gray-300 overflow-auto max-h-[70vh]",children:JSON.stringify(s||{},null,2)})]})})})]})})},be=e=>{let{theme:t,title:a,icon:s,color:l,data:o,labelColor:n={},vAlign:d="top",cardHeight:c=ve}=e;const u=(0,r.useMemo)(()=>{switch(s){case"ShoppingCart":return x.A;case"Users":return v.A;case"Activity":return h.A;default:return null}},[s]),m="center"===d?"grid grid-rows-[auto,1fr]":"between"===d?"flex flex-col justify-between":"flex flex-col";return(0,ae.jsxs)("div",{className:(0,i.x)(`p-6 rounded-2xl shadow-xl border transition-all duration-300 ease-in-out ${m} flex-1`,"dark"===t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),style:{height:c},children:[(0,ae.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,ae.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:a}),u&&(0,ae.jsx)(u,{className:`${l} w-8 h-8`})]}),(0,ae.jsx)("div",{className:(0,i.x)("text-base text-gray-700 dark:text-gray-400","center"===d?"self-center w-full mt-1":"mt-3","space-y-2"),children:Object.entries(o).map(e=>{let[t,a]=e;return(0,ae.jsxs)("div",{className:"flex justify-between",children:[(0,ae.jsxs)("span",{children:[t,":"]}),(0,ae.jsx)("span",{className:(0,i.x)("font-bold","text-gray-900 dark:text-gray-100",n[t]),children:a})]},t)})})]})},fe=e=>{let{theme:t,userActivity:a,onClearClick:s,onShowDetails:l,cardHeight:o=360}=e;const n=(0,r.useRef)(null),[d,c]=(0,r.useState)(!1),[u,m]=(0,r.useState)(!1),x=(0,r.useCallback)(()=>{const e=n.current;e&&(c(e.scrollTop>0),m(e.scrollTop+e.clientHeight<e.scrollHeight))},[]);(0,r.useEffect)(()=>{x()},[a,x]);const v="dark"===t?"hover:bg-gray-700/40":"hover:bg-gray-100",p="dark"===t?"border-gray-700":"border-gray-200",b="dark"===t?"bg-gradient-to-b from-gray-800 to-transparent":"bg-gradient-to-b from-white to-transparent",f="dark"===t?"bg-gradient-to-t from-gray-800 to-transparent":"bg-gradient-to-t from-white to-transparent";return(0,ae.jsxs)("div",{className:(0,i.x)("p-6 rounded-2xl shadow-xl border flex flex-col","dark"===t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),style:{height:o},children:[(0,ae.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ae.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"Actividad Reciente"}),(0,ae.jsx)(h.A,{className:"text-orange-400 w-8 h-8"})]}),(0,ae.jsxs)("div",{ref:n,onScroll:x,className:"relative text-sm min-h-40 max-h-56 overflow-y-auto overflow-x-auto custom-scrollbar pr-2 flex-1",children:[0===a.length?(0,ae.jsx)("p",{className:"text-gray-400 text-center",children:"No hay actividad para la fecha."}):(0,ae.jsx)("div",{className:"min-w-max table w-full",children:a.map((e,t)=>(0,ae.jsxs)("div",{className:"table-row",children:[(0,ae.jsx)("div",{className:`table-cell align-middle pr-3 py-2 border-b ${p}`,children:(0,ae.jsxs)("div",{role:"button",tabIndex:0,onClick:()=>l(e),onKeyDown:t=>("Enter"===t.key||" "===t.key)&&l(e),className:`inline-flex items-center gap-2 whitespace-nowrap cursor-pointer rounded-md px-2 py-1 transition-colors ${v}`,title:"Ver detalles",children:[(0,ae.jsx)("span",{className:"text-gray-400",children:e.action||"\u2014"}),e.action&&(0,ae.jsx)("span",{className:"text-gray-600",children:"\u2022"}),(0,ae.jsx)("span",{className:"text-gray-500 text-xs",title:e.timestamp?new Date(e.timestamp).toLocaleString("es-CO"):"N/A",children:e.timestamp?new Date(e.timestamp).toLocaleString("es-CO"):"N/A"})]})}),(0,ae.jsx)("div",{className:`table-cell align-middle pl-2 pr-1 py-2 text-right border-b ${p}`,children:e.details&&(0,ae.jsx)("button",{onClick:()=>l(e),className:"text-blue-400 hover:text-blue-300 p-1 rounded-full",title:"Ver detalles de la actividad",children:(0,ae.jsx)(g.A,{className:"w-4 h-4"})})})]},t))}),d&&(0,ae.jsx)("div",{className:(0,i.x)("pointer-events-none absolute top-0 left-0 right-0 h-4",b)}),u&&(0,ae.jsx)("div",{className:(0,i.x)("pointer-events-none absolute bottom-0 left-0 right-0 h-4",f)})]}),(0,ae.jsx)("div",{className:"mt-4 text-center",children:(0,ae.jsxs)("button",{onClick:s,className:(0,i.x)("px-4 py-2 rounded-md text-xs font-medium flex items-center justify-center mx-auto","dark"===t?"bg-red-600 hover:bg-red-700 text-white":"bg-red-500 hover:bg-red-600 text-white"),children:[(0,ae.jsx)(y.A,{className:"w-4 h-4 mr-2"})," Limpiar TODAS las Actividades"]})})]})},je=e=>{var t,a,s,l,o,d,u,m,x,v,h,g;let{theme:y,totals:D,deliveryPersons:N,lastUpdatedAt:k,orders:S,proteinDaily:A,tableOrders:C,breakfastOrders:O,cardHeight:T=ve}=e;const[M,z]=(0,r.useState)(!1),[E,F]=(0,r.useState)(!1),[P,I]=(0,r.useState)(!1),[$,L]=(0,r.useState)(!1),[_,G]=(0,r.useState)(!1),[q,K]=(0,r.useState)(!1),{selectedDate:B,setSelectedDate:J,timeAgo:H}=xe(),Y=e=>(e||"").toString().trim().toLowerCase(),V=e=>{if("number"===typeof e&&Number.isFinite(e))return Math.floor(e);const t=String(null!==e&&void 0!==e?e:"").replace(/[^0-9-]/g,""),a=parseInt(t,10);return Number.isFinite(a)?a:0},Q=e=>{const t=V(e);return`${t<0?"-":""}$${Math.abs(t).toLocaleString("es-CO")}`},R=e=>{const t=Y("string"===typeof e?e:(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.label)||(null===e||void 0===e?void 0:e.title)||(null===e||void 0===e?void 0:e.method)||(null===e||void 0===e?void 0:e.type));return t.includes("efect")||t.includes("cash")?"cash":t.includes("nequi")?"nequi":t.includes("davi")?"daviplata":"other"},U=e=>{const t="string"===typeof e?e:(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.value)||"",a=Y(t);return["table","mesa","para mesa","en mesa"].includes(a)?"table":["takeaway","para llevar","llevar","take away","take-away"].includes(a)?"takeaway":["delivery","domicilio","domicilios"].includes(a)?"delivery":""},W=e=>{var t,a,r,s,l,o,i,n,d,c,u,m,x,v,h,g;return null!==(t=null!==(a=null!==(r=null!==(s=null!==(l=null!==(o=null===e||void 0===e?void 0:e.payment)&&void 0!==o?o:null===e||void 0===e?void 0:e.paymentMethod)&&void 0!==l?l:null===e||void 0===e||null===(i=e.meals)||void 0===i||null===(n=i[0])||void 0===n||null===(d=n.payment)||void 0===d?void 0:d.name)&&void 0!==s?s:null===e||void 0===e||null===(c=e.meals)||void 0===c||null===(u=c[0])||void 0===u?void 0:u.paymentMethod)&&void 0!==r?r:null===e||void 0===e||null===(m=e.breakfasts)||void 0===m||null===(x=m[0])||void 0===x||null===(v=x.payment)||void 0===v?void 0:v.name)&&void 0!==a?a:null===e||void 0===e||null===(h=e.breakfasts)||void 0===h||null===(g=h[0])||void 0===g?void 0:g.paymentMethod)&&void 0!==t?t:""},Z=e=>{var t;const a=V(null!==(t=null===e||void 0===e?void 0:e.total)&&void 0!==t?t:null===e||void 0===e?void 0:e.amount);if(a>0)return a;const r=(e=>Array.isArray(null===e||void 0===e?void 0:e.meals)?e.meals.reduce((e,t)=>{var a,r;return e+V(null!==(a=null!==(r=null===t||void 0===t?void 0:t.total)&&void 0!==r?r:null===t||void 0===t?void 0:t.price)&&void 0!==a?a:null===t||void 0===t?void 0:t.amount)},0):0)(e)+(e=>Array.isArray(null===e||void 0===e?void 0:e.breakfasts)?e.breakfasts.reduce((e,t)=>{var a,r;return e+V(null!==(a=null!==(r=null===t||void 0===t?void 0:t.total)&&void 0!==r?r:null===t||void 0===t?void 0:t.price)&&void 0!==a?a:null===t||void 0===t?void 0:t.amount)},0):0)(e);return r>0?r:0},X=e=>Array.isArray(null===e||void 0===e?void 0:e.payments)&&e.payments.length?e.payments.map(e=>({methodKey:R(e.method),amount:V(e.amount)})):[{methodKey:R(W(e)),amount:Z(e)}],ee=(null===D||void 0===D?void 0:D.byCategory)||{},te=V(ee.domiciliosAlmuerzo)+V(ee.domiciliosDesayuno),re=V(ee.mesasAlmuerzo)+V(ee.llevarAlmuerzo)+V(ee.mesasDesayuno)+V(ee.llevarDesayuno),se="number"===typeof(null===D||void 0===D?void 0:D.grossIncome)?V(D.grossIncome):te+re,le=V(null===D||void 0===D?void 0:D.expenses),oe=se-le,ie=(0,r.useMemo)(()=>{const e=25e3,t=25e3,a=23e3,r=25e3,s=24e3,l=25e3;return{cash:e+t,daviplata:a+r,nequi:s+l,byOrigin:{salon:{cash:e,daviplata:a,nequi:s},domicilio:{cash:t,daviplata:r,nequi:l}}}},[]),ne=((0,r.useMemo)(()=>{const e={cash:0,daviplata:0,nequi:0,other:0},t={cash:0,daviplata:0,nequi:0,other:0},a=(e,t,a)=>{const r=V(a);r&&(e[t]=(e[t]||0)+r)};return(C||[]).forEach(t=>{X(t).forEach(t=>{let{methodKey:r,amount:s}=t;return a(e,r,s)})}),(O||[]).forEach(r=>{const s=(e=>{if("delivery"===U(null===e||void 0===e?void 0:e.orderType))return!0;const t=((null===e||void 0===e?void 0:e.__collection)||(null===e||void 0===e?void 0:e.collectionName)||"").toLowerCase();return!(!t.includes("delivery")&&!t.includes("domicil"))||(!(null===e||void 0===e||!e.deliveryPerson)||!!(Array.isArray(null===e||void 0===e?void 0:e.breakfasts)&&e.breakfasts.some(e=>!(null===e||void 0===e||!e.address))||Array.isArray(null===e||void 0===e?void 0:e.meals)&&e.meals.some(e=>!(null===e||void 0===e||!e.address))))})(r)?t:e;X(r).forEach(e=>{let{methodKey:t,amount:r}=e;return a(s,t,r)})}),(S||[]).forEach(r=>{const s="delivery"===(U(null===r||void 0===r?void 0:r.orderType)||"delivery")?t:e;X(r).forEach(e=>{let{methodKey:t,amount:r}=e;return a(s,t,r)})}),{cash:{domicilio:t.cash,salon:e.cash},daviplata:{domicilio:t.daviplata,salon:e.daviplata},nequi:{domicilio:t.nequi,salon:e.nequi}}},[S,C,O]),(0,r.useMemo)(()=>{const e={},t=(t,a,r)=>{t||(t="JUAN"),e[t]=e[t]||{desayuno:{total:0},almuerzo:{total:0}},e[t][a].total+=V(r)},a=[...S||[],...O||[]];for(const r of a){const e=String((null===r||void 0===r?void 0:r.deliveryPerson)||"JUAN").trim(),a="breakfast"===(null===r||void 0===r?void 0:r.type)||Array.isArray(null===r||void 0===r?void 0:r.breakfasts)?"desayuno":"almuerzo",s=Z(r);V(s)>0&&t(e,a,s)}return e},[S,O])),de=(0,r.useMemo)(()=>N&&Object.keys(N||{}).length>0?N:ne,[N,ne]),{totalLunchCount:ce,totalBreakfastCount:ue}=(0,r.useMemo)(()=>{const e=(S||[]).filter(e=>!("breakfast"===(null===e||void 0===e?void 0:e.type)||Array.isArray(null===e||void 0===e?void 0:e.breakfasts))),t=O||[],a=C||[],r=a.filter(e=>["table","mesa","en mesa","para mesa"].includes(Y(e.orderType))).length,s=a.filter(e=>!["table","mesa","en mesa","para mesa"].includes(Y(e.orderType))).length,l=t.filter(e=>"delivery"===U(null===e||void 0===e?void 0:e.orderType)).length,o=t.filter(e=>["table","mesa","en mesa","para mesa"].includes(Y(e.orderType))).length,i=t.filter(e=>!["delivery","table","mesa","en mesa","para mesa"].includes(U(null===e||void 0===e?void 0:e.orderType))).length;return{totalLunchCount:e.length+r+s,totalBreakfastCount:l+o+i}},[S,C,O]),me=e=>{let{left:t,right:a,strong:r,rightClass:s,onClick:l}=e;return(0,ae.jsxs)("div",{className:"flex justify-between",onClick:l,children:[(0,ae.jsx)("span",{className:(0,i.x)(r?"font-semibold":"","text-gray-400",l&&"cursor-pointer hover:underline"),children:t}),(0,ae.jsx)("span",{className:(0,i.x)("font-bold",null!==s&&void 0!==s?s:"text-gray-100"),children:a})]})};return(0,ae.jsxs)("div",{className:(0,i.x)("p-0 rounded-2xl shadow-xl border transition-all duration-300 ease-in-out hover:shadow-2xl flex flex-col flex-1","dark"===y?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),style:{height:T},children:[(0,ae.jsxs)("div",{className:"flex items-center justify-center px-6 pt-5 flex-shrink-0",children:[(0,ae.jsx)("h3",{className:"text-xl font-semibold text-gray-100 whitespace-nowrap",children:"Totales Generales"}),(0,ae.jsx)(p.A,{className:"text-emerald-400 w-8 h-8 ml-4","aria-hidden":"true"})]}),(0,ae.jsxs)("div",{className:(0,i.x)("mt-4 px-6 pb-3 relative min-h-0 h-[260px] custom-scrollbar",M?"overflow-y-auto":"overflow-hidden"),children:[(0,ae.jsxs)("div",{className:"space-y-3 text-base mt-5 sm:mt-6",children:[(0,ae.jsxs)("div",{onClick:()=>I(e=>!e),className:"cursor-pointer",children:[(0,ae.jsxs)("div",{className:"flex justify-between items-center text-gray-400 hover:underline hover:text-gray-100 transition-colors",children:[(0,ae.jsx)("span",{children:"Total ingresos"}),(0,ae.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ae.jsx)("span",{className:"font-bold text-green-400",children:Q(se)}),P?(0,ae.jsx)(b.A,{className:"w-4 h-4 text-gray-500"}):(0,ae.jsx)(f.A,{className:"w-4 h-4 text-gray-500"})]})]}),(0,ae.jsx)(n.e,{show:P,children:(0,ae.jsxs)("div",{className:"mt-2 pl-4 space-y-1 text-sm text-gray-400",children:[(0,ae.jsxs)("div",{className:"flex justify-between",children:[(0,ae.jsx)("span",{children:"- De Domicilios:"}),(0,ae.jsx)("span",{className:"font-semibold text-emerald-300",children:Q(te)})]}),(0,ae.jsxs)("div",{className:"flex justify-between",children:[(0,ae.jsx)("span",{children:"- De Sal\xf3n:"}),(0,ae.jsx)("span",{className:"font-semibold text-emerald-300",children:Q(re)})]})]})})]}),(0,ae.jsxs)("div",{onClick:()=>F(e=>!e),className:"cursor-pointer",children:[(0,ae.jsxs)("div",{className:"flex justify-between items-center text-gray-400 hover:underline hover:text-gray-100 transition-colors",children:[(0,ae.jsx)("span",{children:"Gastos"}),(0,ae.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ae.jsx)("span",{className:"font-bold text-red-400",children:Q(-le)}),E?(0,ae.jsx)(b.A,{className:"w-4 h-4 text-gray-500"}):(0,ae.jsx)(f.A,{className:"w-4 h-4 text-gray-500"})]})]}),(0,ae.jsx)(n.e,{show:E,children:(0,ae.jsx)("div",{className:"mt-2 pl-4 space-y-1 text-sm text-gray-400",children:Object.entries((null===D||void 0===D||null===(t=D.expensesByProvider)||void 0===t?void 0:t.byProvider)||{}).map(e=>{let[t,a]=e;return(0,ae.jsxs)("div",{className:"flex justify-between",children:[(0,ae.jsxs)("span",{children:["- ",t,":"]}),(0,ae.jsx)("span",{className:"font-semibold text-red-300",children:Q(-a)})]},t)})})})]}),(0,ae.jsx)("div",{className:(0,i.x)("border-t mt-2","dark"===y?"border-gray-700":"border-gray-200")}),(0,ae.jsx)(me,{strong:!0,left:"Total neto",right:Q(oe),rightClass:oe<0?"text-red-400 text-xl":"text-emerald-400 text-xl"})]}),(0,ae.jsx)("div",{className:"mt-6 sm:mt-8 text-center",children:(0,ae.jsx)("button",{onClick:()=>z(e=>!e),"aria-expanded":M,className:"text-blue-500 hover:text-blue-600 transition-colors text-sm font-semibold underline underline-offset-4",children:M?"Ver menos":"Ver m\xe1s"})}),(0,ae.jsxs)("div",{className:(0,i.x)("pt-4 mt-4 text-sm",M?"":"hidden"),children:[(0,ae.jsx)("div",{className:(0,i.x)("border-t my-3","dark"===y?"border-gray-700":"border-gray-200")}),(0,ae.jsx)("p",{className:(0,i.x)("text-sm mb-2 font-semibold","dark"===y?"text-gray-400":"text-gray-600"),children:"Desglose de ingresos"}),(0,ae.jsxs)("div",{className:"space-y-1",children:[(0,ae.jsxs)("div",{className:"flex justify-between items-center cursor-pointer",onClick:()=>L(e=>!e),children:[(0,ae.jsx)("span",{children:"Efectivo (Caja)"}),(0,ae.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ae.jsx)("span",{className:"font-bold text-green-400",children:Q(ie.cash)}),$?(0,ae.jsx)(b.A,{className:"w-4 h-4 text-gray-500"}):(0,ae.jsx)(f.A,{className:"w-4 h-4 text-gray-500"})]})]}),(0,ae.jsx)(n.e,{show:$,children:(0,ae.jsxs)("div",{className:"mt-1 pl-4 space-y-1 text-sm text-gray-400",children:[(0,ae.jsxs)("div",{className:"flex justify-between",children:[(0,ae.jsx)("span",{children:"- De Domicilios:"}),(0,ae.jsx)("span",{className:"font-semibold",children:Q(ie.byOrigin.domicilio.cash)})]}),(0,ae.jsxs)("div",{className:"flex justify-between",children:[(0,ae.jsx)("span",{children:"- De Sal\xf3n:"}),(0,ae.jsx)("span",{className:"font-semibold",children:Q(ie.byOrigin.salon.cash)})]})]})}),(0,ae.jsxs)("div",{className:"flex justify-between items-center cursor-pointer mt-2",onClick:()=>G(e=>!e),children:[(0,ae.jsx)("span",{children:"DaviPlata"}),(0,ae.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ae.jsx)("span",{className:"font-bold text-red-400",children:Q(ie.daviplata)}),_?(0,ae.jsx)(b.A,{className:"w-4 h-4 text-gray-500"}):(0,ae.jsx)(f.A,{className:"w-4 h-4 text-gray-500"})]})]}),(0,ae.jsx)(n.e,{show:_,children:(0,ae.jsxs)("div",{className:"mt-1 pl-4 space-y-1 text-sm text-gray-400",children:[(0,ae.jsxs)("div",{className:"flex justify-between",children:[(0,ae.jsx)("span",{children:"- De Domicilios:"}),(0,ae.jsx)("span",{className:"font-semibold",children:Q(ie.byOrigin.domicilio.daviplata)})]}),(0,ae.jsxs)("div",{className:"flex justify-between",children:[(0,ae.jsx)("span",{children:"- De Sal\xf3n:"}),(0,ae.jsx)("span",{className:"font-semibold",children:Q(ie.byOrigin.salon.daviplata)})]})]})}),(0,ae.jsxs)("div",{className:"flex justify-between items-center cursor-pointer mt-2",onClick:()=>K(e=>!e),children:[(0,ae.jsx)("span",{children:"Nequi"}),(0,ae.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ae.jsx)("span",{className:"font-bold text-blue-400",children:Q(ie.nequi)}),q?(0,ae.jsx)(b.A,{className:"w-4 h-4 text-gray-500"}):(0,ae.jsx)(f.A,{className:"w-4 h-4 text-gray-500"})]})]}),(0,ae.jsx)(n.e,{show:q,children:(0,ae.jsxs)("div",{className:"mt-1 pl-4 space-y-1 text-sm text-gray-400",children:[(0,ae.jsxs)("div",{className:"flex justify-between",children:[(0,ae.jsx)("span",{children:"- De Domicilios:"}),(0,ae.jsx)("span",{className:"font-semibold",children:Q(ie.byOrigin.domicilio.nequi)})]}),(0,ae.jsxs)("div",{className:"flex justify-between",children:[(0,ae.jsx)("span",{children:"- De Sal\xf3n:"}),(0,ae.jsx)("span",{className:"font-semibold",children:Q(ie.byOrigin.salon.nequi)})]})]})})]}),(0,ae.jsx)("div",{className:(0,i.x)("border-t my-3","dark"===y?"border-gray-700":"border-gray-200")}),(0,ae.jsx)("p",{className:(0,i.x)("text-sm mb-2 font-semibold","dark"===y?"text-gray-400":"text-gray-600"),children:"Ingresos por Domiciliario"}),(0,ae.jsx)("div",{className:"space-y-3",children:Object.entries(de||{}).map(e=>{var t,a;let[r,s]=e;const l=V(null===s||void 0===s||null===(t=s.desayuno)||void 0===t?void 0:t.total),o=V(null===s||void 0===s||null===(a=s.almuerzo)||void 0===a?void 0:a.total),n=l+o;return(0,ae.jsxs)("div",{className:(0,i.x)("rounded-lg p-3 border","dark"===y?"bg-gray-800/60 border-gray-700":"bg-gray-50 border-gray-200"),children:[(0,ae.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[(0,ae.jsx)("span",{className:"font-medium",children:r}),(0,ae.jsx)("span",{className:"font-bold",children:Q(n)})]}),(0,ae.jsxs)("div",{className:"flex justify-between text-sm my-0.5",children:[(0,ae.jsx)("span",{children:"\ud83d\udef5 Desayuno"}),(0,ae.jsx)("span",{className:"font-semibold",children:Q(l)})]}),(0,ae.jsxs)("div",{className:"flex justify-between text-sm my-0.5",children:[(0,ae.jsx)("span",{children:"\ud83d\udef5 Almuerzo"}),(0,ae.jsx)("span",{className:"font-semibold",children:Q(o)})]})]},r)})}),(0,ae.jsx)("div",{className:(0,i.x)("border-t my-3","dark"===y?"border-gray-700":"border-gray-200")}),(0,ae.jsx)("p",{className:(0,i.x)("text-sm mb-2 font-semibold","dark"===y?"text-gray-400":"text-gray-600"),children:"Tipo de Venta"}),(0,ae.jsxs)("div",{className:"space-y-3 mt-2 text-sm",children:[(0,ae.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,ae.jsx)("h4",{className:"font-semibold text-gray-100",children:"Domicilios"}),(0,ae.jsxs)("ul",{className:"space-y-1 text-gray-400",children:[(0,ae.jsxs)("li",{className:"flex justify-between items-center",children:[(0,ae.jsx)("span",{className:"flex-1",children:"\ud83d\udef5 Almuerzo"}),(0,ae.jsx)("span",{className:"font-bold text-gray-100 text-right",children:Q((null===D||void 0===D||null===(a=D.byCategory)||void 0===a?void 0:a.domiciliosAlmuerzo)||0)})]}),(0,ae.jsxs)("li",{className:"flex justify-between items-center",children:[(0,ae.jsx)("span",{className:"flex-1",children:"\ud83c\udf73 Desayuno"}),(0,ae.jsx)("span",{className:"font-bold text-gray-100 text-right",children:Q((null===D||void 0===D||null===(s=D.byCategory)||void 0===s?void 0:s.domiciliosDesayuno)||0)})]})]})]}),(0,ae.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,ae.jsx)("h4",{className:"font-semibold text-gray-100",children:"Sal\xf3n"}),(0,ae.jsxs)("ul",{className:"space-y-1 text-gray-400",children:[(0,ae.jsxs)("li",{className:"flex justify-between items-center",children:[(0,ae.jsx)("span",{className:"flex-1",children:"\ud83e\ude91 Almuerzo Mesa"}),(0,ae.jsx)("span",{className:"font-bold text-gray-100 text-right",children:Q((null===D||void 0===D||null===(l=D.byCategory)||void 0===l?void 0:l.mesasAlmuerzo)||0)})]}),(0,ae.jsxs)("li",{className:"flex justify-between items-center",children:[(0,ae.jsx)("span",{className:"flex-1",children:"\ud83d\udce6 Almuerzo llevar"}),(0,ae.jsx)("span",{className:"font-bold text-gray-100 text-right",children:Q((null===D||void 0===D||null===(o=D.byCategory)||void 0===o?void 0:o.llevarAlmuerzo)||0)})]}),(0,ae.jsxs)("li",{className:"flex justify-between items-center",children:[(0,ae.jsx)("span",{className:"flex-1",children:"\ud83e\ude91 Desayuno Mesa"}),(0,ae.jsx)("span",{className:"font-bold text-gray-100 text-right",children:Q((null===D||void 0===D||null===(d=D.byCategory)||void 0===d?void 0:d.mesasDesayuno)||0)})]}),(0,ae.jsxs)("li",{className:"flex justify-between items-center",children:[(0,ae.jsx)("span",{className:"flex-1",children:"\ud83d\udce6 Desayuno llevar"}),(0,ae.jsx)("span",{className:"font-bold text-gray-100 text-right",children:Q((null===D||void 0===D||null===(u=D.byCategory)||void 0===u?void 0:u.llevarDesayuno)||0)})]})]})]})]}),(0,ae.jsx)("div",{className:(0,i.x)("border-t my-3","dark"===y?"border-gray-700":"border-gray-200")}),(0,ae.jsxs)("div",{className:"space-y-1",children:[(0,ae.jsx)(me,{left:"Prote\xednas preparadas (unid.)",right:String(V((null===A||void 0===A?void 0:A.preparedUnits)||0)),rightClass:"text-gray-100"}),(0,ae.jsx)(me,{left:"Almuerzos vendidos (unid.)",right:String(V((S||[]).length+(C||[]).length)),rightClass:"text-gray-100"}),(0,ae.jsx)(me,{left:"Desayunos vendidos (unid.)",right:String(V((O||[]).length)),rightClass:"text-gray-100"})]}),(0,ae.jsx)("div",{className:(0,i.x)("border-t my-3","dark"===y?"border-gray-700":"border-gray-200")}),(0,ae.jsxs)("p",{className:(0,i.x)("text-[13px]","dark"===y?"text-gray-300":"text-gray-700"),children:["\u2022 ",V(null===A||void 0===A||null===(m=A.leftovers)||void 0===m?void 0:m.res)," res\u2003\u2022 ",V(null===A||void 0===A||null===(x=A.leftovers)||void 0===x?void 0:x.lomo)," lomo\u2003\u2022 ",V(null===A||void 0===A||null===(v=A.leftovers)||void 0===v?void 0:v.pechuga)," pechuga\u2003\u2022 ",V(null===A||void 0===A||null===(h=A.leftovers)||void 0===h?void 0:h.pollo)," pollo\u2003\u2022 ",V(null===A||void 0===A||null===(g=A.leftovers)||void 0===g?void 0:g.recuperada)," recuperada"]})]}),!M&&(0,ae.jsx)("div",{className:(0,i.x)("pointer-events-none absolute bottom-0 left-0 right-0 h-16","dark"===y?"bg-gradient-to-t from-gray-800 to-transparent":"bg-gradient-to-t from-white to-transparent")})]}),(0,ae.jsxs)("div",{className:(0,i.x)("px-6 py-2 text-[12px] flex items-center justify-between mt-auto flex-shrink-0 gap-x-2 gap-y-1 rounded-b-2xl","dark"===y?"bg-gray-700 text-gray-400":"bg-gray-100 text-gray-600"),children:[(0,ae.jsx)(c.AM,{className:"relative",children:e=>{let{open:t}=e;return(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsxs)(c.ut,{className:(0,i.x)("inline-flex items-center gap-1 text-[11px] transition-colors cursor-pointer","dark"===y?"text-gray-400 hover:text-gray-200":"text-gray-700 hover:text-gray-900"),children:[(0,ae.jsx)(j.A,{className:"w-3 h-3 text-green-400"}),(0,ae.jsxs)("span",{children:["Fecha: ",B]})]}),(0,ae.jsx)(n.e,{as:r.Fragment,enter:"transition ease-out duration-150",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-100",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:(0,ae.jsxs)(c.QT,{className:(0,i.x)("absolute z-50 mt-2 p-3 rounded-xl shadow-lg w-64 left-0 origin-top-left","max-w-[calc(100vw-2rem)]","dark"===y?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"),children:[(0,ae.jsx)("label",{className:(0,i.x)("block text-xs mb-1","dark"===y?"text-gray-400":"text-gray-600"),children:"Selecciona una fecha"}),(0,ae.jsx)("input",{type:"date",value:B,onChange:e=>e.target.value&&J(e.target.value),className:(0,i.x)("w-full rounded-md px-3 py-2 text-sm border focus:outline-none focus:ring-1 focus:ring-emerald-500","dark"===y?"bg-gray-900 border-gray-700 text-gray-100":"bg-white border-gray-300 text-gray-900")}),(0,ae.jsx)("p",{className:"text-[11px] mt-2 text-gray-500",children:"Cambiar la fecha actualiza todo el dashboard para ese d\xeda."})]})})]})}}),(0,ae.jsxs)("span",{className:"flex items-center gap-1 text-[11px]",children:[(0,ae.jsx)(w.A,{className:"w-3 h-3"})," Actualizado ",H(k)]})]})]})},we=e=>{let{theme:t}=e;const[a,i]=(0,r.useState)(null),[n,d]=(0,r.useState)(!1),{notify:c}=(()=>{const[e,t]=(0,r.useState)(null);return{notify:(0,r.useCallback)((e,a)=>{t({type:e,text:a}),setTimeout(()=>t(null),5e3)},[]),message:e}})(),{selectedDate:u,startOfDay:m,endOfDay:x}=xe(),{loadingData:v,orders:h,users:g,totals:y,statusCounts:p,userActivity:b,deliveryPersons:f,proteinDaily:j,lastUpdatedAt:w,ingresosCategoriasData:D,gastosPorTiendaData:N,pedidosDiariosChartData:k,statusPieChartData:S,tableOrders:A,breakfastOrders:C,handleSaveDailyIngresos:O,handleDeleteDailyIngresos:T,handleSaveDailyOrders:M,handleDeleteDailyOrders:z}=I(s.db,a,n,c,m,x,u),[E,F]=(0,r.useState)(!1),[P,$]=(0,r.useState)(""),[L,_]=(0,r.useState)(!1),[G,q]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(!s.j)return;const e=(0,l.hg)(s.j,async e=>{if(e)i(e.uid),d(!0);else try{he?await(0,l.p)(s.j,he):await(0,l.zK)(s.j)}catch(t){console.error("Error al iniciar sesi\xf3n:",t),c("error",`Error de autenticaci\xf3n: ${t.message}`)}finally{d(!0)}});return()=>e()},[]);const K="dark"===t?"#cbd5e1":"#475569",B=!n||v;return B?(0,ae.jsx)(ge,{theme:t}):(0,ae.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 font-inter",children:[(0,ae.jsx)("h2",{className:"text-3xl font-extrabold mb-8 text-gray-900 dark:text-white transition-colors duration-200",children:"Dashboard"}),(0,ae.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,ae.jsx)(be,{theme:t,title:"Pedidos",icon:"ShoppingCart",color:"text-blue-400",vAlign:"center",cardHeight:ve,data:{Total:p.Pending+p.Delivered+p.Cancelled,Pendientes:p.Pending,Entregados:p.Delivered,Cancelados:p.Cancelled},labelColor:{Pendientes:"text-yellow-400",Entregados:"text-green-400",Cancelados:"text-red-400"}}),(0,ae.jsx)(je,{theme:t,totals:y,deliveryPersons:f,lastUpdatedAt:w,orders:h,proteinDaily:j,tableOrders:A,breakfastOrders:C,cardHeight:ve}),(0,ae.jsx)(be,{theme:t,title:"Usuarios",icon:"Users",color:"text-purple-400",cardHeight:ve,data:{Total:g.length}}),(0,ae.jsx)(fe,{theme:t,userActivity:b,onClearClick:()=>F(!0),onShowDetails:e=>{q(e),_(!0)},cardHeight:ve})]}),(0,ae.jsx)(ne,{theme:t,cardHeight:ve,chartTextColor:K,ingresosCategoriasData:D,gastosPorTiendaData:N,pedidosDiariosChartData:k,statusPieChartData:S,loading:B,handleSaveDailyIngresos:O,handleDeleteDailyIngresos:T,handleSaveDailyOrders:M,handleDeleteDailyOrders:z,proteinDaily:j}),(0,ae.jsx)(ye,{show:E,onClose:()=>{F(!1),$("")},onConfirm:async()=>{if("confirmar"===P.toLowerCase())try{const e=(0,o.wP)(s.db),t=await(0,o.GG)((0,o.rJ)(s.db,"userActivity"));let a=0;t.forEach(t=>{e.delete(t.ref),a++}),a>0&&await e.commit(),F(!1),$(""),c("success",0===a?"No hab\xeda actividades para eliminar.":`Todas las actividades (${a}) han sido eliminadas.`)}catch(e){c("error",`Error al eliminar actividades: ${e.message}`)}else c("error",'Por favor, escribe "confirmar" para proceder.')},confirmText:P,setConfirmText:$,theme:t}),(0,ae.jsx)(pe,{show:L,onClose:()=>_(!1),details:null===G||void 0===G?void 0:G.details,theme:t})]})},De=e=>(0,ae.jsx)(me,{children:(0,ae.jsx)(we,{...e})})}}]);
//# sourceMappingURL=37.d0f9d87b.chunk.js.map