"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[181],{6568:(e,a,t)=>{function s(){for(var e=arguments.length,a=new Array(e),t=0;t<e;t++)a[t]=arguments[t];return a.filter(Boolean).join(" ")}t.d(a,{x:()=>s})},8181:(e,a,t)=>{t.r(a),t.d(a,{default:()=>C});var s=t(5043),l=t(1283),r=t(5509),o=t(1958),n=t(5472),d=t(6568),i=t(2315),c=t(4791),m=t(1252),u=t(2811),x=t(9248),p=t(8224),h=t(6365),b=t(196),v=t(5492),g=t(2781),y=t(1238),N=t(7762),j=(t(557),t(2061)),f=t(2049),w=t(1535),k=t(579);const C=e=>{var a,t,C,$,A;let{theme:M="light"}=e;const{user:P,role:E,loading:T}=(0,r.A)(),S=(0,l.Zp)(),[O,z]=(0,s.useState)([]),[L,D]=(0,s.useState)(""),[B,_]=(0,s.useState)(!1),[H,R]=(0,s.useState)(null),[q,I]=(0,s.useState)(1),[V,G]=(0,s.useState)(10),[F,J]=(0,s.useState)("createdAt"),[Q,W]=(0,s.useState)("desc"),[Z,U]=(0,s.useState)(!1),[K,X]=(0,s.useState)(null),[Y,ee]=(0,s.useState)(null),[ae,te]=(0,s.useState)("all"),[se,le]=(0,s.useState)([]),re=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(T)return;if(!P||2!==E)return R("Acceso denegado. Solo los administradores pueden acceder a esta p\xe1gina."),void setTimeout(()=>S("/login"),3e3);_(!0);const e=(0,n.aQ)((0,n.rJ)(o.db,"breakfastTypes"),e=>{const a=e.docs.map(e=>({id:e.id,...e.data()}));le(a)},e=>{console.error("Error al escuchar breakfastTypes:",e),R("Error al cargar tipos de desayuno. Intenta de nuevo.")}),a=(0,n.aQ)((0,n.rJ)(o.db,"breakfastOrders"),e=>{const a=e.docs.map(e=>({id:e.id,...e.data(),type:"breakfast"}));z(e=>[...e.filter(e=>"breakfast"!==e.type),...a]),_(!1)},e=>{console.error("Error al escuchar breakfastOrders:",e),R("Error al cargar \xf3rdenes de desayunos. Intenta de nuevo."),_(!1)}),t=(0,n.aQ)((0,n.rJ)(o.db,"tableOrders"),e=>{const a=e.docs.map(e=>({id:e.id,...e.data(),type:"lunch"}));z(e=>[...e.filter(e=>"lunch"!==e.type),...a]),_(!1)},e=>{console.error("Error al escuchar tableOrders:",e),R("Error al cargar \xf3rdenes de mesas. Intenta de nuevo."),_(!1)});return()=>{e(),a(),t()}},[P,T,E,S]),(0,s.useEffect)(()=>{function e(e){re.current&&!re.current.contains(e.target)&&U(!1)}return Z&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[Z]);const oe=(()=>{const e={cash:0,nequi:0,daviplata:0};return O.forEach(a=>{var t,s;"Cancelada"!==a.status&&(null===(t=a.meals)||void 0===t||t.forEach(t=>{var s,l,r;const o=null===(s=t.paymentMethod)||void 0===s||null===(l=s.name)||void 0===l?void 0:l.toLowerCase(),n=a.total/((null===(r=a.meals)||void 0===r?void 0:r.length)||1);"efectivo"===o?e.cash+=n:"nequi"===o?e.nequi+=n:"daviplata"===o&&(e.daviplata+=n)}),null===(s=a.breakfasts)||void 0===s||s.forEach(t=>{var s,l,r;const o=null===(s=t.paymentMethod)||void 0===s||null===(l=s.name)||void 0===l?void 0:l.toLowerCase(),n=a.total/((null===(r=a.breakfasts)||void 0===r?void 0:r.length)||1);"efectivo"===o?e.cash+=n:"nequi"===o?e.nequi+=n:"daviplata"===o&&(e.daviplata+=n)}))}),e})(),ne=O.filter(e=>{var a,t;const s=L.toLowerCase();return(e.id.toLowerCase().includes(s)||(null===(a=e.meals)||void 0===a?void 0:a.some(e=>{var a,t,l,r;return(null===(a=e.tableNumber)||void 0===a?void 0:a.toString().toLowerCase().includes(s))||(null===(t=e.paymentMethod)||void 0===t||null===(l=t.name)||void 0===l?void 0:l.toLowerCase().includes(s))||(null===(r=e.notes)||void 0===r?void 0:r.toLowerCase().includes(s))}))||(null===(t=e.breakfasts)||void 0===t?void 0:t.some(e=>{var a,t,l,r;return(null===(a=e.tableNumber)||void 0===a?void 0:a.toString().toLowerCase().includes(s))||(null===(t=e.paymentMethod)||void 0===t||null===(l=t.name)||void 0===l?void 0:l.toLowerCase().includes(s))||(null===(r=e.notes)||void 0===r?void 0:r.toLowerCase().includes(s))})))&&("all"===ae||e.type===ae)}),de=[...ne].sort((e,a)=>{const t="orderNumber"===F?"id":F,s="id"===t?e.id:e[t]||"",l="id"===t?a.id:a[t]||"";return"asc"===Q?s>l?1:-1:s<l?1:-1}),ie=Math.ceil(de.length/V),ce=de.slice((q-1)*V,q*V),me=e=>{F===e?W("asc"===Q?"desc":"asc"):(J(e),W("asc"))},ue=e=>F===e?"asc"===Q?"\u2191":"\u2193":"",xe=(e,a,t)=>{if("total"===a&&-1===e)ee(e=>({...e,total:parseFloat(t)||0}));else if("lunch"===Y.type){const s=[...Y.meals];s[e]="principle"===a||"sides"===a?{...s[e],[a]:t?t.split(", ").map(e=>({name:e})):[]}:"soup"===a||"soupReplacement"===a||"protein"===a||"drink"===a||"paymentMethod"===a?{...s[e],[a]:t?{name:t}:null}:{...s[e],[a]:t},ee({...Y,meals:s})}else if("breakfast"===Y.type){const s=[...Y.breakfasts];s[e]="additions"===a?{...s[e],[a]:t?t.split(", ").map(e=>({name:e,quantity:1})):[]}:"type"===a||"broth"===a||"eggs"===a||"riceBread"===a||"drink"===a||"protein"===a||"paymentMethod"===a?{...s[e],[a]:t?{name:t}:null}:{...s[e],[a]:t},ee({...Y,breakfasts:s})}},pe=()=>{const e=ne.map(e=>{var a,t,s,l,r,o,n,d,i;return{"N\xba Orden":e.id.slice(0,8),Tipo:"breakfast"===e.type?"Desayuno":"Almuerzo",Mesa:ge((null===(a=e.meals)||void 0===a||null===(t=a[0])||void 0===t?void 0:t.tableNumber)||(null===(s=e.breakfasts)||void 0===s||null===(l=s[0])||void 0===l?void 0:l.tableNumber)),Estado:e.status,Total:`$${(null===(r=e.total)||void 0===r?void 0:r.toLocaleString("es-CO"))||"N/A"}`,"M\xe9todo de Pago":ge((null===(o=e.meals)||void 0===o||null===(n=o[0])||void 0===n?void 0:n.paymentMethod)||(null===(d=e.breakfasts)||void 0===d||null===(i=d[0])||void 0===i?void 0:i.paymentMethod)),Detalles:"lunch"===e.type?e.meals.map((e,a)=>`Almuerzo #${a+1}: Sopa: ${ge(e.soup||e.soupReplacement)}, Principio: ${ye(e.principle)}, Prote\xedna: ${ge(e.protein)}, Bebida: ${ge(e.drink)}, Acompa\xf1amientos: ${ye(e.sides)}, Notas: ${e.notes||"Ninguna"}`).join("; "):e.breakfasts.map((e,a)=>`Desayuno #${a+1}: Tipo: ${ge(e.type)}, Caldo: ${ge(e.broth)}, Huevos: ${ge(e.eggs)}, Arroz/Pan: ${ge(e.riceBread)}, Bebida: ${ge(e.drink)}, Prote\xedna: ${ge(e.protein)}, Adiciones: ${ye(e.additions)}, Notas: ${e.notes||"Ninguna"}`).join("; ")}}),a=y.Wp.json_to_sheet(e),t=y.Wp.book_new();y.Wp.book_append_sheet(t,a,"\xd3rdenes"),y._h(t,`ordenes_${ae}_${(0,w.GP)(new Date,"yyyy-MM-dd_HH-mm-ss")}.xlsx`)},he=()=>{const e=new N.default;e.text("\xd3rdenes",14,10),e.autoTable({head:[["N\xba Orden","Tipo","Mesa","Estado","Total","M\xe9todo de Pago","Detalles"]],body:ne.map(e=>{var a,t,s,l,r,o,n,d,i;return[e.id.slice(0,8),"breakfast"===e.type?"Desayuno":"Almuerzo",ge((null===(a=e.meals)||void 0===a||null===(t=a[0])||void 0===t?void 0:t.tableNumber)||(null===(s=e.breakfasts)||void 0===s||null===(l=s[0])||void 0===l?void 0:l.tableNumber)),e.status,`$${(null===(r=e.total)||void 0===r?void 0:r.toLocaleString("es-CO"))||"N/A"}`,ge((null===(o=e.meals)||void 0===o||null===(n=o[0])||void 0===n?void 0:n.paymentMethod)||(null===(d=e.breakfasts)||void 0===d||null===(i=d[0])||void 0===i?void 0:i.paymentMethod)),"lunch"===e.type?e.meals.map((e,a)=>`Almuerzo #${a+1}: Sopa: ${ge(e.soup||e.soupReplacement)}, Principio: ${ye(e.principle)}, Prote\xedna: ${ge(e.protein)}, Bebida: ${ge(e.drink)}, Acompa\xf1amientos: ${ye(e.sides)}`).join("; "):e.breakfasts.map((e,a)=>`Desayuno #${a+1}: Tipo: ${ge(e.type)}, Caldo: ${ge(e.broth)}, Huevos: ${ge(e.eggs)}, Arroz/Pan: ${ge(e.riceBread)}, Bebida: ${ge(e.drink)}, Prote\xedna: ${ge(e.protein)}, Adiciones: ${ye(e.additions)}`).join("; ")]})}),e.save(`ordenes_${ae}_${(0,w.GP)(new Date,"yyyy-MM-dd_HH-mm-ss")}.pdf`)},be=()=>{const e=[["N\xba Orden","Tipo","Mesa","Estado","Total","M\xe9todo de Pago","Detalles"],...ne.map(e=>{var a,t,s,l,r,o,n,d,i;return[e.id.slice(0,8),"breakfast"===e.type?"Desayuno":"Almuerzo",ge((null===(a=e.meals)||void 0===a||null===(t=a[0])||void 0===t?void 0:t.tableNumber)||(null===(s=e.breakfasts)||void 0===s||null===(l=s[0])||void 0===l?void 0:l.tableNumber)),e.status,`$${(null===(r=e.total)||void 0===r?void 0:r.toLocaleString("es-CO"))||"N/A"}`,ge((null===(o=e.meals)||void 0===o||null===(n=o[0])||void 0===n?void 0:n.paymentMethod)||(null===(d=e.breakfasts)||void 0===d||null===(i=d[0])||void 0===i?void 0:i.paymentMethod)),`"${"lunch"===e.type?e.meals.map((e,a)=>`Almuerzo #${a+1}: Sopa: ${ge(e.soup||e.soupReplacement)}, Principio: ${ye(e.principle)}, Prote\xedna: ${ge(e.protein)}, Bebida: ${ge(e.drink)}, Acompa\xf1amientos: ${ye(e.sides)}, Notas: ${e.notes||"Ninguna"}`).join("; "):e.breakfasts.map((e,a)=>`Desayuno #${a+1}: Tipo: ${ge(e.type)}, Caldo: ${ge(e.broth)}, Huevos: ${ge(e.eggs)}, Arroz/Pan: ${ge(e.riceBread)}, Bebida: ${ge(e.drink)}, Prote\xedna: ${ge(e.protein)}, Adiciones: ${ye(e.additions)}, Notas: ${e.notes||"Ninguna"}`).join("; ")}"`]})].map(e=>e.join(",")).join("\n"),a=new Blob([e],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a");t.href=URL.createObjectURL(a),t.download=`ordenes_${ae}_${(0,w.GP)(new Date,"yyyy-MM-dd_HH-mm-ss")}.csv`,t.click()},ve=(e,a)=>{e(),R(null)},ge=e=>e?"string"===typeof e?e:e.name?e.name:"N/A":"N/A",ye=e=>e&&Array.isArray(e)?0===e.length?"N/A":e.map(e=>ge(e)).filter(e=>"N/A"!==e).join(", "):ge(e);return T?(0,k.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:"Cargando..."}):(0,k.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,k.jsx)("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100 mb-6",children:"Gesti\xf3n de pedidos Mesas"}),(0,k.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6 text-sm text-gray-700 dark:text-gray-300",children:[(0,k.jsxs)("div",{className:(0,d.x)("p-3 sm:p-4 rounded-lg shadow-sm","dark"===M?"bg-gray-700":"bg-gray-100"),children:[(0,k.jsx)("p",{className:"font-semibold text-sm sm:text-base",children:"Total Efectivo"}),(0,k.jsxs)("p",{className:"text-lg sm:text-xl font-bold",children:["$",oe.cash.toLocaleString("es-CO")]})]}),(0,k.jsxs)("div",{className:(0,d.x)("p-3 sm:p-4 rounded-lg shadow-sm","dark"===M?"bg-gray-700":"bg-gray-100"),children:[(0,k.jsx)("p",{className:"font-semibold text-sm sm:text-base",children:"Total Daviplata"}),(0,k.jsxs)("p",{className:"text-lg sm:text-xl font-bold",children:["$",oe.daviplata.toLocaleString("es-CO")]})]}),(0,k.jsxs)("div",{className:(0,d.x)("p-3 sm:p-4 rounded-lg shadow-sm","dark"===M?"bg-gray-700":"bg-gray-100"),children:[(0,k.jsx)("p",{className:"font-semibold text-sm sm:text-base",children:"Total Nequi"}),(0,k.jsxs)("p",{className:"text-lg sm:text-xl font-bold",children:["$",oe.nequi.toLocaleString("es-CO")]})]}),(0,k.jsxs)("div",{className:(0,d.x)("p-3 sm:p-4 rounded-lg shadow-sm","dark"===M?"bg-gray-700":"bg-gray-100"),children:[(0,k.jsx)("p",{className:"font-semibold text-sm sm:text-base",children:"Total General"}),(0,k.jsxs)("p",{className:"text-lg sm:text-xl font-bold",children:["$",(oe.cash+oe.daviplata+oe.nequi).toLocaleString("es-CO")]})]})]}),(0,k.jsxs)("div",{className:"flex flex-wrap justify-between items-center mb-6 gap-3 sm:gap-4",children:[(0,k.jsx)("input",{type:"text",value:L,onChange:e=>D(e.target.value),placeholder:"Buscar \xf3rdenes por ID, mesa o m\xe9todo de pago...",className:(0,d.x)("p-2 sm:p-3 rounded-lg border focus:outline-none focus:ring-2 focus:ring-blue-500 w-full sm:max-w-xs shadow-sm text-sm sm:text-base transition-all duration-200","dark"===M?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900")}),(0,k.jsxs)("div",{className:"relative z-50 flex-shrink-0",ref:re,children:[(0,k.jsx)("button",{onClick:()=>U(!Z),className:(0,d.x)("flex items-center justify-center p-2 rounded-lg text-xs sm:text-sm font-medium transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-blue-500"),"aria-label":"Opciones de men\xfa",children:(0,k.jsx)(i.A,{className:(0,d.x)("w-6 h-6","dark"===M?"text-gray-200 hover:text-white":"text-gray-700 hover:text-gray-900")})}),Z&&(0,k.jsx)("div",{className:(0,d.x)("absolute right-0 mt-2 w-48 rounded-lg shadow-xl z-50","dark"===M?"bg-gray-700 text-gray-200":"bg-white text-gray-900"),children:(0,k.jsxs)("div",{className:"py-1",children:[(0,k.jsx)("button",{onClick:()=>{te("breakfast"),U(!1)},className:"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200",children:"Ver Desayunos"}),(0,k.jsx)("button",{onClick:()=>{te("lunch"),U(!1)},className:"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200",children:"Ver Almuerzos"}),(0,k.jsx)("button",{onClick:()=>{te("all"),U(!1)},className:"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200",children:"Ver Todos"}),(0,k.jsxs)("button",{onClick:()=>{ve(pe),U(!1)},className:"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200 flex items-center",children:[(0,k.jsx)(c.A,{className:"w-4 h-4 mr-2"}),"Exportar Excel"]}),(0,k.jsxs)("button",{onClick:()=>{ve(he),U(!1)},className:"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200 flex items-center",children:[(0,k.jsx)(c.A,{className:"w-4 h-4 mr-2"}),"Exportar PDF"]}),(0,k.jsxs)("button",{onClick:()=>{ve(be),U(!1)},className:"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200 flex items-center",children:[(0,k.jsx)(c.A,{className:"w-4 h-4 mr-2"}),"Exportar CSV"]})]})})]})]}),(0,k.jsx)("div",{className:(0,d.x)("p-3 sm:p-4 rounded-2xl shadow-xl max-h-[70vh] overflow-y-auto custom-scrollbar transition-all duration-300","dark"===M?"bg-gray-800":"bg-white"),children:B?(0,k.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,k.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-4 border-blue-500"})}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"overflow-x-auto",children:(0,k.jsxs)("table",{className:"min-w-full text-left border-collapse text-sm",children:[(0,k.jsx)("thead",{children:(0,k.jsxs)("tr",{className:(0,d.x)("font-semibold sticky top-0 z-10 shadow-sm","dark"===M?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700"),children:[(0,k.jsxs)("th",{className:"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap",onClick:()=>me("orderNumber"),children:["N\xba ",ue("orderNumber")]}),(0,k.jsx)("th",{className:"p-2 sm:p-3 border-b whitespace-nowrap",children:"Detalles"}),(0,k.jsxs)("th",{className:"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap",onClick:()=>me("meals.0.tableNumber"),children:["Mesa ",ue("meals.0.tableNumber")]}),(0,k.jsxs)("th",{className:"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap",onClick:()=>me("meals.0.paymentMethod.name"),children:["Pago ",ue("meals.0.paymentMethod.name")]}),(0,k.jsxs)("th",{className:"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap",onClick:()=>me("total"),children:["Total ",ue("total")]}),(0,k.jsxs)("th",{className:"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap",onClick:()=>me("status"),children:["Estado ",ue("status")]}),(0,k.jsx)("th",{className:"p-2 sm:p-3 border-b whitespace-nowrap",children:"Acciones"})]})}),(0,k.jsx)("tbody",{children:0===ce.length?(0,k.jsx)("tr",{children:(0,k.jsx)("td",{colSpan:"7",className:"p-6 text-center text-gray-500 dark:text-gray-400",children:"No se encontraron \xf3rdenes de mesas. Intenta ajustar tu b\xfasqueda."})}):ce.map((e,a)=>{var t,s,l,r,i,c,p,h,b;const v="asc"===Q?(q-1)*V+a+1:ce.length-((q-1)*V+a),g=ge((null===(t=e.meals)||void 0===t||null===(s=t[0])||void 0===s?void 0:s.paymentMethod)||(null===(l=e.breakfasts)||void 0===l||null===(r=l[0])||void 0===r?void 0:r.paymentMethod)),y="Pendiente"===e.status?"bg-yellow-500 text-black":"Preparando"===e.status?"bg-blue-500 text-white":"Completada"===e.status?"bg-green-500 text-white":"Cancelada"===e.status?"bg-red-500 text-white":"";return(0,k.jsxs)("tr",{className:(0,d.x)("border-b transition-colors duration-150","dark"===M?"border-gray-700 hover:bg-gray-700":"border-gray-200 hover:bg-gray-50",a%2===0?"dark"===M?"bg-gray-750":"bg-gray-50":""),children:[(0,k.jsx)("td",{className:"p-2 sm:p-3 text-gray-300",children:v}),(0,k.jsx)("td",{className:"p-2 sm:p-3 text-gray-300",children:(0,k.jsxs)("button",{onClick:()=>X(e),className:"text-blue-400 hover:text-blue-300 text-xs sm:text-sm flex items-center",title:"Ver detalles de la orden",children:[(0,k.jsx)(m.A,{className:"w-4 h-4 mr-1"}),"Ver"]})}),(0,k.jsx)("td",{className:"p-2 sm:p-3 text-gray-300 whitespace-nowrap",children:ge((null===(i=e.meals)||void 0===i||null===(c=i[0])||void 0===c?void 0:c.tableNumber)||(null===(p=e.breakfasts)||void 0===p||null===(h=p[0])||void 0===h?void 0:h.tableNumber))}),(0,k.jsx)("td",{className:"p-2 sm:p-3 text-gray-300 whitespace-nowrap",children:g}),(0,k.jsxs)("td",{className:"p-2 sm:p-3 text-gray-300 whitespace-nowrap",children:["$",(null===(b=e.total)||void 0===b?void 0:b.toLocaleString("es-CO"))||"N/A"]}),(0,k.jsx)("td",{className:"p-2 sm:p-3 whitespace-nowrap",children:(0,k.jsxs)("select",{value:e.status||"Pendiente",onChange:a=>(async(e,a)=>{try{_(!0);const t="breakfast"===O.find(a=>a.id===e).type?"breakfastOrders":"tableOrders",s=(0,n.H9)(o.db,t,e);await(0,n.mZ)(s,{status:a,updatedAt:new Date}),R(null)}catch(t){console.error("Error al actualizar estado:",t),R("Error al actualizar el estado de la orden. Intenta de nuevo.")}finally{_(!1)}})(e.id,a.target.value),className:(0,d.x)("px-2 py-1 rounded-full text-xs font-semibold appearance-none cursor-pointer",y,"dark"===M?"bg-opacity-70":"bg-opacity-90","focus:outline-none focus:ring-2 focus:ring-blue-500"),children:[(0,k.jsx)("option",{value:"Pendiente",children:"Pendiente"}),(0,k.jsx)("option",{value:"Preparando",children:"Preparando"}),(0,k.jsx)("option",{value:"Completada",children:"Completada"}),(0,k.jsx)("option",{value:"Cancelada",children:"Cancelada"})]})}),(0,k.jsxs)("td",{className:"p-2 sm:p-3 whitespace-nowrap",children:[(0,k.jsx)("button",{onClick:()=>(e=>{"lunch"===e.type?ee({...e,meals:e.meals.map(e=>({...e,soup:e.soup||null,soupReplacement:e.soupReplacement||null,principle:e.principle||[],protein:e.protein||null,drink:e.drink||null,sides:e.sides||[],paymentMethod:e.paymentMethod||null,tableNumber:e.tableNumber||"",orderType:e.orderType||"",notes:e.notes||""}))}):"breakfast"===e.type&&ee({...e,breakfasts:e.breakfasts.map(e=>({type:e.type||null,broth:e.broth||null,eggs:e.eggs||null,riceBread:e.riceBread||null,drink:e.drink||null,protein:e.protein||null,additions:e.additions||[],tableNumber:e.tableNumber||"",paymentMethod:e.paymentMethod||null,orderType:e.orderType||"",notes:e.notes||""}))})})(e),className:"text-blue-500 hover:text-blue-400 transition-colors duration-150 p-1 rounded-md mr-2",title:"Editar orden","aria-label":`Editar orden ${v}`,children:(0,k.jsx)(u.A,{className:"w-5 h-5"})}),(0,k.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\xbfEst\xe1s seguro de que deseas eliminar esta orden?"))try{_(!0);const a="breakfast"===O.find(a=>a.id===e).type?"breakfastOrders":"tableOrders";await(0,n.kd)((0,n.H9)(o.db,a,e)),R(null)}catch(a){console.error("Error al eliminar orden:",a),R("Error al eliminar la orden. Intenta de nuevo.")}finally{_(!1)}})(e.id),className:"text-red-500 hover:text-red-400 transition-colors duration-150 p-1 rounded-md",title:"Eliminar orden","aria-label":`Eliminar orden ${v}`,children:(0,k.jsx)(x.A,{className:"w-5 h-5"})})]})]},e.id)})})]})}),(0,k.jsxs)("div",{className:"flex flex-wrap justify-between items-center mt-6 gap-3",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300",children:[(0,k.jsx)("span",{children:"\xd3rdenes por p\xe1gina:"}),(0,k.jsxs)("select",{value:V,onChange:e=>{G(Number(e.target.value)),I(1)},className:(0,d.x)("p-2 rounded-md border text-sm","dark"===M?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900"),children:[(0,k.jsx)("option",{value:"10",children:"10"}),(0,k.jsx)("option",{value:"20",children:"20"}),(0,k.jsx)("option",{value:"30",children:"30"}),(0,k.jsx)("option",{value:"50",children:"50"})]})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300",children:[(0,k.jsx)("button",{onClick:()=>I(e=>Math.max(e-1,1)),disabled:1===q,className:(0,d.x)("p-2 rounded-md transition-colors duration-200",1===q?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"dark"===M?"hover:bg-gray-700 text-gray-200":"hover:bg-gray-100 text-gray-700"),children:(0,k.jsx)(p.A,{className:"w-5 h-5"})}),(0,k.jsxs)("span",{children:["P\xe1gina ",q," de ",ie]}),(0,k.jsx)("button",{onClick:()=>I(e=>Math.min(e+1,ie)),disabled:q===ie,className:(0,d.x)("p-2 rounded-md transition-colors duration-200",q===ie?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"dark"===M?"hover:bg-gray-700 text-gray-200":"hover:bg-gray-100 text-gray-700"),children:(0,k.jsx)(h.A,{className:"w-5 h-5"})})]})]}),K&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10001]",children:(0,k.jsxs)("div",{className:(0,d.x)("p-4 sm:p-6 rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto","dark"===M?"bg-gray-800 text-gray-200":"bg-white text-gray-900"),children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Detalles de la Orden #",K.id.slice(0,8)]}),(0,k.jsxs)("p",{className:"text-sm mb-2",children:["Mesa: ",(null===(a=K.meals)||void 0===a||null===(t=a[0])||void 0===t?void 0:t.tableNumber)||(null===(C=K.breakfasts)||void 0===C||null===($=C[0])||void 0===$?void 0:$.tableNumber)||"N/A"]}),(0,k.jsxs)("p",{className:"text-sm mb-2",children:["Estado: ",K.status]}),(0,k.jsxs)("p",{className:"text-sm mb-4",children:["Total: $",(null===(A=K.total)||void 0===A?void 0:A.toLocaleString("es-CO"))||"N/A"]}),(0,k.jsx)(g.A,{meals:K.meals||K.breakfasts,isTableOrder:!0,calculateTotal:()=>K.total}),(0,k.jsx)("button",{onClick:()=>X(null),className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm",children:"Cerrar"})]})}),Y&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10001]",children:(0,k.jsxs)("div",{className:(0,d.x)("p-4 sm:p-6 rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto","dark"===M?"bg-gray-800 text-gray-200":"bg-white text-gray-900"),children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Editar Orden #",Y.id.slice(0,8)]}),"lunch"===Y.type?Y.meals.map((e,a)=>{var t,s,l,r,o;return(0,k.jsxs)("div",{className:"mt-2",children:[(0,k.jsxs)("h4",{className:"text-sm font-medium",children:["Almuerzo #",a+1]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"Sopa o Reemplazo"}),(0,k.jsx)("input",{type:"text",value:(null===(t=e.soup)||void 0===t?void 0:t.name)||(null===(s=e.soupReplacement)||void 0===s?void 0:s.name)||"",onChange:t=>xe(a,e.soup?"soup":"soupReplacement",t.target.value),placeholder:"Sopa o reemplazo",className:"w-full p-2 mt-1 border rounded text-sm"})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"Principio"}),(0,k.jsx)("input",{type:"text",value:ye(e.principle),onChange:e=>xe(a,"principle",e.target.value),placeholder:"Principio",className:"w-full p-2 mt-1 border rounded text-sm"})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"Prote\xedna"}),(0,k.jsx)("input",{type:"text",value:(null===(l=e.protein)||void 0===l?void 0:l.name)||"",onChange:e=>xe(a,"protein",e.target.value),placeholder:"Prote\xedna",className:"w-full p-2 mt-1 border rounded text-sm"})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"Bebida"}),(0,k.jsx)("input",{type:"text",value:(null===(r=e.drink)||void 0===r?void 0:r.name)||"",onChange:e=>xe(a,"drink",e.target.value),placeholder:"Bebida",className:"w-full p-2 mt-1 border rounded text-sm"})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"Acompa\xf1amientos"}),(0,k.jsx)("input",{type:"text",value:ye(e.sides),onChange:e=>xe(a,"sides",e.target.value),placeholder:"Acompa\xf1amientos",className:"w-full p-2 mt-1 border rounded text-sm"})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"M\xe9todo de Pago"}),(0,k.jsx)("input",{type:"text",value:(null===(o=e.paymentMethod)||void 0===o?void 0:o.name)||"",onChange:e=>xe(a,"paymentMethod",e.target.value),placeholder:"M\xe9todo de pago",className:"w-full p-2 mt-1 border rounded text-sm"})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"N\xfamero de Mesa"}),(0,k.jsx)("input",{type:"text",value:e.tableNumber||"",onChange:e=>xe(a,"tableNumber",e.target.value),placeholder:"N\xfamero de mesa",className:"w-full p-2 mt-1 border rounded text-sm"})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"Tipo de Pedido"}),(0,k.jsxs)("select",{value:e.orderType||"",onChange:e=>xe(a,"orderType",e.target.value),className:"w-full p-2 mt-1 border rounded text-sm",children:[(0,k.jsx)("option",{value:"",children:"Seleccionar"}),(0,k.jsx)("option",{value:"table",children:"Para mesa"}),(0,k.jsx)("option",{value:"takeaway",children:"Para llevar"})]})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"Notas"}),(0,k.jsx)("textarea",{value:e.notes||"",onChange:e=>xe(a,"notes",e.target.value),placeholder:"Notas",className:"w-full p-2 mt-1 border rounded text-sm"})]})]},a)}):Y.breakfasts.map((e,a)=>{var t,s,l,r,o,n,d;return(0,k.jsxs)("div",{className:"mt-2",children:[(0,k.jsxs)("h4",{className:"text-sm font-medium",children:["Desayuno #",a+1]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"Tipo de Desayuno"}),(0,k.jsx)("input",{type:"text",value:(null===(t=e.type)||void 0===t?void 0:t.name)||"",onChange:e=>xe(a,"type",e.target.value),placeholder:"Tipo de desayuno",className:"w-full p-2 mt-1 border rounded text-sm"})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"Caldo"}),(0,k.jsx)("input",{type:"text",value:(null===(s=e.broth)||void 0===s?void 0:s.name)||"",onChange:e=>xe(a,"broth",e.target.value),placeholder:"Caldo",className:"w-full p-2 mt-1 border rounded text-sm"})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"Huevos"}),(0,k.jsx)("input",{type:"text",value:(null===(l=e.eggs)||void 0===l?void 0:l.name)||"",onChange:e=>xe(a,"eggs",e.target.value),placeholder:"Huevos",className:"w-full p-2 mt-1 border rounded text-sm"})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"Arroz/Pan"}),(0,k.jsx)("input",{type:"text",value:(null===(r=e.riceBread)||void 0===r?void 0:r.name)||"",onChange:e=>xe(a,"riceBread",e.target.value),placeholder:"Arroz/Pan",className:"w-full p-2 mt-1 border rounded text-sm"})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"Bebida"}),(0,k.jsx)("input",{type:"text",value:(null===(o=e.drink)||void 0===o?void 0:o.name)||"",onChange:e=>xe(a,"drink",e.target.value),placeholder:"Bebida",className:"w-full p-2 mt-1 border rounded text-sm"})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"Prote\xedna"}),(0,k.jsx)("input",{type:"text",value:(null===(n=e.protein)||void 0===n?void 0:n.name)||"",onChange:e=>xe(a,"protein",e.target.value),placeholder:"Prote\xedna",className:"w-full p-2 mt-1 border rounded text-sm"})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"Adiciones"}),(0,k.jsx)("input",{type:"text",value:ye(e.additions),onChange:e=>xe(a,"additions",e.target.value),placeholder:"Adiciones",className:"w-full p-2 mt-1 border rounded text-sm"})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"M\xe9todo de Pago"}),(0,k.jsx)("input",{type:"text",value:(null===(d=e.paymentMethod)||void 0===d?void 0:d.name)||"",onChange:e=>xe(a,"paymentMethod",e.target.value),placeholder:"M\xe9todo de pago",className:"w-full p-2 mt-1 border rounded text-sm"})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"N\xfamero de Mesa"}),(0,k.jsx)("input",{type:"text",value:e.tableNumber||"",onChange:e=>xe(a,"tableNumber",e.target.value),placeholder:"N\xfamero de mesa",className:"w-full p-2 mt-1 border rounded text-sm"})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"Tipo de Pedido"}),(0,k.jsxs)("select",{value:e.orderType||"",onChange:e=>xe(a,"orderType",e.target.value),className:"w-full p-2 mt-1 border rounded text-sm",children:[(0,k.jsx)("option",{value:"",children:"Seleccionar"}),(0,k.jsx)("option",{value:"table",children:"Para mesa"}),(0,k.jsx)("option",{value:"takeaway",children:"Para llevar"})]})]}),(0,k.jsxs)("div",{className:"mt-1",children:[(0,k.jsx)("label",{className:"text-xs",children:"Notas"}),(0,k.jsx)("textarea",{value:e.notes||"",onChange:e=>xe(a,"notes",e.target.value),placeholder:"Notas",className:"w-full p-2 mt-1 border rounded text-sm"})]})]},a)}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"text-xs block mb-1",children:"Total (editable)"}),(0,k.jsx)("input",{type:"number",value:Y.total||"",onChange:e=>xe(-1,"total",e.target.value),placeholder:"Total",className:"w-full p-2 mt-1 border rounded text-sm"})]}),(0,k.jsxs)("div",{className:"mt-4 flex space-x-2",children:[(0,k.jsx)("button",{onClick:async()=>{try{_(!0);const e=O.find(e=>e.id===Y.id),a="breakfast"===e.type?"breakfastOrders":"tableOrders",t=(0,n.H9)(o.db,a,Y.id);await(0,n.mZ)(t,{..."lunch"===e.type?{meals:Y.meals}:{breakfasts:Y.breakfasts},total:Y.total||("lunch"===e.type?(0,j.N9)(Y.meals,E):(0,f.VC)(Y.breakfasts,E,se)),updatedAt:new Date}),ee(null),R(null)}catch(e){console.error("Error al guardar edici\xf3n:",e),R("Error al guardar los cambios. Intenta de nuevo.")}finally{_(!1)}},className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 text-sm",children:"Guardar"}),(0,k.jsx)("button",{onClick:()=>ee(null),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 text-sm",children:"Cancelar"})]})]})})]})}),(0,k.jsxs)("div",{className:"fixed top-16 right-4 z-[10002] space-y-2 w-80 max-w-xs",children:[B&&(0,k.jsx)(b.A,{}),H&&(0,k.jsx)(v.A,{message:H,onClose:()=>R(null)})]})]})}}}]);
//# sourceMappingURL=181.da48df86.chunk.js.map