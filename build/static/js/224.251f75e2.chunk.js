/*! For license information please see 224.251f75e2.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[224],{4224:(e,t,s)=>{s.r(t),s.d(t,{default:()=>u});var r=s(5043),a=s(1958),o=s(5472),l=s(7784);const n=(0,l.A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),i=(0,l.A)("circle-plus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var m=s(9855);const d=(0,l.A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),c=(0,l.A)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var x=s(579);const g=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}),u=e=>{let{setError:t,setSuccess:s,theme:l}=e;const[u,h]=(0,r.useState)([]),[b,p]=(0,r.useState)([{name:"",units:"",amount:"",store:""}]),[y,f]=(0,r.useState)(null),[j,v]=(0,r.useState)(!1),[w,N]=(0,r.useState)(""),[k,$]=(0,r.useState)(null),[C,E]=(0,r.useState)(!1);(0,r.useEffect)(()=>{const e=(0,o.P)((0,o.rJ)(a.db,"payments"),(0,o.My)("timestamp","desc")),s=(0,o.aQ)(e,e=>{h(e.docs.map(e=>({id:e.id,...e.data()})))},e=>t(`Error al cargar pagos: ${e.message}`));return()=>s()},[t]);const A=(e,t)=>{const{name:s,value:r}=t.target,a="amount"===s?r.replace(/[^0-9]/g,""):r,o=[...b];o[e]={...o[e],[s]:a},p(o)},P=(0,r.useMemo)(()=>u.reduce((e,t)=>{const s=t.timestamp?new Date(t.timestamp.toDate()).toLocaleDateString("es-CO",{year:"numeric",month:"long",day:"numeric"}):"Fecha Desconocida";return e[t.store]||(e[t.store]={}),e[t.store][s]||(e[t.store][s]=[]),e[t.store][s].push(t),e},{}),[u]),S=(0,r.useMemo)(()=>{const e={};return u.forEach(t=>{e[t.store]=(e[t.store]||0)+t.amount}),e},[u]),M=(0,r.useMemo)(()=>u.reduce((e,t)=>e+t.amount,0),[u]),O=e=>{$(e),E(!0)};return(0,x.jsxs)("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8 py-4 sm:py-8",children:[(0,x.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between mb-4 sm:mb-8 p-3 sm:p-4 rounded-xl shadow-lg bg-gradient-to-r from-blue-500 to-indigo-600 text-white",children:[(0,x.jsx)("h2",{className:"text-xl sm:text-3xl font-extrabold tracking-tight mb-1 sm:mb-0 text-center sm:text-left",children:"Gesti\xf3n de Pagos \ud83d\udcb8"}),(0,x.jsx)("div",{className:"text-lg sm:text-xl font-semibold",children:(0,x.jsxs)("p",{children:["Total Gastado: ",g.format(M)]})})]}),(0,x.jsxs)("button",{onClick:()=>{v(!j),f(null),p([{name:"",units:"",amount:"",store:""}]),N(""),E(!1)},className:`mb-4 sm:mb-6 px-4 py-2 sm:px-6 sm:py-3 rounded-full flex items-center justify-center space-x-2 transition-all duration-300 ease-in-out w-full sm:w-auto mx-auto\n          ${j?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"} text-white shadow-lg\n          transform hover:scale-105 text-sm sm:text-base`,children:[j?(0,x.jsx)(n,{className:"w-4 h-4 sm:w-5 sm:h-5"}):(0,x.jsx)(i,{className:"w-4 h-4 sm:w-5 sm:h-5"}),(0,x.jsx)("span",{children:j?"Cerrar Formulario":"Registrar Nuevo Pago"})]}),j&&(0,x.jsxs)("div",{className:`p-4 sm:p-6 rounded-xl shadow-xl transform transition-all duration-500 ease-in-out ${"dark"===l?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"} ${j?"scale-100 opacity-100":"scale-95 opacity-0"} mb-6`,children:[(0,x.jsx)("h3",{className:"text-xl sm:text-2xl font-bold mb-4 sm:mb-6 "+("dark"===l?"text-white":"text-gray-900"),children:y?"Editar Pago":"Registrar Nuevos Pagos"}),(0,x.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(async()=>{try{const e=[],r=[];if(b.forEach((t,s)=>{if(!t.name||!t.amount||!t.store)return void r.push(`El pago ${s+1} requiere Producto/Gasto, Monto y Tienda.`);const a=parseInt(t.amount);isNaN(a)||a<=0?r.push(`El monto del pago ${s+1} debe ser un n\xfamero v\xe1lido mayor que 0.`):e.push({name:t.name,units:parseInt(t.units)||0,amount:a,store:t.store,timestamp:new Date})}),r.length>0)return void t(r.join("\n"));if(y){const t=e[0];await(0,o.mZ)((0,o.H9)(a.db,"payments",y),t),s("Pago actualizado exitosamente.")}else{const t=e.map(e=>(0,o.gS)((0,o.rJ)(a.db,"payments"),e));await Promise.all(t),s("Pagos registrados exitosamente.")}p([{name:"",units:"",amount:"",store:""}]),f(null),v(!1)}catch(e){t(`Error al guardar pagos: ${e.message}`)}})()},children:[b.map((e,t)=>(0,x.jsxs)("div",{className:"p-3 sm:p-4 rounded-lg border mb-4 "+("dark"===l?"border-gray-600 bg-gray-700":"border-gray-200 bg-gray-50"),children:[(0,x.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:`name-${t}`,className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Producto/Gasto"}),(0,x.jsx)("input",{type:"text",name:"name",id:`name-${t}`,value:e.name,onChange:e=>A(t,e),className:`mt-1 p-2 sm:p-3 w-full rounded-lg border focus:ring-blue-500 focus:border-blue-500 transition-colors text-sm sm:text-base\n                        ${"dark"===l?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-gray-50 border-gray-300 text-gray-900"} shadow-sm`,placeholder:"Ej: Leche, Almuerzo",required:!0})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:`units-${t}`,className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Unidades (Opcional)"}),(0,x.jsx)("input",{type:"number",name:"units",id:`units-${t}`,value:e.units,onChange:e=>A(t,e),className:`mt-1 p-2 sm:p-3 w-full rounded-lg border focus:ring-blue-500 focus:border-blue-500 transition-colors text-sm sm:text-base\n                        ${"dark"===l?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-gray-50 border-gray-300 text-gray-900"} shadow-sm`,placeholder:"Ej: 2"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:`amount-${t}`,className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Monto Total (COP)"}),(0,x.jsx)("input",{type:"text",name:"amount",id:`amount-${t}`,value:e.amount,onChange:e=>A(t,e),placeholder:"Ej: 4700",className:`mt-1 p-2 sm:p-3 w-full rounded-lg border focus:ring-blue-500 focus:border-blue-500 transition-colors text-sm sm:text-base\n                        ${"dark"===l?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-gray-50 border-gray-300 text-gray-900"} shadow-sm`,required:!0})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{htmlFor:`store-${t}`,className:"block text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tienda/Lugar"}),(0,x.jsx)("input",{type:"text",name:"store",id:`store-${t}`,value:e.store,onChange:e=>A(t,e),className:`mt-1 p-2 sm:p-3 w-full rounded-lg border focus:ring-blue-500 focus:border-blue-500 transition-colors text-sm sm:text-base\n                        ${"dark"===l?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-gray-50 border-gray-300 text-gray-900"} shadow-sm`,placeholder:"Ej: \xc9xito, Cafeter\xeda",required:!0,onBlur:e=>N(e.target.value)})]})]}),!y&&b.length>1&&(0,x.jsx)("div",{className:"flex justify-end mt-3",children:(0,x.jsxs)("button",{type:"button",onClick:()=>(e=>{const t=b.filter((t,s)=>s!==e);p(t),0===t.length&&v(!1)})(t),className:"text-red-500 hover:text-red-600 transition-colors flex items-center text-sm",children:[(0,x.jsx)(m.A,{className:"w-4 h-4 mr-1"})," Eliminar este pago"]})})]},t)),(0,x.jsxs)("div",{className:"mt-4 sm:mt-6 flex flex-wrap justify-center sm:justify-start gap-3 sm:gap-4",children:[!y&&(0,x.jsxs)("button",{type:"button",onClick:()=>{var e;const t=(null===(e=b[b.length-1])||void 0===e?void 0:e.store)||"";N(t),p([...b,{name:"",units:"",amount:"",store:t}])},className:`px-4 py-2 sm:px-5 sm:py-2.5 rounded-lg flex items-center justify-center space-x-1 sm:space-x-2 transition-colors duration-200 text-xs sm:text-sm\n                    ${"dark"===l?"bg-blue-700 hover:bg-blue-800":"bg-blue-600 hover:bg-blue-700"} text-white shadow-md`,children:[(0,x.jsx)(i,{className:"w-4 h-4"}),(0,x.jsx)("span",{children:"Agregar Otro Pago"})]}),(0,x.jsxs)("button",{type:"submit",className:`px-4 py-2 sm:px-5 sm:py-2.5 rounded-lg flex items-center justify-center space-x-1 sm:space-x-2 transition-colors duration-200 text-xs sm:text-sm\n                  ${"dark"===l?"bg-purple-700 hover:bg-purple-800":"bg-purple-600 hover:bg-purple-700"} text-white shadow-md`,children:[(0,x.jsx)(i,{className:"w-4 h-4"}),(0,x.jsx)("span",{children:y?"Actualizar Pago":"Guardar Pagos"})]})]})]})]}),!j&&(0,x.jsx)("div",{className:`p-4 sm:p-6 rounded-xl shadow-xl max-h-[70vh] overflow-y-auto custom-scrollbar ${"dark"===l?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"} mb-6`,children:C?(0,x.jsxs)("div",{children:[(0,x.jsxs)("button",{onClick:()=>{$(null),E(!1)},className:`mb-4 px-3 py-1.5 rounded-full flex items-center space-x-2 transition-colors duration-200 text-sm\n                  ${"dark"===l?"bg-gray-700 hover:bg-gray-600 text-gray-200":"bg-gray-200 hover:bg-gray-300 text-gray-800"} shadow-md`,children:[(0,x.jsx)(d,{className:"w-4 h-4"}),(0,x.jsx)("span",{children:"Volver al Dashboard de Tiendas"})]}),(0,x.jsxs)("h3",{className:"text-xl sm:text-2xl font-bold mb-4 "+("dark"===l?"text-white":"text-gray-900"),children:["Pagos en ",k,(0,x.jsxs)("span",{className:"ml-2 text-blue-500",children:["(",g.format(S[k]||0),")"]})]}),0===Object.keys(P[k]||{}).length?(0,x.jsxs)("p",{className:"text-center text-gray-500 dark:text-gray-400 py-4 sm:py-8 text-sm sm:text-base",children:["No hay pagos registrados para ",k,"."]}):Object.entries(P[k]).map(e=>{let[r,n]=e;return(0,x.jsxs)("div",{className:"mb-6",children:[(0,x.jsxs)("h4",{className:"text-lg font-semibold mb-3 px-3 py-2 rounded-lg "+("dark"===l?"bg-gray-700 text-white":"bg-gray-100 text-gray-800"),children:["\ud83d\udcc5 ",r]}),(0,x.jsx)("div",{className:"space-y-2",children:n.map(e=>{var r;return(0,x.jsxs)("div",{className:`p-3 rounded-lg flex flex-col sm:flex-row justify-between items-start sm:items-center transition-colors duration-200\n                            ${"dark"===l?"bg-gray-700 hover:bg-gray-600 text-gray-100":"bg-gray-100 hover:bg-gray-200 text-gray-900"} shadow-sm`,children:[(0,x.jsxs)("div",{className:"flex-grow mb-1 sm:mb-0",children:[(0,x.jsxs)("p",{className:"text-sm sm:text-base font-medium",children:[(0,x.jsx)("span",{className:"text-blue-400",children:e.name})," ",e.units?`(${e.units} unidades)`:""," - ",(0,x.jsx)("strong",{children:g.format(e.amount)})]}),(0,x.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:["Fecha de Registro: ",new Date(null===(r=e.timestamp)||void 0===r?void 0:r.toDate()).toLocaleString("es-CO",{dateStyle:"short",timeStyle:"short"})]})]}),(0,x.jsxs)("div",{className:"flex space-x-2 mt-2 sm:mt-0",children:[(0,x.jsx)("button",{onClick:()=>(e=>{f(e.id),p([{...e,amount:e.amount.toString()}]),v(!0),N(e.store),E(!1)})(e),className:"text-yellow-500 hover:text-yellow-400 p-1.5 sm:p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:"Editar pago",children:(0,x.jsx)(c,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),(0,x.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\xbfEst\xe1s seguro de eliminar este pago?"))try{await(0,o.kd)((0,o.H9)(a.db,"payments",e)),s("Pago eliminado exitosamente.")}catch(r){t(`Error al eliminar pago: ${r.message}`)}})(e.id),className:"text-red-500 hover:text-red-400 p-1.5 sm:p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:"Eliminar pago",children:(0,x.jsx)(m.A,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]},e.id)})})]},r)})]}):(0,x.jsxs)("div",{children:[(0,x.jsx)("h3",{className:"text-xl sm:text-2xl font-bold mb-4 "+("dark"===l?"text-white":"text-gray-900"),children:"Gastos por Tienda \ud83d\udcca"}),0===Object.keys(S).length?(0,x.jsx)("p",{className:"text-center text-gray-500 dark:text-gray-400 py-4 sm:py-8 text-sm sm:text-base",children:"No hay tiendas con gastos registrados."}):(0,x.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(S).map(e=>{let[t,s]=e;return(0,x.jsxs)("div",{onClick:()=>O(t),className:`p-4 sm:p-5 rounded-lg shadow-md cursor-pointer transition-transform duration-200 hover:scale-[1.02]\n                        ${"dark"===l?"bg-gray-700 hover:bg-gray-600 text-gray-100":"bg-blue-50 hover:bg-blue-100 text-gray-900"} border border-transparent hover:border-blue-400`,children:[(0,x.jsxs)("h4",{className:"text-lg font-semibold mb-1 flex items-center",children:[(0,x.jsx)("span",{className:"text-blue-500 mr-2",children:"\ud83d\udecd\ufe0f"})," ",t]}),(0,x.jsx)("p",{className:"text-xl font-bold text-red-400",children:g.format(s)}),(0,x.jsx)("button",{onClick:e=>{e.stopPropagation(),O(t)},className:"mt-2 text-blue-600 dark:text-blue-400 hover:underline text-sm",children:"Ver todos los pagos"})]},t)})})]})})]})}},7784:(e,t,s)=>{s.d(t,{A:()=>m});var r=s(5043);const a=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},o=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>Boolean(e)&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()},l=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const i=(0,r.forwardRef)((e,t)=>{let{color:s="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:m,className:d="",children:c,iconNode:x,...g}=e;return(0,r.createElement)("svg",{ref:t,...n,width:a,height:a,stroke:s,strokeWidth:m?24*Number(i)/Number(a):i,className:o("lucide",d),...!c&&!l(g)&&{"aria-hidden":"true"},...g},[...x.map(e=>{let[t,s]=e;return(0,r.createElement)(t,s)}),...Array.isArray(c)?c:[c]])}),m=(e,t)=>{const s=(0,r.forwardRef)((s,l)=>{let{className:n,...m}=s;return(0,r.createElement)(i,{ref:l,iconNode:t,className:o(`lucide-${d=a(e),d.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,n),...m});var d});return s.displayName=a(e),s}},9855:(e,t,s)=>{s.d(t,{A:()=>r});const r=(0,s(7784).A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}}]);
//# sourceMappingURL=224.251f75e2.chunk.js.map