"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[37],{5343:(e,t,a)=>{a.d(t,{XF:()=>i,Zd:()=>d,_s:()=>n,fz:()=>u});const r=e=>(null!==e&&void 0!==e?e:"").toString().trim().toLowerCase(),s=e=>{const t="string"===typeof e?e:(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.label)||(null===e||void 0===e?void 0:e.title)||(null===e||void 0===e?void 0:e.method)||(null===e||void 0===e?void 0:e.type)||(null===e||void 0===e?void 0:e.payment)||"",a=r(t);return a.includes("efect")||a.includes("cash")?"cash":a.includes("nequi")?"nequi":a.includes("davi")?"daviplata":"other"},l=e=>"string"===typeof e?e:(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.label)||(null===e||void 0===e?void 0:e.title)||(null===e||void 0===e?void 0:e.method)||(null===e||void 0===e?void 0:e.type)||(null===e||void 0===e?void 0:e.payment)||"Otro",o=e=>{var t,a,r,o,i,n,d,c,m,u,x;const g=Math.floor(Number((null===e||void 0===e?void 0:e.total)||0))||0;if(Array.isArray(null===e||void 0===e?void 0:e.payments)&&e.payments.length)return e.payments.map(e=>{const t=Math.floor(Number((null===e||void 0===e?void 0:e.amount)||0))||0;return{methodKey:s(null===e||void 0===e?void 0:e.method),amount:t,rawLabel:l(null===e||void 0===e?void 0:e.method)}});const h=[null!==(t=null===e||void 0===e||null===(a=e.meals)||void 0===a||null===(r=a[0])||void 0===r?void 0:r.paymentMethod)&&void 0!==t?t:null===e||void 0===e||null===(o=e.meals)||void 0===o||null===(i=o[0])||void 0===i?void 0:i.payment,null!==(n=null===e||void 0===e||null===(d=e.breakfasts)||void 0===d||null===(c=d[0])||void 0===c?void 0:c.payment)&&void 0!==n?n:null===e||void 0===e||null===(m=e.breakfasts)||void 0===m||null===(u=m[0])||void 0===u?void 0:u.paymentMethod,null!==(x=null===e||void 0===e?void 0:e.paymentMethod)&&void 0!==x?x:null===e||void 0===e?void 0:e.payment].filter(Boolean);if(h.length){const e=l(h[0]);return[{methodKey:s(h[0]),amount:g,rawLabel:e}]}return[{methodKey:"other",amount:g,rawLabel:"Otro"}]},i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!Array.isArray(e)||!e.length)return"Sin pago";const t=e.reduce((e,t)=>{const a=t.methodKey||s(null===t||void 0===t?void 0:t.method);return e[a]=(e[a]||0)+(Math.floor(Number(t.amount||0))||0),e},{}),a=[];return t.cash&&a.push(`Efectivo $${t.cash.toLocaleString("es-CO")}`),t.nequi&&a.push(`Nequi $${t.nequi.toLocaleString("es-CO")}`),t.daviplata&&a.push(`Daviplata $${t.daviplata.toLocaleString("es-CO")}`),t.other&&!a.length&&a.push(`Otro $${t.other.toLocaleString("es-CO")}`),a.join(" + ")||"Sin pago"},n=e=>{const t=o(e);if(null!==t&&void 0!==t&&t.length)return t.map(e=>{let{methodKey:t,amount:a}=e;return{method:t,amount:a}});return[{method:"cash",amount:Math.floor(Number((null===e||void 0===e?void 0:e.total)||0))||0}]},d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t={cash:0,nequi:0,daviplata:0,other:0,total:0};for(const a of e){const e=o(a);for(const a of e){const e=Math.floor(Number(a.amount||0))||0;t[a.methodKey]=(t[a.methodKey]||0)+e,t.total+=e}}return t},c=e=>{var t,a;if(((null===e||void 0===e?void 0:e.__collection)||"").toLowerCase().includes("table"))return!0;const s=r((null===e||void 0===e?void 0:e.orderType)||(null===e||void 0===e||null===(t=e.breakfasts)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.orderType)||"");return!(!Array.isArray(null===e||void 0===e?void 0:e.breakfasts)||!(s.includes("table")||s.includes("takeaway")||s.includes("para llevar")||s.includes("llevar")))},m=e=>{var t;return!(null===e||void 0===e||null===(t=e.settlement)||void 0===t||!t.status||"liquidated"!==r(e.settlement.status))||(!0===(null===e||void 0===e?void 0:e.liquidated)||(!0===(null===e||void 0===e?void 0:e.cashSettled)||!(null===e||void 0===e||!e.settledAt)))},u=function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const a={nequiTotal:0,daviplataTotal:0,cashSalon:0,cashClientesSettled:0,cashClientesPendiente:0},r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];for(const t of e){const e=o(t);let r=0,s=0,l=0;for(const t of e){const e=Math.floor(Number((null===t||void 0===t?void 0:t.amount)||0))||0;"cash"===t.methodKey?r+=e:"nequi"===t.methodKey?s+=e:"daviplata"===t.methodKey&&(l+=e)}a.nequiTotal+=s,a.daviplataTotal+=l,r>0&&(c(t)?a.cashSalon+=r:m(t)?a.cashClientesSettled+=r:a.cashClientesPendiente+=r)}};return r(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]),r(e),r(t),{...a,cashCaja:a.cashSalon+a.cashClientesSettled}}},6568:(e,t,a)=>{function r(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter(Boolean).join(" ")}a.d(t,{x:()=>r})},9037:(e,t,a)=>{a.r(t),a.d(t,{default:()=>we});var r=a(5043),s=a(1958),l=a(458),o=a(5472),i=a(6568),n=a(7015),d=a(9795),c=a(4645),m=a(7719),u=a(614),x=a(1419),g=a(7118),h=a(4537),y=a(7856),v=a(9855),p=a(3062),b=a(5711),f=a(2382),j=a(8646),w=a(5088);const D="pendiente",N="entregado",k="cancelado",S={[D]:"Pendientes",[N]:"Entregados",[k]:"Cancelados"},C=["#fbbf24","#4ade80","#ef4444","#60a5fa","#a78bfa"],A="Ingresos",T="PedidosDiariosGuardados";var O=a(5343);const z=(e,t,a)=>{const r=new Date;r.setHours(0,0,0,0);let s=new Date(r),l=new Date(r);switch(l.setHours(23,59,59,999),e){case"7_days":default:s.setDate(r.getDate()-6);break;case"30_days":s=new Date(r.getFullYear(),r.getMonth(),1),l=new Date(r.getFullYear(),r.getMonth()+1,0),l.setHours(23,59,59,999);break;case"year":s=new Date(r.getFullYear(),0,1),l=new Date(r.getFullYear(),11,31),l.setHours(23,59,59,999);break;case"custom":s=t?new Date(t):null,s&&s.setHours(0,0,0,0),l=a?new Date(a):null,l&&l.setHours(23,59,59,999)}return{startDate:s,endDate:l}},M=e=>{const t=(null===e||void 0===e?void 0:e.createdAt)||(null===e||void 0===e?void 0:e.timestamp)||(null===e||void 0===e?void 0:e.date),a=null!==t&&void 0!==t&&t.toDate?t.toDate():t?new Date(t):null;return a?a.toISOString().split("T")[0]:null},F=e=>Boolean((null===e||void 0===e?void 0:e.isBreakfast)||"breakfast"===(null===e||void 0===e?void 0:e.meal)||Array.isArray(null===e||void 0===e?void 0:e.breakfasts)&&e.breakfasts.length>0),$=e=>{var t,a,r,s,l,o;const i=(null!==(t=null!==(a=null!==(r=null!==(s=null!==(l=null!==(o=null===e||void 0===e?void 0:e.orderTypeNormalized)&&void 0!==o?o:null===e||void 0===e?void 0:e.serviceType)&&void 0!==l?l:null===e||void 0===e?void 0:e.orderType)&&void 0!==s?s:null===e||void 0===e?void 0:e.channel)&&void 0!==r?r:null===e||void 0===e?void 0:e.tipoPedido)&&void 0!==a?a:null===e||void 0===e?void 0:e.typeOfOrder)&&void 0!==t?t:"").toString().toLowerCase();return/mesa|table|sal[o\xf3]n|dine/.test(i)?"mesa":/llevar|para\s*llevar|take(?:-|\s)?away|to-?go|takeout/.test(i)?"llevar":/domicil|deliver|env[i\xed]o/.test(i)?"domicilio":null},E=(e,t,a,s,l,i,n,d,c,m,u)=>{var x;let g=null,h=null,y=null,v=null,p=null,b=null,f="7_days",j=null,w=null,E="7_days",L=null,P=null,I=null;"function"===typeof s?(g=s,h=e=>{var t;return null===(t=g)||void 0===t?void 0:t("error",e)},y=e=>{var t;return null===(t=g)||void 0===t?void 0:t("success",e)},v=l||null,p=i||null,b=n||null):(h=s,y=l,f=null!==i&&void 0!==i?i:f,j=null!==n&&void 0!==n?n:null,w=null!==d&&void 0!==d?d:null,E=null!==c&&void 0!==c?c:E,L=null!==m&&void 0!==m?m:null,P=null!==u&&void 0!==u?u:null,I=arguments.length>=12?arguments[11]:null,g=null,v=null,p=null,b=null);const[_,G]=(0,r.useState)(!0),[B,K]=(0,r.useState)([]),[H,J]=(0,r.useState)([]),[q,V]=(0,r.useState)([]),[Y,R]=(0,r.useState)([]),[Q,U]=(0,r.useState)({cash:0,cashCaja:0,cashPendiente:0,daviplata:0,nequi:0,expenses:0,expensesByProvider:{total:0,byProvider:{},counts:{}},byCategory:{domiciliosAlmuerzo:0,mesasAlmuerzo:0,llevarAlmuerzo:0,domiciliosDesayuno:0,mesasDesayuno:0,llevarDesayuno:0},grossIncome:0,net:0}),[W,Z]=(0,r.useState)({domicilio_almuerzo:0,domicilio_desayuno:0,mesa_almuerzo:0,llevar_almuerzo:0,mesa_desayuno:0,llevar_desayuno:0}),[X,ee]=(0,r.useState)({Pending:0,Delivered:0,Cancelled:0}),[te,ae]=(0,r.useState)([]),[re,se]=(0,r.useState)([]),[le,oe]=(0,r.useState)([]),[ie,ne]=(0,r.useState)([]),[de,ce]=(0,r.useState)([]),[me,ue]=(0,r.useState)([]),xe=(0,r.useRef)({orders:!1,tableOrders:!1,breakfastOrders:!1,users:!1,activity:!1,ingresos:!1,pedidosDiariosGuardados:!1,payments:!1}),ge=()=>{xe.current.orders&&xe.current.tableOrders&&xe.current.breakfastOrders&&xe.current.users&&xe.current.activity&&xe.current.ingresos&&xe.current.pedidosDiariosGuardados&&xe.current.payments&&G(!1)};(0,r.useEffect)(()=>{const e={domiciliosAlmuerzo:0,mesasAlmuerzo:0,llevarAlmuerzo:0,domiciliosDesayuno:0,mesasDesayuno:0,llevarDesayuno:0};e.domiciliosAlmuerzo=B.reduce((e,t)=>e+Number(t.total||0),0);for(const i of H){const t=Number(i.total||0);if(t<=0)continue;const a=F(i),r=$(i)||"mesa";a?"mesa"===r?e.mesasDesayuno+=t:"llevar"===r?e.llevarDesayuno+=t:"domicilio"===r?e.domiciliosDesayuno+=t:e.mesasDesayuno+=t:"mesa"===r?e.mesasAlmuerzo+=t:"llevar"===r?e.llevarAlmuerzo+=t:"domicilio"===r?e.domiciliosAlmuerzo+=t:e.mesasAlmuerzo+=t}for(const i of q){var t,a,r,s;const l=Number(i.total||0);if(l<=0)continue;const o=$(i);null!==(t=i.address)&&void 0!==t&&t.address||null!==(a=i.breakfasts)&&void 0!==a&&null!==(r=a[0])&&void 0!==r&&null!==(s=r.address)&&void 0!==s&&s.address;"mesa"===o?e.mesasDesayuno+=l:"llevar"===o?e.llevarDesayuno+=l:e.domiciliosDesayuno+=l}const l=e.domiciliosAlmuerzo+e.mesasAlmuerzo+e.llevarAlmuerzo+e.domiciliosDesayuno+e.mesasDesayuno+e.llevarDesayuno;U(t=>({...t,byCategory:e,grossIncome:l,net:Math.max(l-(t.expenses||0),0)}));const o=[...B,...H,...q];Z(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t={domicilio_almuerzo:0,domicilio_desayuno:0,mesa_almuerzo:0,llevar_almuerzo:0,mesa_desayuno:0,llevar_desayuno:0};for(const a of e){const e=Number(null===a||void 0===a?void 0:a.total)||0;if(e<=0)continue;const r=F(a)?"desayuno":"almuerzo",s=$(a);s&&("domicilio"===s?t[`domicilio_${r}`]+=e:"mesa"===s?t[`mesa_${r}`]+=e:"llevar"===s&&(t[`llevar_${r}`]+=e))}return t}(o))},[B,H,q]),(0,r.useEffect)(()=>{if(!e||!t||!a)return;G(!0);const r=[],s=(0,o.rJ)(e,"orders"),l=(0,o.aQ)(s,e=>{const t=e.docs.map(e=>({id:e.id,__collection:"orders",...e.data()}));K(t);const a={cash:0,daviplata:0,nequi:0},r={Pending:0,Delivered:0,Cancelled:0};t.forEach(e=>{var t;const s=e.paymentSummary||{};a.cash+=Number(s.Efectivo||0),a.daviplata+=Number(s.Daviplata||0),a.nequi+=Number(s.Nequi||0);const l=(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())||"";l===D?r.Pending+=1:l===N?r.Delivered+=1:l===k&&(r.Cancelled+=1)}),ee(r);const s=[{name:S[D],value:r.Pending,color:C[0]},{name:S[N],value:r.Delivered,color:C[1]},{name:S[k],value:r.Cancelled,color:C[2]}];ue(s),xe.current.orders||(xe.current.orders=!0,ge())},e=>{h(`Error al cargar pedidos: ${e.message}`),xe.current.orders||(xe.current.orders=!0,ge())});r.push(l);const i=(0,o.rJ)(e,"tableOrders"),n=(0,o.aQ)(i,e=>{const t=e.docs.map(e=>({id:e.id,__collection:"tableOrders",...e.data()}));J(t),xe.current.tableOrders||(xe.current.tableOrders=!0,ge())},e=>{h(`Error al cargar pedidos de mesa: ${e.message}`),xe.current.tableOrders||(xe.current.tableOrders=!0,ge())});r.push(n);const d=(0,o.rJ)(e,"deliveryBreakfastOrders"),c=(0,o.aQ)(d,e=>{const t=e.docs.map(e=>({id:e.id,__collection:"deliveryBreakfastOrders",...e.data()}));V(t),xe.current.breakfastOrders||(xe.current.breakfastOrders=!0,ge())},e=>{h(`Error al cargar desayunos: ${e.message}`),xe.current.breakfastOrders||(xe.current.breakfastOrders=!0,ge())});r.push(c);const m=(0,o.rJ)(e,"users"),u=(0,o.aQ)(m,e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));R(t),xe.current.users||(xe.current.users=!0,ge())},e=>{h(`Error al cargar usuarios: ${e.message}`),xe.current.users||(xe.current.users=!0,ge())});r.push(u);const x=(0,o.rJ)(e,"userActivity"),g=(0,o.aQ)(x,e=>{const t=e.docs.map(e=>{const t=e.data(),a=t.timestamp instanceof o.Dc?t.timestamp.toDate():null;return{id:e.id,...t,timestamp:a}}).sort((e,t)=>(t.timestamp?t.timestamp.getTime():0)-(e.timestamp?e.timestamp.getTime():0));ae(t),xe.current.activity||(xe.current.activity=!0,ge())},e=>{h(`Error al cargar actividad: ${e.message}`),xe.current.activity||(xe.current.activity=!0,ge())});r.push(g);const y=(0,o.rJ)(e,A),b=(0,o.aQ)(y,e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));se(t),xe.current.ingresos||(xe.current.ingresos=!0,ge())},e=>{h(`Error al cargar ingresos: ${e.message}`),xe.current.ingresos||(xe.current.ingresos=!0,ge())});r.push(b);const f=(0,o.rJ)(e,T),j=(0,o.aQ)(f,e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));oe(t),xe.current.pedidosDiariosGuardados||(xe.current.pedidosDiariosGuardados=!0,ge())},e=>{h(`Error al cargar pedidos diarios guardados: ${e.message}`),xe.current.pedidosDiariosGuardados||(xe.current.pedidosDiariosGuardados=!0,ge())});r.push(j);const w=v&&p?(0,o.P)((0,o.rJ)(e,"payments"),(0,o._M)("timestamp",">=",v),(0,o._M)("timestamp","<=",p),(0,o.My)("timestamp","asc")):(0,o.rJ)(e,"payments"),O=(0,o.aQ)(w,e=>{const t=e.docs.map(e=>({id:e.id,...e.data()})).filter(e=>!!e.timestamp);let a=0;const r={},s={};for(const l of t){const e=Number(l.amount||0),t=(l.provider||l.store||"\u2014").toString().trim()||"\u2014";a+=e,r[t]=(r[t]||0)+e,s[t]=(s[t]||0)+1}U(e=>{const t=Math.max((e.grossIncome||0)-a,0);return{...e,expenses:a,expensesByProvider:{total:a,byProvider:r,counts:s},net:t}}),xe.current.payments||(xe.current.payments=!0,ge())},e=>{var t;null===(t=h)||void 0===t||t(`Error al cargar pagos: ${e.message}`),xe.current.payments||(xe.current.payments=!0,ge())});return r.push(O),()=>{r.forEach(e=>e())}},[e,t,a]),(0,r.useEffect)(()=>{const e=(0,O.fz)(B,H,q);U(t=>({...t,cash:e.cashCaja,cashCaja:e.cashCaja,cashPendiente:e.cashClientesPendiente,daviplata:e.daviplataTotal,nequi:e.nequiTotal}))},[B,H,q]),(0,r.useEffect)(()=>{if(!a)return;const e=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],{startDate:t,endDate:r}=z(f,j,w),s=new Date;s.setHours(0,0,0,0);const l=s.toISOString().split("T")[0];let o;if("year"!==f||I){const e={};if(re.forEach(a=>{const s=new Date(a.date).toISOString().split("T")[0];if(s>=t.toISOString().split("T")[0]&&s<=r.toISOString().split("T")[0]){var l,o,i,n;const t=a.categories||{};e[s]={"Domicilios Almuerzo":((null===(l=e[s])||void 0===l?void 0:l["Domicilios Almuerzo"])||0)+Number(t.domiciliosAlmuerzo||0),"Domicilios Desayuno":((null===(o=e[s])||void 0===o?void 0:o["Domicilios Desayuno"])||0)+Number(t.domiciliosDesayuno||0),"Mesas/Llevar Almuerzo":((null===(i=e[s])||void 0===i?void 0:i["Mesas/Llevar Almuerzo"])||0)+Number(t.mesasAlmuerzo||0),"Mesas/Llevar Desayuno":((null===(n=e[s])||void 0===n?void 0:n["Mesas/Llevar Desayuno"])||0)+Number(t.mesasDesayuno||0)}}}),s>=t&&s<=r){var i,n,d,c;let a=0,s=0,o=0,m=0;B.forEach(e=>{var s;const l=null!==(s=e.createdAt)&&void 0!==s&&s.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:null;l&&l>=t.toISOString().split("T")[0]&&l<=r.toISOString().split("T")[0]&&(a+=Number(e.total||0))}),H.forEach(e=>{var a;const s=null!==(a=e.createdAt)&&void 0!==a&&a.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:null;s&&s>=t.toISOString().split("T")[0]&&s<=r.toISOString().split("T")[0]&&(o+=Number(e.total||0))}),q.forEach(e=>{const a=M(e);if(a&&a>=t.toISOString().split("T")[0]&&a<=r.toISOString().split("T")[0]){var l,o,i,n,d,c;const t=Number(e.total||0),a=((null===(l=e.breakfasts)||void 0===l||null===(o=l[0])||void 0===o?void 0:o.orderType)||e.orderType||"").toLowerCase();null!==(i=e.address)&&void 0!==i&&i.address||null!==(n=e.breakfasts)&&void 0!==n&&null!==(d=n[0])&&void 0!==d&&null!==(c=d.address)&&void 0!==c&&c.address;"table"===a||"takeaway"===a?m+=t:s+=t}});const u=l;e[u]={"Domicilios Almuerzo":((null===(i=e[u])||void 0===i?void 0:i["Domicilios Almuerzo"])||0)+a,"Domicilios Desayuno":((null===(n=e[u])||void 0===n?void 0:n["Domicilios Desayuno"])||0)+s,"Mesas/Llevar Almuerzo":((null===(d=e[u])||void 0===d?void 0:d["Mesas/Llevar Almuerzo"])||0)+o,"Mesas/Llevar Desayuno":((null===(c=e[u])||void 0===c?void 0:c["Mesas/Llevar Desayuno"])||0)+m}}o=Object.keys(e).sort((e,t)=>new Date(e)-new Date(t)).map(t=>({name:t,"Domicilios Almuerzo":e[t]["Domicilios Almuerzo"]||0,"Domicilios Desayuno":e[t]["Domicilios Desayuno"]||0,"Mesas/Llevar Almuerzo":e[t]["Mesas/Llevar Almuerzo"]||0,"Mesas/Llevar Desayuno":e[t]["Mesas/Llevar Desayuno"]||0}))}else{const t={},a=s.getFullYear();for(let e=0;e<12;e++){const r=`${a}-${String(e+1).padStart(2,"0")}`;t[r]={"Domicilios Almuerzo":0,"Domicilios Desayuno":0,"Mesas/Llevar Almuerzo":0,"Mesas/Llevar Desayuno":0}}re.forEach(e=>{const r=new Date(e.date);if(r.getFullYear()===a){const a=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`,s=e.categories||{};t[a]["Domicilios Almuerzo"]+=Number(s.domiciliosAlmuerzo||0),t[a]["Domicilios Desayuno"]+=Number(s.domiciliosDesayuno||0),t[a]["Mesas/Llevar Almuerzo"]+=Number(s.mesasAlmuerzo||0),t[a]["Mesas/Llevar Desayuno"]+=Number(s.mesasDesayuno||0)}});const r=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`;let l={da:0,dd:0,ma:0,md:0};B.forEach(e=>{var t;const r=null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()):null;r&&r.getFullYear()===a&&r.getMonth()===s.getMonth()&&(l.da+=Number(e.total||0))}),H.forEach(e=>{var t;const r=null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()):null;r&&r.getFullYear()===a&&r.getMonth()===s.getMonth()&&(l.ma+=Number(e.total||0))}),q.forEach(e=>{const t=M(e);if(t){const m=new Date(t);if(m.getFullYear()===a&&m.getMonth()===s.getMonth()){var r,o,i,n,d,c;const t=Number(e.total||0),a=((null===(r=e.breakfasts)||void 0===r||null===(o=r[0])||void 0===o?void 0:o.orderType)||e.orderType||"").toLowerCase();null!==(i=e.address)&&void 0!==i&&i.address||null!==(n=e.breakfasts)&&void 0!==n&&null!==(d=n[0])&&void 0!==d&&null!==(c=d.address)&&void 0!==c&&c.address;"table"===a||"takeaway"===a?l.md+=t:l.dd+=t}}}),t[r]["Domicilios Almuerzo"]+=l.da,t[r]["Mesas/Llevar Almuerzo"]+=l.ma,t[r]["Domicilios Desayuno"]+=l.dd,t[r]["Mesas/Llevar Desayuno"]+=l.md,o=Object.keys(t).map(a=>({name:e[parseInt(a.split("-")[1])-1],monthKey:a,"Domicilios Almuerzo":t[a]["Domicilios Almuerzo"],"Domicilios Desayuno":t[a]["Domicilios Desayuno"],"Mesas/Llevar Almuerzo":t[a]["Mesas/Llevar Almuerzo"],"Mesas/Llevar Desayuno":t[a]["Mesas/Llevar Desayuno"]}))}ne(o)},[B,H,q,re,f,j,w,a,I]),(0,r.useEffect)(()=>{if(!a)return;const e=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],{startDate:t,endDate:r}=z(E,L,P),s=new Date;s.setHours(0,0,0,0);const l=s.toISOString().split("T")[0];let o;if("year"!==E||I){const e={};if(le.forEach(a=>{const s=new Date(a.date).toISOString().split("T")[0];if(s>=t.toISOString().split("T")[0]&&s<=r.toISOString().split("T")[0])if("year"===E&&I){`${new Date(a.date).getFullYear()}-${String(new Date(a.date).getMonth()+1).padStart(2,"0")}`===I&&(e[s]={Domicilios:a.domicilios||0,Mesas:a.mesas||0})}else e[s]={Domicilios:a.domicilios||0,Mesas:a.mesas||0}}),s>=t&&s<=r){let t=0,a=0;if(B.forEach(e=>{var a;(null!==(a=e.createdAt)&&void 0!==a&&a.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:null)===l&&t++}),H.forEach(e=>{var t;(null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:null)===l&&a++}),"year"===E&&I){var i,n;if(`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`===I)e[l]={Domicilios:((null===(i=e[l])||void 0===i?void 0:i.Domicilios)||0)+t,Mesas:((null===(n=e[l])||void 0===n?void 0:n.Mesas)||0)+a}}else{var d,c;e[l]={Domicilios:((null===(d=e[l])||void 0===d?void 0:d.Domicilios)||0)+t,Mesas:((null===(c=e[l])||void 0===c?void 0:c.Mesas)||0)+a}}}o=Object.keys(e).sort((e,t)=>new Date(e)-new Date(t)).map(t=>({name:t,Domicilios:e[t].Domicilios,Mesas:e[t].Mesas}))}else{const t={},a=s.getFullYear();for(let e=0;e<12;e++){const r=`${a}-${String(e+1).padStart(2,"0")}`;t[r]={domicilios:0,mesas:0}}le.forEach(e=>{const r=new Date(e.date);if(r.getFullYear()===a){const a=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`;t[a].domicilios+=e.domicilios||0,t[a].mesas+=e.mesas||0}});const r=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`;let l=0,i=0;B.forEach(e=>{var t;const r=null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()):null;r&&r.getFullYear()===a&&r.getMonth()===s.getMonth()&&l++}),H.forEach(e=>{var t;const r=null!==(t=e.createdAt)&&void 0!==t&&t.toDate?new Date(e.createdAt.toDate()):null;r&&r.getFullYear()===a&&r.getMonth()===s.getMonth()&&i++}),t[r].domicilios+=l,t[r].mesas+=i,o=Object.keys(t).map(a=>({name:e[parseInt(a.split("-")[1])-1],monthKey:a,Domicilios:t[a].domicilios,Mesas:t[a].mesas}))}ce(o)},[B,H,le,E,L,P,a,I]);const he=(0,r.useCallback)(async()=>{G(!0);try{const t=(new Date).toISOString().split("T")[0];let a=0,r=0,s=0,l=0;B.forEach(e=>{var r;(null!==(r=e.createdAt)&&void 0!==r&&r.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:null)===t&&(a+=Number(e.total||0))}),H.forEach(e=>{var a;(null!==(a=e.createdAt)&&void 0!==a&&a.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:null)===t&&(s+=Number(e.total||0))}),q.forEach(e=>{if(M(e)===t){var a,s,o,i,n,d;const t=Number(e.total||0),c=((null===(a=e.breakfasts)||void 0===a||null===(s=a[0])||void 0===s?void 0:s.orderType)||e.orderType||"").toLowerCase();null!==(o=e.address)&&void 0!==o&&o.address||null!==(i=e.breakfasts)&&void 0!==i&&null!==(n=i[0])&&void 0!==n&&null!==(d=n.address)&&void 0!==d&&d.address;"table"===c||"takeaway"===c?l+=t:r+=t}});const i=a+r+s+l,n=(0,o.P)((0,o.rJ)(e,A),(0,o._M)("date","==",t)),d=await(0,o.GG)(n),c={date:t,categories:{domiciliosAlmuerzo:a,domiciliosDesayuno:r,mesasAlmuerzo:s,mesasDesayuno:l},totalIncome:i,updatedAt:(0,o.O5)()};d.empty?(await(0,o.gS)((0,o.rJ)(e,A),{...c,createdAt:(0,o.O5)()}),y(`Resumen de ingresos para ${t} guardado correctamente.`)):(await(0,o.mZ)((0,o.H9)(e,A,d.docs[0].id),c),y(`Resumen de ingresos para ${t} actualizado correctamente.`))}catch(t){h(`Error al guardar/actualizar resumen de ingresos: ${t.message}`),console.error("Error al guardar ingresos diarios:",t)}finally{G(!1)}},[e,B,H,q,y,h]);(0,r.useEffect)(()=>{if(!a)return;const t=()=>{const a=new Date,r=new Date(a);r.setDate(a.getDate()+1),r.setHours(0,0,5,0);const s=r.getTime()-a.getTime();return setTimeout(async()=>{await(async()=>{try{const t=new Date,a=t.toISOString().split("T")[0],r=new Date(t);r.setDate(r.getDate()-1),r.setHours(0,0,0,0);const s=r.toISOString().split("T")[0],l=(e,t)=>{const a=null!==e&&void 0!==e&&e.toDate?e.toDate():e?new Date(e):null;return!!a&&a.toISOString().split("T")[0]===t};let i=0,n=0,d=0,c=0;B.forEach(e=>{l(e.createdAt,s)&&(i+=Number(e.total||0))}),H.forEach(e=>{l(e.createdAt,s)&&(d+=Number(e.total||0))}),q.forEach(e=>{var t,a,r,l,o,i;if(M(e)!==s)return;const d=Number(e.total||0),m=((null===(t=e.breakfasts)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.orderType)||e.orderType||"").toLowerCase();null!==(r=e.address)&&void 0!==r&&r.address||null!==(l=e.breakfasts)&&void 0!==l&&null!==(o=l[0])&&void 0!==o&&null!==(i=o.address)&&void 0!==i&&i.address,"table"===m||"takeaway"===m?c+=d:n+=d});const m={date:s,categories:{domiciliosAlmuerzo:i,domiciliosDesayuno:n,mesasAlmuerzo:d,mesasDesayuno:c},totalIncome:i+n+d+c,updatedAt:(0,o.O5)()},u=(0,o.P)((0,o.rJ)(e,A),(0,o._M)("date","==",s)),x=await(0,o.GG)(u);x.empty?await(0,o.gS)((0,o.rJ)(e,A),{...m,createdAt:(0,o.O5)()}):await(0,o.mZ)((0,o.H9)(e,A,x.docs[0].id),m);const g=(0,o.P)((0,o.rJ)(e,A),(0,o._M)("date","==",a));(await(0,o.GG)(g)).empty&&await(0,o.gS)((0,o.rJ)(e,A),{date:a,categories:{domiciliosAlmuerzo:0,domiciliosDesayuno:0,mesasAlmuerzo:0,mesasDesayuno:0},totalIncome:0,createdAt:(0,o.O5)(),updatedAt:(0,o.O5)()})}catch(a){var t;null===(t=h)||void 0===t||t(`Cierre autom\xe1tico: ${a.message}`),console.error("Cierre autom\xe1tico diario",a)}})(),t()},s)},r=t();return()=>clearTimeout(r)},[a,B,H,q,h]);const ye=(0,r.useCallback)(async()=>{G(!0);try{const t=(new Date).toISOString().split("T")[0],a=(0,o.P)((0,o.rJ)(e,A),(0,o._M)("date","==",t)),r=await(0,o.GG)(a);if(r.empty)y(`No se encontr\xf3 un resumen de ingresos para ${t} para eliminar.`);else{const a=r.docs[0];await(0,o.kd)((0,o.H9)(e,A,a.id)),y(`Resumen de ingresos para ${t} eliminado correctamente.`)}}catch(t){h(`Error al eliminar resumen de ingresos: ${t.message}`),console.error("Error al eliminar ingresos diarios:",t)}finally{G(!1)}},[e,y,h]),ve=(0,r.useCallback)(async()=>{G(!0);try{const t=(new Date).toISOString().split("T")[0];let a=0,r=0;B.forEach(e=>{var r;(null!==(r=e.createdAt)&&void 0!==r&&r.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:null)===t&&a++}),H.forEach(e=>{var a;(null!==(a=e.createdAt)&&void 0!==a&&a.toDate?new Date(e.createdAt.toDate()).toISOString().split("T")[0]:null)===t&&r++});const s=(0,o.P)((0,o.rJ)(e,T),(0,o._M)("date","==",t)),l=await(0,o.GG)(s);if(l.empty)await(0,o.gS)((0,o.rJ)(e,T),{date:t,domicilios:a,mesas:r,createdAt:(0,o.O5)(),updatedAt:(0,o.O5)()}),y(`Conteo de pedidos diarios para ${t} guardado correctamente.`);else{const s=l.docs[0];await(0,o.mZ)((0,o.H9)(e,T,s.id),{domicilios:a,mesas:r,updatedAt:(0,o.O5)()}),y(`Conteo de pedidos diarios para ${t} actualizado correctamente.`)}}catch(t){h(`Error al guardar/actualizar conteo de pedidos diarios: ${t.message}`),console.error("Error al guardar conteo de pedidos diarios:",t)}finally{G(!1)}},[e,B,H,y,h]),pe=(0,r.useCallback)(async()=>{G(!0);try{const t=(new Date).toISOString().split("T")[0],a=(0,o.P)((0,o.rJ)(e,T),(0,o._M)("date","==",t)),r=await(0,o.GG)(a);if(r.empty)y(`No se encontr\xf3 un conteo de pedidos diarios para ${t} para eliminar.`);else{const a=r.docs[0];await(0,o.kd)((0,o.H9)(e,T,a.id)),y(`Conteo de pedidos diarios para ${t} eliminado correctamente.`)}}catch(t){h(`Error al eliminar conteo de pedidos diarios: ${t.message}`),console.error("Error al eliminar conteo de pedidos diarios:",t)}finally{G(!1)}},[e,y,h]);return{loadingData:_,orders:B,tableOrders:H,breakfastOrders:q,users:Y,totals:Q,statusCounts:X,userActivity:te,ingresosCategoriasData:ie,gastosPorTiendaData:Object.entries((null===Q||void 0===Q||null===(x=Q.expensesByProvider)||void 0===x?void 0:x.byProvider)||{}).map(e=>{let[t,a]=e;return{name:t,value:a}}),pedidosDiariosChartData:de,statusPieChartData:me,saleTypeBreakdown:W,handleSaveDailyIngresos:he,handleDeleteDailyIngresos:ye,handleSaveDailyOrders:ve,handleDeleteDailyOrders:pe}};var L=a(5323),P=a(108),I=a(1474),_=a(7734),G=a(2185),B=a(760),K=a(379),H=a(95),J=a(7136),q=a(6992),V=a(6102),Y=a(7869),R=a(2647),Q=a(5686),U=a(8693),W=a(5469),Z=a(1990),X=a(4919),ee=a(2319),te=a(579);const ae=e=>{let{type:t,theme:a,isMobile:r}=e;if("bar"===t){const e=r?5:7;return(0,te.jsx)("div",{className:"flex h-full items-end justify-around p-4 animate-pulse",children:Array.from({length:e}).map((t,r)=>(0,te.jsx)("div",{className:(0,i.x)("rounded-t-md","dark"===a?"bg-gray-700":"bg-gray-200","mx-1"),style:{width:100/e-5+"%",height:70*Math.random()+30+"%"}},r))})}return"pie"===t?(0,te.jsx)("div",{className:"flex justify-center items-center h-full animate-pulse",children:(0,te.jsx)("div",{className:(0,i.x)(r?"w-32 h-32":"w-40 h-40","rounded-full","dark"===a?"bg-gray-700":"bg-gray-200")})}):null},re=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}),se=e=>{let{active:t,payload:a,label:r,theme:s,chartTextColor:l,copFormatter:o,isOrderChart:i=!1}=e;if(t&&a&&a.length){const e=a.reduce((e,t)=>e+t.value,0),t=i?e=>e.toLocaleString():e=>"function"===typeof o?o(e):o.format(e);return(0,te.jsxs)(L.P.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:5},className:"custom-tooltip p-3 rounded-xl shadow-lg border",style:{backgroundColor:"dark"===s?"rgba(31, 41, 55, 0.95)":"rgba(255, 255, 255, 0.95)",borderColor:"dark"===s?"rgba(75, 85, 99, 0.7)":"rgba(229, 231, 235, 0.7)",backdropFilter:"blur(8px)",color:l,fontSize:"14px"},children:[(0,te.jsx)("p",{className:"font-bold mb-1",children:r}),a.map((e,a)=>(0,te.jsxs)("p",{style:{color:e.color||l},children:[e.name,": ",(0,te.jsx)("span",{className:"font-semibold",children:t(e.value)})]},`item-${a}`)),(0,te.jsxs)("p",{className:"font-bold mt-2 border-t pt-2",style:{borderColor:"dark"===s?"#4b5563":"#e5e7eb"},children:["Total: ",t(e)]})]})}return null},le=e=>{let{active:t,payload:a,theme:r,chartTextColor:s}=e;if(t&&a&&a.length){const e=a[0].payload;return(0,te.jsxs)(L.P.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:5},className:"custom-tooltip p-3 rounded-xl shadow-lg border",style:{backgroundColor:"dark"===r?"rgba(31, 41, 55, 0.95)":"rgba(255, 255, 255, 0.95)",borderColor:"dark"===r?"rgba(75, 85, 99, 0.7)":"rgba(229, 231, 235, 0.7)",backdropFilter:"blur(8px)",color:s,fontSize:"14px"},children:[(0,te.jsx)("p",{className:"font-bold mb-1",style:{color:e.color||s},children:e.name}),(0,te.jsxs)("p",{children:["Valor: ",(0,te.jsx)("span",{className:"font-semibold",children:e.value})]}),(0,te.jsxs)("p",{children:["Porcentaje: ",(0,te.jsx)("span",{className:"font-semibold",children:`${(100*e.percent).toFixed(1)}%`})]})]})}return null},oe=r.memo(e=>{let{dailySalesChartData:t,dailyOrdersChartData:a,statusPieChartData:l,theme:d="dark",chartTextColor:m="#ffffff",salesFilterRange:u,setSalesFilterRange:x=()=>{},salesCustomStartDate:g,setSalesCustomStartDate:h=()=>{},salesCustomEndDate:y,setSalesCustomEndDate:b=()=>{},ordersFilterRange:f,setOrdersFilterRange:j=()=>{},ordersCustomStartDate:w,setOrdersCustomStartDate:D=()=>{},ordersCustomEndDate:N,setOrdersCustomEndDate:k=()=>{},handleSaveDailyIngresos:S=()=>{},handleDeleteDailyIngresos:A=()=>{},handleSaveDailyOrders:T=()=>{},handleDeleteDailyOrders:O=()=>{},handleSaveDailyExpenses:z=()=>{},handleDeleteDailyExpenses:M=()=>{},loading:F,selectedMonth:$,setSelectedMonth:E=()=>{}}=e;const[oe,ie]=(0,r.useState)(!1),[ne,de]=(0,r.useState)([]),[ce,me]=(0,r.useState)("30_days"),[ue,xe]=(0,r.useState)(null),[ge,he]=(0,r.useState)(null),[ye,ve]=(0,r.useState)(null);(0,r.useEffect)(()=>{const e=(0,o.P)((0,o.rJ)(s.db,"payments"),(0,o.My)("timestamp","desc")),t=(0,o.aQ)(e,e=>{de(e.docs.map(e=>({id:e.id,...e.data()})))},e=>console.error(`Error al cargar pagos: ${e.message}`));return()=>t()},[]),(0,r.useEffect)(()=>{const e=()=>{ie((0,ee.Fr)())};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const pe=(0,r.useMemo)(()=>{const e=ne.reduce((e,t)=>{if(!t.timestamp)return e;const a=new Date(t.timestamp.toDate()),r=new Date;let s;if(s="7_days"===ce?new Date(r.setDate(r.getDate()-7)):"30_days"===ce?new Date(r.setDate(r.getDate()-30)):"year"===ce?new Date(r.getFullYear(),0,1):"custom"===ce&&ue&&ge?new Date(ue):new Date(0),"custom"===ce&&ge){const t=new Date(ge);if(a<s||a>t)return e}else if(a<s)return e;const l=a.toISOString().split("T")[0];return e[l]||(e[l]={name:l,Total:0}),e[l].Total+=t.amount,e},{});return Object.values(e).sort((e,t)=>new Date(e.name)-new Date(t.name))},[ne,ce,ue,ge]),be=(0,r.useMemo)(()=>ne.reduce((e,t)=>e+t.amount,0),[ne]),fe=(0,r.useMemo)(()=>l.reduce((e,t)=>e+t.value,0),[l]),je=(0,r.useMemo)(()=>{const e=ne.reduce((e,t)=>{const a=t.store||"Desconocido";return e[a]||(e[a]={totalAmount:0,payments:[]}),e[a].totalAmount+=t.amount,e[a].payments.push(t),e},{});return Object.entries(e).map(e=>{let[t,a]=e;return{store:t,...a}}).sort((e,t)=>t.totalAmount-e.totalAmount)},[ne]),we=(0,r.useMemo)(()=>ye?ne.filter(e=>e.store===ye).sort((e,t)=>t.timestamp.toDate()-e.timestamp.toDate()):[],[ne,ye]),De={hidden:{opacity:0,scale:.98,y:10},visible:{opacity:1,scale:1,y:0,transition:{duration:.6,ease:"easeOut"}},exit:{opacity:0,scale:.98,y:10,transition:{duration:.4,ease:"easeIn"}}},Ne=oe?"min-w-[700px]":"min-w-0",ke=oe?"h-[250px]":"h-[300px]";return(0,te.jsxs)("div",{className:"flex flex-col gap-12 mb-8 pb-12 w-full",children:[(0,te.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n  .custom-scrollbar::-webkit-scrollbar {\n    width: 8px;\n    height: 8px;\n  }\n  .custom-scrollbar::-webkit-scrollbar-track {\n    background: var(--scrollbar-track-color, #2d3748);\n    border-radius: 10px;\n  }\n  .custom-scrollbar::-webkit-scrollbar-thumb {\n    background: var(--scrollbar-thumb-color, #4a5568);\n    border-radius: 10px;\n  }\n  .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n    background: var(--scrollbar-thumb-hover-color, #64748b);\n  }\n  .custom-scrollbar {\n    scrollbar-width: thin;\n    scrollbar-color: var(--scrollbar-thumb-color, #4a5568) var(--scrollbar-track-color, #2d3748);\n  }\n"}}),(0,te.jsxs)("div",{className:(0,i.x)("dark"===d?"bg-gray-800":"bg-white",oe?"p-4":"p-6","rounded-2xl shadow-xl border","dark"===d?"border-gray-700":"border-gray-200","relative min-h-[450px] flex flex-col"),children:[(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("h3",{className:"text-xl font-semibold mb-4 text-gray-200 dark:text-gray-100 flex items-center",children:[(0,te.jsx)(p.A,{className:(0,i.x)(oe?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-green-400")}),"Ingresos Diarios"]}),(0,te.jsxs)(c.AM,{className:"relative",children:[(0,te.jsx)(c.ut,{className:"p-2 rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",children:(0,te.jsx)(Q.A,{className:(0,i.x)(oe?"w-4 h-4":"w-5 h-5","text-gray-400")})}),(0,te.jsx)(n.e,{as:r.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:(0,te.jsx)(c.QT,{className:(0,i.x)("absolute z-50 mt-2","right-0 left-auto",oe?"w-[150px] text-sm":"w-56","rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none","dark"===d?"bg-gray-700":"bg-white","origin-top-right","max-h-[80vh] overflow-y-auto custom-scrollbar"),children:(0,te.jsxs)("div",{className:"py-1",children:[(0,te.jsxs)("button",{onClick:S,disabled:F,className:(0,i.x)("block w-full text-left px-4 py-2 flex items-center transition-colors",oe?"text-xs":"text-sm",F?"text-gray-400 cursor-not-allowed":"dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:[(0,te.jsx)(U.A,{className:(0,i.x)(oe?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-blue-400")}),F?"Guardando...":"Guardar Ventas del D\xeda"]}),(0,te.jsxs)("button",{onClick:()=>A(),disabled:F,className:(0,i.x)("block w-full text-left px-4 py-2 flex items-center mt-1 transition-colors",oe?"text-xs":"text-sm",F?"text-gray-400 cursor-not-allowed":"dark"===d?"text-red-300 hover:bg-gray-600":"text-red-600 hover:bg-gray-100"),children:[(0,te.jsx)(v.A,{className:(0,i.x)(oe?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-red-400")}),"Eliminar Ventas del D\xeda"]}),(0,te.jsx)("div",{className:(0,i.x)("my-1","dark"===d?"border-t border-gray-600":"border-t border-gray-200")}),(0,te.jsx)("button",{onClick:()=>{x("7_days"),h(null),b(null),E(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",oe?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver \xfaltimos 7 d\xedas"}),(0,te.jsx)("button",{onClick:()=>{x("30_days"),h(null),b(null),E(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",oe?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver todo el mes"}),(0,te.jsx)("button",{onClick:()=>{x("year"),h(null),b(null),E(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",oe?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver todo el a\xf1o"}),(0,te.jsx)("div",{className:(0,i.x)("my-1","dark"===d?"border-t border-gray-600":"border-t border-gray-200")}),(0,te.jsx)("div",{className:(0,i.x)("px-4 py-2 font-medium text-gray-400",oe?"text-xs":"text-sm"),children:"Filtros personalizados"}),(0,te.jsxs)("div",{className:"px-4 py-2",children:[(0,te.jsx)("label",{className:(0,i.x)("block font-medium text-gray-400 mb-1",oe?"text-xs":"text-sm"),children:"Desde:"}),(0,te.jsx)("input",{type:"date",value:g?g.toISOString().split("T")[0]:"",onChange:e=>{h(new Date(e.target.value)),x("custom"),E(null)},className:(0,i.x)("block w-full rounded-md shadow-sm p-2",oe?"text-xs sm:text-sm":"text-sm","dark"===d?"bg-gray-800 text-gray-200 border-gray-600":"bg-white text-gray-900 border-gray-300")})]}),(0,te.jsxs)("div",{className:"px-4 py-2",children:[(0,te.jsx)("label",{className:(0,i.x)("block font-medium text-gray-400 mb-1",oe?"text-xs":"text-sm"),children:"Hasta:"}),(0,te.jsx)("input",{type:"date",value:y?y.toISOString().split("T")[0]:"",onChange:e=>{b(new Date(e.target.value)),x("custom")},className:(0,i.x)("block w-full rounded-md shadow-sm p-2",oe?"text-xs sm:text-sm":"text-sm","dark"===d?"bg-gray-800 text-gray-200 border-gray-600":"bg-white text-gray-900 border-gray-300")})]})]})})})]})]}),(0,te.jsxs)(L.P.div,{className:(0,i.x)(oe?"overflow-x-auto overflow-y-hidden custom-scrollbar":"overflow-x-hidden overflow-y-hidden","relative flex flex-col flex-grow"),variants:De,initial:"hidden",animate:"visible",exit:"exit",children:["year"===u&&$&&(0,te.jsxs)(L.P.button,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},onClick:()=>E(null),className:"mb-4 text-blue-500 hover:underline text-sm self-start transition-all duration-200",children:[(0,te.jsx)(W.A,{className:"w-4 h-4 inline-block mr-2"}),"Volver al resumen anual"]}),F?(0,te.jsx)(ae,{type:"bar",theme:d,isMobile:oe}):(0,te.jsx)("div",{className:(0,i.x)("w-full",ke,Ne),children:(0,te.jsx)(P.u,{width:"100%",height:"100%",children:(0,te.jsxs)(I.E,{data:t,margin:{top:20,right:30,left:20,bottom:20},barCategoryGap:oe?"0%":"40%",barGap:1,children:[(0,te.jsx)(_.d,{strokeDasharray:oe?"2 2":"3 3",stroke:"dark"===d?"#4b5563":"#e5e7eb",vertical:!1}),(0,te.jsx)(G.W,{dataKey:"name",stroke:m,tick:{fill:m,fontSize:oe?9:11},angle:-45,textAnchor:"end",interval:0,height:60}),(0,te.jsx)(B.h,{stroke:m,tick:{fill:m,fontSize:oe?9:11},tickFormatter:e=>re.format(e),width:oe?50:80}),(0,te.jsx)(K.m,{cursor:{fill:"dark"===d?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)",rx:4},content:(0,te.jsx)(se,{theme:d,chartTextColor:m,copFormatter:re})}),(0,te.jsx)(H.s,{wrapperStyle:{color:m,fontSize:oe?10:13,paddingTop:"15px",paddingBottom:"20px"},align:"center",verticalAlign:"top",iconType:"circle"}),(0,te.jsx)(J.y,{dataKey:"Domicilios Almuerzo",fill:"#34D399",stroke:"#34D399",radius:[8,8,0,0],maxBarSize:oe?12:25,animationDuration:800,onClick:e=>{"year"===u&&e.monthKey&&E(e.monthKey)}}),(0,te.jsx)(J.y,{dataKey:"Domicilios Desayuno",fill:"#60A5FA",stroke:"#60A5FA",radius:[8,8,0,0],maxBarSize:oe?12:25,animationDuration:800,onClick:e=>{"year"===u&&e.monthKey&&E(e.monthKey)}}),(0,te.jsx)(J.y,{dataKey:"Mesas/Llevar Almuerzo",fill:"#FBBF24",stroke:"#FBBF24",radius:[8,8,0,0],maxBarSize:oe?12:25,animationDuration:800,onClick:e=>{"year"===u&&e.monthKey&&E(e.monthKey)}}),(0,te.jsx)(J.y,{dataKey:"Mesas/Llevar Desayuno",fill:"#F472B6",stroke:"#F472B6",radius:[8,8,0,0],maxBarSize:oe?12:25,animationDuration:800,onClick:e=>{"year"===u&&e.monthKey&&E(e.monthKey)}})]})})})]})]}),(0,te.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[(0,te.jsxs)("div",{className:(0,i.x)("dark"===d?"bg-gray-800":"bg-white",oe?"p-4":"p-6","rounded-2xl shadow-xl border","dark"===d?"border-gray-700":"border-gray-200","relative min-h-[350px] flex flex-col"),children:[(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("h3",{className:"text-xl font-semibold mb-4 text-gray-200 dark:text-gray-100 flex items-center",children:[(0,te.jsx)(p.A,{className:(0,i.x)(oe?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-red-400")}),"Gastos Diarios"]}),(0,te.jsxs)(c.AM,{className:"relative",children:[(0,te.jsx)(c.ut,{className:"p-2 rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",children:(0,te.jsx)(Q.A,{className:(0,i.x)(oe?"w-4 h-4":"w-5 h-5","text-gray-400")})}),(0,te.jsx)(n.e,{as:r.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:(0,te.jsx)(c.QT,{className:(0,i.x)("absolute z-50 mt-2","right-0 left-auto",oe?"w-[150px] text-sm":"w-56","rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none","dark"===d?"bg-gray-700":"bg-white","origin-top-right","max-h-[80vh] overflow-y-auto custom-scrollbar"),children:(0,te.jsxs)("div",{className:"py-1",children:[(0,te.jsxs)("button",{onClick:z,disabled:F,className:(0,i.x)("block w-full text-left px-4 py-2 flex items-center transition-colors",oe?"text-xs":"text-sm",F?"text-gray-400 cursor-not-allowed":"dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:[(0,te.jsx)(U.A,{className:(0,i.x)(oe?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-blue-400")}),F?"Guardando...":"Guardar Gastos del D\xeda"]}),(0,te.jsxs)("button",{onClick:()=>M(),disabled:F,className:(0,i.x)("block w-full text-left px-4 py-2 flex items-center mt-1 transition-colors",oe?"text-xs":"text-sm",F?"text-gray-400 cursor-not-allowed":"dark"===d?"text-red-300 hover:bg-gray-600":"text-red-600 hover:bg-gray-100"),children:[(0,te.jsx)(v.A,{className:(0,i.x)(oe?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-red-400")}),"Eliminar Gastos del D\xeda"]}),(0,te.jsx)("div",{className:(0,i.x)("my-1","dark"===d?"border-t border-gray-600":"border-t border-gray-200")}),(0,te.jsx)("button",{onClick:()=>{me("7_days"),xe(null),he(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",oe?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver \xfaltimos 7 d\xedas"}),(0,te.jsx)("button",{onClick:()=>{me("30_days"),xe(null),he(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",oe?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver todo el mes"}),(0,te.jsx)("button",{onClick:()=>{me("year"),xe(null),he(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",oe?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver todo el a\xf1o"}),(0,te.jsx)("div",{className:(0,i.x)("my-1","dark"===d?"border-t border-gray-600":"border-t border-gray-200")}),(0,te.jsx)("div",{className:(0,i.x)("px-4 py-2 font-medium text-gray-400",oe?"text-xs":"text-sm"),children:"Filtros personalizados"}),(0,te.jsxs)("div",{className:"px-4 py-2",children:[(0,te.jsx)("label",{className:(0,i.x)("block font-medium text-gray-400 mb-1",oe?"text-xs":"text-sm"),children:"Desde:"}),(0,te.jsx)("input",{type:"date",value:ue?ue.toISOString().split("T")[0]:"",onChange:e=>{xe(new Date(e.target.value)),me("custom")},className:(0,i.x)("block w-full rounded-md shadow-sm p-2",oe?"text-xs sm:text-sm":"text-sm","dark"===d?"bg-gray-800 text-gray-200 border-gray-600":"bg-white text-gray-900 border-gray-300")})]}),(0,te.jsxs)("div",{className:"px-4 py-2",children:[(0,te.jsx)("label",{className:(0,i.x)("block font-medium text-gray-400 mb-1",oe?"text-xs":"text-sm"),children:"Hasta:"}),(0,te.jsx)("input",{type:"date",value:ge?ge.toISOString().split("T")[0]:"",onChange:e=>{he(new Date(e.target.value)),me("custom")},className:(0,i.x)("block w-full rounded-md shadow-sm p-2",oe?"text-xs sm:text-sm":"text-sm","dark"===d?"bg-gray-800 text-gray-200 border-gray-600":"bg-white text-gray-900 border-gray-300")})]})]})})})]})]}),(0,te.jsx)(L.P.div,{className:(0,i.x)(oe?"overflow-x-auto overflow-y-hidden custom-scrollbar":"overflow-x-hidden overflow-y-hidden","relative flex flex-col flex-grow"),variants:De,initial:"hidden",animate:"visible",exit:"exit",children:F?(0,te.jsx)(ae,{type:"bar",theme:d,isMobile:oe}):(0,te.jsx)("div",{className:(0,i.x)("w-full",ke,Ne),children:(0,te.jsx)(P.u,{width:"100%",height:"100%",children:(0,te.jsxs)(I.E,{data:pe,margin:{top:20,right:30,left:20,bottom:20},barCategoryGap:oe?"0%":"40%",barGap:1,children:[(0,te.jsx)(_.d,{strokeDasharray:oe?"2 2":"3 3",stroke:"dark"===d?"#4b5563":"#e5e7eb",vertical:!1}),(0,te.jsx)(G.W,{dataKey:"name",stroke:m,tick:{fill:m,fontSize:oe?9:11},angle:-45,textAnchor:"end",interval:0,height:60}),(0,te.jsx)(B.h,{stroke:m,tick:{fill:m,fontSize:oe?9:11},tickFormatter:e=>re.format(e),width:oe?50:80}),(0,te.jsx)(K.m,{cursor:{fill:"dark"===d?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)",rx:4},content:(0,te.jsx)(se,{theme:d,chartTextColor:m,copFormatter:re})}),(0,te.jsx)(H.s,{wrapperStyle:{color:m,paddingTop:"15px",fontSize:oe?10:13},align:"center",verticalAlign:"top",iconType:"circle"}),(0,te.jsx)(J.y,{dataKey:"Total",fill:"#EF4444",stroke:"#EF4444",radius:[8,8,0,0],maxBarSize:oe?12:25,animationDuration:800})]})})})})]}),(0,te.jsxs)(L.P.div,{className:(0,i.x)(`bg-${"dark"===d?"gray-800":"white"} p-6 rounded-2xl shadow-xl transform transition-all duration-300 hover:scale-[1.02] hover:shadow-2xl border border-${"dark"===d?"gray-700":"gray-200"}`),variants:De,initial:"hidden",animate:"visible",exit:"exit",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-5",children:[(0,te.jsx)("h3",{className:"text-2xl font-bold text-gray-100",children:"Gastos"}),(0,te.jsx)(p.A,{className:"text-red-400 w-10 h-10 animate-pulse"})]}),(0,te.jsxs)("div",{className:"space-y-4 text-base text-gray-300",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center text-xl font-semibold",children:[(0,te.jsx)("span",{className:"text-gray-200",children:"Total de Gastos:"}),(0,te.jsx)("span",{className:"font-extrabold text-red-400",children:re.format(be)})]}),(0,te.jsx)("div",{className:"border-t border-dashed my-4",style:{borderColor:"dark"===d?"#4b5563":"#d1d5db"}}),ye?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)("button",{onClick:()=>ve(null),className:"flex items-center text-blue-400 hover:underline text-sm mb-4 transition-colors",children:[(0,te.jsx)(W.A,{className:"w-4 h-4 mr-2"})," Volver a Gastos por Remitente"]}),(0,te.jsx)("h4",{className:"text-lg font-semibold text-gray-200 mb-3",children:ye}),(0,te.jsx)("div",{className:(0,i.x)("text-sm max-h-52 overflow-y-auto custom-scrollbar pr-2",oe?"overflow-x-auto":"overflow-x-hidden"),children:(0,te.jsx)("div",{className:"min-w-full inline-block align-middle",children:0===we.length?(0,te.jsx)("p",{className:"text-gray-500 text-center py-6",children:"No hay movimientos para este remitente en el rango de fechas seleccionado."}):we.map((e,t)=>{var a;return(0,te.jsxs)("div",{className:"flex items-center py-3 border-b last:border-b-0 transition-colors duration-200 hover:bg-gray-700 dark:hover:bg-gray-800 rounded-md px-2 -mx-2",style:{borderColor:"dark"===d?"#374151":"#e5e7eb"},children:[(0,te.jsx)("span",{className:"text-gray-400 font-normal mr-3 min-w-[80px]",children:e.name||"N/A"}),(0,te.jsx)("span",{className:"text-gray-300 font-light text-nowrap mr-3 min-w-[150px]",children:new Date(null===(a=e.timestamp)||void 0===a?void 0:a.toDate()).toLocaleString("es-CO",{dateStyle:"short",timeStyle:"short"})}),(0,te.jsx)("span",{className:"text-red-300 font-semibold text-right flex-grow",children:re.format(e.amount)})]},t)})})})]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("p",{className:"text-gray-400 text-sm mb-2",children:"Gastos por Remitente:"}),(0,te.jsx)("div",{className:"text-sm max-h-52 overflow-y-auto custom-scrollbar pr-2",children:0===je.length?(0,te.jsx)("p",{className:"text-gray-500 text-center py-6",children:"A\xfan no hay gastos registrados. \xa1Empieza a a\xf1adir algunos! \ud83d\udcdd"}):je.map((e,t)=>(0,te.jsxs)("button",{onClick:()=>ve(e.store),className:"flex justify-between items-center w-full py-3 border-b last:border-b-0 transition-colors duration-200 hover:bg-gray-700 dark:hover:bg-gray-800 rounded-md px-2 -mx-2 cursor-pointer",style:{borderColor:"dark"===d?"#374151":"#e5e7eb"},children:[(0,te.jsx)("span",{className:"text-gray-300 flex-1 pr-3 truncate text-left font-medium",children:e.store}),(0,te.jsxs)("div",{className:"flex flex-col items-end",children:[(0,te.jsx)("span",{className:"text-red-300 font-semibold",children:re.format(e.totalAmount)}),(0,te.jsxs)("span",{className:"text-gray-500 text-xs mt-1",children:["(",e.payments.length," movimientos)"]})]})]},t))})]})]})]})]}),(0,te.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[(0,te.jsxs)("div",{className:(0,i.x)("dark"===d?"bg-gray-800":"bg-white",oe?"p-4":"p-6","rounded-2xl shadow-xl border","dark"===d?"border-gray-700":"border-gray-200","relative min-h-[350px] flex flex-col"),children:[(0,te.jsxs)("h3",{className:"text-xl font-semibold mb-4 text-gray-200 dark:text-gray-100 flex items-center justify-between",children:[(0,te.jsxs)("span",{className:"flex items-center",children:[(0,te.jsx)(Z.A,{className:(0,i.x)(oe?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-purple-400")}),"Pedidos Diarios"]}),(0,te.jsxs)(c.AM,{className:"relative",children:[(0,te.jsx)(c.ut,{className:"p-2 rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",children:(0,te.jsx)(Q.A,{className:(0,i.x)(oe?"w-4 h-4":"w-5 h-5","text-gray-400")})}),(0,te.jsx)(n.e,{as:r.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:(0,te.jsx)(c.QT,{className:(0,i.x)("absolute z-50 mt-2","right-0 left-auto",oe?"w-[150px] text-sm":"w-56","rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none","dark"===d?"bg-gray-700":"bg-white","origin-top-right","max-h-[80vh] overflow-y-auto custom-scrollbar"),children:(0,te.jsxs)("div",{className:"py-1",children:[(0,te.jsxs)("button",{onClick:T,disabled:F,className:(0,i.x)("block w-full text-left px-4 py-2 flex items-center transition-colors",oe?"text-xs":"text-sm",F?"text-gray-400 cursor-not-allowed":"dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:[(0,te.jsx)(U.A,{className:(0,i.x)(oe?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-blue-400")}),F?"Guardando...":"Guardar Pedidos del D\xeda"]}),(0,te.jsxs)("button",{onClick:()=>O(),disabled:F,className:(0,i.x)("block w-full text-left px-4 py-2 flex items-center mt-1 transition-colors",oe?"text-xs":"text-sm",F?"text-gray-400 cursor-not-allowed":"dark"===d?"text-red-300 hover:bg-gray-600":"text-red-600 hover:bg-gray-100"),children:[(0,te.jsx)(v.A,{className:(0,i.x)(oe?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-red-400")}),"Eliminar Pedidos del D\xeda"]}),(0,te.jsx)("div",{className:(0,i.x)("my-1","dark"===d?"border-t border-gray-600":"border-t border-gray-200")}),(0,te.jsx)("button",{onClick:()=>{j("7_days"),D(null),k(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",oe?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver \xfaltimos 7 d\xedas"}),(0,te.jsx)("button",{onClick:()=>{j("30_days"),D(null),k(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",oe?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver todo el mes"}),(0,te.jsx)("button",{onClick:()=>{j("year"),D(null),k(null)},className:(0,i.x)("block w-full text-left px-4 py-2 transition-colors",oe?"text-xs":"text-sm","dark"===d?"text-gray-200 hover:bg-gray-600":"text-gray-700 hover:bg-gray-100"),children:"Ver todo el a\xf1o"}),(0,te.jsx)("div",{className:(0,i.x)("my-1","dark"===d?"border-t border-gray-600":"border-t border-gray-200")}),(0,te.jsx)("div",{className:(0,i.x)("px-4 py-2 font-medium text-gray-400",oe?"text-xs":"text-sm"),children:"Filtros personalizados"}),(0,te.jsxs)("div",{className:"px-4 py-2",children:[(0,te.jsx)("label",{className:(0,i.x)("block font-medium text-gray-400 mb-1",oe?"text-xs":"text-sm"),children:"Desde:"}),(0,te.jsx)("input",{type:"date",value:w?w.toISOString().split("T")[0]:"",onChange:e=>{D(new Date(e.target.value)),j("custom")},className:(0,i.x)("block w-full rounded-md shadow-sm p-2",oe?"text-xs sm:text-sm":"text-sm","dark"===d?"bg-gray-800 text-gray-200 border-gray-600":"bg-white text-gray-900 border-gray-300")})]}),(0,te.jsxs)("div",{className:"px-4 py-2",children:[(0,te.jsx)("label",{className:(0,i.x)("block font-medium text-gray-400 mb-1",oe?"text-xs":"text-sm"),children:"Hasta:"}),(0,te.jsx)("input",{type:"date",value:N?N.toISOString().split("T")[0]:"",onChange:e=>{k(new Date(e.target.value)),j("custom")},className:(0,i.x)("block w-full rounded-md shadow-sm p-2",oe?"text-xs sm:text-sm":"text-sm","dark"===d?"bg-gray-800 text-gray-200 border-gray-600":"bg-white text-gray-900 border-gray-300")})]})]})})})]})]}),(0,te.jsxs)(L.P.div,{className:(0,i.x)(oe?"overflow-x-auto overflow-y-hidden custom-scrollbar":"overflow-x-hidden overflow-y-hidden","relative flex flex-col flex-grow"),variants:De,initial:"hidden",animate:"visible",exit:"exit",children:["year"===f&&$&&(0,te.jsxs)(L.P.button,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},onClick:()=>E(null),className:"mb-4 text-blue-500 hover:underline text-sm self-start transition-all duration-200",children:[(0,te.jsx)(W.A,{className:"w-4 h-4 inline-block mr-2"}),"Volver al resumen anual"]}),F?(0,te.jsx)(ae,{type:"bar",theme:d,isMobile:oe}):(0,te.jsx)("div",{className:(0,i.x)("w-full",ke,Ne),children:(0,te.jsx)(P.u,{width:"100%",height:"100%",children:(0,te.jsxs)(I.E,{data:a,margin:{top:20,right:30,left:20,bottom:20},barCategoryGap:oe?"0%":"40%",barGap:1,children:[(0,te.jsx)(_.d,{strokeDasharray:oe?"2 2":"3 3",stroke:"dark"===d?"#4b5563":"#e5e7eb",vertical:!1}),(0,te.jsx)(G.W,{dataKey:"name",stroke:m,tick:{fill:m,fontSize:oe?9:11},angle:-45,textAnchor:"end",interval:0,height:60}),(0,te.jsx)(B.h,{stroke:m,tick:{fill:m,fontSize:oe?9:11},width:oe?30:50}),(0,te.jsx)(K.m,{cursor:{fill:"dark"===d?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.05)",rx:4},content:(0,te.jsx)(se,{theme:d,chartTextColor:m,copFormatter:e=>e.toLocaleString()})}),(0,te.jsx)(H.s,{wrapperStyle:{color:m,paddingTop:"10px",fontSize:oe?8:12},align:"center",verticalAlign:"top",iconType:"circle"}),(0,te.jsx)(J.y,{dataKey:"Domicilios",fill:"#8B5CF6",stroke:"#8B5CF6",radius:[10,10,0,0],opacity:1,isAnimationActive:!1,maxBarSize:oe?12:25}),(0,te.jsx)(J.y,{dataKey:"Mesas",fill:"#10B981",stroke:"#10B981",radius:[10,10,0,0],opacity:1,isAnimationActive:!1,maxBarSize:oe?12:25})]})})})]})]}),(0,te.jsxs)(L.P.div,{className:(0,i.x)("dark"===d?"bg-gray-800":"bg-white",oe?"p-4":"p-6","rounded-2xl shadow-xl border","dark"===d?"border-gray-700":"border-gray-200","relative min-h-[350px] flex flex-col justify-center items-center"),variants:{hidden:{opacity:0,scale:.9},visible:{opacity:1,scale:1,transition:{duration:.7,ease:"easeOut"}},exit:{opacity:0,scale:.9,transition:{duration:.5,ease:"easeIn"}}},initial:"hidden",animate:"visible",exit:"exit",children:[(0,te.jsxs)("h3",{className:"text-xl font-semibold mb-4 text-gray-200 dark:text-gray-100 flex items-center",children:[(0,te.jsx)(X.A,{className:(0,i.x)(oe?"w-4 h-4 mr-2":"w-5 h-5 mr-2","text-blue-400")}),"Estado de Pedidos"]}),F?(0,te.jsx)(ae,{type:"pie",theme:d,isMobile:oe}):(0,te.jsx)(P.u,{width:"100%",height:"100%",children:(0,te.jsxs)(q.r,{children:[(0,te.jsxs)(V.F,{data:l,cx:"50%",cy:"50%",outerRadius:oe?80:120,fill:"#8884d8",dataKey:"value",animationDuration:800,innerRadius:oe?40:60,children:[l.map((e,t)=>(0,te.jsx)(Y.f,{fill:C[t%C.length],stroke:"dark"===d?"#1f2937":"#ffffff",strokeWidth:2},`cell-${t}`)),(0,te.jsx)(R.J,{value:`${fe} Pedidos`,position:"center",fill:m,fontSize:oe?14:18,fontWeight:"bold",dy:oe?0:-10}),(0,te.jsx)(R.J,{value:"Total",position:"center",fill:m,fontSize:oe?10:12,dy:15})]}),(0,te.jsx)(K.m,{content:(0,te.jsx)(le,{theme:d,chartTextColor:m})}),(0,te.jsx)(H.s,{wrapperStyle:{color:m,fontSize:oe?10:13,paddingTop:"15px"},align:"center",verticalAlign:"bottom",iconType:"circle",layout:"horizontal"})]})})]})]})]})}),ie=oe,ne=(0,r.createContext)(null),de=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return new Intl.DateTimeFormat("en-CA",{timeZone:"America/Bogota",year:"numeric",month:"2-digit",day:"2-digit"}).format(e)},ce=e=>{if(!e)return"\u2014";const t=Date.now()-new Date(e).getTime(),a=Math.max(0,Math.floor(t/6e4));if(a<1)return"hace segundos";if(1===a)return"hace 1 min";if(a<60)return`hace ${a} min`;const r=Math.floor(a/60);if(1===r)return"hace 1 hora";if(r<24)return`hace ${r} horas`;const s=Math.floor(r/24);return 1===s?"hace 1 d\xeda":`hace ${s} d\xedas`},me=e=>{let{children:t}=e;const[a,s]=(0,r.useState)(de()),l=(0,r.useCallback)(e=>{e&&s(e)},[]),o=(0,r.useMemo)(()=>{const e=new Date(`${a}T00:00:00.000-05:00`);const t=(e=>new Date(`${e}T23:59:59.999-05:00`))(a);return{selectedDate:a,startOfDay:e,endOfDay:t,setSelectedDate:l,timeAgo:ce,ymdInBogota:de}},[a]);return(0,te.jsx)(ne.Provider,{value:o,children:t})},ue=()=>(0,r.useContext)(ne),xe=360,ge="undefined"!==typeof __initial_auth_token?__initial_auth_token:null,he=e=>{let{theme:t}=e;return(0,te.jsx)("div",{className:"flex justify-center items-center h-screen bg-gray-900",children:(0,te.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 "+("dark"===t?"border-emerald-500":"border-emerald-600")})})},ye=e=>{let{show:t,onClose:a,onConfirm:s,confirmText:l,setConfirmText:o,theme:c}=e;return(0,te.jsx)(n.e,{show:t,as:r.Fragment,children:(0,te.jsxs)(d.lG,{as:"div",className:"relative z-50",onClose:a,children:[(0,te.jsx)(n.e.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,te.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50"})}),(0,te.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,te.jsx)(n.e.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,te.jsxs)(d.lG.Panel,{className:(0,i.x)("w-full max-w-sm p-6 rounded-lg shadow-md text-center","dark"===c?"bg-gray-800 text-gray-200":"bg-white text-gray-900"),children:[(0,te.jsxs)(d.lG.Title,{className:"text-lg font-medium mb-4 flex items-center justify-center gap-2 text-red-500",children:[(0,te.jsx)(m.A,{className:"w-6 h-6"}),"Confirmar Limpieza de Actividad"]}),(0,te.jsxs)("p",{className:"mb-4 text-sm",children:["Est\xe1s a punto de eliminar ",(0,te.jsx)("span",{className:"font-bold text-red-500",children:"TODAS"}),' las actividades. Esta acci\xf3n es irreversible. Para confirmar, escribe "confirmar":']}),(0,te.jsx)("input",{type:"text",value:l,onChange:e=>o(e.target.value),className:(0,i.x)("w-full p-2 rounded-md border text-center text-sm","dark"===c?"border-gray-600 bg-gray-700 text-white":"border-gray-200 bg-white text-gray-900","focus:outline-none focus:ring-1 focus:ring-red-500"),placeholder:"escribe 'confirmar'"}),(0,te.jsxs)("div",{className:"mt-6 flex justify-center gap-2",children:[(0,te.jsx)("button",{onClick:a,className:(0,i.x)("px-4 py-2 rounded-md text-sm font-medium","dark"===c?"bg-gray-600 hover:bg-gray-700 text-gray-200":"bg-gray-200 hover:bg-gray-300 text-gray-900"),children:"Cancelar"}),(0,te.jsx)("button",{onClick:s,className:"px-4 py-2 rounded-md text-sm font-medium bg-red-600 hover:bg-red-700 text-white",children:"Limpiar Actividad"})]})]})})})]})})},ve=e=>{let{show:t,onClose:a,details:s,theme:l}=e;return(0,te.jsx)(n.e,{show:t,as:r.Fragment,children:(0,te.jsxs)(d.lG,{as:"div",className:"relative z-50",onClose:a,children:[(0,te.jsx)(n.e.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,te.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50"})}),(0,te.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,te.jsx)(n.e.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,te.jsxs)(d.lG.Panel,{className:(0,i.x)("w-full max-w-md p-6 rounded-lg shadow-md","dark"===l?"bg-gray-800 text-gray-200":"bg-white text-gray-900"),children:[(0,te.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,te.jsx)(d.lG.Title,{className:"text-lg font-medium",children:"Detalle de Actividad"}),(0,te.jsx)("button",{onClick:a,className:"p-1 rounded-full hover:bg-gray-700 transition",children:(0,te.jsx)(u.A,{className:"w-5 h-5 text-gray-400"})})]}),(0,te.jsx)("pre",{className:"text-xs whitespace-pre-wrap p-4 bg-gray-700 rounded-lg text-gray-300 overflow-auto max-h-[70vh]",children:JSON.stringify(s||{},null,2)})]})})})]})})},pe=e=>{let{theme:t,title:a,icon:s,color:l,data:o,labelColor:n={},vAlign:d="top",cardHeight:c=xe}=e;const m=(0,r.useMemo)(()=>{switch(s){case"ShoppingCart":return x.A;case"Users":return g.A;case"Activity":return h.A;default:return null}},[s]),u="center"===d?"grid grid-rows-[auto,1fr]":"between"===d?"flex flex-col justify-between":"flex flex-col";return(0,te.jsxs)("div",{className:(0,i.x)(`p-6 rounded-2xl shadow-xl border transition-all duration-300 ease-in-out ${u} flex-1`,"dark"===t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),style:{height:c},children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,te.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:a}),m&&(0,te.jsx)(m,{className:`${l} w-8 h-8`})]}),(0,te.jsx)("div",{className:(0,i.x)("text-base text-gray-700 dark:text-gray-400","center"===d?"self-center w-full mt-1":"mt-3","space-y-2"),children:Object.entries(o).map(e=>{let[t,a]=e;return(0,te.jsxs)("div",{className:"flex justify-between",children:[(0,te.jsxs)("span",{children:[t,":"]}),(0,te.jsx)("span",{className:(0,i.x)("font-bold","text-gray-900 dark:text-gray-100",n[t]),children:a})]},t)})})]})},be=e=>{let{theme:t,userActivity:a,onClearClick:s,onShowDetails:l,cardHeight:o=360}=e;const n=(0,r.useRef)(null),[d,c]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!1),x=(0,r.useCallback)(()=>{const e=n.current;e&&(c(e.scrollTop>0),u(e.scrollTop+e.clientHeight<e.scrollHeight))},[]);(0,r.useEffect)(()=>{x()},[a,x]);const g="dark"===t?"hover:bg-gray-700/40":"hover:bg-gray-100",p="dark"===t?"border-gray-700":"border-gray-200",b="dark"===t?"bg-gradient-to-b from-gray-800 to-transparent":"bg-gradient-to-b from-white to-transparent",f="dark"===t?"bg-gradient-to-t from-gray-800 to-transparent":"bg-gradient-to-t from-white to-transparent";return(0,te.jsxs)("div",{className:(0,i.x)("p-6 rounded-2xl shadow-xl border flex flex-col","dark"===t?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),style:{height:o},children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,te.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"Actividad Reciente"}),(0,te.jsx)(h.A,{className:"text-orange-400 w-8 h-8"})]}),(0,te.jsxs)("div",{ref:n,onScroll:x,className:"relative text-sm min-h-40 max-h-56 overflow-y-auto overflow-x-auto custom-scrollbar pr-2 flex-1",children:[0===a.length?(0,te.jsx)("p",{className:"text-gray-400 text-center",children:"No hay actividad para la fecha."}):(0,te.jsx)("div",{className:"min-w-max table w-full",children:a.map((e,t)=>(0,te.jsxs)("div",{className:"table-row",children:[(0,te.jsx)("div",{className:`table-cell align-middle pr-3 py-2 border-b ${p}`,children:(0,te.jsxs)("div",{role:"button",tabIndex:0,onClick:()=>l(e),onKeyDown:t=>("Enter"===t.key||" "===t.key)&&l(e),className:`inline-flex items-center gap-2 whitespace-nowrap cursor-pointer rounded-md px-2 py-1 transition-colors ${g}`,title:"Ver detalles",children:[(0,te.jsx)("span",{className:"text-gray-400",children:e.action||"\u2014"}),e.action&&(0,te.jsx)("span",{className:"text-gray-600",children:"\u2022"}),(0,te.jsx)("span",{className:"text-gray-500 text-xs",title:e.timestamp?new Date(e.timestamp).toLocaleString("es-CO"):"N/A",children:e.timestamp?new Date(e.timestamp).toLocaleString("es-CO"):"N/A"})]})}),(0,te.jsx)("div",{className:`table-cell align-middle pl-2 pr-1 py-2 text-right border-b ${p}`,children:e.details&&(0,te.jsx)("button",{onClick:()=>l(e),className:"text-blue-400 hover:text-blue-300 p-1 rounded-full",title:"Ver detalles de la actividad",children:(0,te.jsx)(y.A,{className:"w-4 h-4"})})})]},t))}),d&&(0,te.jsx)("div",{className:(0,i.x)("pointer-events-none absolute top-0 left-0 right-0 h-4",b)}),m&&(0,te.jsx)("div",{className:(0,i.x)("pointer-events-none absolute bottom-0 left-0 right-0 h-4",f)})]}),(0,te.jsx)("div",{className:"mt-4 text-center",children:(0,te.jsxs)("button",{onClick:s,className:(0,i.x)("px-4 py-2 rounded-md text-xs font-medium flex items-center justify-center mx-auto","dark"===t?"bg-red-600 hover:bg-red-700 text-white":"bg-red-500 hover:bg-red-600 text-white"),children:[(0,te.jsx)(v.A,{className:"w-4 h-4 mr-2"})," Limpiar TODAS las Actividades"]})})]})},fe=e=>{var t,a,s,l,o,d,m,u,x,g,h,y,v,D;let{theme:N,totals:k,deliveryPersons:S,lastUpdatedAt:C,orders:A,proteinDaily:T,tableOrders:O,breakfastOrders:z,cardHeight:M=xe}=e;const[F,$]=(0,r.useState)(!1),[E,L]=(0,r.useState)(!1),[P,I]=(0,r.useState)(!1),{selectedDate:_,setSelectedDate:G,timeAgo:B}=ue(),{totalLunchCount:K,totalBreakfastCount:H}=(0,r.useMemo)(()=>{const e=A.filter(e=>"lunch"===e.category),t=z||[],a=O||[];return{totalLunchCount:e.filter(e=>"delivery"===e.orderType).length+a.filter(e=>"table"===e.orderType).length+a.filter(e=>"takeaway"===e.orderType).length,totalBreakfastCount:t.filter(e=>"delivery"===e.orderType).length+t.filter(e=>"table"===e.orderType).length+t.filter(e=>"takeaway"===e.orderType).length}},[A,O,z]),J=(0,r.useMemo)(()=>{const e=(null===k||void 0===k?void 0:k.byCategory)||{};return{domicilios:(e.domiciliosAlmuerzo||0)+(e.domiciliosDesayuno||0),salon:(e.mesasAlmuerzo||0)+(e.llevarAlmuerzo||0)+(e.mesasDesayuno||0)+(e.llevarDesayuno||0)}},[k]),q=e=>{let{left:t,right:a,strong:r,rightClass:s,onClick:l}=e;return(0,te.jsxs)("div",{className:"flex justify-between",onClick:l,children:[(0,te.jsx)("span",{className:(0,i.x)(r?"font-semibold":"","text-gray-400",l&&"cursor-pointer hover:underline"),children:t}),(0,te.jsx)("span",{className:(0,i.x)("font-bold",null!==s&&void 0!==s?s:"text-gray-100"),children:a})]})};return(0,te.jsx)(te.Fragment,{children:(0,te.jsxs)("div",{className:(0,i.x)("p-0 rounded-2xl shadow-xl border transition-all duration-300 ease-in-out hover:shadow-2xl flex flex-col flex-1","dark"===N?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),style:{height:M},children:[(0,te.jsxs)("div",{className:"flex items-center justify-center px-6 pt-5 flex-shrink-0",children:[(0,te.jsx)("h3",{className:"text-xl font-semibold text-gray-100 whitespace-nowrap",children:"Totales Generales"}),(0,te.jsx)(p.A,{className:"text-emerald-400 w-8 h-8 ml-4","aria-hidden":"true"})]}),(0,te.jsxs)("div",{className:(0,i.x)("mt-4 px-6 pb-3 relative min-h-0 h-[260px] custom-scrollbar",F?"overflow-y-auto":"overflow-hidden"),children:[(0,te.jsxs)("div",{className:"space-y-3 text-base mt-5 sm:mt-6",children:[(0,te.jsxs)("div",{onClick:()=>I(e=>!e),className:"cursor-pointer",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center text-gray-400 hover:underline hover:text-gray-100 transition-colors",children:[(0,te.jsx)("span",{children:"Total ingresos"}),(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsxs)("span",{className:"font-bold text-green-400",children:["$",((null===k||void 0===k?void 0:k.grossIncome)||0).toLocaleString("es-CO")]}),P?(0,te.jsx)(b.A,{className:"w-4 h-4 text-gray-500"}):(0,te.jsx)(f.A,{className:"w-4 h-4 text-gray-500"})]})]}),(0,te.jsx)(n.e,{show:P,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,te.jsxs)("div",{className:"mt-2 pl-4 space-y-1 text-sm text-gray-400",children:[(0,te.jsxs)("div",{className:"flex justify-between",children:[(0,te.jsx)("span",{children:"- De Domicilios:"}),(0,te.jsxs)("span",{className:"font-semibold text-emerald-300",children:["$",J.domicilios.toLocaleString("es-CO")]})]}),(0,te.jsxs)("div",{className:"flex justify-between",children:[(0,te.jsx)("span",{children:"- De Sal\xf3n:"}),(0,te.jsxs)("span",{className:"font-semibold text-emerald-300",children:["$",J.salon.toLocaleString("es-CO")]})]})]})})]}),(0,te.jsxs)("div",{onClick:()=>L(e=>!e),className:"cursor-pointer",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center text-gray-400 hover:underline hover:text-gray-100 transition-colors",children:[(0,te.jsx)("span",{children:"Gastos"}),(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsxs)("span",{className:"font-bold text-red-400",children:["-$",((null===k||void 0===k?void 0:k.expenses)||0).toLocaleString("es-CO")]}),E?(0,te.jsx)(b.A,{className:"w-4 h-4 text-gray-500"}):(0,te.jsx)(f.A,{className:"w-4 h-4 text-gray-500"})]})]}),(0,te.jsx)(n.e,{show:E,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,te.jsx)("div",{className:"mt-2 pl-4 space-y-1 text-sm text-gray-400",children:Object.entries((null===k||void 0===k||null===(t=k.expensesByProvider)||void 0===t?void 0:t.byProvider)||{}).map(e=>{let[t,a]=e;return(0,te.jsxs)("div",{className:"flex justify-between",children:[(0,te.jsxs)("span",{children:["- ",t,":"]}),(0,te.jsxs)("span",{className:"font-semibold text-red-300",children:["-$",a.toLocaleString("es-CO")]})]},t)})})})]}),(0,te.jsx)("div",{className:(0,i.x)("border-t mt-2","dark"===N?"border-gray-700":"border-gray-200")}),(0,te.jsx)(q,{strong:!0,left:"Total neto",right:`$${((null===k||void 0===k?void 0:k.net)||0).toLocaleString("es-CO")}`,rightClass:"text-emerald-400 text-xl"})]}),(0,te.jsx)("div",{className:"mt-6 sm:mt-8 text-center",children:(0,te.jsx)("button",{onClick:()=>$(e=>!e),"aria-expanded":F,className:"text-blue-500 hover:text-blue-600 transition-colors text-sm font-semibold underline underline-offset-4",children:F?"Ver menos":"Ver m\xe1s"})}),(0,te.jsxs)("div",{className:(0,i.x)("pt-4 mt-4 text-sm",F?"":"hidden"),children:[(0,te.jsx)("div",{className:(0,i.x)("border-t my-3","dark"===N?"border-gray-700":"border-gray-200")}),(0,te.jsx)("p",{className:(0,i.x)("text-sm mb-2 font-semibold","dark"===N?"text-gray-400":"text-gray-600"),children:"Desglose de ingresos"}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)(q,{left:"Efectivo (Caja)",right:`$${(null!==(a=null!==(s=null===k||void 0===k?void 0:k.cashCaja)&&void 0!==s?s:null===k||void 0===k?void 0:k.cash)&&void 0!==a?a:0).toLocaleString("es-CO")}`,rightClass:"text-green-400"}),"number"===typeof(null===k||void 0===k?void 0:k.cashPendiente)&&k.cashPendiente>0&&(0,te.jsx)(q,{left:"Efectivo pendiente (clientes no liquidados)",right:`$${k.cashPendiente.toLocaleString("es-CO")}`,rightClass:"text-yellow-400"}),(0,te.jsx)("div",{className:"space-y-1 mt-2",children:Object.entries(S||{}).map(e=>{var t,a;let[r,s]=e;return(0,te.jsxs)("div",{children:[(0,te.jsxs)("div",{className:"flex justify-between items-center text-gray-400",children:[(0,te.jsxs)("span",{className:"flex items-center",children:["\ud83d\udef5 ",r," Desayuno"]}),(0,te.jsxs)("span",{className:"font-bold text-purple-400 text-right",children:["$",((null===s||void 0===s||null===(t=s.desayuno)||void 0===t?void 0:t.total)||0).toLocaleString("es-CO")]})]}),(0,te.jsxs)("div",{className:"flex justify-between items-center text-gray-400",children:[(0,te.jsxs)("span",{className:"flex items-center",children:["\ud83d\udef5 ",r," Almuerzo"]}),(0,te.jsxs)("span",{className:"font-bold text-purple-400 text-right",children:["$",((null===s||void 0===s||null===(a=s.almuerzo)||void 0===a?void 0:a.total)||0).toLocaleString("es-CO")]})]})]},r)})}),(0,te.jsx)(q,{left:"DaviPlata",right:`$${((null===k||void 0===k?void 0:k.daviplata)||0).toLocaleString("es-CO")}`,rightClass:"text-red-400"}),(0,te.jsx)(q,{left:"Nequi",right:`$${((null===k||void 0===k?void 0:k.nequi)||0).toLocaleString("es-CO")}`,rightClass:"text-blue-400"})]}),(0,te.jsx)("div",{className:(0,i.x)("border-t my-3","dark"===N?"border-gray-700":"border-gray-200")}),(0,te.jsx)("p",{className:(0,i.x)("text-sm mb-2 font-semibold","dark"===N?"text-gray-400":"text-gray-600"),children:"Tipo de Venta"}),(0,te.jsxs)("div",{className:"space-y-3 mt-2 text-sm",children:[(0,te.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,te.jsx)("h4",{className:"font-semibold text-gray-100",children:"Domicilios"}),(0,te.jsxs)("ul",{className:"space-y-1 text-gray-400",children:[(0,te.jsxs)("li",{className:"flex justify-between items-center",children:[(0,te.jsx)("span",{className:"flex-1",children:"\ud83d\udef5 Almuerzo"}),(0,te.jsxs)("span",{className:"font-bold text-gray-100 text-right",children:["$",((null===k||void 0===k||null===(l=k.byCategory)||void 0===l?void 0:l.domiciliosAlmuerzo)||0).toLocaleString("es-CO")]})]}),(0,te.jsxs)("li",{className:"flex justify-between items-center",children:[(0,te.jsx)("span",{className:"flex-1",children:"\ud83c\udf73 Desayuno"}),(0,te.jsxs)("span",{className:"font-bold text-gray-100 text-right",children:["$",((null===k||void 0===k||null===(o=k.byCategory)||void 0===o?void 0:o.domiciliosDesayuno)||0).toLocaleString("es-CO")]})]})]})]}),(0,te.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,te.jsx)("h4",{className:"font-semibold text-gray-100",children:"Sal\xf3n"}),(0,te.jsxs)("ul",{className:"space-y-1 text-gray-400",children:[(0,te.jsxs)("li",{className:"flex justify-between items-center",children:[(0,te.jsx)("span",{className:"flex-1",children:"\ud83e\ude91 Almuerzo Mesa"}),(0,te.jsxs)("span",{className:"font-bold text-gray-100 text-right",children:["$",((null===k||void 0===k||null===(d=k.byCategory)||void 0===d?void 0:d.mesasAlmuerzo)||0).toLocaleString("es-CO")]})]}),(0,te.jsxs)("li",{className:"flex justify-between items-center",children:[(0,te.jsx)("span",{className:"flex-1",children:"\ud83d\udce6 Almuerzo llevar"}),(0,te.jsxs)("span",{className:"font-bold text-gray-100 text-right",children:["$",((null===k||void 0===k||null===(m=k.byCategory)||void 0===m?void 0:m.llevarAlmuerzo)||0).toLocaleString("es-CO")]})]}),(0,te.jsxs)("li",{className:"flex justify-between items-center",children:[(0,te.jsx)("span",{className:"flex-1",children:"\ud83e\ude91 Desayuno Mesa"}),(0,te.jsxs)("span",{className:"font-bold text-gray-100 text-right",children:["$",((null===k||void 0===k||null===(u=k.byCategory)||void 0===u?void 0:u.mesasDesayuno)||0).toLocaleString("es-CO")]})]}),(0,te.jsxs)("li",{className:"flex justify-between items-center",children:[(0,te.jsx)("span",{className:"flex-1",children:"\ud83d\udce6 Desayuno llevar"}),(0,te.jsxs)("span",{className:"font-bold text-gray-100 text-right",children:["$",((null===k||void 0===k||null===(x=k.byCategory)||void 0===x?void 0:x.llevarDesayuno)||0).toLocaleString("es-CO")]})]})]})]})]}),(0,te.jsx)("div",{className:(0,i.x)("border-t my-3","dark"===N?"border-gray-700":"border-gray-200")}),(0,te.jsx)("p",{className:(0,i.x)("text-sm mb-2 font-semibold","dark"===N?"text-gray-400":"text-gray-600"),children:"Producci\xf3n y ventas"}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)(q,{left:"Prote\xednas preparadas (unid.)",right:String(Number((null===T||void 0===T?void 0:T.preparedUnits)||0)),rightClass:"text-gray-100"}),(0,te.jsx)(q,{left:"Almuerzos vendidos (unid.)",right:String(K),rightClass:"text-gray-100"}),(0,te.jsx)(q,{left:"Desayunos vendidos (unid.)",right:String(H),rightClass:"text-gray-100"})]}),(0,te.jsx)("div",{className:(0,i.x)("border-t my-3","dark"===N?"border-gray-700":"border-gray-200")}),(0,te.jsx)("p",{className:(0,i.x)("text-sm mb-2 font-semibold","dark"===N?"text-gray-400":"text-gray-600"),children:"Sobrantes"}),(0,te.jsxs)("p",{className:(0,i.x)("text-[13px]","dark"===N?"text-gray-300":"text-gray-700"),children:["\u2022 ",Number((null===T||void 0===T||null===(g=T.leftovers)||void 0===g?void 0:g.res)||0)," res\u2003\u2022 ",Number((null===T||void 0===T||null===(h=T.leftovers)||void 0===h?void 0:h.lomo)||0)," lomo\u2003\u2022 ",Number((null===T||void 0===T||null===(y=T.leftovers)||void 0===y?void 0:y.pechuga)||0)," pechuga\u2003\u2022 ",Number((null===T||void 0===T||null===(v=T.leftovers)||void 0===v?void 0:v.pollo)||0)," pollo\u2003\u2022 ",Number((null===T||void 0===T||null===(D=T.leftovers)||void 0===D?void 0:D.recuperada)||0)," recuperada"]})]}),!F&&(0,te.jsx)("div",{className:(0,i.x)("pointer-events-none absolute bottom-0 left-0 right-0 h-16","dark"===N?"bg-gradient-to-t from-gray-800 to-transparent":"bg-gradient-to-t from-white to-transparent")})]}),(0,te.jsxs)("div",{className:(0,i.x)("px-6 py-2 text-[12px] flex items-center justify-between mt-auto flex-shrink-0 gap-x-2 gap-y-1 rounded-b-2xl","dark"===N?"bg-gray-700 text-gray-400":"bg-gray-100 text-gray-600"),children:[(0,te.jsx)(c.AM,{className:"relative",children:e=>{let{open:t}=e;return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)(c.ut,{className:(0,i.x)("inline-flex items-center gap-1 text-[11px] transition-colors cursor-pointer","dark"===N?"text-gray-400 hover:text-gray-200":"text-gray-700 hover:text-gray-900"),children:[(0,te.jsx)(j.A,{className:"w-3 h-3 text-green-400"}),(0,te.jsxs)("span",{children:["Fecha: ",_]})]}),(0,te.jsx)(n.e,{as:r.Fragment,enter:"transition ease-out duration-150",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-100",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:(0,te.jsxs)(c.QT,{className:(0,i.x)("absolute z-50 mt-2 p-3 rounded-xl shadow-lg w-64 left-0 origin-top-left","max-w-[calc(100vw-2rem)]","dark"===N?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"),children:[(0,te.jsx)("label",{className:(0,i.x)("block text-xs mb-1","dark"===N?"text-gray-400":"text-gray-600"),children:"Selecciona una fecha"}),(0,te.jsx)("input",{type:"date",value:_,onChange:e=>e.target.value&&G(e.target.value),className:(0,i.x)("w-full rounded-md px-3 py-2 text-sm border focus:outline-none focus:ring-1 focus:ring-emerald-500","dark"===N?"bg-gray-900 border-gray-700 text-gray-100":"bg-white border-gray-300 text-gray-900")}),(0,te.jsx)("p",{className:"text-[11px] mt-2 text-gray-500",children:"Cambiar la fecha actualiza todo el dashboard para ese d\xeda."})]})})]})}}),(0,te.jsxs)("span",{className:"flex items-center gap-1 text-[11px]",children:[(0,te.jsx)(w.A,{className:"w-3 h-3"})," Actualizado ",B(C)]})]})]})})},je=e=>{let{theme:t}=e;const[a,i]=(0,r.useState)(null),[n,d]=(0,r.useState)(!1),{notify:c}=(()=>{const[e,t]=(0,r.useState)(null);return{notify:(0,r.useCallback)((e,a)=>{t({type:e,text:a}),setTimeout(()=>t(null),5e3)},[]),message:e}})(),{selectedDate:m,startOfDay:u,endOfDay:x}=ue(),{loadingData:g,orders:h,users:y,totals:v,statusCounts:p,userActivity:b,deliveryPersons:f,proteinDaily:j,lastUpdatedAt:w,ingresosCategoriasData:D,gastosPorTiendaData:N,pedidosDiariosChartData:k,statusPieChartData:S,tableOrders:C,breakfastOrders:A,handleSaveDailyIngresos:T,handleDeleteDailyIngresos:O,handleSaveDailyOrders:z,handleDeleteDailyOrders:M}=E(s.db,a,n,c,u,x,m),[F,$]=(0,r.useState)(!1),[L,P]=(0,r.useState)(""),[I,_]=(0,r.useState)(!1),[G,B]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(!s.j)return;const e=(0,l.hg)(s.j,async e=>{if(e)i(e.uid),d(!0);else try{ge?await(0,l.p)(s.j,ge):await(0,l.zK)(s.j)}catch(t){console.error("Error al iniciar sesi\xf3n:",t),c("error",`Error de autenticaci\xf3n: ${t.message}`)}finally{d(!0)}});return()=>e()},[]);const K="dark"===t?"#cbd5e1":"#475569",H=!n||g;return H?(0,te.jsx)(he,{theme:t}):(0,te.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 font-inter",children:[(0,te.jsx)("h2",{className:"text-3xl font-extrabold mb-8 text-gray-900 dark:text-white transition-colors duration-200",children:"Dashboard"}),(0,te.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,te.jsx)(pe,{theme:t,title:"Pedidos",icon:"ShoppingCart",color:"text-blue-400",vAlign:"center",cardHeight:xe,data:{Total:p.Pending+p.Delivered+p.Cancelled,Pendientes:p.Pending,Entregados:p.Delivered,Cancelados:p.Cancelled},labelColor:{Pendientes:"text-yellow-400",Entregados:"text-green-400",Cancelados:"text-red-400"}}),(0,te.jsx)(fe,{theme:t,totals:v,deliveryPersons:f,lastUpdatedAt:w,orders:h,proteinDaily:j,tableOrders:C,breakfastOrders:A,cardHeight:xe}),(0,te.jsx)(pe,{theme:t,title:"Usuarios",icon:"Users",color:"text-purple-400",cardHeight:xe,data:{Total:y.length}}),(0,te.jsx)(be,{theme:t,userActivity:b,onClearClick:()=>$(!0),onShowDetails:e=>{B(e),_(!0)},cardHeight:xe})]}),(0,te.jsx)(ie,{theme:t,cardHeight:xe,chartTextColor:K,ingresosCategoriasData:D,gastosPorTiendaData:N,pedidosDiariosChartData:k,statusPieChartData:S,loading:H,handleSaveDailyIngresos:T,handleDeleteDailyIngresos:O,handleSaveDailyOrders:z,handleDeleteDailyOrders:M,proteinDaily:j}),(0,te.jsx)(ye,{show:F,onClose:()=>{$(!1),P("")},onConfirm:async()=>{if("confirmar"===L.toLowerCase())try{const e=(0,o.wP)(s.db),t=await(0,o.GG)((0,o.rJ)(s.db,"userActivity"));let a=0;t.forEach(t=>{e.delete(t.ref),a++}),a>0&&await e.commit(),$(!1),P(""),c("success",0===a?"No hab\xeda actividades para eliminar.":`Todas las actividades (${a}) han sido eliminadas.`)}catch(e){c("error",`Error al eliminar actividades: ${e.message}`)}else c("error",'Por favor, escribe "confirmar" para proceder.')},confirmText:L,setConfirmText:P,theme:t}),(0,te.jsx)(ve,{show:I,onClose:()=>_(!1),details:null===G||void 0===G?void 0:G.details,theme:t})]})},we=e=>(0,te.jsx)(me,{children:(0,te.jsx)(je,{...e})})}}]);
//# sourceMappingURL=37.9bd6e70f.chunk.js.map