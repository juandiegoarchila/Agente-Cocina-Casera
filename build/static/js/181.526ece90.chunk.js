"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[181],{5172:(e,t,a)=>{a.d(t,{A:()=>d});var l=a(5043),o=a(6568),s=a(579);const r=e=>{const t=Math.floor(Number(e||0));return Number.isFinite(t)?t:0},n=e=>(e||"").toString().trim().toLowerCase(),i=e=>{if(Array.isArray(e)&&e.length){const t=e.map(e=>"string"===typeof e?e:(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.label)||"").filter(Boolean);return Array.from(new Set(t))}return["Efectivo","Nequi","Daviplata"]};function d(e){let{theme:t="light",total:a=0,value:d=[],onChange:c,catalogMethods:m=[],disabled:u=!1}=e;const p=(0,l.useMemo)(()=>i(m),[m]),[x,h]=(0,l.useState)(()=>{const e=Array.isArray(d)?d:[];return e.length?e.map(e=>{var t;return{method:"string"===typeof e.method?e.method:(null===e||void 0===e||null===(t=e.method)||void 0===t?void 0:t.name)||"",amount:r(e.amount),note:e.note||""}}):[{method:"Efectivo",amount:r(a),note:""}]});(0,l.useEffect)(()=>{const e=Array.isArray(d)?d:[];e.length&&h(e.map(e=>{var t;return{method:"string"===typeof e.method?e.method:(null===e||void 0===e||null===(t=e.method)||void 0===t?void 0:t.name)||"",amount:r(e.amount),note:e.note||""}}))},[d]);const b=x.reduce((e,t)=>e+r(t.amount),0),g=r(a)-b,v=0===g,y=e=>{h(e),c&&c(e.map(e=>({method:e.method,amount:r(e.amount),note:e.note||""})))},f=(e,t,a)=>{const l=x.map((l,o)=>o===e?{...l,[t]:"amount"===t?r(a):a}:l);y(l)};return(0,s.jsxs)("div",{className:(0,o.x)("p-3 rounded-lg border","dark"===t?"border-gray-600 bg-gray-800":"border-gray-200 bg-gray-50"),children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2 mb-2",children:[(0,s.jsx)("h5",{className:"font-semibold text-sm",children:"Dividir pago"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)("button",{type:"button",disabled:u,onClick:()=>{if(p.length<2)return;const e=Math.floor(r(a)/2),t=r(a)-e;y([{method:p[0],amount:e,note:""},{method:p[1],amount:t,note:""}])},className:(0,o.x)("px-2 py-1 rounded text-xs border","dark"===t?"border-gray-500 hover:bg-gray-700":"border-gray-300 hover:bg-white"),children:"50 / 50"}),(0,s.jsx)("button",{type:"button",disabled:u,onClick:()=>{const e=Math.floor(r(a)/3),t=Math.floor((r(a)-e)/2),l=r(a)-e-t;y([{method:p[0]||"Efectivo",amount:e,note:""},{method:p[1]||"Nequi",amount:t,note:""},{method:p[2]||"Daviplata",amount:l,note:""}])},className:(0,o.x)("px-2 py-1 rounded text-xs border","dark"===t?"border-gray-500 hover:bg-gray-700":"border-gray-300 hover:bg-white"),children:"1/3 cada uno"}),p.map(e=>(0,s.jsxs)("button",{type:"button",disabled:u,onClick:()=>(e=>{y([{method:e,amount:r(a),note:""}])})(e),className:(0,o.x)("px-2 py-1 rounded text-xs border","dark"===t?"border-gray-500 hover:bg-gray-700":"border-gray-300 hover:bg-white"),children:["Todo ",e]},e))]})]}),(0,s.jsx)("div",{className:"space-y-2",children:x.map((e,l)=>(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-2 items-center",children:[(0,s.jsx)("select",{disabled:u,value:e.method,onChange:e=>f(l,"method",e.target.value),className:(0,o.x)("sm:col-span-4 p-2 rounded border text-sm","dark"===t?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white"),children:p.map(e=>(0,s.jsx)("option",{value:e,children:e},e))}),(0,s.jsx)("input",{disabled:u,type:"number",min:"0",step:"1",value:e.amount,onChange:e=>f(l,"amount",e.target.value),className:(0,o.x)("sm:col-span-4 p-2 rounded border text-sm","dark"===t?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white"),placeholder:"Monto en COP"}),(0,s.jsx)("input",{disabled:u,type:"text",value:e.note||"",onChange:e=>f(l,"note",e.target.value),className:(0,o.x)("sm:col-span-3 p-2 rounded border text-sm","dark"===t?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white"),placeholder:"Nota (opcional)"}),(0,s.jsx)("div",{className:"sm:col-span-1 flex justify-end",children:(0,s.jsx)("button",{type:"button",disabled:u,onClick:()=>(e=>{const t=x.filter((t,a)=>a!==e);y(t.length?t:[{method:"Efectivo",amount:r(a),note:""}])})(l),className:(0,o.x)("px-2 py-1 rounded text-xs border","dark"===t?"border-gray-500 hover:bg-gray-700":"border-gray-300 hover:bg-white"),children:"\u2715"})})]},l))}),(0,s.jsxs)("div",{className:"mt-3 flex items-center justify-between text-sm",children:[(0,s.jsx)("button",{type:"button",disabled:u,onClick:()=>{const e=p.find(e=>!x.some(t=>n(t.method)===n(e)))||p[0],t=[...x,{method:e,amount:Math.max(0,g),note:""}];y(t)},className:(0,o.x)("px-3 py-1 rounded border","dark"===t?"border-gray-500 hover:bg-gray-700":"border-gray-300 hover:bg-white"),children:"+ A\xf1adir l\xednea"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{children:"Total pedido:"}),(0,s.jsxs)("strong",{children:["$",r(a).toLocaleString("es-CO")]})]})]}),(0,s.jsx)("div",{className:"mt-2",children:v?(0,s.jsx)("span",{className:(0,o.x)("inline-block text-xs px-2 py-1 rounded","dark"===t?"bg-green-700 text-white":"bg-green-100 text-green-800"),children:"\u2714 Suma exacta"}):g>0?(0,s.jsxs)("span",{className:(0,o.x)("inline-block text-xs px-2 py-1 rounded","dark"===t?"bg-yellow-700 text-white":"bg-yellow-100 text-yellow-800"),children:["Falta asignar $",g.toLocaleString("es-CO")]}):(0,s.jsxs)("span",{className:(0,o.x)("inline-block text-xs px-2 py-1 rounded","dark"===t?"bg-red-700 text-white":"bg-red-100 text-red-800"),children:["Sobran $",Math.abs(g).toLocaleString("es-CO")]})})]})}},5343:(e,t,a)=>{a.d(t,{XF:()=>n,Zd:()=>d,_s:()=>i,fz:()=>m});const l=e=>(null!==e&&void 0!==e?e:"").toString().trim().toLowerCase(),o=e=>{const t="string"===typeof e?e:(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.label)||(null===e||void 0===e?void 0:e.title)||(null===e||void 0===e?void 0:e.method)||(null===e||void 0===e?void 0:e.type)||(null===e||void 0===e?void 0:e.payment)||"",a=l(t);return a.includes("efect")||a.includes("cash")?"cash":a.includes("nequi")?"nequi":a.includes("davi")?"daviplata":"other"},s=e=>"string"===typeof e?e:(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.label)||(null===e||void 0===e?void 0:e.title)||(null===e||void 0===e?void 0:e.method)||(null===e||void 0===e?void 0:e.type)||(null===e||void 0===e?void 0:e.payment)||"Otro",r=e=>{var t,a,l,r,n,i,d,c,m,u,p;const x=Math.floor(Number((null===e||void 0===e?void 0:e.total)||0))||0;if(Array.isArray(null===e||void 0===e?void 0:e.payments)&&e.payments.length)return e.payments.map(e=>{const t=Math.floor(Number((null===e||void 0===e?void 0:e.amount)||0))||0;return{methodKey:o(null===e||void 0===e?void 0:e.method),amount:t,rawLabel:s(null===e||void 0===e?void 0:e.method)}});const h=[null!==(t=null===e||void 0===e||null===(a=e.meals)||void 0===a||null===(l=a[0])||void 0===l?void 0:l.paymentMethod)&&void 0!==t?t:null===e||void 0===e||null===(r=e.meals)||void 0===r||null===(n=r[0])||void 0===n?void 0:n.payment,null!==(i=null===e||void 0===e||null===(d=e.breakfasts)||void 0===d||null===(c=d[0])||void 0===c?void 0:c.payment)&&void 0!==i?i:null===e||void 0===e||null===(m=e.breakfasts)||void 0===m||null===(u=m[0])||void 0===u?void 0:u.paymentMethod,null!==(p=null===e||void 0===e?void 0:e.paymentMethod)&&void 0!==p?p:null===e||void 0===e?void 0:e.payment].filter(Boolean);if(h.length){const e=s(h[0]);return[{methodKey:o(h[0]),amount:x,rawLabel:e}]}return[{methodKey:"other",amount:x,rawLabel:"Otro"}]},n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!Array.isArray(e)||!e.length)return"Sin pago";const t=e.reduce((e,t)=>{const a=t.methodKey||o(null===t||void 0===t?void 0:t.method);return e[a]=(e[a]||0)+(Math.floor(Number(t.amount||0))||0),e},{}),a=[];return t.cash&&a.push(`Efectivo $${t.cash.toLocaleString("es-CO")}`),t.nequi&&a.push(`Nequi $${t.nequi.toLocaleString("es-CO")}`),t.daviplata&&a.push(`Daviplata $${t.daviplata.toLocaleString("es-CO")}`),t.other&&!a.length&&a.push(`Otro $${t.other.toLocaleString("es-CO")}`),a.join(" + ")||"Sin pago"},i=e=>{const t=r(e);if(null!==t&&void 0!==t&&t.length)return t.map(e=>{let{methodKey:t,amount:a}=e;return{method:t,amount:a}});return[{method:"cash",amount:Math.floor(Number((null===e||void 0===e?void 0:e.total)||0))||0}]},d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t={cash:0,nequi:0,daviplata:0,other:0,total:0};for(const a of e){const e=r(a);for(const a of e){const e=Math.floor(Number(a.amount||0))||0;t[a.methodKey]=(t[a.methodKey]||0)+e,t.total+=e}}return t},c=e=>{var t,a;if(((null===e||void 0===e?void 0:e.__collection)||"").toLowerCase().includes("table"))return!0;const o=l((null===e||void 0===e?void 0:e.orderType)||(null===e||void 0===e||null===(t=e.breakfasts)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.orderType)||"");return!(!Array.isArray(null===e||void 0===e?void 0:e.breakfasts)||!(o.includes("table")||o.includes("takeaway")||o.includes("para llevar")||o.includes("llevar")))},m=function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const a={nequiTotal:0,daviplataTotal:0,nequiPendiente:0,daviplatasPendiente:0,cashSalon:0,cashClientesSettled:0,cashClientesPendiente:0,totalLiquidado:0,totalPendiente:0,totalDomicilios:0,totalSalon:0},l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];for(const s of e){const e=r(s),n=c(s);for(const r of e){const e=Math.floor(Number((null===r||void 0===r?void 0:r.amount)||0))||0;var t;if(!(e<=0))if(n)a.totalSalon+=e,"cash"===r.methodKey?a.cashSalon+=e:"nequi"===r.methodKey?a.nequiTotal+=e:"daviplata"===r.methodKey&&(a.daviplataTotal+=e),a.totalLiquidado+=e;else if(a.totalDomicilios+=e,"cash"===r.methodKey)null!==s&&void 0!==s&&s.settled||null!==s&&void 0!==s&&null!==(t=s.paymentSettled)&&void 0!==t&&t.cash?(a.cashClientesSettled+=e,a.totalLiquidado+=e):(a.cashClientesPendiente+=e,a.totalPendiente+=e);else if("nequi"===r.methodKey){var l;null!==s&&void 0!==s&&s.settled||null!==s&&void 0!==s&&null!==(l=s.paymentSettled)&&void 0!==l&&l.nequi?(a.nequiTotal+=e,a.totalLiquidado+=e):(a.nequiPendiente+=e,a.totalPendiente+=e)}else if("daviplata"===r.methodKey){var o;null!==s&&void 0!==s&&s.settled||null!==s&&void 0!==s&&null!==(o=s.paymentSettled)&&void 0!==o&&o.daviplata?(a.daviplataTotal+=e,a.totalLiquidado+=e):(a.daviplatasPendiente+=e,a.totalPendiente+=e)}}}};return l(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]),l(e),l(t),a.cashCaja=a.cashSalon+a.cashClientesSettled,a}},6568:(e,t,a)=>{function l(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter(Boolean).join(" ")}a.d(t,{x:()=>l})},8181:(e,t,a)=>{a.r(t),a.d(t,{default:()=>z});var l=a(5043),o=a(1283),s=a(5509),r=a(1958),n=a(5472),i=a(6568),d=a(2315),c=a(4791),m=a(1252),u=a(2811),x=a(9248),h=a(8224),b=a(6365),g=a(196),v=a(5492),y=a(2781),f=a(1173),j=a(1238),N=a(7762),k=(a(557),a(2061)),w=a(2049),A=a(1535),S=a(5172),C=a(5343),$=a(579);const M=e=>(e||"").replace(/\s*NUEVO\s*$/i,"").trim(),P=(e,t)=>{if(!t)return null;const a="string"===typeof t?t:null===t||void 0===t?void 0:t.name;return e.find(e=>M(e.name)===M(a))||null},T=(e,t)=>Array.isArray(t)?t.map(t=>P(e,t)).filter(Boolean):[],E=function(){var e,t,a,l,o,s,r,n,i,d,c,m;let u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{address:null!==(e=null!==(t=u.address)&&void 0!==t?t:p.address)&&void 0!==e?e:"",phoneNumber:null!==(a=null!==(l=u.phoneNumber)&&void 0!==l?l:p.phoneNumber)&&void 0!==a?a:"",addressType:null!==(o=null!==(s=u.addressType)&&void 0!==s?s:p.addressType)&&void 0!==o?o:"",localName:null!==(r=null!==(n=u.localName)&&void 0!==n?n:p.localName)&&void 0!==r?r:"",unitDetails:null!==(i=null!==(d=u.unitDetails)&&void 0!==d?d:p.unitDetails)&&void 0!==i?i:"",recipientName:null!==(c=null!==(m=u.recipientName)&&void 0!==m?m:p.recipientName)&&void 0!==c?c:""}},O=e=>{var t,a,l,o;if(!e)return"N/A";if("string"===typeof e)return e;return[e.name,e.label,e.title,e.method,e.type,e.payment,e.value,null===e||void 0===e||null===(t=e.method)||void 0===t?void 0:t.name,null===e||void 0===e||null===(a=e.payment)||void 0===a?void 0:a.name,null===e||void 0===e||null===(l=e.value)||void 0===l?void 0:l.name,null===e||void 0===e||null===(o=e.type)||void 0===o?void 0:o.name].filter(e=>"string"===typeof e&&e.trim())[0]||"N/A"},L=e=>{var t,a,l,o,s,r,n,i,d,c,m;return null!==(t=null!==(a=null!==(l=null!==(o=null!==(s=null===e||void 0===e||null===(r=e.meals)||void 0===r||null===(n=r[0])||void 0===n?void 0:n.paymentMethod)&&void 0!==s?s:null===e||void 0===e||null===(i=e.breakfasts)||void 0===i||null===(d=i[0])||void 0===d?void 0:d.payment)&&void 0!==o?o:null===e||void 0===e||null===(c=e.breakfasts)||void 0===c||null===(m=c[0])||void 0===m?void 0:m.paymentMethod)&&void 0!==l?l:null===e||void 0===e?void 0:e.payment)&&void 0!==a?a:null===e||void 0===e?void 0:e.paymentMethod)&&void 0!==t?t:null},q=e=>O(L(e)),D=e=>("string"===typeof e?e:O(e)).toLowerCase().trim(),B=e=>{const t=("string"===typeof e?e:(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.label)||(null===e||void 0===e?void 0:e.method)||(null===e||void 0===e?void 0:e.type)||"").toString().trim().toLowerCase();return t?t.includes("efect")||t.includes("cash")?"Efectivo":t.includes("nequi")?"Nequi":t.includes("davi")?"Daviplata":"":""},z=e=>{var t,a,M,z,I,_;let{theme:R="light"}=e;const{user:H,role:K,loading:V}=(0,s.A)(),F=(0,o.Zp)(),[G,Z]=(0,l.useState)([]),[J,Q]=(0,l.useState)(""),[X,U]=(0,l.useState)(!1),[W,Y]=(0,l.useState)(null),[ee,te]=(0,l.useState)(1),[ae,le]=(0,l.useState)(10),[oe,se]=(0,l.useState)("createdAt"),[re,ne]=(0,l.useState)("desc"),[ie,de]=(0,l.useState)(!1),[ce,me]=(0,l.useState)(null),[ue,pe]=(0,l.useState)(null),[xe,he]=(0,l.useState)("all"),[be,ge]=(0,l.useState)([]),ve=(0,l.useRef)(null),[ye,fe]=(0,l.useState)([]),[je,Ne]=(0,l.useState)([]),[ke,we]=(0,l.useState)([]),[Ae,Se]=(0,l.useState)([]),[Ce,$e]=(0,l.useState)([]),[Me,Pe]=(0,l.useState)([]),[Te,Ee]=(0,l.useState)([]),[Oe,Le]=(0,l.useState)([]),[qe,De]=(0,l.useState)([]),[Be,ze]=(0,l.useState)([]),[Ie,_e]=(0,l.useState)([]),[Re,He]=(0,l.useState)([]),[Ke,Ve]=(0,l.useState)([]),[Fe,Ge]=(0,l.useState)([]);(0,l.useEffect)(()=>{if(V)return;if(!H||2!==K)return Y("Acceso denegado. Solo los administradores pueden acceder a esta p\xe1gina."),void setTimeout(()=>F("/login"),3e3);U(!0);const e=(0,n.aQ)((0,n.rJ)(r.db,"breakfastTypes"),e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));ge(t)},e=>{console.error("Error al escuchar breakfastTypes:",e),Y("Error al cargar tipos de desayuno. Intenta de nuevo.")}),t=(0,n.aQ)((0,n.rJ)(r.db,"breakfastOrders"),e=>{const t=e.docs.map(e=>({id:e.id,...e.data(),type:"breakfast",__collection:"breakfastOrders"}));Z(e=>[...e.filter(e=>"breakfast"!==e.type),...t]),U(!1)},e=>{console.error("Error al escuchar breakfastOrders:",e),Y("Error al cargar \xf3rdenes de desayunos. Intenta de nuevo."),U(!1)}),a=(0,n.aQ)((0,n.rJ)(r.db,"tableOrders"),e=>{const t=e.docs.map(e=>({id:e.id,...e.data(),type:"lunch",__collection:"tableOrders"}));Z(e=>[...e.filter(e=>"lunch"!==e.type),...t]),U(!1)},e=>{console.error("Error al escuchar tableOrders:",e),Y("Error al cargar \xf3rdenes de mesas. Intenta de nuevo."),U(!1)});return()=>{e(),t(),a()}},[H,V,K,F]),(0,l.useEffect)(()=>{const e=[],t=(t,a)=>{const l=(0,n.aQ)((0,n.rJ)(r.db,t),e=>{a(e.docs.map(e=>({id:e.id,...e.data()})))});e.push(l)};return t("soups",fe),t("soupReplacements",Ne),t("principles",we),t("proteins",Se),t("drinks",$e),t("sides",Pe),t("additions",Ee),t("paymentMethods",Le),t("breakfastEggs",De),t("breakfastBroths",ze),t("breakfastRiceBread",_e),t("breakfastDrinks",He),t("breakfastAdditions",Ve),t("breakfastProteins",Ge),()=>e.forEach(e=>e&&e())},[]),(0,l.useEffect)(()=>{function e(e){ve.current&&!ve.current.contains(e.target)&&de(!1)}return ie&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[ie]);const Ze=(0,C.Zd)(G),Je=G.filter(e=>{var t,a,l,o;const s=J.toLowerCase();return(e.id.toLowerCase().includes(s)||(null===(t=e.meals)||void 0===t?void 0:t.some(e=>{var t,a,l;const o=D(null!==(t=e.paymentMethod)&&void 0!==t?t:"");return(null===(a=e.tableNumber)||void 0===a?void 0:a.toString().toLowerCase().includes(s))||o.includes(s)||(null===(l=e.notes)||void 0===l?void 0:l.toLowerCase().includes(s))}))||(null===(a=e.breakfasts)||void 0===a?void 0:a.some(e=>{var t,a,l,o;const r=D(null!==(t=null!==(a=e.payment)&&void 0!==a?a:e.paymentMethod)&&void 0!==t?t:"");return(null===(l=e.tableNumber)||void 0===l?void 0:l.toString().toLowerCase().includes(s))||r.includes(s)||(null===(o=e.notes)||void 0===o?void 0:o.toLowerCase().includes(s))}))||D("string"===typeof p.method?p.method:null===(l=p)||void 0===l||null===(o=l.method)||void 0===o?void 0:o.name).includes(s))&&("all"===xe||e.type===xe)}),Qe=[...Je].sort((e,t)=>{const a="orderNumber"===oe?"id":oe,l="id"===a?e.id:e[a]||"",o="id"===a?t.id:t[a]||"";return"asc"===re?l>o?1:-1:l<o?1:-1}),Xe=Math.ceil(Qe.length/ae),Ue=Qe.slice((ee-1)*ae,ee*ae),We=e=>{oe===e?ne("asc"===re?"desc":"asc"):(se(e),ne("asc"))},Ye=e=>oe===e?"asc"===re?"\u2191":"\u2193":"",et=(0,l.useRef)(null);(0,l.useEffect)(()=>{if(!ue)return void(et.current=null);if(!(ye.length||ke.length||Ae.length||Ce.length||Me.length||Te.length||be.length||Be.length||qe.length||Ie.length||Re.length||Ke.length||Fe.length||Oe.length))return;if(et.current===ue.id)return;const e=Array.isArray(ue.breakfasts),t=ue.address||{};if(e){const e=(ue.breakfasts||[]).map(e=>{var a;return{type:P(be,e.type),broth:P(Be,e.broth),eggs:P(qe,e.eggs),riceBread:P(Ie,e.riceBread),drink:P(Re,e.drink),protein:P(Fe,e.protein),additions:Array.isArray(e.additions)?e.additions.map(e=>{var t,a;const l=P(Ke,e);return l?{...l,quantity:e.quantity||1,price:null!==(t=null!==(a=l.price)&&void 0!==a?a:e.price)&&void 0!==t?t:0}:null}).filter(Boolean):[],cutlery:!!e.cutlery,time:"string"===typeof e.time?e.time:(null===(a=e.time)||void 0===a?void 0:a.name)||"",address:E(e.address,t),notes:e.notes||"",paymentMethod:P(Oe,e.payment||e.paymentMethod),orderType:e.orderType||"",tableNumber:e.tableNumber||""}});pe(t=>({...t,type:"breakfast",breakfasts:e}))}else{const e=(ue.meals||[]).map(e=>{var a;return{soup:P(ye,e.soup),soupReplacement:P(je,e.soupReplacement),principle:T(ke,e.principle),protein:P(Ae,e.protein),drink:P(Ce,e.drink),sides:T(Me,e.sides),additions:Array.isArray(e.additions)?e.additions.map(e=>{var t,a;const l=P(Te,e);return l?{...l,quantity:e.quantity||1,price:null!==(t=null!==(a=e.price)&&void 0!==a?a:l.price)&&void 0!==t?t:0}:null}).filter(Boolean):[],cutlery:!!e.cutlery,time:"string"===typeof e.time?e.time:(null===(a=e.time)||void 0===a?void 0:a.name)||"",address:E(e.address,t),notes:e.notes||"",paymentMethod:e.paymentMethod?P(Oe,e.paymentMethod):null,orderType:e.orderType||"",tableNumber:e.tableNumber||""}});pe(t=>({...t,type:"lunch",meals:e}))}et.current=ue.id},[ue,ye,je,ke,Ae,Ce,Me,Te,Oe,be,Be,qe,Ie,Re,Ke,Fe]),(0,l.useEffect)(()=>{if(ue)if(Array.isArray(ue.meals)){const e=Number((0,k.N9)(ue.meals,3)||0);(ue.total||0)!==e&&pe(t=>({...t,total:e}))}else if(Array.isArray(ue.breakfasts)){const e=Number((0,w.VC)(ue.breakfasts,K,be)||0);(ue.total||0)!==e&&pe(t=>({...t,total:e}))}},[null===ue||void 0===ue?void 0:ue.meals,null===ue||void 0===ue?void 0:ue.breakfasts,K,be]);const tt=(e,t,a)=>{pe(l=>{const o=[...l.meals||[]],s={...o[e]||{}};if("soup"===t)s.soup=a||null,s.soupReplacement=null;else if("soupReplacement"===t)s.soupReplacement=a||null,s.soup=null;else if(t.includes(".")){const[e,l]=t.split(".");s[e]={...s[e]||{},[l]:a}}else s[t]=a;return o[e]=s,{...l,meals:o}})},at=(e,t,a)=>{pe(l=>{const o=[...l.breakfasts||[]],s={...o[e]||{}};if(t.includes(".")){const[e,l]=t.split(".");s[e]={...s[e]||{},[l]:a}}else s[t]=a;return o[e]=s,{...l,breakfasts:o}})},lt=()=>{const e=Je.map(e=>{var t,a,l,o,s;const r=Array.isArray(e.payments)&&e.payments.length?(0,C.XF)(e.payments):q(e);return{"N\xba Orden":e.id.slice(0,8),Tipo:"breakfast"===e.type?"Desayuno":"Almuerzo",Mesa:O((null===(t=e.meals)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.tableNumber)||(null===(l=e.breakfasts)||void 0===l||null===(o=l[0])||void 0===o?void 0:o.tableNumber)),Estado:e.status,Total:`$${(null===(s=e.total)||void 0===s?void 0:s.toLocaleString("es-CO"))||"N/A"}`,"M\xe9todo de Pago":r,Detalles:"lunch"===e.type?e.meals.map((e,t)=>`Almuerzo #${t+1}: Sopa: ${O(e.soup||e.soupReplacement)}, Principio: ${O(e.principle)}, Prote\xedna: ${O(e.protein)}, Bebida: ${O(e.drink)}, Acompa\xf1amientos: ${O(e.sides)}, Notas: ${e.notes||"Ninguna"}`).join("; "):e.breakfasts.map((e,t)=>`Desayuno #${t+1}: Tipo: ${O(e.type)}, Caldo: ${O(e.broth)}, Huevos: ${O(e.eggs)}, Arroz/Pan: ${O(e.riceBread)}, Bebida: ${O(e.drink)}, Prote\xedna: ${O(e.protein)}, Adiciones: ${O(e.additions)}, Notas: ${e.notes||"Ninguna"}`).join("; ")}}),t=j.Wp.json_to_sheet(e),a=j.Wp.book_new();j.Wp.book_append_sheet(a,t,"\xd3rdenes"),j._h(a,`ordenes_${xe}_${(0,A.GP)(new Date,"yyyy-MM-dd_HH-mm-ss")}.xlsx`)},ot=()=>{const e=new N.default;e.text("\xd3rdenes",14,10),e.autoTable({head:[["N\xba Orden","Tipo","Mesa","Estado","Total","M\xe9todo de Pago","Detalles"]],body:Je.map(e=>{var t,a,l,o,s;const r=Array.isArray(e.payments)&&e.payments.length?(0,C.XF)(e.payments):q(e);return[e.id.slice(0,8),"breakfast"===e.type?"Desayuno":"Almuerzo",O((null===(t=e.meals)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.tableNumber)||(null===(l=e.breakfasts)||void 0===l||null===(o=l[0])||void 0===o?void 0:o.tableNumber)),e.status,`$${(null===(s=e.total)||void 0===s?void 0:s.toLocaleString("es-CO"))||"N/A"}`,r,"lunch"===e.type?e.meals.map((e,t)=>`Almuerzo #${t+1}: Sopa: ${O(e.soup||e.soupReplacement)}, Principio: ${O(e.principle)}, Prote\xedna: ${O(e.protein)}, Bebida: ${O(e.drink)}, Acompa\xf1amientos: ${O(e.sides)}`).join("; "):e.breakfasts.map((e,t)=>`Desayuno #${t+1}: Tipo: ${O(e.type)}, Caldo: ${O(e.broth)}, Huevos: ${O(e.eggs)}, Arroz/Pan: ${O(e.riceBread)}, Bebida: ${O(e.drink)}, Prote\xedna: ${O(e.protein)}, Adiciones: ${O(e.additions)}`).join("; ")]})}),e.save(`ordenes_${xe}_${(0,A.GP)(new Date,"yyyy-MM-dd_HH-mm-ss")}.pdf`)},st=()=>{const e=[["N\xba Orden","Tipo","Mesa","Estado","Total","M\xe9todo de Pago","Detalles"],...Je.map(e=>{var t,a,l,o,s;const r=Array.isArray(e.payments)&&e.payments.length?(0,C.XF)(e.payments):q(e);return[e.id.slice(0,8),"breakfast"===e.type?"Desayuno":"Almuerzo",O((null===(t=e.meals)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.tableNumber)||(null===(l=e.breakfasts)||void 0===l||null===(o=l[0])||void 0===o?void 0:o.tableNumber)),e.status,`$${(null===(s=e.total)||void 0===s?void 0:s.toLocaleString("es-CO"))||"N/A"}`,r,`${"lunch"===e.type?e.meals.map((e,t)=>`Almuerzo #${t+1}: Sopa: ${O(e.soup||e.soupReplacement)}, Principio: ${O(e.principle)}, Prote\xedna: ${O(e.protein)}, Bebida: ${O(e.drink)}, Acompa\xf1amientos: ${O(e.sides)}, Notas: ${e.notes||"Ninguna"}`).join("; "):e.breakfasts.map((e,t)=>`Desayuno #${t+1}: Tipo: ${O(e.type)}, Caldo: ${O(e.broth)}, Huevos: ${O(e.eggs)}, Arroz/Pan: ${O(e.riceBread)}, Bebida: ${O(e.drink)}, Prote\xedna: ${O(e.protein)}, Adiciones: ${O(e.additions)}, Notas: ${e.notes||"Ninguna"}`).join("; ")}`]})].map(e=>e.map(e=>`"${String(e).replace(/"/g,'""')}"`).join(",")).join("\n"),t=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");a.href=URL.createObjectURL(t),a.download=`ordenes_${xe}_${(0,A.GP)(new Date,"yyyy-MM-dd_HH-mm-ss")}.csv`,a.click()},rt=e=>{e(),Y(null)};return V?(0,$.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:"Cargando..."}):(0,$.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,$.jsx)("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100 mb-6",children:"Gesti\xf3n de pedidos Mesas"}),(0,$.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6 text-sm text-gray-700 dark:text-gray-300",children:[(0,$.jsxs)("div",{className:(0,i.x)("p-3 sm:p-4 rounded-lg shadow-sm","dark"===R?"bg-gray-700":"bg-gray-100"),children:[(0,$.jsx)("p",{className:"font-semibold text-sm sm:text-base",children:"Total Efectivo"}),(0,$.jsxs)("p",{className:"text-lg sm:text-xl font-bold",children:["$",Math.floor(Ze.cash).toLocaleString("es-CO")]})]}),(0,$.jsxs)("div",{className:(0,i.x)("p-3 sm:p-4 rounded-lg shadow-sm","dark"===R?"bg-gray-700":"bg-gray-100"),children:[(0,$.jsx)("p",{className:"font-semibold text-sm sm:text-base",children:"Total Daviplata"}),(0,$.jsxs)("p",{className:"text-lg sm:text-xl font-bold",children:["$",Math.floor(Ze.daviplata).toLocaleString("es-CO")]})]}),(0,$.jsxs)("div",{className:(0,i.x)("p-3 sm:p-4 rounded-lg shadow-sm","dark"===R?"bg-gray-700":"bg-gray-100"),children:[(0,$.jsx)("p",{className:"font-semibold text-sm sm:text-base",children:"Total Nequi"}),(0,$.jsxs)("p",{className:"text-lg sm:text-xl font-bold",children:["$",Math.floor(Ze.nequi).toLocaleString("es-CO")]})]}),(0,$.jsxs)("div",{className:(0,i.x)("p-3 sm:p-4 rounded-lg shadow-sm","dark"===R?"bg-gray-700":"bg-gray-100"),children:[(0,$.jsx)("p",{className:"font-semibold text-sm sm:text-base",children:"Total General"}),(0,$.jsxs)("p",{className:"text-lg sm:text-xl font-bold",children:["$",Math.floor(Ze.cash+Ze.daviplata+Ze.nequi).toLocaleString("es-CO")]})]})]}),(0,$.jsxs)("div",{className:"flex flex-wrap justify-between items-center mb-6 gap-3 sm:gap-4",children:[(0,$.jsx)("input",{type:"text",value:J,onChange:e=>Q(e.target.value),placeholder:"Buscar \xf3rdenes por ID, mesa o m\xe9todo de pago...",className:(0,i.x)("p-2 sm:p-3 rounded-lg border focus:outline-none focus:ring-2 focus:ring-blue-500 w-full sm:max-w-xs shadow-sm text-sm sm:text-base transition-all duration-200","dark"===R?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900")}),(0,$.jsxs)("div",{className:"relative z-50 flex-shrink-0",ref:ve,children:[(0,$.jsx)("button",{onClick:()=>de(!ie),className:(0,i.x)("flex items-center justify-center p-2 rounded-lg text-xs sm:text-sm font-medium transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-blue-500"),"aria-label":"Opciones de men\xfa",children:(0,$.jsx)(d.A,{className:(0,i.x)("w-6 h-6","dark"===R?"text-gray-200 hover:text-white":"text-gray-700 hover:text-gray-900")})}),ie&&(0,$.jsx)("div",{className:(0,i.x)("absolute right-0 mt-2 w-48 rounded-lg shadow-xl z-50","dark"===R?"bg-gray-700 text-gray-200":"bg-white text-gray-900"),children:(0,$.jsxs)("div",{className:"py-1",children:[(0,$.jsx)("button",{onClick:()=>{he("breakfast"),de(!1)},className:"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200",children:"Ver Desayunos"}),(0,$.jsx)("button",{onClick:()=>{he("lunch"),de(!1)},className:"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200",children:"Ver Almuerzos"}),(0,$.jsx)("button",{onClick:()=>{he("all"),de(!1)},className:"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200",children:"Ver Todos"}),(0,$.jsxs)("button",{onClick:()=>{rt(lt),de(!1)},className:"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200 flex items-center",children:[(0,$.jsx)(c.A,{className:"w-4 h-4 mr-2"}),"Exportar Excel"]}),(0,$.jsxs)("button",{onClick:()=>{rt(ot),de(!1)},className:"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200 flex items-center",children:[(0,$.jsx)(c.A,{className:"w-4 h-4 mr-2"}),"Exportar PDF"]}),(0,$.jsxs)("button",{onClick:()=>{rt(st),de(!1)},className:"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200 flex items-center",children:[(0,$.jsx)(c.A,{className:"w-4 h-4 mr-2"}),"Exportar CSV"]})]})})]})]}),(0,$.jsx)("div",{className:(0,i.x)("p-3 sm:p-4 rounded-2xl shadow-xl max-h-[70vh] overflow-y-auto custom-scrollbar transition-all duration-300","dark"===R?"bg-gray-800":"bg-white"),children:X?(0,$.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,$.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-4 border-blue-500"})}):(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)("div",{className:"overflow-x-auto",children:(0,$.jsxs)("table",{className:"min-w-full text-left border-collapse text-sm",children:[(0,$.jsx)("thead",{children:(0,$.jsxs)("tr",{className:(0,i.x)("font-semibold sticky top-0 z-10 shadow-sm","dark"===R?"bg-gray-700 text-gray-200":"bg-gray-100 text-gray-700"),children:[(0,$.jsxs)("th",{className:"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap",onClick:()=>We("orderNumber"),children:["N\xba ",Ye("orderNumber")]}),(0,$.jsx)("th",{className:"p-2 sm:p-3 border-b whitespace-nowrap",children:"Detalles"}),(0,$.jsxs)("th",{className:"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap",onClick:()=>We("meals.0.tableNumber"),children:["Mesa ",Ye("meals.0.tableNumber")]}),(0,$.jsxs)("th",{className:"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap",onClick:()=>We("meals.0.paymentMethod.name"),children:["Pago ",Ye("meals.0.paymentMethod.name")]}),(0,$.jsxs)("th",{className:"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap",onClick:()=>We("total"),children:["Total ",Ye("total")]}),(0,$.jsxs)("th",{className:"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap",onClick:()=>We("status"),children:["Estado ",Ye("status")]}),(0,$.jsx)("th",{className:"p-2 sm:p-3 border-b whitespace-nowrap",children:"Acciones"})]})}),(0,$.jsx)("tbody",{children:0===Ue.length?(0,$.jsx)("tr",{children:(0,$.jsx)("td",{colSpan:"7",className:"p-6 text-center text-gray-500 dark:text-gray-400",children:"No se encontraron \xf3rdenes de mesas. Intenta ajustar tu b\xfasqueda."})}):Ue.map((e,t)=>{var a,l,o,s,d;const c="asc"===re?(ee-1)*ae+t+1:Ue.length-((ee-1)*ae+t),p=(e=>{if(Array.isArray(null===e||void 0===e?void 0:e.payments)&&e.payments.length){const t=e.payments.map(e=>{var t;return B("string"===typeof e.method?e.method:(null===e||void 0===e||null===(t=e.method)||void 0===t?void 0:t.name)||(null===e||void 0===e?void 0:e.method))}).filter(Boolean);return[...new Set(t)].join(" + ")||"Sin pago"}return B(L(e))||"Sin pago"})(e),h="Pendiente"===e.status?"bg-yellow-500 text-black":"Preparando"===e.status?"bg-blue-500 text-white":"Completada"===e.status?"bg-green-500 text-white":"Cancelada"===e.status?"bg-red-500 text-white":"";return(0,$.jsxs)("tr",{className:(0,i.x)("border-b transition-colors.duration-150","dark"===R?"border-gray-700 hover:bg-gray-700":"border-gray-200 hover:bg-gray-50",t%2===0?"dark"===R?"bg-gray-750":"bg-gray-50":""),children:[(0,$.jsx)("td",{className:"p-2 sm:p-3 text-gray-300",children:c}),(0,$.jsx)("td",{className:"p-2 sm:p-3 text-gray-300",children:(0,$.jsxs)("button",{onClick:()=>me(e),className:"text-blue-400 hover:text-blue-300 text-xs sm:text-sm flex items-center",title:"Ver detalles de la orden",children:[(0,$.jsx)(m.A,{className:"w-4 h-4 mr-1"}),"Ver"]})}),(0,$.jsx)("td",{className:"p-2 sm:p-3 text-gray-300 whitespace-nowrap",children:O((null===(a=e.meals)||void 0===a||null===(l=a[0])||void 0===l?void 0:l.tableNumber)||(null===(o=e.breakfasts)||void 0===o||null===(s=o[0])||void 0===s?void 0:s.tableNumber))}),(0,$.jsx)("td",{className:"p-2 sm:p-3 text-gray-300 whitespace-nowrap",children:p}),(0,$.jsxs)("td",{className:"p-2 sm:p-3 text-gray-300 whitespace-nowrap",children:["$",(null===(d=e.total)||void 0===d?void 0:d.toLocaleString("es-CO"))||"N/A"]}),(0,$.jsx)("td",{className:"p-2 sm:p-3 whitespace-nowrap",children:(0,$.jsxs)("select",{value:e.status||"Pendiente",onChange:t=>(async(e,t)=>{try{U(!0);const a="breakfast"===G.find(t=>t.id===e).type?"breakfastOrders":"tableOrders",l=(0,n.H9)(r.db,a,e);await(0,n.mZ)(l,{status:t,updatedAt:new Date}),Y(null)}catch(a){console.error("Error al actualizar estado:",a),Y("Error al actualizar el estado de la orden. Intenta de nuevo.")}finally{U(!1)}})(e.id,t.target.value),className:(0,i.x)("px-2 py-1 rounded-full text-xs font-semibold appearance-none cursor-pointer",h,"dark"===R?"bg-opacity-70":"bg-opacity-90","focus:outline-none focus:ring-2 focus:ring-blue-500"),children:[(0,$.jsx)("option",{value:"Pendiente",children:"Pendiente"}),(0,$.jsx)("option",{value:"Preparando",children:"Preparando"}),(0,$.jsx)("option",{value:"Completada",children:"Completada"}),(0,$.jsx)("option",{value:"Cancelada",children:"Cancelada"})]})}),(0,$.jsxs)("td",{className:"p-2 sm:p-3 whitespace-nowrap",children:[(0,$.jsx)("button",{onClick:()=>(e=>{pe(e)})(e),className:"text-blue-500 hover:text-blue-400 transition-colors duration-150 p-1 rounded-md mr-2",title:"Editar orden","aria-label":`Editar orden ${c}`,children:(0,$.jsx)(u.A,{className:"w-5 h-5"})}),(0,$.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\xbfEst\xe1s seguro de que deseas eliminar esta orden?"))try{U(!0);const t="breakfast"===G.find(t=>t.id===e).type?"breakfastOrders":"tableOrders";await(0,n.kd)((0,n.H9)(r.db,t,e)),Y(null)}catch(t){console.error("Error al eliminar orden:",t),Y("Error al eliminar la orden. Intenta de nuevo.")}finally{U(!1)}})(e.id),className:"text-red-500 hover:text-red-400 transition-colors duration-150 p-1 rounded-md",title:"Eliminar orden","aria-label":`Eliminar orden ${c}`,children:(0,$.jsx)(x.A,{className:"w-5 h-5"})})]})]},e.id)})})]})}),(0,$.jsxs)("div",{className:"flex flex-wrap justify-between items-center mt-6 gap-3",children:[(0,$.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300",children:[(0,$.jsx)("span",{children:"\xd3rdenes por p\xe1gina:"}),(0,$.jsxs)("select",{value:ae,onChange:e=>{le(Number(e.target.value)),te(1)},className:(0,i.x)("p-2 rounded-md border text-sm","dark"===R?"border-gray-600 bg-gray-700 text-white":"border-gray-300 bg-white text-gray-900"),children:[(0,$.jsx)("option",{value:"10",children:"10"}),(0,$.jsx)("option",{value:"20",children:"20"}),(0,$.jsx)("option",{value:"30",children:"30"}),(0,$.jsx)("option",{value:"50",children:"50"})]})]}),(0,$.jsxs)("div",{className:"flex.items-center gap-2 text-sm text-gray-700 dark:text-gray-300",children:[(0,$.jsx)("button",{onClick:()=>te(e=>Math.max(e-1,1)),disabled:1===ee,className:(0,i.x)("p-2 rounded-md transition-colors duration-200",1===ee?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"dark"===R?"hover:bg-gray-700 text-gray-200":"hover:bg-gray-100 text-gray-700"),children:(0,$.jsx)(h.A,{className:"w-5 h-5"})}),(0,$.jsxs)("span",{children:["P\xe1gina ",ee," de ",Xe]}),(0,$.jsx)("button",{onClick:()=>te(e=>Math.min(e+1,Xe)),disabled:ee===Xe,className:(0,i.x)("p-2 rounded-md transition-colors duration-200",ee===Xe?"text-gray-400 dark:text-gray-600 cursor-not-allowed":"dark"===R?"hover:bg-gray-700 text-gray-200":"hover:bg-gray-100 text-gray-700"),children:(0,$.jsx)(b.A,{className:"w-5 h-5"})})]})]}),ce&&(0,$.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10001]",children:(0,$.jsxs)("div",{className:(0,i.x)("p-4 sm:p-6 rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto","dark"===R?"bg-gray-800 text-gray-200":"bg-white text-gray-900"),children:[(0,$.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Detalles de la Orden #",ce.id.slice(0,8)]}),(0,$.jsxs)("p",{className:"text-sm mb-2",children:["Mesa: ",(null===(t=ce.meals)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.tableNumber)||(null===(M=ce.breakfasts)||void 0===M||null===(z=M[0])||void 0===z?void 0:z.tableNumber)||"N/A"]}),(0,$.jsxs)("p",{className:"text-sm mb-2",children:["Estado: ",ce.status]}),(0,$.jsxs)("p",{className:"text-sm mb-4",children:["Total: $",(null===(I=ce.total)||void 0===I?void 0:I.toLocaleString("es-CO"))||"N/A"]}),(0,$.jsx)(y.A,{meals:ce.meals||ce.breakfasts,isTableOrder:!0,calculateTotal:()=>ce.total}),(0,$.jsx)("button",{onClick:()=>me(null),className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm",children:"Cerrar"})]})}),ue&&(0,$.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10001]",children:(0,$.jsxs)("div",{className:(0,i.x)("p-4 sm:p-6 rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto","dark"===R?"bg-gray-800 text-gray-200":"bg-white text-gray-900"),children:[(0,$.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Editar Orden #",ue.id.slice(0,8)]}),Array.isArray(ue.breakfasts)?ue.breakfasts.map((e,t)=>(0,$.jsxs)("div",{className:"mb-6 p-4 border rounded-md border-gray-200 dark:border-gray-700",children:[(0,$.jsxs)("h4",{className:"text-sm font-medium mb-2",children:["Desayuno #",t+1]}),(0,$.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"Tipo"}),(0,$.jsx)(f.A,{title:"Tipo",emoji:"\ud83e\udd5e",options:be,selected:e.type||null,multiple:!1,onImmediateSelect:e=>at(t,"type",e)})]}),(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"Caldo"}),(0,$.jsx)(f.A,{title:"Caldo",emoji:"\ud83e\udd63",options:Be,selected:e.broth||null,multiple:!1,onImmediateSelect:e=>at(t,"broth",e)})]}),(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"block text-xs font-medium.mb-1",children:"Huevos"}),(0,$.jsx)(f.A,{title:"Huevos",emoji:"\ud83e\udd5a",options:qe,selected:e.eggs||null,multiple:!1,onImmediateSelect:e=>at(t,"eggs",e)})]}),(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"Arroz/Pan"}),(0,$.jsx)(f.A,{title:"Arroz/Pan",emoji:"\ud83c\udf5e",options:Ie,selected:e.riceBread||null,multiple:!1,onImmediateSelect:e=>at(t,"riceBread",e)})]}),(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"Bebida"}),(0,$.jsx)(f.A,{title:"Bebida",emoji:"\ud83e\udd64",options:Re,selected:e.drink||null,multiple:!1,onImmediateSelect:e=>at(t,"drink",e)})]}),(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"Prote\xedna"}),(0,$.jsx)(f.A,{title:"Prote\xedna",emoji:"\ud83c\udf56",options:Fe,selected:e.protein||null,multiple:!1,onImmediateSelect:e=>at(t,"protein",e)})]}),(0,$.jsxs)("div",{className:"sm:col-span-2",children:[(0,$.jsx)("label",{className:"block.text-xs font-medium mb-1",children:"Adiciones"}),(0,$.jsx)(f.A,{title:"Adiciones",emoji:"\u2795",options:Ke,selected:e.additions||[],multiple:!0,onImmediateSelect:e=>at(t,"additions",e.map(e=>({name:e.name,quantity:e.quantity||1,price:e.price||0})))})]}),(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"M\xe9todo de Pago"}),(0,$.jsx)(f.A,{title:"M\xe9todo de Pago",emoji:"\ud83d\udcb3",options:Oe,selected:e.paymentMethod||null,multiple:!1,onImmediateSelect:e=>at(t,"paymentMethod",e)})]}),(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"N\xfamero de Mesa"}),(0,$.jsx)("input",{type:"text",value:e.tableNumber||"",onChange:e=>at(t,"tableNumber",e.target.value),className:(0,i.x)("w-full p-2 rounded-md border text-sm","dark"===R?"border-gray-600 bg-gray-700 text-white":"border-gray-200 bg-white text-gray-900","focus:outline-none focus:ring-1 focus:ring-blue-500")})]}),(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"Tipo de Pedido"}),(0,$.jsxs)("select",{value:e.orderType||"",onChange:e=>at(t,"orderType",e.target.value),className:(0,i.x)("w-full p-2 rounded-md border text-sm","dark"===R?"border-gray-600 bg-gray-700 text-white":"border-gray-200 bg-white text-gray-900","focus:outline-none focus:ring-1 focus:ring-blue-500"),children:[(0,$.jsx)("option",{value:"",children:"Seleccionar"}),(0,$.jsx)("option",{value:"table",children:"Para mesa"}),(0,$.jsx)("option",{value:"takeaway",children:"Para llevar"})]})]}),(0,$.jsxs)("div",{className:"sm:col-span-2",children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"Notas"}),(0,$.jsx)("input",{type:"text",value:e.notes||"",onChange:e=>at(t,"notes",e.target.value),className:(0,i.x)("w-full p-2 rounded-md border text-sm","dark"===R?"border-gray-600 bg-gray-700 text-white":"border-gray-200 bg-white text-gray-900","focus:outline-none focus:ring-1 focus:ring-blue-500")})]})]})]},t)):null===(_=ue.meals)||void 0===_?void 0:_.map((e,t)=>(0,$.jsxs)("div",{className:"mb-6 p-4 border rounded-md border-gray-200 dark:border-gray-700",children:[(0,$.jsxs)("h4",{className:"text-sm font-medium mb-2",children:["Almuerzo #",t+1]}),(0,$.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"Sopa (excluyente con Reemplazo)"}),(0,$.jsx)(f.A,{title:"Sopa",emoji:"\ud83e\udd63",options:ye,selected:e.soup||null,multiple:!1,onImmediateSelect:e=>tt(t,"soup",e)})]}),(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"Reemplazo (ej: Solo bandeja)"}),(0,$.jsx)(f.A,{title:"Reemplazo",emoji:"\ud83d\udeab",options:je,selected:e.soupReplacement||null,multiple:!1,onImmediateSelect:e=>tt(t,"soupReplacement",e)})]}),(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"Principio"}),(0,$.jsx)(f.A,{title:"Principio",emoji:"\ud83c\udf5a",options:ke,selected:e.principle||[],multiple:!0,showConfirmButton:!0,onImmediateSelect:e=>tt(t,"principle",e)})]}),(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"Prote\xedna"}),(0,$.jsx)(f.A,{title:"Prote\xedna",emoji:"\ud83c\udf56",options:Ae,selected:e.protein||null,multiple:!1,onImmediateSelect:e=>tt(t,"protein",e)})]}),(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"Bebida"}),(0,$.jsx)(f.A,{title:"Bebida",emoji:"\ud83e\udd64",options:Ce,selected:e.drink||null,multiple:!1,onImmediateSelect:e=>tt(t,"drink",e)})]}),(0,$.jsxs)("div",{className:"sm:col-span-2",children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"Acompa\xf1amientos"}),(0,$.jsx)(f.A,{title:"Acompa\xf1amientos",emoji:"\ud83e\udd57",options:Me,selected:e.sides||[],multiple:!0,onImmediateSelect:e=>tt(t,"sides",e)})]}),(0,$.jsxs)("div",{className:"sm:col-span-2",children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"Adiciones"}),(0,$.jsx)(f.A,{title:"Adiciones",emoji:"\u2795",options:Te,selected:e.additions||[],multiple:!0,onImmediateSelect:e=>tt(t,"additions",e.map(e=>({id:e.id,name:e.name,price:e.price||0,protein:e.protein||"",replacement:e.replacement||"",quantity:e.quantity||1})))})]}),(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"M\xe9todo de Pago (legacy)"}),(0,$.jsx)(f.A,{title:"M\xe9todo de Pago",emoji:"\ud83d\udcb3",options:Oe,selected:e.paymentMethod||null,multiple:!1,onImmediateSelect:e=>tt(t,"paymentMethod",e)})]}),(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"N\xfamero de Mesa"}),(0,$.jsx)("input",{type:"text",value:e.tableNumber||"",onChange:e=>tt(t,"tableNumber",e.target.value),className:(0,i.x)("w-full p-2 rounded-md border text-sm","dark"===R?"border-gray-600 bg-gray-700 text.white":"border-gray-200 bg-white text-gray-900","focus:outline-none focus:ring-1 focus:ring-blue-500")})]}),(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"Tipo de Pedido"}),(0,$.jsxs)("select",{value:e.orderType||"",onChange:e=>tt(t,"orderType",e.target.value),className:(0,i.x)("w-full p-2 rounded-md border text-sm","dark"===R?"border-gray-600 bg-gray-700 text.white":"border-gray-200 bg-white text-gray-900","focus:outline-none focus:ring-1 focus:ring-blue-500"),children:[(0,$.jsx)("option",{value:"",children:"Seleccionar"}),(0,$.jsx)("option",{value:"table",children:"Para mesa"}),(0,$.jsx)("option",{value:"takeaway",children:"Para llevar"})]})]}),(0,$.jsxs)("div",{className:"sm:col-span-2",children:[(0,$.jsx)("label",{className:"block text-xs font-medium mb-1",children:"Notas"}),(0,$.jsx)("input",{type:"text",value:e.notes||"",onChange:e=>tt(t,"notes",e.target.value),className:(0,i.x)("w-full p-2 rounded-md border text-sm","dark"===R?"border-gray-600 bg-gray-700 text.white":"border-gray-200 bg-white text-gray-900","focus:outline-none focus:ring-1 focus:ring-blue-500")})]})]})]},t)),(0,$.jsxs)("div",{children:[(0,$.jsx)("label",{className:"text-xs block mb-1",children:"Total (se recalcula autom\xe1ticamente)"}),(0,$.jsx)("input",{type:"number",value:ue.total||0,onChange:e=>{return t=e.target.value,void pe(e=>({...e,total:Number(t)||0}));var t},placeholder:"Total",className:(0,i.x)("w-full p-2 mt-1 border rounded text-sm","dark"===R?"border-gray-600 bg-gray-700 text-white":"border-gray-200 bg-white text-gray-900")})]}),(0,$.jsx)("div",{className:"mt-4",children:(0,$.jsx)(S.A,{theme:R,total:ue.total||0,value:Array.isArray(ue.payments)&&ue.payments.length?ue.payments:(0,C._s)(ue),catalogMethods:Oe,onChange:e=>{pe(t=>({...t,payments:e}))}})}),(0,$.jsxs)("div",{className:"mt-4 flex space-x-2",children:[(0,$.jsx)("button",{onClick:async()=>{try{U(!0);const e=Array.isArray(ue.breakfasts),t=e?"breakfastOrders":"tableOrders",a=(0,n.H9)(r.db,t,ue.id),l=Number(e?(0,w.VC)(ue.breakfasts,K,be)||0:(0,k.N9)(ue.meals,K)||0),o=Array.isArray(ue.payments)&&ue.payments.length?ue.payments.map(e=>{var t;return{method:"string"===typeof e.method?e.method:(null===e||void 0===e||null===(t=e.method)||void 0===t?void 0:t.name)||"",amount:Math.floor(Number(e.amount||0))||0,note:e.note||""}}):(0,C._s)({...ue,total:l}),s=o.reduce((e,t)=>e+(t.amount||0),0);if(s!==l)return alert(`La suma de pagos (${s.toLocaleString("es-CO")}) no coincide con el total (${l.toLocaleString("es-CO")}). Aj\xfastala antes de guardar.`),void U(!1);const i=e?{breakfasts:ue.breakfasts}:{meals:ue.meals};await(0,n.mZ)(a,{...i,payments:o,total:l,updatedAt:new Date}),pe(null),Y(null)}catch(e){console.error("Error al guardar edici\xf3n:",e),Y("Error al guardar los cambios. Intenta de nuevo.")}finally{U(!1)}},className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 text-sm",children:"Guardar"}),(0,$.jsx)("button",{onClick:()=>pe(null),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 text-sm",children:"Cancelar"})]})]})})]})}),(0,$.jsxs)("div",{className:"fixed top-16 right-4 z-[10002] space-y-2 w-80 max-w-xs",children:[X&&(0,$.jsx)(g.A,{}),W&&(0,$.jsx)(v.A,{message:W,onClose:()=>Y(null)})]})]})}}}]);
//# sourceMappingURL=181.526ece90.chunk.js.map